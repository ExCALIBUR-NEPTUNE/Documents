TN-06_IonIonModelCollisionOperatorsKrookOperatorModelFokkerPlanckOperator
=========================================================================

.. meta::
   :description: technical note

   :keywords: Report,2070839-TN-06,1,Ion-ion,model,collision,operators:,a,Krook,operator,and,a,model,Fokker-Planck,operator,M.,R.,Hardman1,2,,J.,Omotani3,,M.,Barnes2,,S.,L.,Newton3,,and,F.,I.,Parra4,1,Tokamak,Energy,Ltd,,173,Brook,Drive,,Milton,Park,,Abingdon,,OX14,4SD,,United,Kingdom,2,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,3,United,Kingdom,Atomic,Energy,Authority,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,UK,4,Princeton,Plasma,Physics,Laboratory,,P.O.,Box,451,,Princeton,,New,Jersey,08540,,United,States,E-mail:,michael.hardman@tokamakenergy.co.uk,1.,Introduction,In,this,report,,we,explore,model,collision,operators,for,ion-ion,collisions.,Ion-ion,collisions,are,crucial,for,accurate,descriptions,of,the,plasma,for,several,reasons.,Firstly,,in,the,hot,core,of,the,plasma,,ion-ion,collisions,drive,the,ion,distribution,function,towards,a,Maxwellian,distribution,that,is,parameterised,by,a,density,,mean,velocity,,and,temperature,[1,,2].,Considering,the,small,turbulent,fluctuations,that,perturb,the,dominant,Maxwellian,distribution,,the,ion-ion,collisions,regularise,the,complicated,kinetic,ion,distribution,function,by,dissipating,fine,structures,in,velocity,space,[3,,4].,In,the,edge,,the,plasma,transitions,from,the,hot,core-like,conditions,to,a,much,colder,plasma,near,the,divertor,target.,Because,of,the,change,in,temperature,,the,Fokker-,Planck,collision,frequency,becomes,larger,,potentially,forcing,the,ion,distribution,function,closer,to,a,Maxwellian,and,making,even,the,turbulent,fluctuations,close,to,a,Maxwellian,response.,However,,at,the,divertor,target,itself,the,absorbing,ion,boundary,condition,implies,that,a,Maxwellian,distribution,is,not,the,solution,for,the,ion,distribution,function,–,to,find,the,form,of,the,ion,distribution,near,the,divertor,target,we,need,to,include,an,accurate,collision,operator,and,discover,how,the,operator,interacts,with,the,wall,boundary,conditions,[5].,Recent,PhD,work,by,M,Abazorius,explores,a,simplified,1D2V,model,of,ions,in,the,collisional,pre-sheath,with,the,exact,Fokker-Planck,ion,collision,operator,[6],and,Boltzmann,electrons,[5],–,this,work,shares,common,features,with,our,model,development,,such,as,finite-element,methods.,However,,the,work,in,[5],solves,only,steady-state,problems,,requiring,a,new,model,implementation,for,the,time-evolving,problem.,Report,2070839-TN-06,2,In,this,report,,we,consider,a,1D2V,model,of,a,simple,two,species,plasma,consisting,of,a,drift,kinetic,model,of,ions,and,Boltzmann,electrons.,For,the,collision,operator,we,consider,a,model,Krook,operator,[7].,We,test,our,implementation,of,the,Krook,operator,using,manufactured,solutions,tests.,We,also,document,the,initial,stages,of,our,work,in,progress,implementing,the,full,Fokker-Planck,operator.,We,begin,by,implementing,a,model,Fokker-Planck,operator,and,we,develop,analytical,functional,tests.,Whilst,we,have,not,yet,implemented,the,full,,exact,Fokker-Planck,operator,,our,results,may,influence,future,development.,2.,The,1D2V,model,of,the,plasma,The,ion,distribution,function,Fi,is,evolved,with,the,drift-kinetic,equation,[8]:,∂Fi,∂t,+,bzv∥,∂Fi,∂z,+,Cii,ebzEz,∂Fi,mi,∂v∥,(cid:2)Fi,,F,M,i,=,(cid:3),+,νK,(cid:0)F,M,i,−,Fi,(cid:1),+,ν∥,∂2Fi,∂v∥,2,+,Si,,(1),where,v∥,=,v,·,b,and,v⊥,=,|v,−,v∥b|,are,the,components,of,the,particle,velocity,v,that,are,parallel,and,perpendicular,to,the,magnetic,field,direction,b,=,B/B,,respectively,,with,B,the,magnetic,field,strength.,The,frequency,νK,is,an,effective,,constant,,collision,frequency,,F,M,is,a,Maxwellian,distribution,formed,from,the,first,three,velocity,moments,of,Fi,,i.e.,,i,(cid:34),exp,−,(cid:35),(v∥,−,u∥i)2,+,v2,⊥,v2,th,i,,,(2),(cid:3),is,the,modified,Fokker-Planck,operator,,which,we,and,the,collision,operator,Cii,describe,in,the,next,section.,The,variable,t,is,the,time,,bz,=,Bz/B,,ϕ,is,the,electrostatic,potential,,ν∥,is,a,numerical,diffusion,coefficient,,and,Si,is,a,source,function,that,may,be,used,to,inject,particles,,momentum,,and,heat,,or,to,facilitate,a,test,via,the,method,of,manufactured,solutions.,i,The,electrostatic,potential,is,computed,by,enforcing,quasineutrality,ni,=,ne,and,using,a,Boltzmann,response,for,electrons,,i.e.,,ni,=,ne,=,Ne,exp,(cid:19),,,(cid:18),eϕ,Te,(3),where,the,constant,Ne,is,either,taken,to,be,a,reference,density,,or,calculated,through,a,simple,electron,sheath,model.,The,ion,density,ni,is,computed,by,integrating,over,the,ion,distribution,function:,ni(z,,r,,t),=,2π,(cid:90),∞,(cid:90),∞,dv∥,−∞,0,dv⊥v⊥Fi(z,,r,,v⊥,,v∥,,t).,We,obtain,the,electric,fields,by,differentiation,of,ϕ:,Ez,=,−,∂ϕ,∂z,,,and,Er,=,−,∂ϕ,∂r,.,(4),(5),F,M,i,=,ni,π3/2v3,(cid:2)Fi,,F,M,th,i,Report,2070839-TN-06,3,3.,The,Fokker-Planck,collision,operator,The,full,Fokker-Planck,operator,for,collisions,between,species,indexed,by,s,and,s′,with,distribution,functions,Fs,=,Fs(v),and,Fs′,=,Fs′(v),,respectively,,is,[6,,9],Css′,[Fs,,Fs′],=,(cid:26)(cid:90),γss′,ms,∂,∂v,·,∂2g,∂v∂v,(cid:20),Fs′(v′),ms,·,∂Fs,∂v,−,Fs(v),ms′,∂Fs′,∂v′,(cid:21),(cid:27),,,d3v′,where,and,γss′,=,2πZ,2,2e4,ln,Λss′,s,Zs′,(4πϵ0)2,g,=,|v,−,v′|.,(6),(7),(8),It,is,useful,to,reduce,the,collision,operator,to,the,drift-kinetic,case,where,the,distribution,functions,are,independent,of,gyroangle,,i.e.,,Fs,=,Fs(v∥,,v⊥),and,Fs′,=,Fs′(v∥,,v⊥).,We,write,the,operator,in,the,Rosenbluth-MacDonald-Judd,(RMJ),form,Css′,[Fs,,Fs′],=,∂Γ∥,∂v∥,+,1,v⊥,∂,∂v⊥,(v⊥Γ⊥),.,with,the,fluxes,and,Γ∥,=,γss′,m2,s,(cid:18),∂Fs,∂v∥,∂2Gs′,∂v∥,2,+,∂Fs,∂v⊥,∂2Gs′,∂v⊥∂v∥,−,2,ms,ms′,Fs,∂Hs′,∂v∥,Γ⊥,=,γss′,m2,s,(cid:18),∂Fs,∂v∥,∂2Gs′,∂v∥∂v⊥,+,∂Fs,∂v⊥,∂2Gs′,∂v⊥,2,−,2,ms,ms′,Fs,∂Hs′,∂v⊥,(cid:19),,,(cid:19),,,where,the,Rosenbluth,potentials,are,and,(cid:90),Gs′(v),=,Fs′(v′)g,d3v′,Hs′(v),=,(cid:90),Fs′(v′),g,d3v′.,In,terms,of,(v∥,,v⊥),coordinates,,the,Rosebluth,potentials,simplify,to,(9),(10),(11),(12),(13),Gs′,=,(cid:90),∞,(cid:90),∞,0,−∞,(cid:16)(cid:0)v∥,−,v′,∥,4,(cid:1)2,+,(v⊥,+,v′,⊥)2(cid:17)1/2,E(k(v∥,,v⊥,,v′,∥,,v′,⊥))Fs′(v′,∥,,v′,⊥)v′,⊥,dv′,∥dv′,⊥,,(14),and,Hs′,=,where,(cid:90),∞,(cid:90),∞,0,−∞,(cid:16)(cid:0)v∥,−,v′,∥,4,(cid:1)2,+,(v⊥,+,v′,⊥)2(cid:17)−1/2,K(k(v∥,,v⊥,,v′,∥,,v′,⊥))Fs′(v′,∥,,v′,⊥)v′,⊥,dv′,∥dv′,⊥,,(15),k(v∥,,v⊥,,v′,∥,,v′,⊥),=,2(v⊥v′,⊥)1/2,(cid:16)(cid:0)v∥,−,v′,∥,(cid:1)2,+,(v⊥,+,v′,⊥)2(cid:17)−1/2,,,(16),Report,2070839-TN-06,and,we,have,used,the,definitions,of,the,complete,elliptic,integral,of,the,first,kind,K(k),=,(cid:90),π/2,0,1,1,−,k2,sin2,θ,(cid:112),dθ,and,the,complete,elliptic,integral,of,the,second,kind,E(k),=,(cid:90),π/2,0,(cid:112),1,−,k2,sin2,θ,dθ.,3.1.,Rosenbluth,potentials,for,shifted,Maxwellian,distributions,It,is,useful,to,compute,these,potentials,for,the,shifted,Maxwellian,distribution,F,M,s′,(v),=,ns′,π3/2v3,th,s′,(cid:34),exp,−,(cid:35),.,(v,−,us′)2,v2,th,s′,4,(17),(18),(19),The,results,for,a,Maxwellian,distribution,centred,on,us′,=,0,are,given,by,[9],(cid:19),Gs′(v),=,ns′vth,s′G(η),=,exp,(cid:2)−η2(cid:3),+,(1,+,2η2),erf(η),ns′vth,s′,2η,(cid:18),2η,√,π,and,Hs′(v),=,ns′,vth,s′,H(η),=,ns′,vth,s′,erf(η),η,,,,,(20),(21),with,η,=,|v|/vth,s′.,For,the,case,where,us′,̸=,0,we,can,find,a,very,similar,result,(cid:35),|v,−,v′|,d3v′,(cid:90),(cid:90),Gs′(v),=,=,(v,−,us′)2,v2,th,s′,(cid:35),(cid:34),exp,−,(cid:34),exp,−,ns′,π3/2v3,th,s′,ns′,π3/2v3,th,s′,(cid:18)|v,−,us′|,vth,s′,|w′|2,v2,th,s′,(cid:19),,,=,ns′vth,s′G,|(v,−,us′),−,w′|,d3w′,(22),where,G(η),is,defined,above.,Similarly,,we,find,that,for,a,shifted,Maxwellian,Hs′(v),=,ns′,vth,s′,H,(cid:18),|v,−,us′|,vth,s′,(cid:19),.,These,results,mean,that,we,can,use,(20),and,(21),with,η,defined,by,η,=,|v,−,us′|,vth,s′,=,(cid:112)(v∥,−,u∥,s′)2,+,v2,vth,s′,⊥,,,(23),(24),where,we,have,used,that,us′,=,u∥,s′b,in,the,leading-order,drift-kinetic,model.,The,coefficients,needed,for,the,collision,operator,that,are,derived,from,the,Rosenbluth,potentials,are,∂2Gs′,2,,,∂v∥,∂2Gs′,∂v∥∂v⊥,,,∂2Gs′,2,,,∂v⊥,∂Hs′,∂v∥,,,and,∂Hs′,∂v⊥,.,(25),Report,2070839-TN-06,In,terms,of,the,functions,G(η),and,H(η),,these,coefficients,are,(cid:32),∂2Gs′,∂v∥,2,=,ns′,vth,s′η,dG,dη,+,(v∥,−,u∥,s′)2,v2,th,s′,d,dη,(cid:19)(cid:33),,,(cid:18),1,η,dG,dη,∂2Gs′,∂v∥∂v⊥,=,ns′v⊥(v∥,−,u∥,s′),v3,th,s′η,d,dη,∂2Gs′,∂v⊥,2,=,ns′,vth,s′η,(cid:32),dG,dη,+,v2,⊥,v2,th,s′,d,dη,(cid:18),1,η,dG,dη,(cid:19),,,(cid:19)(cid:33),,,(cid:18),1,η,dG,dη,and,where,we,have,used,that,∂Gs′,∂v⊥,=,ns′v⊥,vth,s′η,dG,dη,,,∂Hs′,∂v∥,=,ns′(v∥,−,u∥,s′),v3,th,s′η,dH,dη,,,∂Hs′,∂v⊥,=,ns′v⊥,v3,th,s′η,dH,dη,,,∂η,∂v∥,=,v∥,−,u∥,s′,v2,th,s′η,,,∂η,∂v⊥,=,v⊥,v2,th,s′η,.,The,derivatives,of,G(η),and,H(η),are,dG,dη,=,(cid:18),1,√,π,exp,[−η2],η,(cid:18),+,1,−,(cid:19),1,2η2,(cid:19),erf(η),,,(cid:19),d,dη,(cid:18),1,η,dG,dη,=,(cid:18)(cid:18),3,2η2,−,1,(cid:19),erf(η),η2,−,3,√,π,exp,[−η2],η3,(cid:19),,,and,dH,dη,=,(cid:18),2,√,π,exp,[−η2],η,−,erf(η),η2,(cid:19),=,−,d2G,dη2,.,3.2.,Collisions,between,Maxwellian-distributed,particle,species,5,(26),(27),(28),(29),(30),(31),(32),(33),(34),(35),It,is,tedious,but,straightforward,to,compute,the,fluxes,for,collisions,between,particles,distributed,with,F,M,s,.,The,results,are,s′,and,F,M,Γ∥,=,−,2,π3/2,γss′,m2,s,ns′ns,vth,s′v4,th,s,(cid:34),exp,−,(v∥,−,u∥,s)2,+,v2,⊥,v2,th,s,(cid:35),(cid:32),(cid:32),d2G,dη2,+,ms,ms′,v2,th,s,v2,th,s′,dH,dη,(cid:33),+,u∥,s′,−,u∥,s,vth,s,1,η,(cid:32),dG,dη,+,(v∥,−,u∥,s′)2,v2,th,s′,v∥,−,u∥,s′,vth,s,(cid:18),1,η,dG,dη,d,dη,(cid:19)(cid:33),(cid:33),,,(36),Report,2070839-TN-06,and,Γ⊥,=,−,2,π3/2,γss′,m2,s,v⊥nsns′,v5,th,svth,s′,(cid:34),exp,−,(v∥,−,u∥,s)2,+,v2,⊥,v2,th,s,(cid:35),(cid:32),+,(u∥,s′,−,u∥,s)(v∥,−,u∥,s′),v2,th,s′,1,η,d,dη,(cid:18),1,η,dG,dη,6,(37),ms,ms′,v2,th,s,v2,th,s′η,dH,dη,d2G,dη2,+,(cid:19),(cid:33),,,respectively.,Note,that,if,F,M,s,=,F,M,s′,then,Γ∥,=,Γ⊥,=,0,identically.,3.3.,The,model,Fokker-Planck,operator,The,numerical,calculation,of,Gs′,from,equation,(12),is,relatively,straightforward,using,Clenshaw-Curtis,or,Gaussian,quadrature,integration,weights.,However,,the,integrand,contains,a,square,root,function,,meaning,that,spectrally,accurate,results,are,not,guaranteed.,For,the,Rosenbluth,potential,Hs′,,defined,by,equation,(13),,the,problem,is,more,challenging,,because,the,integrand,diverges,wherever,v′,=,v.,This,problem,only,becomes,more,severe,as,further,differentiations,are,applied,to,obtain,the,formal,definitions,of,the,coefficients,in,equation,(25).,Although,the,solution,of,this,problem,is,desirable,,we,leave,this,to,future,work.,A,possible,solution,may,be,to,use,integration,quadratures,or,cubatures,that,pack,points,near,to,the,location,of,the,divergence,in,v′,(see,section,19.8.6,of,[10],for,examples,in,1D,of,quadratures,that,can,resolve,divergences,of,the,form,z−1+α,with,z,the,integration,variable,and,α,>,0,).,Previous,authors,[5,,11],have,avoided,this,problem,by,using,the,Landau,form,of,the,collision,operator,,where,the,symmetry,of,the,operator,prevents,divergences,in,the,velocity,integrals,over,v′.,For,this,report,detailing,our,work-in-progress,,we,consider,the,possibility,of,avoiding,the,complex,integration,of,diverging,integrands,entirely.,It,is,possible,to,compute,the,coefficients,(25),by,direct,differentiation,of,Gs′,,using,the,identity,where,the,Laplacian,operator,is,L,[Gs′],=,2Hs′,,L,[f,],=,∂2f,∂v∥,2,+,1,v⊥,∂,∂v⊥,(cid:18),v⊥,(cid:19),.,∂f,∂v⊥,(38),(39),However,,up,to,three,numerical,derivatives,are,required,to,compute,the,coefficients,(with,a,final,fourth,derivative,required,to,evaluate,the,divergence,of,the,collisional,fluxes),,and,we,find,that,the,loss,of,accuracy,with,each,numerical,derivative,and,the,initial,numerical,calculation,of,Gs′,is,too,high,for,this,method,to,work,in,our,current,‘strong,form’,numerical,implementation,where,derivatives,of,functions,(evaluated,at,collocation,points),are,evaluated,directly,using,interpolation,with,Chebyshev,polynomials.,We,illustrate,the,challenge,presented,by,the,numerical,problem,of,computing,the,Rosenbluth,potentials,and,derived,coefficients,using,the,‘strong-form’,Chebyshev,In,figure,1,,we,plot,the,maximum,derivatives,implemented,in,‘moment-kinetics’.,Report,2070839-TN-06,7,absolute,error,in,the,result,of,calculating,the,Rosenbluth,potential,Gs′,for,a,Maxwellian,by,direct,integration,using,equation,(14),,comparing,to,the,analytical,result,(22).,We,then,compute,the,potential,Hs′,and,the,derived,coefficients,by,numerical,differentiation,and,compare,the,results,to,the,analytical,formulae.,Note,the,loss,of,convergence,with,each,subsequent,derivative,,and,the,deviation,from,the,expected,scaling.,We,can,make,an,interesting,observation,by,doing,the,same,calculation,for,Hs′,and,the,derived,coefficients,starting,from,the,analytically,prescribed,Gs′,for,a,Maxwellian,input.,The,maximum,errors,in,this,calculation,are,shown,in,figure,2,,demonstrating,far,better,rates,of,convergence,than,in,figure,1.,(The,result,of,computing,Gs′,numerically,is,left,on,figure,2,for,comparison).,From,this,we,can,conclude,(i),that,our,current,scheme,rapidly,accrues,numerical,error,with,each,subsequent,derivative,and,(ii),the,quality,of,the,numerical,integration,precludes,this,simple,‘direct’,computation,of,the,Rosenbluth,potentials,for,arbitrary,Fi.,Finally,,we,can,test,the,numerical,implementation,of,the,fluxes,Γ∥,and,Γ⊥,with,the,analytical,results,for,the,collisional,fluxes,due,to,colliding,Maxwellian,distributions.,The,maximum,errors,are,shown,in,figure,4,,demonstrating,good,convergence.,Overall,,these,results,demonstrate,that,we,have,implemented,the,collision,operator,correctly,in,our,current,formalism,,but,that,the,numerical,methods,that,we,are,using,are,inadequate,for,the,full-F,operator.,To,make,progress,towards,the,full,Fokker,Planck,collision,operator,,whilst,providing,a,plausible,model,operator,,we,make,use,of,the,fact,that,the,Rosenbluth,potentials,are,known,for,shifted,Maxwellian,distributions.,Using,the,fact,that,the,collision,operator,is,bilinear,,we,replace,the,second,argument,Fs′,of,Css′,[Fs,,Fs′],with,the,Maxwellian,distribution,with,the,same,density,velocity,and,temperature,moment,F,M,s′,,,yielding,(cid:3),where,the,coefficients,from,the,Rosenbluth,potentials,are,the,operator,Css′,given,by,(26)-(30).,This,is,an,uncontrolled,approximation,which,must,(eventually),be,justified,a,posteriori,by,comparisons,to,results,obtained,using,the,exact,collision,operator.,Unfortunately,,we,do,not,present,simulations,using,this,operator,in,this,report,,due,to,problems,obtaining,a,stable,steady-state,solution.,Addressing,these,problems,are,left,for,future,work.,(cid:2)Fs,,F,M,s′,4.,Krook,operators,We,now,turn,to,a,description,of,the,Krook,operator.,The,general,Krook,operator,has,the,form,ss′,[Fs,,Fs′],=,νK,where,νK,is,a,collision,frequency,,and,F,M,s′,first,three,velocity,moments,of,Fs′,,i.e.,,C,K,s′,(v),−,Fs(v)(cid:1),,,(cid:0)F,M,is,a,Maxwellian,distribution,formed,from,the,(40),with,F,M,s′,(v),=,ns′,π3/2v3,th,s′,(cid:34),exp,−,(cid:35),,,(v,−,us′)2,v2,th,s′,(cid:90),ns′,=,Fs′(v′),d3v′,,(41),(42),Report,2070839-TN-06,8,Figure,1:,Results,showing,the,numerical,calculation,of,the,Rosenbluth,potential,Gs′,via,numerical,integration,,comparing,to,the,analytical,result,for,a,shifted,Maxwellian,distribution.,The,potential,Hs′,and,subsequent,coefficients,are,obtained,using,numerical,differentiation,,and,compared,to,analytical,results.,The,error,norm,is,the,maximum,value,of,the,absolute,error.,This,figure,was,generated,using,the,script,fkpl,test.jl,on,commit,a6f06ccbbb37de8be113cb31d9c2f28c7fbdf52c.,We,scan,in,the,number,of,elements,in,the,v∥,and,v⊥,grids,Nelement,,for,fixed,Ngrid,=,8,,and,box,sizes,Lv∥,=,12cref,and,Lv⊥,=,6cref.,us′,=,(cid:90),1,ns′,v′Fs′(v′),d3v′,,and,vth,s′,=,(cid:114),2Ts′,ms′,,,where,Ts′,=,(cid:90),ms′,3ns′,(v,−,us′)2Fs′(v′),d3v′.,(43),(44),We,emphasise,that,the,Krook,operator,is,an,ad-hoc,model,which,is,used,primarily,for,simplicity,when,analytical,calculation,involving,the,collision,operator,needs,to,be,carried,out,,commonly,in,the,context,of,teaching,pedagogical,material,,or,when,the,details,of,the,restoration,of,a,perturbed,distribution,function,are,of,no,consequence.,In,the,drift,kinetic,model,,this,nonlinear,model,collision,operator,undergoes,a,simplification,due,to,the,gyrotropic,nature,of,Fs,=,Fs(v∥,,v⊥).,Firstly,,the,leading-order,mean,velocity,is,entirely,parallel,to,the,magnetic,field,line,,i.e.,,us,=,u∥,sb,+,O,(vthρ∗),,,(45),Report,2070839-TN-06,9,Figure,2:,Results,showing,the,numerical,calculation,of,the,Rosenbluth,potential,Hs′,via,numerical,differentiation,,from,an,analytically,specified,Gs′,,comparing,to,the,analytical,result,for,a,shifted,Maxwellian,distribution.,The,subsequent,coefficients,are,obtained,using,numerical,differentiation,of,the,analytically,specified,Gs′,,and,compared,to,analytical,results.,The,error,norm,is,the,maximum,value,of,the,absolute,error.,This,figure,was,generated,using,the,script,fkpl,test.jl,on,commit,a6f06ccbbb37de8be113cb31d9c2f28c7fbdf52c.,We,scan,in,the,number,of,elements,in,the,v∥,and,v⊥,grids,Nelement,,for,fixed,Ngrid,=,8,,and,box,sizes,Lv∥,=,12cref,and,Lv⊥,=,6cref.,with,u∥,s,=,1,ns,(cid:90),∞,(cid:90),∞,−∞,0,v∥Fs,2v⊥dv⊥dv∥.,(46),In,the,model,,the,effect,of,perpendicular,mean,flow,(the,E×B,flow),is,only,important,because,of,the,very,small,pitch,bz,∼,ρ∗,of,the,magnetic,field,line.,The,perpendicular,components,of,the,mean,flow,may,be,found,with,the,gyrophase-dependent,part,of,the,distribution,function,,which,is,O,(ρ∗),small,compared,to,Fs.,Secondly,,the,operator,appearing,in,the,drift,kinetic,equation,must,be,the,gyrophase,averaged,Krook,operator,(cid:10)C,K,ss′,[Fs,,Fs′](cid:11),,where,⟨·⟩,=,1,2π,(cid:90),π,−π,(·),dϑ.,(47),Using,this,information,,we,can,write,a,more,explict,form,of,the,operator,that,appears,Report,2070839-TN-06,10,Figure,3:,The,result,of,calculating,the,collisional,fluxes,Γ∥,and,Γ⊥,for,Maxwellian,inputs,,comparing,to,the,analytical,result,for,differing,Maxwellian,distributions.,The,Rosen-,bluth,potentials,in,these,fluxes,are,specified,analytically.,The,error,in,the,calculation,declines,at,a,similar,rate,to,the,expected,scaling.,This,figure,was,generated,using,the,script,fkpl,test.jl,on,commit,a6f06ccbbb37de8be113cb31d9c2f28c7fbdf52c.,We,scan,in,the,number,of,elements,in,the,v∥,and,v⊥,grids,Nelement,,for,fixed,Ngrid,=,8,,and,box,sizes,Lv∥,=,12cref,and,Lv⊥,=,6cref.,in,the,drift,kinetic,equation,,to,leading-order,in,O,(ρ∗):,(cid:10)C,K,ss′,[Fs,,Fs′](cid:11),=,νK,(cid:32),ns′,π3/2v3,th,s′,(cid:34),exp,−,5.,Normalised,system,of,equations,(cid:1)2,+,v2,⊥,(cid:0)v∥,−,u∥,s′,v2,th,s′,(cid:35),(cid:33),−,Fs(v∥,,v⊥),.,(48),The,normalised,drift,kinetic,equation,for,ions,may,be,written,as,∂,(cid:101)Fi,∂˜t,+,bz,˜v∥,∂,(cid:101)Fi,∂,˜z,+,bz,(cid:101)Ez,2,∂,(cid:101)Fi,∂˜v∥,(cid:105),(cid:104),(cid:101)Fi,,(cid:101)F,M,i,(cid:101)Cii,=,+,˜νK,(cid:16),(cid:101)F,M,i,−,(cid:101)Fi,(cid:17),+,˜ν∥,∂2,(cid:101)Fi,∂˜v2,∥,+,(cid:101)Si,,(49),√,2Trefmref,is,the,normalising,speed,and,Lref,is,the,normalising,length.,where,cref,=,The,variables,˜t,=,tcref/Lref,,˜v∥,=,v∥/cref,,˜v⊥,=,v⊥/cref,,˜z,=,z/Lref.,The,normalised,Report,2070839-TN-06,11,distribution,functions,are,(cid:101)Fi,=,π3/2c3,refFi/nref,,with,nref,the,normalising,density.,The,normalised,diffusion,coefficient,˜ν∥,=,Lrefν∥/c3,ref.,The,normalised,source,is,(cid:101)Si,=,LrefSi/cref,,the,normalised,Krook,operator,frequency,is,˜νK,=,LrefνK/cref.,The,potential,(cid:101)ϕ,=,eϕ/Tref,is,determined,by,the,normalised,quasineutrality,relation,,(cid:101)ni,=,(cid:101)ne,=,(cid:101)Ne,exp,(cid:32),(cid:33),.,(cid:101)ϕ,(cid:101)Te,The,normalised,electric,fields,are,defined,by,(cid:101)Ez,=,−,∂,(cid:101)ϕ,∂,˜z,,,and,(cid:101)Er,=,−,∂,(cid:101)ϕ,∂˜r,.,and,the,density,is,defined,by,(cid:101)ni,=,1,√,π,(cid:90),∞,(cid:90),∞,d˜v∥,−∞,0,2d˜v⊥˜v⊥,(cid:101)Fi.,(50),(51),(52),The,normalised,Maxwellian,distribution,(cid:101)F,M,i,expression,,is,defined,by,setting,s′,=,i,in,the,following,(cid:101)F,M,s′,=,˜ns′,˜v3,th,s′,(cid:34),exp,−,(cid:0)˜v∥,−,˜u∥,s′,˜v2,th,s′,(cid:1)2,+,˜v2,⊥,(cid:35),with,˜ns′,=,ns′/nref,,˜vth,s′,=,vth,s′/cref,,and,˜u∥,s′,=,u∥,s/cref.,Finally,,the,normalised,Fokker-Planck,operator,is,given,by,with,and,(cid:104),(cid:101)Css′,(cid:101)Fs,,(cid:101)Fs′,(cid:105),=,∂(cid:101)Γ∥,∂˜v∥,+,(cid:16),1,˜v⊥,∂,∂˜v⊥,(cid:17),,,˜v⊥(cid:101)Γ⊥,(cid:32),(cid:32),(cid:101)Γ∥,=,(cid:101)νss′,(cid:101)Γ⊥,=,(cid:101)νss′,∂,(cid:101)Fs,∂˜v∥,∂2,(cid:101)Gs′,∂˜v2,∥,+,∂,(cid:101)Fs,∂˜v⊥,∂2,(cid:101)Gs′,∂˜v⊥∂˜v∥,−,2,ms,ms′,Fs,∂,(cid:101)Hs′,∂˜v∥,∂,(cid:101)Fs,∂˜v∥,∂2,(cid:101)Gs′,∂˜v∥∂˜v⊥,+,∂,(cid:101)Fs,∂˜v⊥,∂2,(cid:101)Gs′,∂˜v2,⊥,−,2,ms,ms′,(cid:101)Fs,∂,(cid:101)Hs′,∂˜v⊥,(cid:33),(cid:33),,,,,where,(cid:101)νss′,=,Lrefνss′/cref,and,νss′,=,γss′nref,sc3,m2,ref,.,The,normalised,Rosenbluth,potentials,are,defined,by,Gs′,=,nrefcref,(cid:101)Gs′,,and,Hs′,=,nref,cref,(cid:101)Hs′.,with,integral,definitions,given,by,(cid:101)Gs′,=,(cid:90),∞,(cid:90),∞,0,−∞,(cid:16)(cid:0)˜v∥,−,˜v′,∥,(cid:1)2,+,(˜v⊥,+,˜v′,⊥)2(cid:17)1/2,2E(k(˜v∥,,˜v⊥,,˜v′,∥,,˜v′,⊥)),π,(cid:101)Fs′(˜v′,∥,,˜v′,⊥),(53),(54),(55),(56),(57),(58),2˜v′,⊥√,π,d˜v′,∥d˜v′,⊥,(59),Report,2070839-TN-06,and,12,(cid:90),∞,(cid:90),∞,(cid:16)(cid:0)˜v∥,−,˜v′,(cid:1)2,+,(˜v⊥,+,˜v′,0,∥,−∞,(cid:101)Hs′,=,∥d˜v′,⊥,,(60),respectively.,The,normalised,values,of,the,Rosenbluth,potential,coefficients,for,a,shifted,Maxwellian,may,be,inferred,from,equations,(26)-(30),and,(58).,(cid:101)Fs′(˜v′,∥,,˜v′,d˜v′,⊥),π,⊥)2(cid:17)−1/2,2K(k(˜v∥,,˜v⊥,,˜v′,∥,,˜v′,⊥)),2˜v′,⊥√,π,5.1.,Calculating,the,thermal,speed,To,evaluate,the,Krook,operator,,we,must,calculate,the,thermal,speed.,We,normalise,the,velocities,to,cref,=,(cid:112)2Tref/mref.,Hence,,the,normalised,thermal,speed,is,˜vth,s,=,vth,s,cref,=,(cid:114),Ts,Tref,mref,ms,=,(cid:115),˜Ts,˜ms,.,(61),We,calculate,the,normalised,temperature,from,the,pressure,and,the,density.,The,isotropic,pressure,is,defined,by,(cid:90),∞,(cid:90),∞,(cid:0)(v′,∥,−,u∥,s)2,+,(v′,⊥)2(cid:1),Fs(v′,∥,,v′,⊥),2πv′,⊥dv′,⊥dv′,∥.,(62),ps,=,ms,3,−∞,0,The,normalised,pressure,˜ps,=,ps/nrefTref,is,then,given,by,(cid:90),∞,(cid:90),∞,˜ps,=,2,˜ms,3,−∞,0,(cid:0)(˜v′,∥,−,˜u∥,s)2,+,(˜v′,⊥)2(cid:1),(cid:101)Fs(˜v′,∥,,˜v′,⊥),2˜v′,⊥√,π,d˜v′,⊥d˜v′,∥.,We,can,also,define,a,parallel,pressure,p∥,s,=,ms,(cid:90),∞,(cid:90),∞,−∞,0,and,a,perpendicular,pressure,(v′,∥,−,u∥,s)2Fs(v′,∥,,v′,⊥),2πv′,⊥dv′,⊥dv′,∥,,p⊥,s,=,ms,2,(cid:90),∞,(cid:90),∞,−∞,0,(v′,⊥)2Fs(v′,∥,,v′,⊥),2πv′,⊥dv′,⊥dv′,∥,,so,that,ps,=,1,3,(cid:0)p∥,s,+,2p⊥,s,(cid:1),.,(63),(64),(65),(66),The,normalised,parallel,and,perpendicular,pressures,˜p∥,s,=,p∥,s/nrefTref,and,˜p⊥,s,=,p⊥,s/nrefTref,are,˜p∥,s,=,2,˜ms,(cid:90),∞,(cid:90),∞,−∞,0,(˜v′,∥,−,˜u∥,s)2,(cid:101)Fs(˜v′,∥,,˜v′,⊥),2v′,⊥√,π,d˜v′,⊥d˜v′,∥,,and,˜p⊥,s,=,˜ms,(cid:90),∞,(cid:90),∞,−∞,0,(˜v′,⊥)2,(cid:101)Fs(˜v′,∥,,˜v′,⊥),2v′,⊥√,π,d˜v′,⊥d˜v′,∥,,respectively.,Finally,,we,use,that,˜Ts,=,Ts/Tref,=,ps/nsTref,=,˜ps/(cid:101)ns,to,write,˜vth,s,=,(cid:114),˜ps,˜ms(cid:101)ns,(67),(68),(69),Report,2070839-TN-06,13,5.2.,Extending,the,wall-boundary,manufactured,solutions,test,results,To,test,the,implementation,of,the,Krook,operator,,we,require,results,for,the,plasma,density,,velocity,,and,thermal,speed.,We,calculate,these,quantities,in,the,existing,wall-,boundary,test,existing,in,the,moment-kinetics,code,framework,[12].,For,the,distribution,function,,we,choose,(cid:34),H,(cid:0)v∥,(cid:1),v4,∥,(cid:101)Fi,=,(cid:19),(cid:18)1,2,+,˜z,˜Lz,n+(˜z,,˜r),+,H,(cid:0)−v∥,(cid:1),v4,∥,(cid:18),1,2,(cid:19),(cid:18)1,2,−,+,(cid:19),(cid:19),˜z,˜Lz,˜z,˜Lz,n−(˜z,,˜r),(cid:35),n0(˜z,,˜r),exp,(cid:0)−v2,∥,−,˜v2,⊥,(cid:1),,,(70),+,(cid:18),1,2,−,˜z,˜Lz,where,v∥,=,˜v∥,−,αρ∗,(cid:101)Er/2bz,,and,α,takes,the,values,of,0,or,1,depending,on,the,type,of,test,carried,out.,We,require,the,forms,of,(cid:101)ni,,(cid:101)u∥i,,(cid:101)p∥i,and,(cid:101)p⊥i.,We,assume,that,˜mi,=,1.,The,normalised,ion,density,is,defined,by,(cid:101)ni,=,1,√,π,(cid:90),∞,(cid:90),∞,d˜v∥,−∞,0,2d˜v⊥˜v⊥,(cid:101)Fi.,Evaluating,this,integral,,we,find,that,(cid:101)ni,=,3,8,n+(˜z,,˜r),(cid:19),(cid:18),1,2,+,˜z,˜Lz,+,3,8,n−(˜z,,˜r),(cid:18),1,2,+,n0(˜z,,˜r),(cid:18),1,2,−,+,˜z,˜Lz,(cid:19),˜z,˜Lz,(cid:19),(cid:18)1,2,−,(cid:19),.,˜z,˜Lz,The,normalised,velocity,is,defined,by,(cid:101)ni(cid:101)u∥i,=,=,1,√,π,1,√,π,(cid:90),∞,−∞,(cid:90),∞,(cid:90),∞,0,(cid:90),∞,d˜v∥,dv∥,−∞,0,2d˜v⊥˜v⊥˜v∥,(cid:101)Fi,(cid:32),2d˜v⊥˜v⊥,v∥,+,(cid:33),(cid:101)Fi.,αρ∗,(cid:101)Er,2bz,We,evaluate,this,integral,to,find,that,(71),(72),(73),(cid:101)ni(cid:101)u∥i,=,1,√,π,(cid:18),n+(˜z,,˜r),(cid:19),(cid:18),1,2,+,˜z,˜Lz,−,n−(˜z,,˜r),(cid:19)(cid:19),(cid:18),1,2,−,˜z,˜Lz,+,(cid:101)ni,αρ∗,(cid:101)Er,2bz,.,(74),Report,2070839-TN-06,14,The,normalised,parallel,pressure,is,(cid:101)p∥i,=,2,=,2,=,2,=,2,(cid:90),∞,(cid:90),∞,−∞,(cid:90),∞,0,(cid:90),∞,−∞,0,(cid:90),∞,(cid:90),∞,−∞,0,(cid:90),∞,(cid:90),∞,−∞,0,2v′,⊥√,π,d˜v′,⊥d˜v′,∥,(˜v′,∥,−,(cid:101)u∥i)2,(cid:101)Fi(˜v′,(cid:32),∥,,˜v′,⊥),(cid:33)2,v∥,+,αρ∗,(cid:101)Er,2bz,−,(cid:101)u∥i,(cid:101)Fi(˜v′,∥(v∥),,˜v′,⊥),2v′,⊥√,π,d˜v′,⊥dv∥,,v2,∥,+,2v∥,(cid:32),αρ∗,(cid:101)Er,2bz,(cid:33),(cid:32),−,(cid:101)u∥i,+,αρ∗,(cid:101)Er,2bz,−,(cid:101)u∥i,(cid:33)2,,(cid:101)Fi(˜v′,∥(v∥),,˜v′,⊥),v2,∥,(cid:101)Fi(˜v′,∥(v∥),,˜v′,⊥),2v′,⊥√,π,d˜v′,⊥dv∥,−,2(cid:101)ni,(cid:33)2,(cid:32),αρ∗,(cid:101)Er,2bz,−,(cid:101)u∥i,Evaluating,the,final,Gaussian,integral,,we,have,that,(cid:101)p∥i,=,15,8,n+(˜z,,˜r),+,n0(˜z,,˜r),(cid:18),1,2,(cid:18),1,2,+,+,˜z,˜Lz,˜z,˜Lz,(cid:19),+,15,8,n−(˜z,,˜r),(cid:18),1,2,−,(cid:19),(cid:18)1,2,(cid:32),(cid:19),−,˜z,˜Lz,−,2(cid:101)ni,(cid:19),˜z,˜Lz,αρ∗,(cid:101)Er,2bz,(cid:33)2,−,(cid:101)u∥i,.,We,can,write,the,final,term,on,the,RHS,explicitly,as,2v′,⊥√,π,d˜v′,⊥dv∥,(75),(76),(cid:19),(cid:101)p∥i,=,15,8,−,n+(˜z,,˜r),(cid:18),1,2,+,(cid:18),n+(˜z,,˜r),2,π(cid:101)ni,˜z,˜Lz,(cid:18),1,2,+,n−(˜z,,˜r),15,8,(cid:19),+,˜z,˜Lz,−,n−(˜z,,˜r),(cid:18),1,2,−,˜z,˜Lz,(cid:19)(cid:19)2,.,(cid:19),(cid:18),1,2,−,˜z,˜Lz,+,n0(˜z,,˜r),(cid:18),1,2,+,(cid:19),(cid:18)1,2,˜z,˜Lz,−,˜z,˜Lz,(cid:19),Finally,,the,normalised,perpendicular,pressure,is,(cid:101)p⊥i,=,(cid:90),∞,(cid:90),∞,−∞,0,(˜v′,⊥)2,(cid:101)Fi(˜v′,∥,,˜v′,⊥),and,we,evaluate,this,integral,to,find,that,(cid:101)p⊥i,=,(cid:101)ni.,5.3.,A,convergence,test,in,1D2V,2v′,⊥√,π,d˜v′,⊥d˜v′,∥,,(77),(78),(79),To,demonstrate,the,correct,implementation,of,the,Krook,collision,operator,in,two,velocity,dimensions,,we,use,the,analytical,results,derived,in,the,previous,section,to,carry,out,a,manufactured,solutions,test.,For,the,physical,parameters,in,the,model,,we,take,bz,=,1.0,,˜νK,=,1.0,,˜ν∥,=,0.0,,(cid:101)νii,=,0.0,,(cid:101)Ne,=,1.0,,and,(cid:101)Te,=,1.0.,The,input,file,corresponding,to,these,parameters,is,given,in,section,Appendix,A.1.,To,test,the,convergence,,we,carry,out,the,simulation,until,˜t,=,1,,for,varying,number,Report,2070839-TN-06,15,of,elements,Nelement,in,each,of,the,coordinate,dimensions,z,,v∥,,and,v⊥.,The,number,of,points,per,element,is,taken,to,be,Ngrid,=,17,,with,Lv∥,=,2Lv⊥,=,12cref.,We,take,∆˜t,=,0.002/Nelement.,The,results,of,the,scan,are,shown,in,figure,4,,where,the,error,norms,plotted,are,the,average,RMS,values,(see,equations,(10)-,(13),of,[12]).,The,expected,scaling,is,plotted.,We,note,that,the,convergence,is,slower,than,the,expected,scaling,,but,still,good,,albeit,with,a,rollover,at,the,very,largest,values,of,Nelement.,We,take,these,results,to,indicate,that,we,have,correctly,implemented,the,Krook,operator.,The,simulations,were,carried,out,with,commit,a6f06ccbbb37de8be113cb31d9c2f28c7fbdf52c.,Figure,4:,Results,demonstrating,the,correct,implementation,of,the,Krook,collision,operator,˜νK(,(cid:101)F,M,in,a,case,with,wall,boundary,conditions.,The,input,file,corresponding,to,these,simulations,is,given,in,section,Appendix,A.1.,Here,,Nel,=,Nelement,and,ng,=,Ngrid.,i,−,(cid:101)Fi),,6.,Steady-state,solutions,with,a,Krook,collision,operator,In,this,section,,we,examine,the,behaviour,of,the,sheath,model,in,the,presence,of,a,simple,ionisation,source,(cid:101)Si,=,exp,(cid:2)−˜v2,∥,−,˜v2,⊥,(cid:3),,,(80),and,the,Krook,operator,and,numerical,dissipation.,We,use,the,manufactured,solution,as,an,initial,condition,,and,we,allow,the,system,to,relax,to,a,steady,state.,We,will,see,that,a,larger,Krook,collision,frequency,˜νK,forces,the,distribution,function,to,be,Report,2070839-TN-06,16,broader,in,velocity,space,,including,at,the,sheath,entrance,near,the,wall.,For,the,physics,parameters,,we,take,bz,=,1.0,,˜ν∥,=,0.01,,(cid:101)νii,=,0.0,(cid:101)Ne,=,1.0,,and,(cid:101)Te,=,1.0.,We,will,vary,˜νK,between,10,and,0.01.,The,input,file,corresponding,to,these,simulations,is,given,in,section,Appendix,A.2.For,the,numerical,input,values,we,take,Ngrid,=,17,for,all,dimensions,,Nelement,=,8,for,v∥,and,v⊥,dimensions,and,Nelement,=,9,for,the,z,dimension.,We,do,this,to,avoid,having,the,point,z,=,0,v∥,=,0,on,grid,,as,this,point,is,a,stagnation,point,in,this,model,for,an,up-down,symmetric,simulation.,We,take,Lv∥,=,2Lv⊥,=,6.,6.1.,Krook,plus,numerical,diffusion,First,,we,examine,in,detail,a,simulation,where,we,take,˜νK,=,0.1.,After,running,to,a,time,of,˜t,=,10,with,a,timestep,of,∆˜t,=,0.0005,,we,find,the,potential,,electric,field,,and,distribution,function,visualised,in,figure,5.,In,figure,5a,we,plot,the,potential,(cid:101)ϕ,,and,in,figure,5b,we,plot,the,electric,field,(cid:101)Ez.,These,fields,show,the,expected,sheath-like,behaviour,with,a,diverging,electric,field,near,the,sheath,entrances,at,z/Lz,=,±1/2.,In,figures,5c,and,5d,we,visualise,the,velocity,space,structure,of,the,distribution,at,z/Lz,=,−1/2.,In,figure,5e,we,show,the,structure,of,the,distribution,function,at,a,typical,v⊥,as,a,function,of,˜z,and,˜v∥.,Finally,,in,figure,5f,we,show,the,mean,velocity,(cid:101)u∥i.,6.2.,Varying,the,strength,of,the,Krook,operator,We,illustrate,the,impact,on,the,solution,of,including,a,Krook,collision,operator,in,figure,6.,By,varying,the,Krook,collision,frequency,˜νK,from,0.01,to,10.0,,we,can,change,the,extent,of,the,distribution,function,in,velocity,space.,This,behaviour,comes,about,because,the,Krook,operator,attempts,to,force,the,ion,distribution,function,towards,a,shifted,Maxwellian.,It,is,interesting,to,note,that,although,the,ionisation,source,(80),is,Maxwellian,(with,no,mean,flow),,the,ion,distribution,function,is,not,close,to,Maxwellian,as,the,ions,approach,the,sheath,,even,in,the,presence,of,the,Krook,operator.,7.,Discussion,This,report,has,investigated,the,(work-in-progress),implementation,of,ion-ion,collision,operators,into,the,‘moment-kinetics’,code.,We,have,reported,on,two,lines,of,development:,a,successful,implementation,of,a,Krook,operator;,and,initial,investigation,into,the,application,of,the,numerical,methods,currently,used,by,the,‘moment-kinetics’,code,to,the,implemention,of,the,exact,Fokker-Planck,collision,operator.,We,developed,a,series,of,tests,to,test,the,calculation,of,the,coefficients,and,fluxes,appearing,in,the,Fokker-Planck,collision,operator.,We,found,that,special,quadratures,that,can,handle,divergences,in,the,integrand,may,be,required,to,compute,the,coefficients,appearing,in,the,Fokker-Planck,operator,,and,that,repeated,differentiation,can,lead,to,inaccurate,results,in,our,implementation.,Report,2070839-TN-06,17,(a),(c),(e),(b),(d),(f),Figure,5:,The,relaxed,state,of,simulating,equation,(49),with,the,source,(80),and,a,Krook,operator,with,˜νK,=,0.1.,Numerical,dissipation,is,included,with,ν∥,=,0.01.,We,take,(cid:101)νii,=,0.0,Report,2070839-TN-06,18,(a),(c),(e),(b),(d),(f),Figure,6:,The,distribution,function,as,a,function,of,z,and,v∥,(at,a,typical,v⊥),and,at,the,sheath,entrane,at,zLz,=,−1/2,as,a,function,of,v∥,and,v⊥.,Taken,from,the,relaxed,state,found,by,simulating,equation,(49),with,the,source,(80),and,a,Krook,operator,with,˜νK,=,0.01,(6a,and,6b),,˜νK,=,1.0,(6c,and,6d),,and,˜νK,=,10.0,(6e,and,6f).,Numerical,dissipation,is,included,with,ν∥,=,0.01.,We,take,(cid:101)νii,=,0.0.,Report,2070839-TN-06,19,To,avoid,the,numerical,integration,required,for,the,full,Fokker-Planck,operator,,we,investigated,the,possibility,of,implementing,a,modified,collision,operator,which,leverages,the,analytical,results,for,the,Rosenbluth,potentials,for,a,shifted,Maxwellian.,This,operator,was,tested,,demonstrating,a,likely,correct,implementation.,However,,steady-,state,solutions,obtained,with,this,operator,are,currently,difficult,to,obtain.,At,the,time,of,writing,this,report,,the,modified,Fokker-Planck,operator,tends,to,produce,distribution,functions,which,go,negative,with,Gibbs,phenomena,in,the,long,time,limit,,suggesting,numerical,issues,,or,a,bug.,Because,the,Fokker-Planck,collision,operator,represents,the,gold,standard,,and,all,model,operators,are,simply,ad,hoc,prescriptions,made,via,uncontrolled,approximations,,it,is,highly,desirable,to,have,the,proper,Fokker-Planck,operator,implemented.,This,report,highlights,the,need,to,consider,other,numerical,methods,which,might,allow,us,to,compute,the,Rosenbluth,potentials,accurately,,or,otherwise,implement,the,operator.,Quadratures,that,can,handle,certain,types,of,diverging,integrands,do,exist,,as,mentioned,in,section,19.8.6,of,[10].,Previous,implementations,of,the,full,Fokker-Planck,operator,exist,in,the,literature,,suggesting,several,methods,to,approach,the,problem,[13,,14,,11,,5].,An,obvious,route,to,follow,is,to,use,the,weak,formulation,of,the,problem,,to,use,integration,by,parts,to,reduce,the,order,of,the,derivatives,formally,required,in,the,numerical,differentiation.,Another,option,could,be,to,focus,on,the,Landau,form,of,the,Fokker,Planck,operator,rather,than,on,on,the,Rosenbluth-MacDonald-Judd,form,,see,e.g.,,[5,,11].,Further,work,will,attempt,to,determine,whether,or,not,the,weak,formulation,provides,any,advantages,in,our,framework.,Appendix,A.,Input,data,In,this,appendix,we,give,simulation,inputs,to,be,used,with,the,‘moment,kinetics’,branch,https://github.com/mabarnes/moment_kinetics/tree/radial-vperp-standard-DKE-Julia-1.,7.2-mpi.,on,commit,a6f06ccbbb37de8be113cb31d9c2f28c7fbdf52c.,Appendix,A.1.,Simulation,input:,MMS,test,with,a,Krook,operator,use_manufactured_solns_for_advance,=,true,n_ion_species,=,1,n_neutral_species,=,0,electron_physics,=,"boltzmann_electron_response",#electron_physics,=,"boltzmann_electron_response_with_simple_sheath",run_name,=,"1D-wall_MMS_nel_r_1_z_8_vpa_8_vperp_8_krook",evolve_moments_density,=,false,evolve_moments_parallel_flow,=,false,evolve_moments_parallel_pressure,=,false,evolve_moments_conservation,=,false,force_Er_zero_at_wall,=,false,#true,Report,2070839-TN-06,20,Er_constant,=,0.0,epsilon_offset,=,0.1,use_vpabar_in_mms_dfni,=,true,T_e,=,1.0,T_wall,=,1.0,rhostar,=,1.0,Bzed,=,1.0,Bmag,=,1.0,initial_density1,=,0.5,initial_temperature1,=,1.0,initial_density2,=,0.5,initial_temperature2,=,1.0,z_IC_option1,=,"sinusoid",z_IC_density_amplitude1,=,0.001,z_IC_density_phase1,=,0.0,z_IC_upar_amplitude1,=,0.0,z_IC_upar_phase1,=,0.0,z_IC_temperature_amplitude1,=,0.0,z_IC_temperature_phase1,=,0.0,z_IC_option2,=,"sinusoid",z_IC_density_amplitude2,=,0.001,z_IC_density_phase2,=,0.0,z_IC_upar_amplitude2,=,0.0,z_IC_upar_phase2,=,0.0,z_IC_temperature_amplitude2,=,0.0,z_IC_temperature_phase2,=,0.0,charge_exchange_frequency,=,0.0,ionization_frequency,=,0.0,nuii_krook,=,1.0,nstep,=,4000,dt,=,0.00025,nwrite,=,400,nwrite_dfns,=,400,use_semi_lagrange,=,false,n_rk_stages,=,4,split_operators,=,false,z_ngrid,=,17,z_nelement,=,8,z_nelement_local,=,8,z_bc,=,"wall",z_discretization,=,"chebyshev_pseudospectral",r_ngrid,=,1,Report,2070839-TN-06,21,r_nelement,=,1,r_nelement_local,=,1,r_bc,=,"periodic",r_discretization,=,"chebyshev_pseudospectral",vpa_ngrid,=,17,vpa_nelement,=,8,vpa_L,=,12.0,vpa_bc,=,"zero",vpa_discretization,=,"chebyshev_pseudospectral",vperp_ngrid,=,17,vperp_nelement,=,8,vperp_L,=,6.0,vperp_bc,=,"periodic",#vperp_discretization,=,"finite_difference",vperp_discretization,=,"chebyshev_pseudospectral",vz_ngrid,=,17,vz_nelement,=,4,vz_L,=,12.0,vz_bc,=,"periodic",vz_discretization,=,"chebyshev_pseudospectral",vr_ngrid,=,17,vr_nelement,=,4,vr_L,=,12.0,vr_bc,=,"periodic",vr_discretization,=,"chebyshev_pseudospectral",vzeta_ngrid,=,17,vzeta_nelement,=,4,vzeta_L,=,12.0,vzeta_bc,=,"periodic",vzeta_discretization,=,"chebyshev_pseudospectral",[numerical_dissipation],vpa_dissipation_coefficient,=,0.0,#z_dissipation_coefficient,=,0.1,r_dissipation_coefficient,=,0.0,Report,2070839-TN-06,22,Appendix,A.2.,Simulation,input:,steady-state,runs,with,a,Krook,operator,use_manufactured_solns_for_init,=,true,use_manufactured_solns_for_advance,=,false,n_ion_species,=,1,n_neutral_species,=,0,electron_physics,=,"boltzmann_electron_response",#electron_physics,=,"boltzmann_electron_response_with_simple_sheath",run_name,=,"1D-wall_evolve_nel_r_1_z_9_vpa_8_vperp_8_krook_diss",evolve_moments_density,=,false,evolve_moments_parallel_flow,=,false,evolve_moments_parallel_pressure,=,false,evolve_moments_conservation,=,false,force_Er_zero_at_wall,=,false,#true,Er_constant,=,0.0,epsilon_offset,=,0.1,use_vpabar_in_mms_dfni,=,true,T_e,=,1.0,T_wall,=,1.0,rhostar,=,1.0,Bzed,=,1.0,Bmag,=,1.0,initial_density1,=,0.5,initial_temperature1,=,1.0,initial_density2,=,0.5,initial_temperature2,=,1.0,z_IC_option1,=,"sinusoid",z_IC_density_amplitude1,=,0.001,z_IC_density_phase1,=,0.0,z_IC_upar_amplitude1,=,0.0,z_IC_upar_phase1,=,0.0,z_IC_temperature_amplitude1,=,0.0,z_IC_temperature_phase1,=,0.0,z_IC_option2,=,"sinusoid",z_IC_density_amplitude2,=,0.001,z_IC_density_phase2,=,0.0,z_IC_upar_amplitude2,=,0.0,z_IC_upar_phase2,=,0.0,z_IC_temperature_amplitude2,=,0.0,z_IC_temperature_phase2,=,0.0,charge_exchange_frequency,=,0.0,ionization_frequency,=,1.0,Report,2070839-TN-06,23,constant_ionization_rate,=,true,nuii_krook,=,0.1,nuii_pitch,=,0.0,nstep,=,20000,dt,=,0.0005,nwrite,=,200,nwrite_dfns,=,200,use_semi_lagrange,=,false,n_rk_stages,=,4,split_operators,=,false,z_ngrid,=,17,z_nelement,=,9,z_nelement_local,=,9,z_bc,=,"wall",z_discretization,=,"chebyshev_pseudospectral",r_ngrid,=,1,r_nelement,=,1,r_nelement_local,=,1,r_bc,=,"periodic",r_discretization,=,"chebyshev_pseudospectral",vpa_ngrid,=,17,vpa_nelement,=,8,vpa_L,=,6.0,vpa_bc,=,"zero",vpa_discretization,=,"chebyshev_pseudospectral",vperp_ngrid,=,17,vperp_nelement,=,8,vperp_L,=,3.0,vperp_bc,=,"periodic",#vperp_discretization,=,"finite_difference",vperp_discretization,=,"chebyshev_pseudospectral",vz_ngrid,=,17,vz_nelement,=,4,vz_L,=,12.0,vz_bc,=,"periodic",vz_discretization,=,"chebyshev_pseudospectral",vr_ngrid,=,17,vr_nelement,=,4,vr_L,=,12.0,vr_bc,=,"periodic",Report,2070839-TN-06,24,vr_discretization,=,"chebyshev_pseudospectral",vzeta_ngrid,=,17,vzeta_nelement,=,4,vzeta_L,=,12.0,vzeta_bc,=,"periodic",vzeta_discretization,=,"chebyshev_pseudospectral",[numerical_dissipation],vpa_dissipation_coefficient,=,0.01,#z_dissipation_coefficient,=,0.1,r_dissipation_coefficient,=,0.0,[1],Helander,P,and,Sigmar,D,J,2002,Collisional,Transport,in,Magnetized,Plasmas,(Cambridge,,UK:,Cambrige,University,Press),[2],Abel,I,G,,Plunk,G,G,,Wang,E,,Barnes,M,,Cowley,S,C,,Dorland,W,and,Schekochihin,A,2013,Rep.,Prog.,Phys.,76,116201,[3],Schekochihin,A,,Cowley,S,,Dorland,W,,Hammett,G,,Howes,G,G,,Plunk,G,,Quataert,E,and,Tatsuno,T,2008,Plasma,Phys.,Control.,Fusion,50,124024,[4],Barnes,M,,Dorland,W,and,Tatsuno,T,2010,Physics,of,Plasmas,17,032106,[5],Abazorius,M,2023,University,of,Oxford,DPhil,Thesis,(In,Progress),[6],Rosenbluth,M,N,,MacDonald,W,M,and,Judd,D,L,1957,Phys.,Rev.,107,1–6,[7],Bhatnagar,P,L,,Gross,E,P,and,Krook,M,1954,Phys.,Rev.,94,511–525,[8],Parra,F,I,,Barnes,M,and,Hardman,M,R,2021,Excalibur/Neptune,Report,2047357–TN–07–01,M1.4,[9],Hazeltine,R,D,and,Meiss,J,D,2003,Plasma,Confinement,(New,York:,Dover),[10],Boyd,J,P,2001,Chebyshev,and,Fourier,Spectral,Methods,(Dover),[11],Hirvijoki,E,and,Adams,M,F,2017,Phys.,Plasmas,24,032121,[12],Hardman,M,R,,Omotani,J,,Barnes,M,,Newton,S,L,and,Parra,F,I,2023,Excalibur/Neptune,Report,2070839-TN-04,[13],Alouani-Bibi,F,,Shoucri,M,and,Matte,J,P,2004,Computer,physics,communications,164,60–66,[14],Pataki,A,and,Greengard,L,2011,Journal,of,Computational,Physics,230,7840–7852

:pdfembed:`src:_static/TN-06_IonIonModelCollisionOperatorsKrookOperatorModelFokkerPlanckOperator.pdf, height:1600, width:1100, align:middle`

