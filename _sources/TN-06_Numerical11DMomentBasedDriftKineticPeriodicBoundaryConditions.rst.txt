TN-06_Numerical11DMomentBasedDriftKineticPeriodicBoundaryConditions
===================================================================

.. meta::
   :description: technical note

   :keywords: Report,2047357-TN-02,,M2.3,Numerical,study,of,1+1D,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions,M.,Barnes1,,F.,I.,Parra1,,M.,R.,Hardman1,and,J.,Omotani2,1,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,2,Culham,Centre,for,Fusion,Energy,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,United,Kingdom,E-mail:,michael.barnes@physics.ox.ac.uk,1.,Introduction,We,expect,that,one,of,the,biggest,challenges,in,numerically,solving,drift,kinetic,equations,in,the,plasma,edge,is,treating,the,motion,of,electrons,along,the,magnetic,ﬁeld.,Because,the,electrons,are,light,,they,move,rapidly,along,the,ﬁeld,,placing,a,severe,stability,restriction,on,the,step,size,for,explicit,time,advance,schemes.,Unfortunately,,an,implicit,treatment,is,not,straightforward,due,to,an,implicit,dependence,of,the,electrostatic,potential,on,the,charged,particle,distribution,functions.,One,of,the,main,aims,of,our,research,is,to,develop,and,test,a,novel,analytical,model,and,associated,numerical,algorithm,for,relaxing,this,restriction.,As,a,ﬁrst,step,towards,this,goal,,we,developed,a,new,code,in,the,programming,language,Julia,to,simulate,a,simple,drift,kinetic,model,for,parallel,dynamics,[1].,We,then,extended,the,code,to,simulate,a,modiﬁed,set,of,equations,in,which,the,density,is,removed,from,the,particle,distribution,function,and,is,evolved,separately,using,the,continuity,equation,[2].,In,this,report,we,describe,the,numerical,implementation,of,the,full,‘moment-kinetic’,model,,in,which,the,particle,density,,parallel,ﬂow,and,parallel,pressure,are,evolved,separately,from,a,modiﬁed,particle,distribution,function.,Numerical,results,are,presented,to,demonstrate,that,the,relevant,conservation,properties,are,satisﬁed,to,machine,precision,and,that,the,moment-based,approach,passes,the,linear,damping,benchmark,developed,in,[1,,3].,2.,Model,equations,A,detailed,derivation,of,the,drift,kinetic,model,we,consider,,as,well,as,the,full,moment-,based,model,,is,provided,in,our,Jan,2021,report,[3].,For,the,Reader’s,convenience,we,produce,ﬁrst,an,overview,of,the,drift,kinetic,model,and,then,of,models,in,which,combinations,of,the,density,,parallel,ﬂow,and,parallel,pressure,are,separately,evolved.,The,system,we,consider,consists,of,a,single,ion,species,of,charge,e,,a,single,neutral,species,,and,an,electron,species,modelled,as,having,a,Boltzmann,response,,all,immersed,1,Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,2,in,a,straight,,uniform,magnetic,ﬁeld,in,the,z,direction.,We,allow,for,charge,exchange,collisions,between,ions,and,neutrals,but,do,not,account,for,intra-species,collisions.,Finally,,we,assume,that,the,plasma,is,homogeneous,in,the,plane,perpendicular,to,the,magnetic,ﬁeld.,With,these,assumptions,,our,model,system,of,equations,is,and,.,=,∂fi,∂t,+,v,(cid:107),∂fi,∂z,−,e,mi,∂φ,∂z,∂fi,∂v,(cid:107),=,Rin,(nnfi,−,−,nifn),,,∂fn,∂t,+,v,∂fn,∂z,(cid:107),=,ns(z,,t),=,−,∞,Rin,(nifn,−,nnfi),,,dv,(cid:107),fs(z,,v,,,t),,(cid:107),(cid:90),−∞,ni,=,Ne,exp,,,eφ,Te,(cid:19),(cid:18),(1),(2),(3),(4),⊥,v,⊥,dϑdv,and,v,Fs,the,marginalized,particle,distribution,function,for,species,s,,with,fs,v,the,components,of,the,particle,velocity,parallel,and,perpendicular,to,the,(cid:82),(cid:107),magnetic,ﬁeld,,respectively,,ϑ,the,gyro-angle,,mi,the,ion,mass,,t,the,time,,φ,the,electrostatic,potential,,and,Rin,a,charge,exchange,collision,frequency,factor.,⊥,For,our,boundary,conditions,,we,impose,periodicity,on,fs,in,both,z,and,v,,,with,(cid:107),periods,Lz,and,Lv(cid:107),,respectively.,There,is,also,the,option,to,impose,zero,boundary,at,the,upwind,boundary,of,the,domain.,As,fs,should,go,to,zero,conditions,on,z,and,v,(cid:107),at,v,,,imposition,of,zero,boundary,conditions,and,periodic,boundary,conditions,should,be,equivalent,as,long,as,Lv(cid:107),is,suﬃciently,large.,Note,that,with,either,choice,of,boundary,conditions,,the,line-averaged,density,We,normalize,Eqs.,(1)-(4),by,deﬁning,Lz,0,dz,ns,should,be,conserved.,(cid:107),→,±∞,˜fs,.,=,fs,,,,,,,(cid:82),cs√π,Ne,cs,Lz,z,Lz,v,(cid:107),cs,ns,Ne,eφ,Te,,,,,,,.,=,t,˜t,.,=,˜z,.,=,˜v,(cid:107),.,=,˜ns,.,=,˜φ,and,˜Rin,.,=,Rin,NeLz,cs,(5),(6),(7),(8),(9),(10),(11),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,3,with,cs,.,=,2Te/ms.,In,terms,of,these,normalised,quantities,,Eqs,(1)-(4),become,(cid:112),∂,˜fi,∂˜t,∂,˜fi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,+,˜v,(cid:107),∂,˜fi,∂˜v,(cid:107),=,˜Rin,−,˜nn,˜fi,−,(cid:16),˜ni,˜fn,,,(cid:17),∂,˜fn,∂˜t,∂,˜fn,∂,˜z,+,˜v,(cid:107),=,e,˜φ,=,˜ni,=,˜Rin,−,1,√π,˜ni,(cid:16),∞,˜fi,,,(cid:17),˜nn,˜fn,−,˜fi,,d˜v,(cid:107),(cid:90),−∞,˜nn,=,1,√π,∞,(cid:90),−∞,˜fn.,d˜v,(cid:107),and,(12),(13),(14),(15),2.1.,Moment,approach:,density,We,now,deﬁne,the,modiﬁed,distribution,function,gs,terms,of,gs,,the,system,of,equations,given,by,Eqs.,(1)-(4),becomes,.,=,fs/ns,so,that,gs,=,1.,In,dv,(cid:107),(cid:82),∂gi,∂t,+,v,(cid:107),∂gi,∂z,−,e,mi,∂φ,∂z,∂gi,∂v,(cid:107),(cid:19),ni,(cid:18),+,gi,∂ni,∂t,+,v,(cid:107),∂ni,∂z,(cid:19),=,Rinninn,(gi,−,−,gn),,,∂gn,∂t,+,v,∂gn,∂z,(cid:107),nn,(cid:18),+,gn,(cid:19),(cid:18),=,Rinninn,(gn,−,−,gi),,,and,us,=,−∞,Note,that,the,1D,continuity,equation,(19),has,replaced,the,moment,equation,(3),as,a,means,of,computing,the,density,for,each,species.,Substituting,the,continuity,equation,(19),into,the,drift,kinetic,equations,(16),and,(17),gives,and,∂gi,∂t,+,v,(cid:107),∂gi,∂z,−,e,mi,∂φ,∂z,∂gi,∂v,(cid:107),=,Rinnn,(gi,−,−,gn),+,gi,∂ui,∂z,−,(cid:18),v,(cid:107),−,ui,(cid:0),(cid:1),∂,ln,ni,∂z,(cid:19),(21),∂gn,∂t,+,v,(cid:107),∂gn,∂z,=,Rinni,(gn,−,−,gi),+,gn,∂un,∂z,−,v,(cid:107),−,un,∂,ln,nn,∂z,,,(22),We,normalize,Eqs.,(18)-(22),by,using,Eqs.,(6)-(11),and,by,further,deﬁning,(cid:18),(cid:0),(cid:1),(cid:19),.,=,gscs√π,˜gs,(23),(cid:18),∂nn,∂t,+,v,(cid:107),∂nn,∂z,(cid:19),,,eφ,Te,(cid:19),=,0,,ni,=,Ne,exp,∂ns,∂t,+,(cid:18),∂nsus,∂z,∞,dv,(cid:107),gsv,.,(cid:107),(cid:90),(16),(17),(18),(19),(20),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,and,.,=,˜us,us,cs,.,In,terms,of,these,normalised,quantities,,Eqs,(18)-(22),become,∂˜gi,∂˜t,+,˜v,(cid:107),∂˜gi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,∂˜gi,∂˜v,(cid:107),=,˜Rin˜nn,(˜gi,−,−,˜gn),+,˜gi,∂,˜ui,∂,˜z,−,˜v,(cid:107),−,˜ui,∂,ln,˜ni,∂,˜z,∂˜gn,∂˜t,+,˜v,(cid:107),∂˜gn,∂,˜z,=,−,˜Rin˜ni,(˜gn,−,∂,˜ns,∂˜t,˜gi),+,˜gn,+,∂,˜ns,˜us,∂,˜z,e,˜φ,=,˜ni,,(cid:18),∂,˜un,∂,˜z,−,(cid:18),=,0,,(cid:0),˜v,(cid:107),−,˜un,(cid:0),(cid:1),(cid:1),∂,ln,˜nn,∂,˜z,4,(24),,,(25),(cid:19),,,(cid:19),(26),(27),(28),(29),and,˜us,=,1,√π,∞,d˜v,(cid:107),˜gn˜v,(cid:107),.,(cid:90),−∞,The,above,form,for,the,equations,is,appealing,because,it,maintains,the,form,of,an,advection,equation,with,the,only,modiﬁcation,being,the,addition,of,source,terms.,However,,it,can,pose,challenges,for,numerical,conservation,of,quantities,such,as,the,0th,velocity,moment,of,gs.,This,is,because,parts,of,the,source,terms,must,cancel,upon,velocity,space,integration,with,some,of,the,advective,terms.,To,ease,the,task,of,preserving,conservation,properties,numerically,,the,equations,can,be,manipulated,into,the,following,form,in,which,such,cancellations,can,be,built,into,the,discretisation:,∂˜gi,∂˜t,+,˜v,(cid:107),˜ni,∂,˜ni˜gi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,∂˜gi,∂˜v,(cid:107),=,˜Rin˜nn,(˜gi,−,−,˜gn),+,˜gi,˜ni,∂,˜ni,˜ui,∂,˜z,,,∂˜gn,∂˜t,+,˜v,(cid:107),˜nn,∂,˜nn˜gn,∂,˜z,=,∂,˜ns,∂˜t,˜gi),+,˜gn,˜nn,∂,˜nn,˜un,∂,˜z,,,−,˜Rin˜ni,(˜gn,−,∂,˜ns,˜us,∂,˜z,e,˜φ,=,˜ni,,+,=,0,,and,˜us,=,1,√π,∞,(cid:90),−∞,d˜v,(cid:107),˜gn˜v,(cid:107),.,2.2.,Moment,approach:,parallel,ﬂow,(30),(31),(32),(33),(34),The,parallel,ﬂow,can,also,be,evolved,separately,by,switching,from,v,.,(cid:107),=,v,to,w,(cid:107),and,(31),become,as,a,coordinate,u.,With,this,change,of,variable,,the,normalised,kinetic,equations,(30),(cid:107),−,∂˜gi,∂˜t,+,˜v,(cid:107),˜ni,∂,˜ni˜gi,∂,˜z,−,(cid:32),1,2,∂,˜φ,∂,˜z,+,∂,˜ui,∂˜t,+,˜ui,∂,˜ui,∂,˜z,+,˜w,∂,˜ui,∂,˜z,(cid:33),(cid:107),∂˜gi,∂,˜w,(cid:107),=,˜Rin˜nn,(˜gi,−,−,˜gn),+,˜gi,˜ni,∂,˜ni,˜ui,∂,˜z,(35),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,5,and,∂˜gn,∂˜t,+,˜v,(cid:107),˜nn,∂,˜nn˜gn,∂,˜z,−,(cid:18),∂,˜un,∂˜t,+,˜un,∂,˜un,∂,˜z,+,˜w,∂,˜un,∂,˜z,(cid:107),∂˜gn,∂,˜w,(cid:107),(cid:19),=,˜Rin˜ni,(˜gn,−,−,˜gi)+,˜gn,˜nn,∂,˜nn,˜un,∂,˜z,,,(36),with,˜us,determined,by,the,momentum,equations,and,where,mini,(cid:18),∂ui,∂t,+,ui,∂ui,∂z,(cid:19),=,∂p,,i,(cid:107),∂z,−,−,eni,∂φ,∂z,+,miRinninn,(un,−,ui),∂un,∂t,+,un,∂un,∂z,mnnn,(cid:18),=,,n,∂p,(cid:107),∂z,−,+,mnRinninn,(ui,−,un),,,dw,msw2,(cid:107),(cid:107),,s.,fs,=,nsT,(cid:107),(cid:19),∞,.,=,p,,s,(cid:107),(cid:90),−∞,Substituting,the,momentum,equations,(37),and,(38),into,Eqs.,(35),and,(36),gives,and,with,and,where,∂˜gi,∂˜t,+,˜w,(cid:107),+,˜ui,˜ni,∂,˜ni˜gi,∂,˜z,+,˙w,,i,(cid:107),∂˜gi,∂,˜w,(cid:107),=,˜Rin˜nn,(˜gi,−,−,˜gn),+,˜gi,˜ni,∂,˜ni,˜ui,∂,˜z,∂˜gn,∂˜t,+,˜w,(cid:107),+,˜un,˜nn,∂,˜nn˜gn,∂,˜z,+,˙w,,n,(cid:107),∂˜gn,∂,˜w,(cid:107),=,˜Rin˜ni,(˜gn,−,−,˜gi),+,˜gn,˜nn,∂,˜nn,˜un,∂,˜z,˙w,,i,=,(cid:107),˜w,(cid:107),−,∂,˜ui,∂,˜z,+,1,˜ni,∂,˜p,,i,(cid:107),∂,˜z,−,˜Rin˜nn,(˜un,−,˜ui),˙w,,n,=,(cid:107),˜w,−,∂,˜un,∂,˜z,(cid:107),+,1,˜nn,∂,˜p,,n,(cid:107),∂,˜z,−,˜Rin˜ni,(˜ui,−,˜un),.,=,˜p,(cid:107),,s,,s,p,(cid:107),Nemsv2,th,i,=,p,,s,(cid:107),2NeTe,.,We,choose,to,evolve,the,momentum,equations,in,conservative,form:,∂,∂t,(miniui),=,∂,∂z,−,(cid:0),p,,i,+,miniu2,i,(cid:107),eni,−,∂φ,∂z,+,miRinninn,(un,−,ui),(cid:1),and,∂,∂z,which,,when,normalised,,become,(mnnnun),=,∂,∂t,−,(cid:0),∂,∂t,(˜ni,˜ui),=,∂,∂,˜z,−,,i,+,˜ni,˜u2,˜p,i,(cid:107),and,∂,∂t,(˜nn,˜un),=,(cid:0),∂,∂,˜z,−,p,,n,+,mnnnu2,n,(cid:107),+,mnRinninn,(ui,−,un),,,(cid:1),˜ni,2,∂,˜φ,∂,˜z,−,(cid:1),+,˜Rin˜ni˜nn,(˜un,−,˜ui),,n,+,˜nn,˜u2,n,˜p,(cid:107),+,˜Rin˜ni˜nn,(˜ui,−,˜un),.,(cid:0),(cid:1),(37),(38),(39),(40),(41),(42),(43),(44),(45),(46),(47),(48),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,6,2.3.,Moment,approach:,parallel,pressure,We,additionally,separate,the,parallel,pressure,(or,,equivalently,,the,thermal,speed),by,changing,variables,from,the,peculiar,velocity,to,the,modiﬁed,peculiar,velocity,w,,,given,by,(cid:107),.,=,w,(cid:107),us,v,(cid:107),−,vth,s,,,(49),where,vth,s,=,equation,of,state,,2T,(cid:107),(cid:112),,s,is,related,to,the,distribution,function,via,the,,s/ms.,Note,that,T,(cid:107),,s,=,T,(cid:107),p,,s,(cid:107),ns,.,=,msv2,th,s,2,dw,(cid:107),2w2,(cid:107),(cid:90),vth,sfs,ns,⇒,(cid:90),dw,w2,(cid:107),(cid:107),vth,sfs,ns,=,1,2,,,(50),and,the,other,relevant,moments,of,the,distribution,function,are,expressed,in,terms,of,the,modiﬁed,peculiar,velocity,as,(51),(52),(53),(54),ns,=,(cid:90),dw,(cid:107),vth,sfs,,nsus,=,dw,w,(cid:107),(cid:107),v2,th,sfs,,and,(cid:90),dw,p,,s,=,(cid:107),(cid:90),msw2,(cid:107),(cid:107),v3,th,sfs,,In,terms,of,the,coordinates,(z,,w,are,(cid:107),∂fs,∂t,+,vth,sw,+,us,(cid:107),where,(cid:0),˙w,,s,=,(cid:107),−,+,(cid:1),+,w2,(cid:107),∂vth,s,∂z,w,msnsv2,(cid:107),1,vth,s,(cid:18),∂q,,s,(cid:107),∂z,th,s,(cid:18),,s,=,q,(cid:107),dw,(cid:107),msw3,(cid:107),v4,th,sfs.,(cid:90),),,the,drift,kinetic,equations,for,the,ions,and,neutrals,∂fs,∂z,+,˙w,,s,(cid:107),∂fs,∂w,(cid:107),=,Rss(cid:48),(ns(cid:48)fs,−,−,nsfs(cid:48)),,,(55),1,msns,∂p,,s,(cid:107),∂z,−,Rss’ns(cid:48),(us(cid:48),us),−,(cid:19),(56),+,Rss’,ns(cid:48)p,,s,−,(cid:107),nsp,,s(cid:48),(cid:107),(cid:0),(cid:19),(cid:1),and,(s,,s(cid:48)),=,(i,,n),or,(s,,s(cid:48)),=,(n,,i).,To,obtain,this,result,,we,made,use,of,the,momentum,equations,(37)-(38),and,the,energy,equation,,∂p,,s,(cid:107),∂t,+,us,∂p,,s,(cid:107),∂z,=,msnsvth,s,=,∂q,,s,∂z,−,(cid:107),−,+,us,∂vth,s,∂t,∂us,∂z,−,,s,(cid:107),(cid:18),3p,∂vth,s,∂z,(cid:19),ns(cid:48)p,Rss’,recognising,that,p,,s,=,msnsv2,(cid:107),th,s/2.,(cid:0),∂ns,∂t,+,us,∂ns,∂z,(cid:19),(57),+,T,(cid:107),,s,,s,−,(cid:107),(cid:18),nsp,,,,s(cid:48),(cid:107),(cid:1),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,7,We,next,deﬁne,a,modiﬁed,distribution,function,that,allows,for,separate,treatment,of,the,density,and,parallel,pressure:,(58),gs(cid:48),.,.,=,gs,vth,s,ns,fs,=,2,ms,(cid:19),(cid:18),1/2,p1/2,,s,(cid:107),n3/2,s,fs.,In,terms,of,gs,the,drift,kinetic,equation,is,∂gs,∂t,+,gs,ns,∂ns,∂t,−,gs,vth,s,∂vth,s,∂t,+,vth,s,ns,vth,sw,+,us,(cid:107),∂fs,∂z,+,˙w,,s,(cid:107),∂gs,∂w,(cid:19),(59),(cid:1),Substituting,the,continuity,and,energy,equations,to,eliminate,∂ns/∂t,and,∂vth,s/∂t,gives,(cid:0),(cid:107),=,Rss(cid:48)ns(cid:48),−,gs,−,(cid:18),vth,s,vth,s(cid:48),∂gs,∂t,+,=,vth,s,ns,gsus,ns,vth,sw,(cid:107),+,us,(cid:0),∂ns,∂z,−,(cid:1),gs,us,vth,s,(cid:18),∂gs,∂w,,s,(cid:107),+,˙w,∂fs,∂z,∂vth,s,∂z,+,+,Rss(cid:48)ns(cid:48),(cid:107),1,msnsvth,s,∂q,,s,(cid:107),∂z,gs(cid:48),gs,−,vth,s,vth,s(cid:48),Rss’,msnsvth,s,(cid:18),+,(cid:19),ns(cid:48)p,(cid:0),,s,−,(cid:107),nsp,,s(cid:48),(cid:107),.,(cid:19),(60),(cid:1),Finally,,we,normalise,the,various,equations.,The,normalised,distribution,function,is,˜fs,.,=,fs,cs√π,Ne,=,˜gs,˜ns,˜vth,s,,,(61),where,˜gs,=,gs√π,and,˜vth,s,=,vth,s/cs.,The,drift,kinetic,equation,is,normalised,by,multiplying,each,term,by,√πLz/cs:,vth,s,vth,s(cid:48),˜gs(cid:48),(cid:19),(62),∂˜gs,∂˜t,+,=,˜vth,s,˜ns,˜vth,sw,(cid:107),+,˜us,∂,˜fs,∂,˜z,+,˜˙w,,s,(cid:107),˜gs,˜us,˜ns,(cid:0),∂,˜ns,∂,˜z,−,(cid:1),˜us,˜vth,s,∂˜vth,s,∂,˜z,+,˜gs,(cid:32),∂˜gs,∂w,(cid:107),1,2˜p,(cid:107),,s,where,+,˜Rss’˜n(cid:48)s,∂,˜q,,s,(cid:107),∂,˜z,+,˜gs,−,(cid:18),˜Rss’,2˜p,(cid:107),,s,(cid:0),˜n(cid:48)s,˜p,,s,−,(cid:107),˜˙w,,s,=,(cid:107),w2,(cid:107),−,∂˜vth,s,∂,˜z,+,1,˜vth,s,(cid:18),1,˜ns,∂,˜p,,s,(cid:107),∂,˜z,−,˜Rss’˜n(cid:48)s,(˜us(cid:48),−,˜us),+,(cid:19),w,(cid:107),2˜p,,s,(cid:18),(cid:107),∂,˜q,,s,(cid:107),∂z,.,=,˜ns,ns,Ne,=,˜vth,s,√π,˜ns,˜us,.,=,ns,Ne,us,cs,˜p,(cid:107),,s,.,=,p,,s,(cid:107),msNec2,s,=,=,dw,˜fs,,(cid:107),dw,(cid:107),w,(cid:107),˜fs,(cid:90),dw,(cid:107),˜fs,,w2,(cid:107),(cid:90),˜v2,th,s,√π,˜v3,th,s,√π,.,=,˜vth,s,vth,s,cs,=,(cid:90),2˜p,,s,(cid:107),˜ns,(cid:114),,,(cid:19),(cid:1),˜ns,˜p,,s(cid:48),(cid:107),,,(cid:33),(cid:1),+,˜Rss’,˜n(cid:48)s,˜p,,s,−,(cid:107),˜ns,˜p,,s(cid:48),(cid:107),(cid:0),(63),(64),(65),(66),(67),Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,and,q,,s,(cid:107),msNec3,s,The,energy,equation,is,normalised,by,multiplying,through,by,Lz/msNec3,s:,,s,=,˜q,(cid:107),˜w3,(cid:107),˜fs.,d,˜w,=,(cid:90),˜v4,th,s,√π,(cid:107),∂,˜p,,s,(cid:107),∂˜t,+,˜us,∂,˜p,,s,(cid:107),∂,˜z,+,∂,˜q,,s,(cid:107),∂,˜z,+,3˜p,(cid:107),,s,∂,˜us,∂,˜z,+,˜Rss’,˜n(cid:48)s,˜p,(cid:107),,s,−,˜ns,˜p,,s(cid:48),(cid:107),=,0.,8,(68),(69),Note,that,in,these,coordinates,the,normalised,particle,distribution,function,should,satisfy,the,following,properties,related,to,particle,number,,momentum,and,energy,conservation:,(cid:0),(cid:1),1,√π,1,√π,(cid:90),dw,(cid:107),˜gs,=,1,,(cid:90),dw,w,(cid:107),(cid:107),˜gs,=,0,,1,√π,(cid:90),dw,w2,(cid:107),(cid:107),˜gs,=,1,2,(70),(71),(72),and,3.,Numerical,implementation,A,detailed,description,of,the,time,and,space,discretisation,employed,in,the,code,is,given,in,[2],,and,the,code,itself,is,publicly,available,at,https://github.com/mabarnes/,moment_kinetics.,Here,we,focus,on,a,novel,extension,to,our,algorithm,that,is,necessary,to,ensure,exact,numerical,satisfaction,of,the,conservation,properties,(70)-(72).,The,currently-favoured,approach,in,the,code,for,satisfying,exactly,the,desired,conservation,properties,is,to,correct,the,numerical,solutions,for,n,and,g,at,the,end,of,each,time,step.,For,the,density,,one,can,set,nm+1,=,ˆnm+1,+,nm,1,(cid:18),where,ˆnm+1,is,the,updated,solution,(at,time,level,m,+,1),to,the,continuity,equation,nm),=,0.,before,applying,any,conserving,correction.,This,guarantees,that,Note,that,the,superscripts,here,refer,to,the,time,level,,not,the,element,index.,The,additional,error,in,the,density,introduced,by,this,correction,is,−,(cid:82),(cid:82),dz,(nm+1,(73),−,(cid:19),(cid:82),,,dz,ˆnm+1,dz,nm,nm,1,(cid:18),dz,ˆnm+1,dz,nm,−,(cid:82),(cid:82),(cid:19),=,nm,=,nm,1,(cid:32),−,(cid:82),dz,(cid:15)m,dz,nm,dz,=,(cid:0),(cid:82),O,nm+1,exact,+,(cid:15)m,dz,nm,((cid:15)m),,(cid:33),(cid:1),(74),(cid:82),(cid:82),where,(cid:15)m,is,the,error,due,to,numerical,discretisation,,and,nm+1,in,the,limit,(cid:15)m,=,0.,exact,is,the,solution,for,ˆnm+1,Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,9,g,=,0,and,g,=,1/2,,where,here,we,are,focusing,on,the,case,in,which,the,density,,parallel,A,similar,technique,can,be,applied,to,conserve,w2,(cid:107),g,=,1,,dw,(cid:107),dw,w,(cid:82),(cid:82),(cid:107),(cid:107),ﬂow,and,parallel,pressure,are,all,evolved,separately.,In,particular,,we,set,(cid:82),dw,(cid:107),gm+1,=,ˆgm+1,+,gm,1,(cid:18),−,(cid:90),ˆgm+1,dw,(cid:107),w,−,(cid:19),(cid:107),gm,E,dw,(cid:107),dw,(cid:107),w,(cid:107),w2,(cid:107),ˆgm+1,gm,E,w2,(cid:107),−,−,(cid:18),1,2,(cid:19),gm,E,(cid:82),dw,w2,1/2,(cid:107),(cid:16),w2,(cid:107),dw,(cid:107),(cid:107),−,w2,(cid:107),−,(cid:17),1/2,(cid:82),(cid:16),(cid:82),ˆgm+1,(cid:82),,,gm,E,(cid:17),(75),w2,(cid:107),(cid:107),where,ˆgm+1,is,the,updated,solution,to,the,drift,kinetic,equation,before,applying,any,component,of,conserving,correction,and,gE(w,),+,g(,(δm),,where,δm,is,g.,Again,,the,additional,error,in,g,associated,with,this,correction,is,gm+1,=,0,the,discretisation,error.,The,correction,ensures,that,and,gm+1,=,1/2,,provided,the,corresponding,properties,are,satisﬁed,for,gm.,))/2,is,the,even-in-w,O,gm+1,=,1,,),=,(g(w,(cid:107),dw,(cid:107),dw,dw,−,w,w,(cid:107),(cid:107),(cid:107),(cid:107),(cid:107),It,is,thus,critical,to,carefully,choose,the,initial,conditions,in,the,code,so,that,(cid:82),these,properties,are,initially,satisﬁed,to,machine,precision.,To,do,this,we,ﬁrst,set,initial,conditions,on,the,density,,parallel,ﬂow,and,parallel,pressure,proﬁles,,and,then,set,the,initial,,normalised,distribution,function,,ˆg0,,to,be,an,even,function,of,w,.,The,(cid:107),constraint,that,ˆg0,be,even,is,not,necessary,,but,is,currently,chosen,for,convenience,as,ˆg0,=,0.,This,initial,distribution,function,is,then,it,automatically,ensures,that,corrected,in,a,manner,analogous,to,ˆgm+1,above:,dw,w,(cid:107),(cid:107),(cid:82),(cid:82),(cid:82),g0,=,ˆg0,dw,(cid:107),+,ˆg0,1,2,−,(cid:82),(cid:32),ˆg0,w2,(cid:107),ˆg0,dw,(cid:107),dw,(cid:107),(cid:82),(cid:82),dw,(cid:107),w2,(cid:107),(cid:32),(cid:30),(cid:32)(cid:90),w2,(cid:107),dw,ˆg0,w2,(cid:107),(cid:107),ˆg0,−,ˆg0,dw,(cid:107),ˆg0,(cid:33),ˆg0,−,(cid:82),ˆg0,ˆg0,dw,(cid:107),(cid:33)(cid:33),(cid:33),(cid:32),w2,(cid:107),dw,(cid:107),ˆg0,(cid:82),w2,(cid:107),(76),(cid:82),This,approach,is,simple,,does,not,change,the,order,of,accuracy,of,the,discretisation,scheme,and,allows,for,the,use,of,numerical,dissipation,to,improve,numerical,stability,properties.,Results,showing,its,eﬃcacy,are,given,in,Sec.,4,(cid:82),4.,Numerical,results,the,moment-based,approach,implementation,of,To,benchmark,our,numerical,encapsulated,in,Eqs.,(62)-(69),,we,compare,our,simulation,results,with,the,analytical,benchmarks,developed,in,[3],and,with,the,numerical,results,obtained,by,directly,solving,the,kinetic,system,corresponding,to,Eqs.,(12)-(15).,We,note,that,the,results,obtained,with,separate,evolution,of,only,the,density,(Eqs.,(30)-(34)),and,of,only,the,density,and,parallel,ﬂow,(Eqs.,(40)-(48)),are,almost,identical,to,the,ones,presented,here,in,which,all,three,of,the,lowest-order,moments,are,evolved,separately.,The,results,reported,here,were,obtained,using,the,conserving,corrections,given,by,Eqs.,73,and,75.,Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,10,We,have,initialised,the,modiﬁed,distribution,functions,for,the,ions,and,neutrals,to,be,of,the,form,(77),˜gs,=,exp,.,w2,(cid:107),(cid:82),−,The,initial,temperature,Ts,is,chosen,to,be,Te,,which,is,constant,along,z,,and,the,initial,(cid:1),(cid:0),density,is,chosen,to,be,˜ns,=,ns,+,δns,,with,ns,=,dz(ns/Ne)/Lz,the,ﬁeld-line-averaged,density,,normalised,to,the,z-independent,electron,density,Ne.,The,piece,of,the,density,that,varies,along,z,,δns,,is,chosen,to,be,small,compared,to,ns,(δns/ns,=,0.001),so,that,the,system,of,equations,can,be,linearised,to,a,good,approximation.,This,facilitates,comparisons,with,the,linear,analytical,theory,presented,in,[3].,For,all,cases,shown,here,,ni,=,nn,=,Ne/2,,T,i,=,T,n,=,Te,and,mi,=,mn.,The,charge,exchange,collision,frequency,is,varied,,and,damping,rates,and,frequencies,are,extracted,by,considering,the,time,evolution,of,the,spatially-varying,component,of,the,electrostatic,potential,,δφ.,In,particular,,a,least-squares,ﬁt,for,δφ(t)/δφ(t0),is,done,for,each,simulation,to,a,function,of,the,form,exp(,ϕ),to,obtain,the,damping,rate,γ,,ϕ)/,cos(ωt0,−,frequency,ω,and,phase,ϕ.,The,results,are,given,in,Fig.,1.,There,is,good,agreement,across,a,wide,range,of,charge,exchange,collision,frequencies,,both,for,the,damping,of,ﬁnite,frequency,modes,(corresponding,to,the,solid,lines),and,to,a,zero,frequency,mode,that,appears,at,larger,collisionalities,(dashed-dotted,lines).,The,minor,discrepancy,between,the,analytical,and,numerical,damping,rates,that,is,apparent,for,the,case,with,normalised,charge,exchange,collision,frequency,near,0.7,is,due,to,the,simultaneous,presence,of,both,modes,with,similar,damping,rates.,t0)),cos(ωt,γ(t,−,−,−,Figure,1.,Normalized,damping,rate,and,real,frequency,as,a,function,of,the,charge,exchange,collision,frequency.,In,Figure,2,we,show,the,diﬀerence,in,conservation,properties,between,cases,for,which,the,conservative,corrections,indicated,at,the,beginning,of,the,Section,are,employed,and,those,for,which,no,conserving,correction,is,applied.,With,the,conservative,implementation,,all,of,the,requisite,moments,of,the,modiﬁed,distribution,function,are,conserved,to,machine,precision,,regardless,of,numerical,resolution.,00.511.522.500.511.52ω/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)analyticalkineticmoment-based−1.4−1.2−1−0.8−0.6−0.4−0.200.511.52γ/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)analyticalkineticmoment-based,Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,11,dw(cid:107)wm,Figure,2.,Time,traces,of,the,deviation,from,exact,conservation,of,the,moments,(cid:107),g,for,low-resolution,(Nz,=,9,on,one,element,,Nv,=,9,on,ﬁve,elements),Solid,and,dotted,lines,correspond,to,simulations,with,normalised,Rin,(cid:82),simulations,with,and,without,conserving,corrections,,respectively.,0.3.,≈,5.,Future,plans,Now,that,we,have,a,proof-of-concept,implementation,of,the,moment-based,approach,to,solving,the,1+1D,kinetic,problem,with,periodic,boundary,conditions,,we,plan,to,extend,the,model,to,treat,wall,boundary,conditions.,1×10−201×10−181×10−161×10−141×10−121×10−101×10−81×10−60.0001012345conservationabsoluteerrortci/Lzm=0m=1m=2,Numerical,study,of,moment-based,drift,kinetic,model,with,periodic,BCs,12,[1],M.,Barnes,,F.,I.,Parra,,and,M.,R.,Hardman.,Numerical,study,of,1d,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,2:2047357–TN–01–02,M2.1,,2021.,[2],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,4:2047357–,TN–01–02,M2.2,,2021.,[3],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,1d,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,1:2047357–TN–01–02,M1.1,,2021.,[4],C.-W.,Shu,and,S.,Osher.,Eﬃcient,implementation,of,essentially,non-oscillator,shock-capturing,schemes.,J.,Comp.,Phys.,,77:439–471,,1988.,[5],S.,Gottlieb,and,C.-W.,Shu.,Total,variation,diminishing,runge-kutta,methods.,Mathematics,of,Computation,,67:73–85,,1998.,[6],S.,Gottlieb,,C.-W.,Shu,,and,E.,Tadmor.,Strong,stability-preserving,high-order,time,discretization,methods.,SIAM,Rev.,,43:89,,2001.,[7],D.,R.,Durran.,Numerical,methods,for,ﬂuid,dynamics.,Springer,,2010.,[8],M.,Abramowitz,and,I.,A.,Stegun.,Handbook,of,Mathematical,Functions,with,Formulas,,Graphs,,and,Mathematical,Tables.,Dover,,New,York,,1972.,[9],Matteo,Frigo,and,Steven,G.,Johnson.,The,design,and,implementation,of,FFTW3.,Proceedings,of,the,IEEE,,93(2):216–231,,2005.,Special,issue,on,“Program,Generation,,Optimization,,and,Platform,Adaptation”.,[10],C.,W.,Clenshaw,and,A.,R,Curtis.,A,method,for,numerical,integration,on,an,automatic,computer.,Numerische,Mathematik,,2:197,,1960.

:pdfembed:`src:_static/TN-06_Numerical11DMomentBasedDriftKineticPeriodicBoundaryConditions.pdf, height:1600, width:1100, align:middle`

