CD-EXCALIBUR-FMS0083-M5c.2_ExcaliburFusionModellingSystemUncertaintyQuantificationComplementaryActions
======================================================================================================

.. meta::
   :description: technical note

   :keywords: ExCALIBUR,Uncertainty,Quantification,Complementary,Actions:,Code,Integration,,Acceptance,and,Operation,2,M5c.2,Version,1.00,Abstract,The,report,describes,work,for,ExCALIBUR,project,NEPTUNE,at,Mile-,stone,M5c.2.,It,outlines,work,towards,uncertainty,quantification,,reduced-,order,modelling,,and,data,assimilation,for,NEPTUNE.,An,analysis,of,the,accuracy,of,numerical,simulations,of,advection-diffusion,problems,is,pre-,sented.,Work,on,the,study,of,the,stability,of,two-dimensional,convective,flows,is,described,,including,a,new,presentation,of,the,use,of,solution,con-,tinuation,to,elucidate,the,structure,of,the,Hopf,bifurcation,from,steady,flows,to,time-dependent,behaviour.,An,update,on,the,status,of,the,Smallab,fluid,heat,transfer,experiments,is,given.,Work,by,the,holder,of,the,grant,T/AW085/21,is,briefly,summarized,,including,developments,in,Gaussian,process,surrogates,for,discontinuous,response,surfaces,and,the,applica-,tion,of,a,particle,filter,to,a,problem,in,drift-wave,turbulence.,UKAEA,REFERENCE,AND,APPROVAL,SHEET,Client,Reference:,UKAEA,Reference:,CD/EXCALIBUR-FMS/83,Issue:,Date:,1.00,June,3,,2024,Project,Name:,ExCALIBUR,Fusion,Modelling,System,Prepared,By:,Name,and,Department,Wayne,Arter,Ed,Threlfall,Signature,N/A,N/A,Date,March,15,,2024,March,15,,2024,CD,Reviewed,By:,Owen,Parry,March,15,,2024,CD,1,1,Introduction,The,uncertainty,quantification,(UQ),in,NEPTUNE,is,to,be,non-intrusive,,which,means,that,the,UQ,functionality,can,be,developed,largely,independently,of,the,main,NEPTUNE,code,base.,Since,the,main,NEPTUNE,codes,are,still,in,development,,the,first,part,of,this,report,offers,an,exposition,of,accuracy,estimation,for,advection-diffusion,problems,,which,are,common,in,plasma,physics,generally,and,NEPTUNE,specifically.,This,analysis,is,of,critical,import,for,the,implementation,of,plasma,fluid,solvers,currently,taking,place,in,the,NESO,framework.,A,subject,of,ongoing,relevance,for,NEPTUNE,is,heat,transfer,by,a,convecting,fluid.,The,stability,properties,of,flows,in,vertical,natural,convection,were,studied,in,the,prequel,[1],to,the,current,report,,with,the,discovery,in,the,space,parameterized,by,the,Prandtl,number,and,the,Rayleigh,number,of,a,one-dimensional,‘stability,frontier’,between,states,with,stable,steady,flows,and,states,which,exhibit,time-dependent,behaviour.,This,is,a,little,like,a,phase,transition,(in,that,the,frontier,is,a,subspace,of,co-dimension,one),and,thus,would,be,expected,to,display,collapse,to,one,dimension,of,the,active,subspace.,Here,(§3),a,deflated,solution,continuation,analysis,is,used,to,give,an,explanation,for,the,form,of,the,stability,frontier,as,a,composite,of,numerous,overlapping,instability,modes.,The,UQ,work,has,been,defrayed,under,Grant,T/AW085/21.,This,grantee’s,work,during,the,past,year,has,taken,the,form,of,code,development,and,related,hackathons,,and,a,final,written,report.,This,material,,which,covers,UQ,,reduced-order,models,,and,data,assimilation,,is,described,briefly,in,§4.,2,2,Estimating,Accuracy,in,Advection-Diffusion,Problems,2.1,Model,Problem,This,section,develops,ref,[2,,§,2.2],,concerning,discretisations,of,the,time-dependent,advection-,diffusion,equation,for,a,scalar,field,f,(x,,t),in,a,flow,u(x,,t),with,diffusion,κ,and,source,term,S(x,,t),∂f,∂t,+,∇,·,(uf,),=,∇,·,(κ∇f,),+,S,(1),Suppose,that,f,only,depends,on,a,single,spatial,coordinate,x,,u,has,a,single,component,u,,and,also,that,the,diffusion,κ,=,const.,Neglecting,gradients,of,u,,the,analytic,model,equation,may,be,taken,∂f,∂t,+,u,=,κ,∂f,∂x,∂2f,∂x2,+,S,(2),Solution,is,made,in,the,finite,domain,0,≤,x,≤,L,over,a,time,interval,[0,,T,].,Note,that,the,assump-,tions,made,do,not,exclude,the,nonlinear,case,f,=,u,,when,Equation,(2),is,known,as,Burgers,equation,and,κ,becomes,the,viscous,diffusion.,It,will,be,important,for,subsequent,work,to,distinguish,different,approaches,to,a,dimensionless,treatment,of,Equation,(2),and,thence,Equation,(1),,see,Section,2.2.,The,following,Section,2.3,shows,how,discretisation,of,Equation,(2),introduces,new,dimensionless,quantities,based,on,mesh,spacing,,and,then,Section,2.4,goes,on,to,discuss,the,implications,of,these,parameters,for,numer-,ical,stability,and,accuracy.,Section,2.3,also,includes,treatment,of,the,hyper-diffusion,term,which,may,be,represented,as,an,addition,to,the,source,in,Equation,(2),of,form,where,κ4,is,the,hyper-diffusion,,aka,hyper-viscosity,in,the,nonlinear,case,that,f,=,u.,S4,=,−κ4,∂4f,∂x4,(3),2.2,Dimensionless,Parameters,Naturally,because,of,the,finite,domain,,distances,are,scaled,by,L,,when,by,far,the,common-,est,approach,,particularly,when,S,=,0,is,to,make,time,t,dimensionless,in,terms,of,the,diffusion,timescale,L2/κ.,It,will,be,recalled,that,this,leads,to,a,model,in,dimensionless,variables,of,the,form,where,the,Peclet,number,∂f,∂t,+,P,e,·,u,∂f,∂x,=,∂2f,∂x2,P,e,=,U0L,κ,(4),(5),with,U0,=,||u||,as,a,representative,absolute,value,of,u,,usually,the,maximum,flow-speed.,Making,t,dimensionless,in,terms,of,the,turnover,timescale,L/U0,,similarly,leads,to,the,appearance,of,(the,reciprocal,of),P,e,in,the,coefficient,of,the,diffusion,term.,The,point,is,that,in,the,linear,problem,,not,only,is,κ,fixed,at,least,in,order,of,magnitude,,but,also,so,is,u/U0,similarly,of,order,unity,throughout.,3,When,u,is,varying,appreciably,,eg.,in,time,as,a,result,of,instability,in,a,coupled,momentum,equation,(or,say,due,to,driving,by,S,when,f,=,u),,it,is,often,customary,to,omit,the,Peclet,number,,and,work,with,a,model,in,dimensionless,variables,of,the,form,∂f,∂t,+,u,∂f,∂x,=,∂2f,∂x2,(6),where,the,dimensionless,u,may,vary,over,orders,of,magnitude,,and,of,course,even,when,u,is,fixed,,this,formulation,is,workable.,The,fixed,flow,case,using,the,model,Equation,(6),is,then,apparently,parameter-free,,although,it,should,be,evident,that,the,scale,of,the,initial,values,of,u,serves,to,set,an,implicit,or,‘hidden’,Peclet,number.,(Similar,remarks,apply,in,respect,of,hyperdiffusion,upon,introducing,P,e4,=,||u||h3/κ4.),2.3,Discrete,Dimensionless,Parameters,Suppose,h,is,the,spatial,mesh,separation,implicitly,assumed,to,be,uniform,,ie.,h,=,L/N,,,where,N,+,1,with,N,≫,1,is,the,number,of,mesh-points,in,0,≤,x,≤,L.,Let,∆t,be,the,timestep,,then,the,discrete,time,advance,is,of,general,form,∆tf,∆t,+,u,h,∆xf,=,κ,∆2,xf,h2,(7),where,∆x,and,∆2,x,are,discrete,difference,operators,in,the,x-coordinate,,eg.,∆xf,=,fi+1,−,fi,,operating,on,the,discrete,values,of,fi,at,the,mesh-points,i.,(∆t,is,defined,analogously.),If,κ,=,0,and,there,is,only,hyper-diffusion,∆tf,∆t,+,u,h,∆xf,=,−κ4,∆2,xf,h4,(8),Evidently,the,discrete,Equation,(7),may,be,made,dimensionless,using,the,mesh-scale,h,,introduc-,ing,the,mesh,Peclet,number,parameter,P,eh,=,U0h,κ,(9),There,are,questions,concerning,the,role,of,P,eh,inherited,from,a,good,deal,of,controversy,about,the,role,of,the,mesh,Reynolds,number,Reh,,viz.,P,eh,for,the,nonlinear,case.,Nonetheless,,at,least,heuristically,it,would,seem,that,when,P,eh,=,O(1),,there,is,an,approximate,balance,between,the,discrete,advective,and,diffusive,terms.,For,smaller,P,eh,the,latter,dominates,,which,is,numerically,significant,in,that,the,discrete,Laplacian,operator,,being,symmetric,and,definite,,is,much,easier,to,treat,numerically,than,the,discrete,advection,operator.,(Similar,remarks,apply,to,Equation,(8),upon,introducing,P,e4h,=,),(10),U0h3,κ4,Other,important,well-known,dimensionless,groups,for,Equations(7),and,(8),are,the,Courant,or,CFL,number,and,the,diffusion,limit,parameters,,respectively,ch,=,U0∆t,h,,,dh,=,κ∆t,h2,,,and,d4,=,κ4∆t,h4,(11),4,When,these,are,separately,unity,,the,corresponding,timestep,has,a,simple,physical,interpreta-,tion,as,respectively,the,timescale,for,the,turnover,,diffusion,and,hyper-diffusion,of,one,cell,of,the,discretisation.,Note,also,the,identities,P,eh,=,ch,dh,and,P,e4h,=,ch,d4,(12),Note,finally,that,,particularly,in,the,case,of,more,general,nonlinear,advection-diffusion,problems,,it,is,unclear,how,long,the,simulated,duration,T,needs,to,be,,and,indeed,what,the,smallest,physically,significant,lengthscale,will,be,,thus,it,is,inadequate,to,consider,the,simple,dimensionless,ratios,∆t/T,and,∆x/L.,2.4,Stability,Parameters,and,Accuracy,If,the,temporal,discretisation,of,Equation,(7),is,explicit,,it,is,plausible,(as,is,confirmed,by,rigorous,analysis,up,to,factors,of,order,unity),that,for,stability,the,timestep,must,be,less,than,or,equal,to,the,turnover,and,diffusion,times,of,one,cell,,viz.,ch,≤,1,,dh,≤,1,,and/or,d4,≤,1,(13),Since,maximal,size,of,timestep,is,to,be,preferred,for,computational,efficiency,,then,to,within,O(1),factors,,ch,=,dh,=,1,will,be,taken,and,so,P,eh,=,1,at,the,stability,boundary.,It,is,important,to,consider,accuracy,,again,this,is,posed,in,heuristic,terms,by,assuming,that,the,smallest,lengthscale,ℓ,important,in,the,dynamics,of,f,is,capable,of,numerical,estimation,,or,known,It,follows,that,for,minimally,accurate,results,h,<,ℓ.,For,say,on,the,basis,of,analytic,results.,advection-diffusion,problems,,whether,or,not,they,are,linear,,provided,S,=,0,,then,typically,ℓ,=,LP,e−α,,or,ℓ4,=,LP,e−β,4,(14),for,positive,α,≤,1,and,β,≤,1.,Simple,balancing,of,coefficients,gives,α,=,β,=,1,,whereas,smaller,values,follow,in,higher,dimensions,when,the,flow,is,incompressible,(typically,α,=,1/2),or,from,estimates,of,turbulent,microscales,in,the,nonlinear,case,,giving,α,=,3/4,[3].,Suppose,further,that,hyper-diffusion,is,added,to,an,advection-diffusion,problem,for,additional,nu-,merical,smoothing,,then,it,is,desirable,that,the,minimum,scale,h4,attained,by,the,latter,satisfies,ℓ4,<,ℓ,,equivalently,P,e−β,4,<,P,e−α,,which,when,α,=,β,implies,κ4,<,κL2,,and,hence,P,e4,>,P,eh/N,2.,Remembering,that,L,=,N,h,and,P,e,=,U0L/κ,,then,h,<,LP,e−α,gives,h,<,N,1−α,α,κ,U0,,,ie.,P,eh,<,N,−1+,1,α,,,implying,ch,<,dhN,−1+,1,α,Similarly,for,hyper-diffusion,h3,<,N,1−3β,β,κ4,U0,,,ie.,P,e4h,<,N,−3+,1,β,,,implying,ch,<,d4N,−3+,1,β,(15),(16),The,results,Equations(15),and,(16),are,key.,From,Equation,(15),it,follows,that,stability,of,the,explicit,scheme,implies,accurate,advection-diffusion,for,all,reasonable,values,of,α.,Moreover,there,5,is,benefit,from,use,of,implicit,schemes,,even,on,uniform,meshes,if,α,<,1,,since,then,accuracy,is,possible,even,when,ch,≫,1.,Whether,accuracy,is,achieved,in,a,time-dependent,calculation,,depends,on,the,smallest,important,timescale,τ,.,The,work,of,Hunt,et,al.,[3],implies,τ,=,ℓ2/κ,,ie.,then,∆t,<,τ,implies,dh,<,1,since,h,<,ℓ,has,been,assumed,,so,that,temporal,accuracy,may,also,be,consistent,with,ch,≫,1.,(For,hyperdiffusion,,d4,<,κ4/(κh2),,so,if,κ4,<,κL2,,d4,<,N,2.),However,if,τ,=,ℓ/U0,,which,could,occur,if,there,were,say,large,initial,transients,,then,for,minimal,accuracy,in,the,time,advance,,∆t,<,τ,implies,ch,<,1.,By,contrast,,in,an,approach,to,a,steady-state,solution,,the,timescale,for,change,of,field,variables,could,become,very,long,,meaning,that,an,implicit,scheme,would,benefit,from,its,ability,to,take,very,large,timesteps,whilst,maintaining,accuracy.,3,Vertical,natural,convection,revisited,Work,described,in,§3.4,of,[1],was,performed,partially,to,provide,target,proxyapps,for,UQ,/,ROM,/,DA,investigations,as,a,stand-in,until,software,developed,in,the,NESO,framework,becomes,avail-,able,for,large-scale,studies.,The,aforementioned,work,targetted,the,different,regimes,of,vertical,natural,convection,in,a,square,cavity,with,the,aim,of,providing,a,‘phase,diagram’,showing,,ini-,tially,,the,dividing,line,(in,a,parameter,space,coordinatized,by,the,two,dimensionless,parameters,in,the,problems,,the,Prandtl,number,(Pr),and,the,Rayleigh,number,(Ra)),between,convecting,sys-,tems,with,a,stationary,steady-state,flow,and,those,where,the,flow,is,subject,to,time-dependent,behaviour,(this,division,,which,is,a,Hopf,bifurcation,,is,referred,to,as,the,‘stability,frontier’,in,the,sequel).,This,is,a,very,interesting,and,rich,problem,due,to,the,variation,in,the,background,flow,for,different,values,of,Pr,and,Ra,.,The,quantification,of,behaviour,over,a,wide,range,of,parameters,is,expected,to,provide,a,useful,general,guide,to,the,behaviour,of,various,fluids,in,heated,cavities:,a,range,of,−2,to,2,was,used,for,the,base-10,logarithm,of,the,Prandtl,number,,which,covers,a,wide,range,of,fluids,at,room,temperature,e.g.,mercury,(Pr,=,0.015),,gases,such,as,air,(Pr,=,0.7),,water,(Pr,=,7.0),,up,to,viscous,oils,(Pr,=,100+),(this,range,reflects,the,relative,ease,of,the,diffusive,transfer,of,momentum,relative,to,that,of,heat).,Note,the,thermal,properties,of,many,of,these,fluids,are,relevant,for,fusion-related,,as,well,as,more,general,,engineering,applications.,The,holder,of,grant,T/AW087/22,was,given,this,problem,to,further,investigate,,in,order,to,demon-,strate,the,use,of,solution,continuation,techniques;,the,grantee,chose,to,use,the,DEFCON,software,package,[4],to,apply,the,technique,of,deflated,continuation,to,the,problem.,The,deflation,technique,allows,additional,solutions,to,nonlinear,systems,to,be,found,,basically,by,removing,known,solu-,tions,from,the,Newton,iteration.,The,science,goals,here,were,to,explain,the,form,of,the,stability,frontier,,and,more,prosaically,to,provide,a,check,on,the,numerics,used,in,[1],(the,grant,holder,is,expert,in,numerical,analysis).,The,outcome,of,the,new,work,is,a,confirmation,of,much,of,the,material,presented,before.,The,stability,frontier,was,plotted,in,[1],for,two,choices,of,boundary,condition,on,the,top,/,bottom,of,the,cavity,(which,was,coordinatized,as,a,unit,square,with,the,bottom,left,corner,at,the,origin):,either,conducting,,where,a,an,inhomogeneous,(1,−,x),Dirichlet,boundary,condition,is,applied,for,the,temperature,(as,used,in,e.g.,[5]),,or,insulating,,where,a,homogeneous,Neumann,condition,applies.,Note,that,the,latter,case,a),appears,to,exhibit,more,interesting,behaviour,and,b),is,more,numerically,demanding,due,to,the,larger,Rayleigh,numbers,required,to,trigger,time-dependent,6,Figure,1:,Stability,frontiers,data,produced,by,grantee,(grey,points),overlain,with,data,presented,in,[1];,conducting,boundaries,(left),,insulating,boundaries,(right).,instabilities,(this,is,an,example,of,the,loose,rule,that,a,more-insulated,fluid,system,is,more,likely,to,remain,in,a,steady,flow,condition).,The,results,from,[1],are,superimposed,on,the,grantee’s,results,in,Fig.1.,Note,the,grantee,has,chosen,to,transpose,the,axes,relative,to,the,existing,work.,The,grantee’s,numerical,results,for,the,conducting,case,shows,good,general,agreement,with,ear-,lier,work,over,the,entire,range,of,parameters,studied,,with,the,possible,exception,of,one,point,at,log10Pr,=,−1,where,the,early,work,appears,not,to,pick,up,the,instability,until,slightly,late,into,the,continuation,parameter,scan,(which,used,monotonically,increasing,values,of,Pr).,The,grantee’s,results,for,the,insulating,case,show,good,agreement,with,earlier,work,up,to,log10Pr,≈,0.4.,For,higher,Pr,values,,where,the,numerics,are,more,challenging,due,to,the,narrowness,of,the,boundary,layers,on,the,upright,walls,,the,grantee,was,unable,to,obtain,numerical,results,to,the,Indeed,,their,results,for,lower,precision,(the,con-,same,level,of,precision,as,their,other,results.,tinuous,part,of,the,grey,curve,in,Fig.1,and,the,continuous,dark,blue,curve,in,Fig.2),show,marked,discrepancy,with,the,numerical,results,presented,in,[1].,In,view,of,the,interesting,behaviour,seen,in,the,latter,,this,is,slightly,unfortunate,and,further,study,of,this,region,of,parameter,space,for,the,problem,would,appear,to,be,indicated.,The,author,considers,their,earlier,results,in,need,of,further,verification,(note,also,the,discrepancy,with,the,study,by,Wang,et,al,[6],for,log10Pr,=,1.0,exhibited,in,Fig.14,of,[1]).,Nevertheless,,the,grantee’s,work,has,provided,a,verification,of,a,large,portion,of,the,parameter,space,for,the,stability,frontier.,Rather,informative,colour-coded,versions,of,the,stability,frontier,diagrams,were,produced,by,the,grantee,(Fig.2),,showing,that,the,frontier,is,in,both,boundary,condition,cases,a,composite,of,multi-,ple,instabilities,protruding,into,the,steady-flow,part,of,the,parameter,space.,This,structure,means,that,the,frontier,is,a,continuous,curve,with,points,of,discontinuous,derivative,(cusps).,It,would,be,of,interest,to,obtain,a,plot,of,the,instability,mode,associated,to,each,of,the,solution,branches.,The,grantee’s,work,was,presented,in-person,(at,the,NEPTUNE,Workshop,2024),in,lieu,of,a,written,report.,The,associated,proxyapp,code,and,some,documentation,can,be,accessed,in,the,repository,7,Figure,2:,Stability,frontiers,colour-coded,by,solution,branch;,conducting,boundaries,(left),,insulat-,ing,boundaries,(right).,Different,branches,denote,different,time-dependent,instabilities.,Note,that,the,continuous,blue,curve,to,the,extreme,right,of,the,right-hand-side,plot,is,a,numerical,region,where,the,precision,needed,to,be,reduced,due,to,the,numerical,demands,of,the,large,Rayleigh,number,and,this,part,of,the,plot,does,not,agree,with,the,results,reported,in,[1].,[7].,Note,that,this,code,was,based,on,the,Firedrake,scripts,used,in,the,earlier,study,but,that,the,grantee,extended,it,to,use,the,DEFCON,software,to,track,the,solution,branches,and,therefore,the,original,code,has,now,been,inspected,by,more,than,one,professional,numerical,analyst.,The,present,author,is,very,interested,to,know,whether,any,results,are,available,regarding,the,overall,shape,of,the,stability,frontier,or,any,asymptotics,(e.g.,very,small,or,very,large,Pr,or,Ra).,There,are,many,possibilities,for,further,work,,involving,extension,of,the,studied,parameter,ranges,,and,extension,into,other,geometries,including,the,three-dimensional,case,which,is,expected,to,contain,additional,instabilities.,The,same,grantee,performed,related,work,applying,adjoint,methods,to,the,cavity,problem,for,values,of,Ra,near,the,stability,frontier,,in,the,case,of,air,as,the,fluid,(Pr,=,0.71,/,log10Pr,=,−0.15,,which,falls,within,the,region,where,there,is,agreement,between,numerics,of,the,author,and,those,explained,above).,This,work,used,the,adjoint,analysis,features,available,in,Nektar++,,thus,providing,a,useful,example,of,an,adjoint,problem,in,Nektar++,(which,latter,is,the,finite-element,framework,currently,used,as,a,basis,for,the,NESO,plasma,fluids,solvers).,In,this,case,,the,adjoint,analysis,is,used,to,discover,the,perturbations,in,the,wall,temperatures,profiles,to,which,the,system,is,most,sensitive,,which,is,complementary,to,the,stability,frontier,work,which,concerns,currently,only,constant,vertical,wall,temperatures.,This,work,was,reported,as,Technical,Report,2068625-,TN-09,,and,the,code,and,scripts,used,(including,some,new,additional,Nektar++,source,code),can,be,found,at,[8].,3.1,Additional,physics,of,vertical,natural,convection,The,vertical,natural,convection,problem,has,other,interesting,aspects,beyond,the,physics,of,the,transition,to,time-dependent,behaviour.,One,is,of,course,the,turbulent,regime,,but,even,the,laminar,8,flows,exhibit,a,range,of,physical,effects,that,are,the,subject,of,current,investigation,by,the,fluids,community;,an,example,of,the,latter,is,the,study,of,secondary,flows,in,[9],(which,does,not,include,It,might,be,noted,that,,while,continuation,in,Pr,,which,is,a,property,of,the,any,UQ,analysis).,fluid,,may,not,seem,particularly,physically-motivated,,it,is,actually,the,case,that,many,fluids,exhibit,significant,change,in,Pr,as,their,temperature,is,varied.,The,examples,in,Fig.3,were,run,using,Firedrake,to,find,the,steady,flow,in,a,tall,tank,(aspect,ratio,10).,The,code,solves,initially,the,problem,for,a,value,of,the,Prandtl,number,close,to,unity,,which,flows,are,a,single,convective,cell,and,prove,numerically,easy,to,obtain.,Subsequently,,continuation,is,performed,i.e.,Pr,is,gradually,decremented,and,the,simulation,is,re-run,using,the,previous,solution,as,an,initial,guess.,This,reveals,,for,sufficiently,small,values,of,Pr,,more,interesting,flow,patterns,containing,multiple,convective,cells,along,the,tank,length,resulting,in,an,approximate,periodicity,,and,which,may,display,more,than,one,cell,structure,per,period,(i.e.,the,alternating-size,sawtooth,pattern,seen,in,the,left-hand,figure).,The,utility,of,the,above,in,a,UQ,/,ROM,context,is,that,these,flows,could,be,made,the,subject,of,a,campaign,of,simulations,where,the,objective,is,to,develop,a,smart,choice,of,‘experimental,design’,(i.e.,choosing,where,in,parameter,space,to,perform,simulations,for,use,in,surrogate,construction),including,the,need,for,solution,continuation,(which,means,that,new,simulations,in,some,areas,of,parameter,space,must,use,a,nearby,solution,as,an,initial,guess,in,order,to,obtain,convergence;,see,the,discussion,in,§.3,of,[1]).,Such,work,would,extend,the,grantee’s,current,expertise,in,exper-,imental,design.,It,is,clearly,also,possible,to,do,the,stability,frontier,analysis,on,this,sort,of,tank,geometry.,4,Management,of,grant,T/AW085/21,The,present,author,has,been,responsible,for,the,management,of,the,titular,grant,for,approximately,the,past,year.,This,has,included,regular,online,meetings,to,discuss,the,grant,work,and,also,regu-,lar,attendance,at,the,meeting,series,‘Uncertainty,in,Fluid,Turbulence’,chaired,by,Professor,Peter,Coveney,of,University,College,London.,As,has,previously,been,the,case,,the,utility,to,Project,NEPTUNE,of,the,grantee’s,expertise,and,technology,(which,includes,the,SEAVEA,Toolkit,of,un-,certainty,quantification,software,(the,acronym,stands,for,Software,Environment,for,Actionable,and,VVUQ-evaluated,Exascale,Applications),,and,also,other,powerful,frameworks,as,listed,in,§.5,of,[10]),has,been,affected,by,the,lack,of,a,large-scale,plasma,solver,code,within,the,NEPTUNE,software,ecosystem.,It,has,been,a,priority,to,ensure,that,such,a,code,is,developed,,hence,the,implementation,of,working,plasma,solvers,in,the,NESO,framework,(these,were,described,in,[11]).,Another,area,of,work,relevant,to,this,grant,is,the,Smallab,fluid,tank,experiment,being,developed,at,Leeds,University.,It,was,originally,conceived,that,novel,measurements,from,such,experiments,would,form,the,basis,for,data,assimilation,and,reduced-order,modelling,work,under,NEPTUNE,,leading,towards,a,digital,twin,of,a,tabletop,fluid,heat,transfer,experiment.,Unfortunately,,there,are,as,yet,no,meaningful,measurements,from,the,experiment,,which,the,present,author,understands,to,have,been,delayed,as,a,result,of,practical,difficulties,(and,said,author,in,no,way,wishes,to,understate,the,challenges,of,this,experiment).,Note,that,the,experimental,work,is,being,supported,by,numerical,simulation,performed,using,,among,other,softwares,,Nektar++,,including,efforts,by,9,log10Pr,=,−0.1,,−0.4,,−0.7,,−1.0,(left,to,right).,Right,panel:,log10Ra,=,Figure,3:,Steady-state,temperature,colour,maps,for,laminar,flows.,Left,panel:,3.5;,log10Pr,=,log10Ra,=,4.0;,−0.2,,−0.6,,−1.0,,−1.4,(left,to,right).,The,acceleration,due,to,gravity,acts,(as,usual),in,the,down-,ward,direction.,10,Figure,4:,Labelled,experimental,setup,for,Smallab,fluid,tank,experiment.,Figure,5:,Example,velocimetry,outputs,from,an,early,version,of,the,Smallab,fluid,tank,experiment.,The,colour,map,indicates,the,local,flow,speed.,the,experimenter,and,also,fully,3D,numerics,performed,by,UKAEA,personnel,(for,the,latter,see,Fig.17,of,[1]).,An,image,of,the,apparatus,being,considered,is,shown,in,fig,4,,from,which,some,of,the,complexity,involved,is,apparent.,The,experimenter,has,given,a,preliminary,presentation,detailing,the,experiment,design,and,showing,some,initial,measurements,(e.g.,Fig.5);,a,video,recording,of,this,presentation,exists,and,may,be,available,,subject,to,relevant,permissions,,by,appealing,to,the,authors,of,this,report.,The,holder,of,grant,T/AW085/21,has,continued,to,provided,HPC,allocations,on,Archer2,to,some,of,the,other,grantees,(specifically,,the,holders,of,grants,T/AW087/22,and,T/AW088/22),and,to,the,UKAEA,,which,latter,allowance,continues,for,at,least,three,months,after,the,expiry,of,T/AW085/21.,Further,details,of,the,work,described,in,this,section,can,be,found,in,UCL,grantee,report,2057701-,TN-02,[12].,11,4.1,NESO,The,grantee,has,implemented,a,plugin,for,FabSim3,to,facilitate,HPC,runs,of,UKAEA,NESO,soft-,ware.,This,is,currently,set,up,with,turn-key,examples,including,a,polynomial,chaos,expansion,of,outputs,from,the,existing,2D-in-3D,Haswgawa-Wakatani,plasma,solver,in,NESO,and,a,Bayesian,calibration,run,using,the,NESO,Electrostatic2D3V,solver.,4.2,Reduced-order,models,for,discontinuous,response,surfaces,Many,models,relevant,to,fusion,exhibit,discontinuous,response,surfaces,(examples,are,the,transi-,tion,to,a,convecting,state,in,Rayleigh-B,´enard,convection,in,a,continuum,fluid,when,the,problem,is,parameterized,by,Rayleigh,and,Prandtl,numbers,,and,the,various,steady-states,of,the,two-stream,instability,in,the,space,parameterized,by,the,plasma,frequency,and,the,proper,velocity,of,the,initial,beams,-,see,Appendix,A.3,of,[13]).,Note,that,the,two-stream,instability,is,a,model,problem,in,plasma,continuum,kinetics,and,has,formed,the,basis,for,one,of,the,NEPTUNE,proxyapps,devel-,oped,under,the,grant,T/AW084/21.,It,is,well-known,that,standard,Gaussian,process,(GP),tech-,niques,work,well,for,smooth,response,surfaces,and,the,grantee,has,explored,the,performance,of,GP,surrogates,for,the,discontinuous,response,case.,The,model,chosen,was,the,Lorenz,63,reduc-,tion,of,Rayleigh-B,´enard,convection,to,a,set,of,nonlinear,ODEs.,Like,the,full,problem,,this,system,has,a,parameter,space,coordinatized,by,the,Prandtl,and,Rayleigh,numbers.,The,response,is,taken,to,be,the,Nusselt,number,(which,in,the,full,problem,is,the,rate,of,heat,transfer,across,the,convect-,ing,fluid).,The,Nusselt,number,exhibits,discontinuous,behaviour,in,(Ra,,Pr)-space,(Fig.6),because,some,choices,of,these,parameters,means,the,system,tends,to,a,stable,fixed,point,,whereas,other,values,lead,to,the,chaotic,behaviour,associated,to,the,familiar,Lorenz,attractor.,The,grantee,investigated,this,problem,using,a,two-layered,deep,GP,and,a,Latin,hypercube-based,design,for,selecting,new,sampling,points,in,(Ra,,Pr)-space.,Further,,due,to,the,knowledge,of,the,asymptotics,,rectangular,regions,were,selected,as,bounding,boxes,for,the,asymptotes,,giving,two,subregions,in,which,to,conduct,Latin,hypercube,sampling;,in,this,way,,the,sample,points,are,con-,centrated,near,where,the,discontinuity,is,expected,to,be.,This,may,reasonably,be,described,as,a,physics-informed,experimental,design,method.,Note,that,the,method,relies,on,knowing,in,ad-,vance,the,asymptotes,of,the,stability,frontier.,The,grantee,has,developed,also,a,statistical,method,capable,of,estimating,where,the,gradient,in,the,underlying,model,exceeds,a,certain,threshold,and,some,outputs,can,be,seen,in,Fig.7.,Note,that,the,two-stream,instability,cases,show,a,markedly,similar,structure,to,that,seen,in,the,Lorenz,63,model,with,an,L-shaped,stability,frontier,having,two,linear,asymptotics,(Fig.8).,In,the,figure,,ωP,is,the,plasma,frequency,,the,counter-propagating,beams,have,initial,speeds,±v0,and,Gaussian,width,(i.e.,square,root,of,temperature),σ,and,k,is,just,a,constant.,The,equation,for,the,kσ,=,(2xD+(x),−,1)−,1,2,e−x2erfi(x),is,a,stability,frontier,is,y,≡,ωP,Dawson,function.,The,two,linear,asymptotes,are,x,=,0.92414,and,y,=,2,where,x,≡,v0√,2σ,and,D+(x),≡,√,2x.,√,π,12,Figure,6:,Response,surface,i.e.,Nusselt,number,(Nu),as,a,function,of,Rayleigh,(Ra),and,Prandtl,(Pr),numbers,for,the,Lorenz,63,system.,The,dashed,blue,lines,are,the,known,linear,asymptotes,of,the,stability,frontier,(given,by,the,discontinuity,in,the,response,surface).,Figure,7:,Sequential,design,for,numerical,experiments,designed,to,detect,the,discontinuity,in,the,response,surface,discussed,in,the,text.,The,colourmap,indicates,the,probability,that,the,local,gradient,exceeds,a,threshold,value.,The,surface,estimates,shown,used,3,,10,,30,and,50,samples,(increasing,left,to,right).,13,Figure,8:,Stability,frontier,for,the,two-stream,instability,problem.,4.3,Data,assimilation:,initial,study,of,drift-wave,turbulence,A,particle,filter-based,data,assimilation,package,,ParticleDA.jl,[14],,was,released,during,2022.,An,initial,version,,which,provides,data,assimilation,capability,linked,to,the,other,capabilities,of,the,SEAVEA,Toolkit,,can,be,found,at,[15].,One,of,the,author’s,goals,has,been,to,apply,this,particle,filter,implementation,to,some,of,the,proxyapps,developed,under,NEPTUNE.,The,output,of,the,Nektar++-based,proxyapp,Nektar-Driftwave,was,chosen,as,an,initial,target,and,the,problem,setup,was,started,at,a,SEAVEA,hackathon,event,which,occurred,on,December,1,,4-5,2024,and,was,attended,by,two,personnel,from,UKAEA,NEPTUNE.,As,background,,the,filtering,problem,is,typically,of,the,form,Xk,=,g(Xk−1),+,Wk−1,Yk,=,h(Xk),+,Vk.,(17),In,the,above,,Xk,is,the,state,of,the,system,at,time,horizon,k,and,Yk,is,an,observation.,Wk−1,is,the,stochastic,component,of,the,model,update,and,Vk,is,measurement,noise,associated,to,observa-,tion,k.,The,model,update,is,g,and,is,Markov.,The,goal,is,to,estimate,the,posterior,distribution,of,the,model,state,given,the,measurements.,Note,that,for,a,linear,update,g,and,Gaussian,Wk,and,Vk,this,posterior,is,available,analytically,and,this,is,the,usual,Kalman,filter,treatment.,The,particle,filter,is,a,way,of,doing,this,problem,that,works,in,nonlinear,cases,such,as,Nektar-Driftwave.,Since,all,currently-available,NEPTUNE,/,NESO,proxyapps,are,deterministic,,and,no,experimental,results,are,available,(results,from,the,fluid,tank,experiment,mentioned,in,§.3,would,have,served,admirably),,the,particle,filter,must,be,applied,to,proxyapp,outputs,to,which,some,artificial,noise,is,added,(particle,filters,require,a,non-degenerate,distribution,of,state,at,future,times,given,the,current,state).,The,grantee,implemented,a,method,of,generating,Gaussian,random,fields,on,a,spatial,domain,,within,the,Nektar++,framework,,and,this,Gaussian,noise,was,added,to,simulation,outputs,to,simulate,model,error.,14,It,is,worth,noting,that,the,version,of,Nektar-Driftwave,used,by,the,grantee,has,,subsequent,to,this,work,,been,updated,and,is,now,a,great,deal,faster,(i.e.,at,least,one,order,of,magnitude),in,execution,than,before.,The,simulations,used,here,were,run,on,HPC,but,it,is,likely,now,that,this,work,could,be,reproduced,quickly,using,only,a,laptop.,Outputs,are,shown,in,Fig.9.,The,filter,is,found,to,work,adequately,for,early,times,,but,once,the,simulation,starts,to,enter,the,turbulent,state,,the,method,fails,due,to,the,well-known,degeneracy,problem,of,particle,filters,,that,is,,the,weights,for,most,of,the,particles,drop,to,near-zero,,making,the,ensemble,close,to,degenerate.,The,grantee,proposes,improved,proposal,distributions,and,/,or,use,of,localization,as,possible,improvements,(it,is,also,the,case,that,increasing,the,ensemble,size,(i.e.,the,number,of,particles),would,stave,off,the,degeneracy,problem,and,allow,the,state,to,be,tracked,for,a,longer,time).,It,would,probably,be,better,to,apply,the,filter,to,one,of,the,other,outputs,of,the,model,which,have,a,smoother,general,appearance,than,the,vorticity,,e.g.,the,potential,,which,obeys,∇2ϕ,=,w,(it,is,clear,that,differentiating,twice,results,in,a,less-smooth,function,,and,in,the,numerical,implementation,the,potential,is,a,continuous,field,,while,the,vorticity,and,density,use,a,discontinuous,representation).,The,problem,discussed,here,is,rather,similar,to,an,application,of,a,particle,filter,to,the,barotropic,vorticity,equations,,detailed,in,Ch.13,of,[16],,in,particular,§.13.4.7.,That,analysis,gives,some,possible,methods,for,improving,the,initial,results,.,Note,that,in,this,example,,the,vorticity,field,seems,to,have,been,chosen,as,the,target,for,the,data,assimilation,problem,in,order,to,give,a,more-challenging,task,than,would,be,the,case,if,the,streamfunction,(the,equivalent,of,the,potential,in,the,Nektar-Driftwave,case),were,used.,∂w,∂t,−,∂ψ,∂y,∂ψ,∂x,+,∂w,∂x,∂2ψ,∂x2,+,=,β,∂w,∂y,∂2ψ,∂y2,=,w,(18),Here,w,is,the,vorticity,,ψ,the,streamfunction,,and,β,a,random,noise,term,representing,errors,in,the,model,equations.,These,equations,are,very,similar,to,the,2D,Hasegawa-Wakatani,system,modelled,by,Nektar-Driftwave.,Unfortunately,,the,current,implementation,of,NESO-Particles,does,not,allow,for,stochastic,time-,evolution,i.e.,there,is,no,stochastic,input,to,the,model,once,it,is,started,(i.e.,a,run,,once,initialized,,is,deterministic).,This,means,NESO-Particles,simulations,cannot,yet,be,used,with,the,particle,filter.,This,issue,will,go,away,once,Monte,Carlo,collisions,are,available,in,NESO-Particles.,15,Figure,9:,Time-evolution,of,the,vorticity,in,Nektar-Driftwave:,true,state,(left),and,particle,filter,estimate,of,the,mean,using,an,initial,ensemble,size,of,512,particles.,The,state,is,tracked,well,during,the,initial,evolution,but,fails,later,on,due,to,the,degeneracy,problem.,16,5,Summary,Material,for,understanding,the,numerical,errors,associated,to,advection-diffusion,problems,,which,problems,are,ubiquitous,in,simulations,of,plasma,physics,,was,presented.,An,update,to,the,analysis,of,stability,for,2D,convecting,fluid,problems,,started,in,[1],,was,provided,and,an,explanation,for,the,form,of,the,stability,frontier,curve,was,presented.,The,recent,work,of,the,holder,of,grant,T/AW085/21,on,uncertainty,,reduced-order,models,,and,data,assimilation,was,briefly,summarized.,The,authors,acknowledge,assistance,from,Niall,Bootland,,Ubaid,Qadri,and,Josh,Williams,of,STFC,,and,Peter,Coveney,,Matt,Graham,,Serge,Guillas,,Yiming,Yang,and,others,of,University,College,London.,Acknowledgement,The,support,of,the,UK,Meteorological,Office,and,Strategic,Priorities,Fund,is,acknowledged.,References,[1],E.,Threlfall,and,Powell,S.,Complementary,actions:,uncertainty,quantification,code,integration,,acceptance,,and,operation,1.,Technical,Report,CD/EXCALIBUR-FMS/0073,,UKAEA,Project,Neptune.,[2],W.,Arter.,Numerical,simulation,of,magnetic,fusion,plasmas.,Reports,on,Progress,in,Physics,,58:1–59,,1995.,http://dx.doi.org/10.1088/0034-4885/58/1/001.,[3],J.C.R.,Hunt,,I.,Eames,,J.,Westerweel,,P.A.,Davidson,,S.,Voropayev,,J.,Fernando,,and,M.,Braza.,Thin,shear,layers-the,key,to,turbulence,structure?,Journal,of,Hydro-environment,Research,,4(2):75–82,,2010.,[4],DEFCON,code,Bitbucket,repository.,master/.,Accessed:,March,2024.,https://bitbucket.org/pefarrell/defcon/src/,[5],Winters,K.H.,Hopf,bifurcation,in,the,double-glazing,problem,with,conducting,boundaries.,Transactions,of,the,ASME,894,/,Vol.109,,November,1987.,,1987.,[6],Wang,Q.,,Liu,H-R.,,Verzicco,R.,,Shishkina,O.,,and,Lohse,D.,Regime,transitions,in,ther-,mally,driven,high-Rayleigh,number,vertical,convection.,J.,Fluid,Mech.,(2021),Vol.197,A.6,doi:10.1017/jfm.2021.262,,2021.,[7],NumericalAnalysis/Continuation,code,repository.,ExCALIBUR-NEPTUNE/NumericalAnalysis/tree/main/Continuation.,2024.,https://github.com/,Accessed:,March,17,[8],NumericalAnalysis/Adjoint,code,repository.,https://github.com/ExCALIBUR-NEPTUNE/,NumericalAnalysis/tree/main/Adjoint.,Accessed:,March,2024.,[9],Umbria,J.S.,and,Net,M.,Prandtl,number,dependence,of,convective,fluids,in,tall,laterally,heated,slots.,The,European,Physics,Journal,Special,Topics,Vol.,227,,pages,481–492,,2018.,[10],E.,Threlfall,,S.,Powell,,and,W.,Arter.,Complementary,actions.,Uncertainty,Quantification,Code,integration,,acceptance,and,operation,1.,Technical,Report,CD/EXCALIBUR-FMS/0073-,M5c.1,,UKAEA,,3,2023.,https://github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/,reports/ukaea_reports/CD-EXCALIBUR-FMS0073-M5c.1.pdf.,[11],J.,Cook,,W.,Saunders,,and,O.,Parry.,integrated,particle,and,continuum,model.,Technical,Report,CD/EXCALIBUR-FMS/0079-M4c.3,,UKAEA,,9,2023.,https://github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/reports/ukaea_,reports/CD-EXCALIBUR-FMS0079-M4c.3.pdf,to,be,posted.,Three-Dimensional,[12],S.,Guillas.,Advanced,Quantification,of,Uncertainties,In,Fusion,modelling,at,the,Exascale,with,model,order,Reduction,(AQUIFER),2.,Technical,Report,2057701-TN-02,,UKAEA,Project,Neptune,,2024.,to,be,posted,at,https://github.com/ExCALIBUR-NEPTUNE/Documents/,blob/main/reports/2057701/TN-02.pdf.,[13],Arter,W.,,Parry,O.,,and,E.,Threlfall.,Finite,element,models:,complementary,actions,3.,Tech-,nical,Report,CD/EXCALIBUR-FMS/0074,,UKAEA,Project,Neptune.,[14],ParticleDA.jl.,https://github.com/Team-RADDISH/ParticleDA.jl.,Accessed:,March,2023.,[15],FABParticleDA.,https://github.com/djgroen/FabParticleDA/tree/master.,Accessed:,March,2023.,[16],Blayo,´E.,,Bocquet,M.,,Cosme,E.,,and,Cugliandolo,L.F.,Les,Houches,2012:,Advanced,Data,Assimilation,for,Geosciences.,Oxford,University,Press,,2015.,18

:pdfembed:`src:_static/CD-EXCALIBUR-FMS0083-M5c.2_ExcaliburFusionModellingSystemUncertaintyQuantificationComplementaryActions.pdf, height:1600, width:1100, align:middle`

