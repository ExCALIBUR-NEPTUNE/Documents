TN-09_2DDriftKineticPeriodicBoundaryConditions
==============================================

.. meta::
   :description: technical note

   :keywords: REPORT,2047357-TN-09-01,M1.6,1,2D,drift,kinetic,model,with,periodic,boundary,conditions,Felix,I.,Parra,,Michael,Barnes,and,Michael,Hardman,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Oxford,OX1,3PU,,UK,(This,version,is,of,29,September,2021),1.,Introduction,In,report,2047357-TN-07-02,,we,presented,a,2D,drift,kinetic,model,for,a,helical,mag-,netic,ﬁeld,with,wall,boundary,conditions.,The,wall,boundary,conditions,made,it,possible,to,obtain,the,potential,and,the,electron,ﬂow,from,the,conservation,of,parallel,current,and,the,electron,parallel,momentum,equation.,With,periodic,boundary,conditions,,ap-,propriate,for,closed,ﬂux,surfaces,,it,will,not,be,suﬃcient,with,conservation,of,parallel,current,,and,we,will,have,to,include,terms,small,in,the,expansion,parameter,that,we,use,,the,ion,gyroradius,over,the,characteristic,width,of,the,scrape-oﬀ,layer,(ρi/Lr).,In,this,report,,we,ﬁrst,remind,the,reader,of,the,content,in,report,2047357-TN-07-02,,and,we,then,explain,how,to,modify,the,current,conservation,equations,for,cases,with,periodic,boundary,conditions.,2.,Magnetic,ﬁeld,,geometry,and,orderings,We,use,the,cylindrical,coordinates,{r,,z,,ζ},(see,report,2047357-TN-07-02,for,the,direc-,tion,of,increase,of,ζ).,We,consider,a,magnetized,plasma,with,one,ion,species,with,charge,e,and,mass,mi,,electrons,with,charge,−e,and,mass,me,,and,one,species,of,neutrals,with,mass,The,plasma,is,magnetized,by,the,helical,magnetic,ﬁeld,mn,=,mi.,B(r,,ζ),:=,Bz(r)ˆz,+,Bζ(r)ˆζ(ζ),,(2.1),(2.2),where,ˆz,and,ˆζ,are,the,unit,vectors,in,the,direction,of,∇z,and,∇ζ.,Note,that,the,compo-,nents,Bz,and,Bζ,only,depend,on,the,radial,position,r.,We,assume,that,the,plasma,only,varies,in,r,and,z.,We,assume,that,the,electric,ﬁeld,produced,by,the,plasma,is,electrostatic,,E,=,−(∂φ/∂r)ˆr,−,(∂φ/∂z)ˆz,,where,ˆr,is,the,unit,vector,in,the,direction,∇r.,The,potential,φ(r,,z,,t),depends,on,the,coordinates,r,and,z,and,on,time,t.,We,impose,periodic,boundary,conditions,at,z,=,0,and,z,=,Lz.,In,the,radial,direction,,we,consider,the,interval,between,r,=,r0,and,r,=,r0,+,Lr.,The,length,Lr,is,determined,by,a,balance,between,the,fast,parallel,velocity,of,the,particles,along,magnetic,ﬁeld,lines,and,their,slow,drift,across,them.,The,characteristic,length,between,the,two,walls,along,a,magnetic,ﬁeld,line,is,of,order,B,Bz,Thus,,the,typical,time,that,it,takes,for,an,ion,to,move,from,wall,to,wall,is,L(cid:107)/vti,∼,L(cid:107),∼,(2.3),Lz.,2,Felix,I.,Parra,,Michael,Barnes,and,Michael,Hardman,(B/Bz)(Lz/vti),,where,vti,:=,(cid:112)2Ti/mi,is,the,ion,thermal,speed,and,Ti,is,the,ion,tem-,perature.,For,a,potential,φ,of,the,order,of,Ti/e,,where,e,is,the,proton,charge,,the,radial,E,×,B,drift,is,vEr,:=,−,Bζ,B2,∂φ,∂z,∼,ρi,Lz,vti,,(2.4),:=,vti/Ωi,is,the,characteristic,ion,gyroradius,and,Ωi,where,ρi,:=,eB/mi,is,the,ion,gyrofrequency.,Thus,,the,time,it,takes,for,an,ion,to,cross,the,domain,in,the,radial,direction,is,Lr/vEr,∼,LrLz/ρivti.,By,making,this,time,of,the,same,order,as,L(cid:107)/vti,,we,solve,for,Lr,to,ﬁnd,Lr,∼,B,Bz,ρi,(2.5),To,simplify,the,problem,to,a,tractable,drift,kinetic,form,,we,assume,that,ρi,is,much,smaller,than,Lr.,This,implies,that,ρi,Lr,∼,Bz,B,∼,Bz,Bζ,(cid:28),1,,(2.6),that,is,,we,will,limit,our,model,to,magnetic,ﬁelds,that,are,mostly,azimuthal,and,have,a,very,small,vertical,component.,This,is,an,approximation,that,is,consistent,with,magnetic,ﬁeld,geometry,in,conventional,tokamaks,and,also,in,the,edge,of,many,shots,in,spherical,tokamaks.,We,also,assume,that,r0,∼,Lz,(cid:29),Lr.,Since,r0,is,the,characteristic,length,of,variation,of,the,magnetic,ﬁeld,B,,the,magnetic,ﬁeld,barely,changes,across,the,domain,[r0,,r0,+,Lr].,Thus,,within,our,ordering,,we,assume,B,to,be,uniform,in,the,domain,of,interest.,We,assume,the,time,derivatives,to,be,of,the,same,order,as,the,parallel,and,perpendic-,ular,time,scales,that,we,have,discussed,above,,∂,∂t,∼,ρi,Lr,vti,Lz,.,(2.7),Our,orderings,above,rest,on,the,assumption,φ,∼,Ti/e.,In,the,case,with,wall,boundary,conditions,,the,wall,boundary,conditions,ensured,that,φ,remained,of,this,order.,With,periodic,boundary,conditions,,the,size,of,φ,is,controlled,by,the,momentum,input.,The,force,per,unit,volume,on,the,plasma,due,to,external,sources,,neutral-plasma,collisions,or,ionization,must,satisfy,|Fi,ext⊥|,,|Fe,ext⊥|,,|Fin⊥|,,|Fen⊥|,,|Fi,ion⊥|,,|Fe,ion⊥|,(cid:46),(cid:18),ρi,Lr,(cid:19)2,pi,Lz,,,(2.8),where,pi,is,the,ion,pressure.,This,estimate,for,the,force,per,unit,volume,comes,from,making,the,force,of,the,order,of,the,perpendicular,inertia,,∂(nimiui⊥)/∂t,,where,the,perpendicular,ion,velocity,ui⊥,is,taken,to,be,of,order,(ρi/Lr)vti,(see,equation,(4.7),below,for,a,justiﬁcation,of,this,ordering,for,ui⊥;,also,note,that,this,means,that,the,perpendicular,ﬂow,is,much,smaller,than,the,parallel,one,,which,we,assume,to,be,of,the,order,of,vti).,Equation,(2.8),might,seem,stringent,,but,the,friction,between,ions,and,neutrals,and,electron,and,neutrals,(due,to,elastic,collisions,or,ionization),is,small,in,the,closed,ﬁeld,line,region,of,the,tokamak,because,the,neutral,density,is,small,,i.e.,we,can,assume,that,nnRin,∼,nnRen,(cid:114),me,mi,∼,nnRion,(cid:46),(cid:18),ρi,Lr,(cid:19)2,vti,Lz,,,(2.9),where,nnRin,,nnRen,and,nnRion,are,the,ion-neutral,,electron-neutral,and,ionization,collision,frequencies.,2D,drift,kinetic,model,with,periodic,boundary,conditions,3,3.,Summary,of,report,2047357-TN-07-02,The,model,in,report,2047357-TN-07-02,is,comprised,of:,•,three,ﬂuid,equations,(conservation,of,particles,,parallel,momentum,and,energy),for,ions,that,have,to,be,solved,in,conjunction,with,an,ion,kinetic,equation,to,determine,the,ion,density,ni,=,ne,,the,ion,parallel,velocity,ui(cid:107),,the,ion,temperature,Ti,and,the,normalized,ion,distribution,function,Fi;,•,ﬁve,ﬂuid,equations,(conservation,of,particles,,the,three,components,of,momentum,and,energy),for,neutrals,that,have,to,be,solved,in,conjunction,with,a,neutral,kinetic,equation,to,determine,the,neutral,density,nn,,the,three,components,of,the,neutral,velocity,un,,the,neutral,temperature,Tn,and,the,normalized,neutral,distribution,function,Fn;,•,two,ﬂuid,equations,(conservation,of,parallel,current,,Bz,B,∂,∂z,(cid:2)ni,(cid:0)ui(cid:107),−,ue(cid:107),(cid:1)(cid:3),=,0,,(3.1),and,conservation,of,energy),for,electrons,that,have,to,be,solved,in,conjunction,with,an,electron,kinetic,equation,to,determine,the,electron,parallel,velocity,ue(cid:107),,the,electron,temperature,Te,and,the,electron,normalized,distribution,function,Fe;,and,•,the,electron,parallel,momentum,equation,,0,=,−,Bz,B,∂pe(cid:107),∂z,+,eneBz,B,∂φ,∂z,+,Fei(cid:107),+,nemennRen(un(cid:107),−,ue(cid:107)),,(3.2),for,the,potential,φ.,Here,,Fei(cid:107),is,the,collisional,friction,force,between,electrons,and,ions.,In,report,2047357-TN-07-02,,we,proposed,a,method,to,solve,equations,(3.1),and,(3.2),in,conjunction,with,wall,boundary,conditions.,Equation,(3.1),can,be,integrated,in,z,to,obtain,ue(cid:107)(r,,z,,t),−,ue(cid:107)(r,,0,,t),(recall,that,ni,and,ui(cid:107),are,time-advanced,using,ion,equations).,With,this,result,,equation,(3.2),can,be,integrated,in,z,to,obtain,the,diﬀerence,φ(r,,z,,t),−,φ(r,,0,,t),as,a,function,of,the,unknown,ue(cid:107)(r,,0,,t),(recall,that,pe(cid:107),is,determined,by,the,electron,energy,equation,and,the,electron,kinetic,equation,,and,that,Fei(cid:107),depends,on,ue(cid:107)).,With,wall,boundary,conditions,,we,could,solve,for,both,ue(cid:107)(r,,0,,t),and,φ(r,,0,,t).,Unfortunately,,the,same,cannot,be,said,for,periodic,boundary,conditions.,With,periodic,boundary,conditions,and,these,equations,,it,is,possible,to,ﬁnd,an,equation,for,ue(cid:107)(r,,0,,t),,but,not,for,φ(r,,0,,t).,Indeed,,dividing,equation,(3.2),by,ne,,integrating,in,z,and,using,the,periodic,boundary,conditions,for,φ,,we,ﬁnd,the,condition,(cid:90),Lz,(cid:20),−,0,=,0,Bz,neB,∂pe(cid:107),∂z,+,Fei(cid:107),ne,(cid:21),+,mennRen(un(cid:107),−,ue(cid:107)),dz.,(3.3),This,condition,is,satisﬁed,by,choosing,the,correct,value,of,ue(cid:107)(r,,0,,t).,Within,equa-,tions,(3.1),and,(3.2),,there,is,no,other,similar,condition,for,φ(r,,0,,t).,To,ﬁnd,such,a,condition,,we,need,to,modify,equation,(3.1),by,keeping,higher,order,terms,in,ρi/Lr.,4.,Current,conservation,for,periodic,boundary,conditions,Parra,&,Catto,(2008),showed,that,gyrokinetic,equations,(and,consequently,the,sub-,sidiary,limit,of,drift,kinetics),require,higher,order,terms,in,ρi/Lr,in,order,to,determine,the,component,of,the,electric,ﬁeld,perpendicular,to,the,ﬂux,surfaces,traced,by,the,mag-,netic,ﬁeld,when,the,magnetic,ﬁeld,is,axisymmetric.,In,this,case,,this,means,that,one,needs,higher,order,terms,to,determine,∂φ/∂r.,The,need,for,higher,order,terms,can,be,demonstrated,using,moments,of,the,full,kinetic,equation.,Before,we,start,taking,moments,,we,explain,what,we,mean,by,full,kinetic,distribution,function,and,full,kinetic,equation,in,this,report,,and,how,they,compare,to,4,Felix,I.,Parra,,Michael,Barnes,and,Michael,Hardman,the,drift,kinetic,distribution,function,and,kinetic,equation,that,we,have,used,so,far.,Importantly,,what,follows,does,not,apply,to,the,neutral,distribution,function,and,kinetic,equation,as,we,have,not,reduced,them,using,the,drift,kinetic,approximation,in,previous,reports.,We,denote,the,ion,and,electron,full,distribution,functions,by,gs(r,,z,,v,,t),,where,the,velocity,is,given,by,v,=,v(cid:107),ˆb,+,v⊥,=,v(cid:107),ˆb,+,v⊥(cos,ϕ,ˆr,+,sin,ϕ,ˆb,×,ˆr),,(4.1),Here,v(cid:107),is,the,velocity,parallel,to,the,magnetic,ﬁeld,,ˆb,:=,B/B,is,the,unit,vector,in,the,direction,to,the,magnetic,ﬁeld,,and,the,velocity,perpendicular,to,the,magnetic,ﬁeld,v⊥,is,described,by,its,magnitude,v⊥,and,its,direction,,given,by,the,gyrophase,ϕ.,The,full,kinetic,distribution,functions,for,ions,and,electrons,,gi,and,ge,,satisfy,the,full,kinetic,equations,∂gi,∂t,+,∇,·,(vgi),+,∇v,·,(cid:20),e,mi,and,∂ge,∂t,+,∇,·,(vge),+,∇v,·,−,(cid:20),e,me,(−∇φ,+,v,×,B),gi,=,Cii,+,Cin,+,Cie,+,Ci,ion,+,Qi,(4.2),(cid:21),(−∇φ,+,v,×,B),ge,=,Cee,+,Cen,+,Cei,+,Ce,ion,+,Qe.,(4.3),(cid:21),Note,that,we,have,included,like-particle,collisions,,electron-ion,collisions,,collisions,with,neutrals,and,ionization,collisions.,The,sources,Qe,represent,the,particle,,momentum,and,energy,input,into,the,plasma.,The,drift,kinetic,ion,and,electron,distribution,functions,fi,and,fe,that,we,used,in,previous,reports,are,gyroaverages,of,the,full,distribution,functions,,fs(r,,z,,v(cid:107),,v⊥,,t),:=,1,2π,(cid:90),2π,0,gs(r,,z,,v(v(cid:107),,v⊥,,ϕ),,t),dϕ.,(4.4),(Correspondingly,,the,sources,Ss,that,we,used,are,the,gyoraverage,of,the,full,sources,Qs.),For,ρi/Lr,(cid:28),1,,the,distribution,functions,gs,and,fs,are,almost,identical,,gs,(cid:39),fs,(Hazeltine,1973).,The,diﬀerence,between,these,distribution,functions,,of,order,ρi/Lr,(cid:28),1,,was,negligible,in,the,case,with,wall,boundary,conditions,,but,it,will,be,important,with,periodic,boundary,conditions.,Thus,,we,write,gs,=,fs,+,gs1,+,.,.,.,,,(4.5),where,,neglecting,the,ion-neutral,,electron-neutral,and,ionization,collisions,to,lowest,order,(recall,equation,(2.9)),,gs1,=,sin,ϕ,(cid:18),v⊥,Ωs,∂fs,∂r,−,1,B,∂φ,∂r,∂fs,∂v⊥,(cid:19),∼,ρs,Lr,fs.,(4.6),Here,Ωs,:=,ZseB/ms,is,the,gyrofrequency,of,species,s,,and,Zs,is,the,charge,number,(1,for,ions,and,−1,for,electrons).,Using,equation,(4.5),,we,can,calculate,the,perpendicular,average,velocity,of,ions,and,electrons,,us⊥,:=,(cid:90),1,ns,v⊥gs,d3v,(cid:39),(cid:90),1,ns,v⊥gs1,d3v,=,ˆb,×,ˆr,(cid:18),1,ZsensB,∂ps⊥,∂r,+,1,B,∂φ,∂r,(cid:19),∼,ρi,Lr,vti,,(4.7),where,ps⊥,:=,(cid:82),(msv2,⊥/2)fs,d3v,is,the,perpendicular,pressure,of,species,s.,Note,that,since,the,average,of,v⊥,over,the,gyrophase,vanishes,,us⊥,is,only,due,to,the,small,correction,gs1.,Thus,,us⊥,is,small.,Note,that,this,is,a,consequence,of,our,assumption,φ,∼,Ti/e.,A,larger,φ,would,have,led,to,a,larger,average,velocity.,2D,drift,kinetic,model,with,periodic,boundary,conditions,5,After,this,brief,introduction,to,the,full,distribution,functions,gs,,we,can,use,moments,of,these,distribution,functions,to,impose,current,conservation,following,the,procedure,proposed,by,Parra,&,Catto,(2009).,Current,conservation,can,be,written,as,(cid:104),(cid:105),eni(ui(cid:107),−,ue(cid:107))ˆb,∇,·,+,∇,·,J⊥,=,0,,(4.8),where,J⊥,is,the,component,of,the,current,density,perpendicular,to,the,magnetic,ﬁeld.,In,report,2047357-TN-07-02,we,could,neglect,the,term,∇,·,J⊥,because,it,is,small,in,Lr/Lz,(cid:28),1.,We,cannot,neglect,it,any,longer,,as,we,need,it,to,determine,φ(r,,0,,t).,Equation,(4.8),can,be,written,as,∂,∂z,(cid:20),eniBz,B,(ui(cid:107),−,ue(cid:107)),+,J⊥,·,ˆz,(cid:21),+,1,r,∂,∂r,(rJ⊥,·,ˆr),=,0.,(4.9),Due,to,the,periodic,boundary,conditions,,the,large,parallel,current,term,can,be,eliminated,by,integrating,in,z,,(cid:32)(cid:90),Lz,0,∂,∂r,(cid:33),J⊥,·,ˆr,dz,=,0,,(4.10),where,we,have,also,used,the,fact,that,r,(cid:39),r0,is,almost,constant.,Condition,(4.10),deter-,mines,φ(r,,0,,t).,Unfortunately,,equation,(4.7),is,not,enough,to,compute,J⊥,·,ˆr,to,the,suﬃciently,high,order,needed,to,obtain,φ(r,,0,,t).,The,perpendicular,current,density,can,,however,,be,calculated,to,very,high,order,by,taking,moments,of,the,full,kinetic,equations,for,ions,and,electrons.,Multiplying,equations,(4.2),and,(4.3),by,msv,and,integrating,over,velocity,space,,we,ﬁnd,the,ion,and,electron,total,momentum,equations,,(nimiui),+,∇,·,(cid:18)(cid:90),(cid:19),mivvgi,d3v,∂,∂t,=,−eni∇φ,+,eniui,×,B,+,Fin,+,Fie,+,Fi,ion,+,Fi,ext,(4.11),and,(nemeue),+,∇,·,(cid:18)(cid:90),(cid:19),mevvge,d3v,∂,∂t,=,ene∇φ,−,eneue,×,B,+,Fen,+,Fei,+,Fe,ion,+,Fe,ext.,(4.12),Here,,Fα,:=,(cid:82),msvCα,d3v,is,the,force,due,to,the,collision,operator,Cα,,and,Fs,ext,:=,(cid:82),msvQs,d3v,is,the,external,momentum,input.,Summing,equations,(4.11),and,(4.12),,using,quasineutrality,and,Fie+Fei,=,0,,and,neglecting,the,electron,momentum,compared,to,the,ion,momentum,,we,ﬁnd,J×B,(cid:39),∇·,(cid:18)(cid:90),mivvgi,d3v,+,(cid:90),mevvge,d3v,(cid:19),+,∂,∂t,(nimiui)−Fin,−Fi,ion,−Fext.,(4.13),where,we,have,deﬁned,the,total,external,force,Fext,:=,Fi,ext,+,Fe,ext.,Multiplying,equa-,tion,(4.13),by,(ˆr,×,ˆb)/B,,we,obtain,the,radial,component,of,J⊥,,J⊥,·,ˆr,(cid:39),−,(cid:18)(cid:90),1,B,∇,·,mivv,·,(ˆb,×,ˆr)gi,d3v,+,(cid:90),(cid:90),miv,·,∇,(cid:17),(cid:16)ˆb,×,ˆr,·,vgi,d3v,+,(cid:90),mev,·,(ˆb,×,ˆr)ge,d3v,(cid:19),mev,·,∇,(cid:17),(cid:16)ˆb,×,ˆr,·,vge,d3v,1,B,(cid:104),nimi,B,ui,·,(ˆb,×,ˆr),(cid:105),+,1,B,Fin,·,(ˆb,×,ˆr),+,1,B,Fi,ion,·,(ˆb,×,ˆr),+,1,B,Fext,·,(ˆb,×,ˆr),,(4.14),+,−,1,B,∂,∂t,6,where,Felix,I.,Parra,,Michael,Barnes,and,Michael,Hardman,(cid:17),(cid:16)ˆb,×,ˆr,∇,=,−,(cid:19),B2,ζ,B2,d,dr,(cid:18),Bz,Bζ,ˆrˆb,−,BzBζ,rB2,ˆbˆr,+,B2,rB2,(ˆb,×,ˆr)ˆr,∼,z,Bz,r0B,∼,ρi,Lr,1,Lz,.,(4.15),The,term,with,the,time,derivative,in,the,right,side,of,equation,(4.14),sets,the,size,of,the,equation.,For,∂/∂t,∼,ρivti/LrLz,,using,the,fact,that,|ui⊥|,∼,(ρi/Lr)vti,,we,ﬁnd,∂,∂t,(cid:104),nimi,B,(cid:105),ui,·,(ˆb,×,ˆr),∼,(cid:18),ρi,Lr,(cid:19)2,pi,BLz,.,(4.16),This,estimate,justiﬁes,the,ordering,(2.8).,Also,,estimate,(4.16),sets,the,size,of,the,terms,that,we,need,to,keep,in,the,equation.,For,example,,the,integrals,that,contain,∇(ˆb,×,ˆr),are,small,because,∇(ˆb,×,ˆr),is,itself,small,in,ρi/Lr,and,the,integrals,over,velocity,are,small,by,a,factor,of,(ρi/Lr)2,,as,can,be,checked,using,expression,(4.6),for,gi,and,ge.,Thus,,integrating,over,z,,using,equation,(4.7),for,ui⊥,and,employing,the,approximation,r,(cid:39),r0,,we,ﬁnd,(cid:90),Lz,0,J⊥,·,ˆr,dz,(cid:39),−,∂,∂t,(cid:34)(cid:90),Lz,(cid:18)(cid:90),1,B,∂,∂r,0,(cid:34)(cid:90),Lz,0,nimi,B2,(cid:18),∂φ,∂r,+,1,eni,∂pi⊥,∂r,miv,·,ˆr(v,×,ˆb),·,ˆr,gi,d3v,+,(cid:19),(cid:90),(cid:35),dz,mev,·,ˆr(v,×,ˆb),·,ˆr,ge,d3v,(cid:19),(cid:35),dz,(cid:90),Lz,0,(cid:20),1,B,Fin,·,(ˆb,×,ˆr),+,1,B,Fi,ion,·,(ˆb,×,ˆr),+,(cid:21),Fext,·,(ˆb,×,ˆr),dz.,1,B,(4.17),−,+,The,velocity,integrals,in,equation,(4.17),can,be,calculated,using,a,moment,of,equa-,i,/4eB)[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2],tions,(4.2),and,(4.3).,Multiplying,equation,(4.2),by,(m2,and,integrating,in,velocity,space,and,z,,we,ﬁnd,(cid:90),Lz,(cid:90),dz,0,(cid:39),+,−,−,d3v,miv,·,ˆr(v,×,ˆb),·,ˆr,gi,(cid:34)(cid:90),Lz,(cid:90),1,4Ωi,∂,∂t,1,4Ωi,(cid:90),Lz,0,1,4Ωi,0,0,(cid:34)(cid:90),Lz,(cid:90),dz,∂,∂r,0,(cid:20),∂φ,∂r,(cid:90),nimi,2B2,(cid:90),Lz,dz,d3v,mi[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2],gi,(cid:35),(cid:35),d3v,miv,·,ˆr[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2],gi,(cid:18),∂φ,∂z,+,1,eni,∂pi⊥,∂z,(cid:19),+,∂φ,∂z,(cid:18),∂φ,∂r,+,1,eni,∂pi⊥,∂r,(cid:19)(cid:21),dz,dz,d3v,mi[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2]Cii,,(4.18),where,we,have,neglected,most,collision,operators,due,to,our,assumption,(2.9).,Due,to,the,integrals,over,the,gyrophase,,the,terms,with,the,time,derivative,and,the,ion-ion,collision,2D,drift,kinetic,model,with,periodic,boundary,conditions,7,operator,vanish,to,the,order,of,interest,,leaving,d3v,miv,·,ˆr(v,×,ˆb),·,ˆr,gi,(cid:34)(cid:90),Lz,(cid:90),(cid:90),Lz,(cid:90),dz,0,(cid:39),−,∂,∂r,1,4Ωi,(cid:90),Lz,0,dz,d3v,miv,·,ˆr[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2],gi,0,(cid:20),∂φ,∂r,(cid:18),∂φ,∂z,+,1,eni,∂pi⊥,∂z,(cid:19),+,∂φ,∂z,(cid:18),∂φ,∂r,+,1,eni,∂pi⊥,∂r,(cid:19)(cid:21),dz.,(4.19),nimi,2B2,(cid:35),There,is,still,another,integral,over,velocity,to,be,calculated.,We,can,use,the,moment,(m2,i,/3eB)[((v,×,ˆb),·,ˆr)3,+,3(v,·,ˆr)2(v,×,ˆb),·,ˆr],of,equation,(4.2),to,ﬁnd,(cid:90),Lz,(cid:90),dz,0,d3v,miv,·,ˆr[(v,·,ˆr)2,−,((v,×,ˆb),·,ˆr)2],gi,(cid:39),−,(cid:90),Lz,0,2pi⊥,B,∂φ,∂z,dz.,(4.20),With,this,result,and,employing,integration,by,parts,in,z,to,write,(cid:34)(cid:90),Lz,0,∂,∂r,2pi⊥,B,∂φ,∂z,(cid:35),dz,(cid:39),=,(cid:90),Lz,0,(cid:90),Lz,0,2,B,2,B,(cid:18),∂pi⊥,∂r,(cid:18),∂pi⊥,∂r,∂φ,∂z,∂φ,∂z,+,pi⊥,(cid:19),∂2φ,∂r∂z,dz,−,∂pi⊥,∂z,∂φ,∂r,(cid:19),dz,,(4.21),equation,(4.19),simpliﬁes,to,(cid:90),Lz,(cid:90),dz,0,d3v,miv,·,ˆr(v,×,ˆb),·,ˆr,gi,=,−,(cid:90),Lz,0,nimi,B2,∂φ,∂z,(cid:18),∂φ,∂r,+,1,eni,∂pi⊥,∂r,(cid:19),dz.,(4.22),The,electron,integral,in,equation,(4.17),can,be,calculated,using,the,same,procedure,that,has,led,to,equation,(4.22),,and,it,turns,out,to,be,negligible,due,to,the,smallness,of,me/mi.,Substituting,equation,(4.22),into,equation,(4.17),and,then,equation,(4.17),into,equa-,tion,(4.10),,and,using,the,same,simpliﬁed,ion-neutral,and,ionization,collision,operators,that,we,have,used,in,previous,reports,,Cin,:=,−Rin(nngi,−,nifn),,Ci,ion,:=,neRionfn,,(4.23),we,ﬁnd,the,ﬁnal,equation,for,φ(r,,0,,t),,∂,∂t,(cid:90),Lz,0,(cid:20),nimi,B2,(cid:18),∂φ,∂r,+,1,eni,(cid:18),∂φ,∂r,(cid:19)(cid:21),dz,∂pi⊥,∂r,+,1,eni,∂pi⊥,∂r,(cid:19),(cid:35),dz,+,1,eni,∂pi⊥,∂r,(cid:19),dz,(cid:34)(cid:90),Lz,0,nimi,B2,niminnRin,B2,∂φ,∂z,(cid:18),∂φ,∂r,(cid:40),∂,∂r,−,+,−,+,1,B,∂,∂r,(cid:90),Lz,0,(cid:90),Lz,0,niminn(Rin,+,Rion)unz,B,dz,+,(cid:90),Lz,0,Fext,·,ˆz,B,(cid:41),dz,=,0.,(4.24),Note,that,in,several,places,we,have,used,the,approximation,ˆb,×,ˆr,(cid:39),ˆz.,Equation,(4.24),is,small,by,a,factor,of,(ρi/Lr)2,compared,to,the,parallel,current,term,in,the,current,conservation,equation,(4.8),,of,order,(ρi/Lr)(enevti/Lz).,Thus,,in,principle,,8,Felix,I.,Parra,,Michael,Barnes,and,Michael,Hardman,to,keep,these,terms,we,would,need,to,keep,terms,up,to,order,(ρi/Lr)3,in,this,equation.,Thankfully,,we,do,not,need,to,do,that,because,we,now,have,equation,(4.24),in,explicit,form.,We,can,add,equation,(4.24),to,our,set,of,equations,in,a,consistent,manner.,We,ﬁnish,by,relating,equation,(4.24),to,momentum,conservation,,a,connection,that,we,0,J⊥,·,ˆr,dz,0,J⊥,·,ˆr,dz,mentioned,at,the,end,of,section,2.,Equation,(4.24),is,a,radial,derivative,of,(cid:82),Lz,(see,equation,(4.10)).,Then,,equation,(4.24),can,be,integrated,to,show,that,(cid:82),Lz,is,a,constant,that,we,will,call,Ir,,giving,∂,∂t,(cid:90),Lz,0,nimiui⊥,·,ˆz,dz,−,(cid:32)(cid:90),Lz,0,∂,∂r,nimi,B,∂φ,∂z,(cid:33),ui⊥,·,ˆz,dz,=,−IrB,−,+,(cid:90),Lz,0,(cid:90),Lz,0,niminnRin(ui⊥,·,ˆz,−,unz),dz,niminnRionunz,dz,+,(cid:90),Lz,0,Fext,·,ˆz,dz.,(4.25),Here,we,have,used,the,ˆz,projection,of,equation,(4.7),to,rewrite,∂φ/∂r,as,a,function,of,ui⊥,·,ˆz.,Equation,(4.25),is,the,perpendicular,momentum,balance,in,the,z,direction,,and,it,includes,the,magnetic,force,due,to,the,radial,current,Ir.,This,magnetic,force,is,zero,in,tokamaks,,where,the,radial,current,vanishes.,5.,Moment,drift,kinetics,The,moment,drift,kinetic,formulation,of,the,problem,with,periodic,boundary,condi-,tions,is,thus,the,equations,in,report,2047357-TN-07-02,plus,our,new,equation,(4.24),for,φ(r,,0,,t).,The,perpendicular,pressure,appearing,in,this,equation,can,be,calculated,from,the,normalized,distribution,function,using,the,formula,ps⊥[ns,,vts,,Fs](r,,z),:=,πnsmsv2,ts,(cid:90),∞,(cid:90),∞,dw(cid:107),−∞,0,dw⊥,w3,⊥Fs(r,,z,,w(cid:107),,w⊥,,t).,(5.1),6.,Discussion,Note,that,the,addition,of,equation,(4.24),has,only,been,possible,because,we,evolve,the,densities,of,ions,and,electrons,independently,of,their,normalized,distribution,functions.,Had,we,proposed,to,evolve,the,unnormalized,ion,and,electron,distribution,functions,,it,would,not,have,been,possible,to,have,an,independent,higher-order,current,conservation,equation,because,it,would,not,be,consistent,with,the,density,that,arises,from,the,time,evolution,of,the,lowest,order,kinetic,equations.,When,implementing,the,equations,proposed,in,this,report,,it,is,important,to,ensure,that,there,is,z-variation,of,density,,temperature,and,ﬂows.,Otherwise,,the,equations,become,trivial.,When,connected,to,the,open,ﬁeld,line,region,(the,topic,of,a,future,report),,the,z-variation,will,arise,naturally,due,to,the,wall,boundary,conditions.,In,the,absence,of,open,ﬁeld,lines,,one,can,use,sources,and,sinks,with,that,are,not,uniform,in,z,(i.e.,excess,ionization,in,the,region,close,to,the,divertor,,where,most,neutrals,are).,REFERENCES,Hazeltine,,R.D.,1973,Recursive,derivation,of,drift-kinetic,equation.,Plasma,Phys.,15,,77–80.,Parra,,F.I.,&,Catto,,P.J.,2008,Limitations,of,gyrokinetics,on,transport,time,scales.,Plasma,Phys.,Control.,Fusion,50,,065014.,2D,drift,kinetic,model,with,periodic,boundary,conditions,9,Parra,,F.I.,&,Catto,,P.J.,2009,Vorticity,and,intrinsic,ambipolarity,in,turbulent,tokamaks.,Plasma,Phys.,Control.,Fusion,51,,095008.

:pdfembed:`src:_static/TN-09_2DDriftKineticPeriodicBoundaryConditions.pdf, height:1600, width:1100, align:middle`

