TN-10_Numerical11DDriftKineticParallelDynamicsPlasmaEdge
========================================================

.. meta::
   :description: technical note

   :keywords: Report,2047357-TN-D2.2+M2.5,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,in,the,plasma,edge,M.,Barnes1,,F.,I.,Parra2,,M.,R.,Hardman1,and,J.,Omotani3,1,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,2,Princeton,Plasma,Physics,Laboratory,,P.O.,Box,451,,Princeton,,New,Jersey,08540,,United,States,3,Culham,Centre,for,Fusion,Energy,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,United,Kingdom,E-mail:,michael.barnes@physics.ox.ac.uk,1.,Introduction,We,expect,that,two,of,the,biggest,challenges,in,numerically,solving,drift,kinetic,equations,in,the,plasma,edge,are,treating,the,motions,of,charged,particles,along,the,magnetic,ﬁeld,line,and,accounting,for,the,interaction,between,charged,and,neutral,particles.,Both,of,these,physics,processes,diﬀer,considerably,depending,on,whether,one,is,in,a,region,with,closed,or,open,ﬁeld,lines:,charged-neutral,interactions,are,only,likely,to,be,signiﬁcant,in,the,open,ﬁeld,line,region,nearest,the,wall,,where,recycling,of,particles,leads,to,a,relatively,large,neutral,density;,and,parallel,dynamics,in,the,open-ﬁeld-line,region,will,be,strongly,modiﬁed,relative,to,the,core,by,the,fact,that,electrons,stream,rapidly,along,ﬁeld,lines,into,the,walls,–,thus,setting,up,boundary,layers,with,strong,electric,ﬁelds.,Our,aim,with,this,report,is,to:,present,a,set,of,drift,kinetic,models,as,candidate,models,for,describing,plasma,dynamics,parallel,to,the,ﬁeld,in,both,open-,ﬁeld-line,and,closed-ﬁeld-line,regions,of,the,edge,,in,the,presence,of,neutrals;,to,describe,how,these,models,might,be,implemented,numerically;,and,to,test,the,relative,eﬃcacy,of,these,models,for,numerical,simulation.,We,start,in,Section,2,by,stating,the,common,assumptions,made,for,all,of,the,models,and,by,presenting,the,standard,drift,kinetic,model,equations,for,parallel,plasma,dynamics.,We,then,derive,a,series,of,‘moment,kinetic’,models,in,Section,3,that,utilise,modiﬁed,particle,distribution,functions,and,parallel,velocity,coordinates,to,separate,the,evolution,of,the,distribution,function,from,its,low-order,velocity,moments.,The,boundary,conditions,imposed,on,the,system,are,discussed,in,Section,4,before,providing,the,normalised,system,of,equations,for,each,model,in,Section,5.,The,key,features,of,our,numerical,implementation,of,the,model,equations,are,described,in,Section,6,before,presenting,numerical,results,from,our,code,in,Section,7.,Finally,,we,provide,our,conclusions,on,the,suitability,of,the,models,for,numerical,simulation,in,Section,8,and,discuss,future,directions,for,the,research.,1,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,2,2.,Drift,kinetics,for,parallel,dynamics,A,detailed,derivation,of,the,drift,kinetic,model,we,consider,is,provided,in,a,previous,report,[5].,Here,we,provide,a,brief,overview,of,the,model,for,the,Reader’s,convenience.,The,system,we,consider,consists,of,a,single,ion,species,of,charge,e,and,mass,mi,,a,single,neutral,species,of,mass,mn,=,mi,,and,an,electron,species,modelled,as,having,a,Boltzmann,response,,all,immersed,in,a,straight,,uniform,magnetic,ﬁeld,in,the,z,direction.,We,allow,for,charge,exchange,collisions,between,ions,and,neutrals,and,ionisation,collisions,involving,ions,,electrons,and,neutrals,,but,do,not,account,for,intra-,species,collisions.,Finally,,we,assume,that,the,plasma,is,homogeneous,in,the,plane,perpendicular,to,the,magnetic,ﬁeld.,With,these,assumptions,,our,model,system,of,equations,describing,drift,kinetics,is,one,dimensional,in,both,conﬁguration,and,velocity,space:,∂fi,∂t,+,v,∂fi,∂z,−,e,mi,∂φ,∂z,(cid:107),∂fi,∂v,(cid:107),=,Rin,(nnfi,−,−,nifn),+,Rionnefn,,∂fn,∂t,+,v,(cid:107),∂fn,∂z,=,Rin,(nifn,−,−,nnfi),−,Rionnefn,,ns(z,,t),=,∞,(cid:90),−∞,dv,(cid:107),fs(z,,v,,,t),,(cid:107),(1),(2),(3),and,.,=,ni,=,ne,=,Ne,exp,eφ,Te,(cid:19),Fs,the,marginalized,particle,distribution,function,for,species,s,,with,fs,the,components,of,the,particle,velocity,parallel,and,perpendicular,to,the,v,(cid:82),(cid:107),magnetic,ﬁeld,,respectively,,ϑ,the,gyro-angle,,t,the,time,,φ,the,electrostatic,potential,,and,Rin,and,Rion,charge,exchange,and,ionization,collision,frequency,factors.,and,v,dϑdv,v,⊥,(4),(cid:18),⊥,⊥,,,3.,Moment,kinetics,One,can,separately,evolve,velocity,space,moments,of,the,particle,distribution,function,(pdf),via,judicious,choices,for,the,parallel,velocity,coordinate,and,for,the,normalisation,of,the,evolved,pdf.,This,approach,presents,a,number,of,potential,advantages:,the,use,of,ﬂuid,equations,for,low-order,moments,of,f,could,be,useful,in,formulating,a,scheme,that,switches,between,ﬂuid,and,kinetic,treatments,where,appropriate,(and,possibly,also,between,small,and,large,amplitude,ﬂuctuations,of,f,);,separate,evolution,of,an,electron,momentum,equation,should,allow,for,an,explicit,equation,for,the,electrostatic,potential,,which,otherwise,must,be,solved,implicitly,or,via,an,iterative,solver;,conservation,properties,for,the,low-order,moments,may,be,easier,to,enforce;,and,use,of,a,velocity,coordinate,normalised,by,the,local,thermal,speed,should,be,more,eﬃcient,than,the,use,of,a,coordinate,normalised,by,some,global,speed.,To,our,knowledge,,this,‘moment,kinetic’,approach,has,not,been,attempted,before,,and,the,aim,of,this,report,is,to,identify,any,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,3,challenges,faced,by,this,approach,and,to,present,solutions,to,these,challenges,where,possible.,We,have,considered,four,variations,of,the,moment,kinetic,approach,corresponding,to,diﬀerent,combinations,of,the,particle,density,,parallel,ﬂow,and,parallel,pressure,being,evolved,separately,from,an,appropriately,normalised,pdf.,In,the,following,sub-sections,we,present,the,system,of,equations,used,for,each,of,these,moment,kinetic,models.,3.1.,Density,evolution,In,this,subsection,,we,describe,a,moment-kinetic,model,in,which,the,particle,density,is,evolved,separately,from,an,appropriately,normalised,particle,distribution,function.,To,separate,the,evolution,of,the,particle,density,from,that,of,the,particle,distribution,function,,we,deﬁne,the,normalised,distribution,function,The,zeroth,velocity,moment,of,gs,satisﬁes,.,=,gs,fs,ns,.,gs,=,1,,dv,(cid:107),(cid:90),(5),(6),and,the,kinetic,equations,for,gi,and,gn,,obtained,by,substituting,Eq.,5,into,Eqs.,(1),and,(2),,are,and,ni,∂gi,∂t,+,gi,∂ni,∂t,+,v,(cid:107),∂fi,∂z,−,eni,mi,∂φ,∂z,∂gi,∂v,(cid:107),=,Rinninn,(gi,−,−,gn),+,Rionninngn,,(7),nn,∂gn,∂t,+,gn,∂nn,∂t,+,v,(cid:107),∂fn,∂z,=,Rinninn,(gn,−,−,gi),−,Rionninngn,,(8),respectively.,Taking,the,v,(cid:107),moment,of,the,kinetic,equations,(1),and,(2),results,in,the,continuity,equation,that,describes,the,time,evolution,of,the,ion,and,neutral,densities:,∂ns,∂t,+,∂nsus,∂z,=,Rionninn,,±,(9),with,the,plus,and,minus,signs,corresponding,to,the,ion,and,neutral,density,evolution,equations,,respectively.,Substituting,Eq.,(9),into,Eqs.,(7),and,(8),eliminates,the,time,derivatives,of,the,density,,leaving,∂gi,∂t,+,v,(cid:107),ni,∂fi,∂z,−,e,mi,∂φ,∂z,∂gi,∂v,(cid:107),=,gi,ni,∂niui,∂z,+,(Rin,+,Rion),nn,(gn,−,gi),,,(10),and,∂gn,∂t,+,v,(cid:107),nn,∂fn,∂z,=,gn,nn,∂nnun,Rinni,(gn,−,gi),.,∂z,−,Eqs.,(9)-(11),,along,with,the,assumed,Boltzmann,response,given,by,Eq.,(4),and,the,relation,(5),between,f,and,g,,constitute,a,closed,system,of,equations,for,the,evolved,quantities,.,Boundary,conditions,must,be,speciﬁed,to,ensure,a,unique,solution,,and,this,will,be,discussed,in,Sec.,4.,gi,,gn,,ni,,nn},{,(11),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,4,3.2.,Density,and,parallel,ﬂow,evolution,In,this,subsection,,we,describe,a,moment-kinetic,model,in,which,both,the,particle,density,and,parallel,ﬂow,are,evolved,separately,from,an,appropriately,normalised,particle,distribution,function.,To,separate,the,evolution,of,both,the,particle,density,and,the,parallel,ﬂow,from,that,of,the,particle,distribution,function,,we,again,deﬁne,the,normalised,distribution,function,.,=,,,t),gs(z,,w,(cid:107),fs(z,,w,,,t),(cid:107),ns(z,,t),,,(12),which,is,now,a,function,of,the,peculiar,velocity,w,deﬁned,via,.,=,v,(cid:107),−,(cid:107),us,,with,the,parallel,ﬂow,nsus,.,=,dv,(cid:107),v,(cid:107),fs.,(cid:90),The,zeroth,and,ﬁrst,velocity,moments,of,gs,satisify,and,dw,(cid:107),gs,=,1,(cid:90),(cid:107),The,kinetic,equation,for,gs,,obtained,by,substituting,Eq.,(12),into,Eqs.,(1),and,(2),,is,(cid:90),w,dw,(cid:107),gs,=,0.,∂gs,∂t,+,gs,ns,∂ns,∂t,+,w,(cid:107),(cid:0),∂fs,∂z,+,us,ns,(cid:1),s,,s(cid:48),{,∂gs,∂w,+,˙w,,s,(cid:107),(cid:107),,,the,+,(,n,,i,},=,gs(cid:48)),Rionns(cid:48)gn,,Rss’ns(cid:48),(gs,−,−,),sign,corresponds,to,ions,(neutrals),,,,the,eﬀective,parallel,acceleration,for,species,(16),±,−,{,=,s,,s(cid:48),where,i,,n,},{,the,z,and,t,derivatives,are,taken,at,ﬁxed,w,s,is,or,=,},},{,(cid:107),˙w,,s,(cid:107),and,we,have,used,.,=,−,δs,i,(cid:18),e,mi,∂φ,∂z,+,∂us,∂t,+,+,us,w,(cid:107),∂us,∂z,,,(cid:19),(cid:0),(cid:1),=,∂,∂w,,,(cid:107),∂,∂v,(cid:107),+,∂w,(cid:107),∂t,+,∂w,(cid:107),∂z,=,∂,∂t,=,∂,∂z,∂,∂t,v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),w(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),w(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),∂,∂w,(cid:107),∂,∂w,(cid:107),=,∂,∂t,=,∂,∂z,−,w(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),−,w(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),∂us,∂t,∂,∂w,(cid:107),∂us,∂z,∂,∂w,.,(cid:107),and,∂,∂z,The,continuity,equation,(9),is,used,to,evolve,the,particle,density,,and,the,parallel,momentum,equation,–,obtained,by,multiplying,the,kinetic,equations,(1),and,(2),by,msv,–,is,now,needed,to,evolve,us:,and,integrating,over,all,v,(cid:107),,s,+,msnsu2,s,(cid:107),∂,p,=,(cid:107),∂,(msnsus),∂t,∂z,−,(cid:0),δs,iens,∂φ,∂z,−,(cid:1),+,msRss(cid:48)nsns(cid:48),(us(cid:48),us),−,±,msRionnsns(cid:48)un,,(21),(13),(14),(15),(17),(18),(19),(20),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,5,where,the,parallel,pressure,p,,s,is,deﬁned,as,(cid:107),.,=,p,,s,(cid:107),(cid:90),∞,msw2,(cid:107),fs.,(22),−∞,The,time,derivative,of,us,appearing,in,Eq.,(17),can,be,re-expressed,using,the,parallel,momentum,equation,(21),and,the,continuity,equation,(9):,∂us,∂t,=,us,ns,∂nsus,∂z,−,1,msns,∂,p,(cid:0),,s,+,msnsu2,s,(cid:107),∂z,(cid:1),+,(Rss(cid:48),+,δs,iRion),ns(cid:48),(us(cid:48),us),δs,i,−,−,e,ms,.,∂φ,∂z,(23),Substituting,the,above,expression,into,the,parallel,acceleration,equation,(17),yields,˙w,,s,=,(cid:107),1,msns,∂p,,s,(cid:107),∂z,−,(Rin,+,δs,iRion),ns(cid:48),(us(cid:48),us),−,−,∂us,∂z,.,w,(cid:107),(24),Finally,,we,eliminate,the,time,derivative,of,the,density,appearing,in,Eq.,(16),by,using,the,continuity,equation,(9),,giving,∂gs,∂t,+,w,(cid:107),(cid:0),+,us,ns,(cid:1),∂fs,∂z,+,˙w,(cid:107),,s,∂gs,∂w,(cid:107),=,gs,∂nsus,∂z,+,(Rin,+,δs,iRion),ns(cid:48),(gs(cid:48),gs),.,−,(25),Subject,to,the,speciﬁcation,of,boundary,conditions,in,Sec.,4,,Eqs.,(9),,(21),,(24),and,(25),,along,with,the,assumed,Boltzmann,response,given,by,Eq.,(4),and,the,relation,(12),between,f,and,g,,constitute,a,closed,system,of,equations,for,the,evolved,quantities,.,gi,,gn,,ni,,nn,,ui,,un},{,3.3.,Density,and,parallel,pressure,evolution,In,this,subsection,,we,describe,a,moment-kinetic,model,in,which,both,the,particle,density,and,parallel,pressure,are,evolved,separately,from,an,appropriately,normalised,particle,distribution,function.,To,separate,the,evolution,of,both,the,particle,density,and,the,parallel,pressure,from,that,of,the,particle,distribution,function,f,,,we,deﬁne,the,normalised,distribution,function,ˆgs(z,,ˆv,(cid:107),,,t),.,=,fs(z,,ˆv,(cid:107),,,t),vth,s(z,,t),ns(z,,t),,,where,the,normalised,parallel,velocity,is,the,thermal,speed,is,.,=,ˆv,(cid:107),v,(cid:107),vth,s,,,.,=,vth,s,2T,,s,(cid:107),ms,,,(cid:115),(26),(27),(28),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,6,the,parallel,pressure,and,temperature,are,p,,s,(cid:107),.,=,nsT,(cid:107),,s,=,dv,(cid:107),msw2,(cid:107),fs,(cid:90),=,2p,,s,(cid:107),(cid:90),dˆv,ˆv2,(cid:107),−,(cid:107),(cid:32),u2,s,v2,th,s,(cid:33),ˆgs,,the,peculiar,parallel,velocity,is,w,=,v,(cid:107),−,(cid:107),us,,and,the,parallel,ﬂow,is,1,ns,(cid:90),The,zeroth,,ﬁrst,and,second,velocity,moments,of,ˆgs,satisify,fs,=,vth,s,dv,(cid:107),dˆv,(cid:107),v,(cid:107),ˆv,(cid:107),ˆgs.,.,=,us,(cid:90),and,ˆgs,=,1,,dˆv,(cid:107),(cid:90),dˆv,(cid:107),ˆv,(cid:107),ˆgs,=,us,vth,s,(cid:90),dˆv,(cid:107),ˆv2,(cid:107),ˆgs,=,1,2,+,u2,s,v2,th,s,.,(cid:90),(29),(30),(31),(32),(33),The,kinetic,equation,for,ˆgs,,obtained,by,substituting,Eq.,(26),into,Eqs.,(1),and,(2),,is,∂ˆgs,∂t,+,ˆgs,=,−,(cid:18),Rss(cid:48)ns(cid:48),∂,ln,ns,∂t,−,∂,ln,vth,s,∂t,+,v2,th,s,ns,∂fs,∂z,ˆv,(cid:107),∂ˆgs,∂ˆv,(cid:107),(34),,s,+,˙ˆv,(cid:107),vth,s,vth,n,,,Rionˆgnns(cid:48),±,(cid:19),ˆgs(cid:48),vth,s,vth,s(cid:48),ˆgs,−,(cid:18),=,(cid:19),,,the,+,(,n,,i,},{,=,s,,s(cid:48),where,i,,n,},{,the,z,and,t,derivatives,are,taken,at,ﬁxed,ˆv,(cid:107),s,is,s,,s(cid:48),{,or,{,},},),sign,corresponds,to,ions,(neutrals),,,,the,eﬀective,parallel,acceleration,for,species,−,˙ˆv,(cid:107),,s,and,we,have,used,.,=,e,msvth,s,∂φ,∂z,+,ˆv,(cid:107),∂,ln,vth,s,∂t,+,vth,sˆv2,(cid:107),∂,ln,vth,s,∂z,,,(cid:19),−,δs,i,(cid:18),=,∂,∂t,v(cid:107),∂,∂t,(cid:12),(cid:12),(cid:12),(cid:12),∂,∂v,(cid:107),=,1,vth,s,,,∂,∂ˆv,(cid:107),+,∂ˆv,(cid:107),∂t,ˆv(cid:107),∂,∂ˆv,(cid:107),v(cid:107),=,∂,∂t,∂,ln,vth,s,∂t,ˆv,(cid:107),∂,∂ˆv,(cid:107),−,ˆv(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),and,=,∂,∂z,∂,∂z,∂,∂ˆv,(cid:107),The,continuity,equation,(9),is,used,to,evolve,the,particle,density,,and,the,parallel,energy,equation,–,obtained,by,multiplying,the,kinetic,equations,(1),and,(2),by,msw2,(cid:107),∂,ln,vth,s,∂z,∂,∂ˆv,(cid:107),∂,∂z,∂ˆv,(cid:107),∂z,(38),ˆv,(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),−,=,+,v(cid:107),v(cid:107),ˆv(cid:107),ˆv(cid:107),.,(35),(36),(37),(39),(40),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,7,and,integrating,over,all,w,(cid:107),–,is,now,needed,to,evolve,p,,s:,(cid:107),+,us,∂p,,s,(cid:107),∂z,∂p,,s,(cid:107),∂t,=,msnsvth,s,∂vth,s,∂t,∂us,∂z,−,where,we,have,deﬁned,the,parallel,heat,ﬂux,∂q,,s,∂z,−,(cid:18),3p,−,=,,s,(cid:107),(cid:107),+,us,Rss’,(cid:0),∂vth,s,∂z,+,T,(cid:107),,s,−,(cid:107),,s,(cid:18),nsp,(cid:19),ns(cid:48)p,,s(cid:48),(cid:107),±,(cid:1),∂ns,∂t,+,us,∂ns,∂z,(cid:19),Rionnep,,n,,(cid:107),.,=,q,,s,(cid:107),(cid:90),dv,(cid:107),msw3,(cid:107),fs,=,msnsv3,th,s,dˆv,(cid:107),ˆv,(cid:107),−,3,ˆgs.,us,vth,s,(cid:19),(cid:18),The,time,derivatives,of,vth,s,appearing,in,Eqs.,(34),and,(35),can,be,re-expressed,(cid:90),using,the,energy,equation,(39),and,the,continuity,equation,(9):,∂,ln,vth,s,∂t,=,Rss’,2,ns(cid:48),T,,s(cid:48),(cid:107),T,,s,−,(cid:107),(cid:18),1,(cid:19),−,1,vth,s,∂usvth,s,∂z,±,Rion,2,ns(cid:48),T,,n,(cid:107),T,,s,−,(cid:107),(cid:18),1,(cid:19),−,1,2p,,s,(cid:107),∂q,,s,(cid:107),∂z,.,(41),Substituting,this,expression,into,the,parallel,acceleration,expression,(35),gives,˙ˆv,,s,=,(cid:107),−,δs,i,(cid:18),e,msvth,s,∂φ,∂z,+,vth,sˆv2,(cid:107),+,ˆv,(cid:107),(Rss(cid:48),+,δs,iRion),1,ns(cid:48),2,∂,ln,vth,s,∂z,T,,s(cid:48),(cid:107),T,,s,(cid:19),(cid:107),−,(cid:19),+,1,vth,s,∂usvth,s,∂z,+,1,2p,,s,∂q,,s,(cid:107),∂z,(42),.,(cid:19),Finally,,we,substitute,Eqs.,(9),and,(41),into,the,kinetic,equation,(34),to,ﬁnd,(cid:18),(cid:18),(cid:107),∂ˆgs,∂t,+,v2,th,s,ns,∂fs,∂z,ˆv,(cid:107),+,˙ˆv,(cid:107),,s,∂ˆgs,∂ˆv,(cid:107),=,ˆgsus,∂,ln,ns,∂z,−,ˆgs,2p,,s,(cid:107),−,(cid:19),∂q,,s,(cid:107),∂z,(Rss(cid:48),+,δs,iRion),ns(cid:48),−,ˆgs,−,(cid:18),ˆgs(cid:48),+,ˆgs,(Rss(cid:48),+,δs,iRion),∂,ln,vth,s,∂z,ns(cid:48),2,(cid:18),(cid:18),vth,s,vth,s(cid:48),(cid:19),T,,s(cid:48),(cid:107),T,,s,−,(cid:107),(cid:18),.,1,(cid:19)(cid:19),(43),Subject,to,the,speciﬁcation,of,boundary,conditions,in,Sec.,4,,Eqs.,(9),,(35),,(39),and,(43),,along,with,the,assumed,Boltzmann,response,given,by,Eq.,(4),and,the,relation,(26),between,f,and,g,,constitute,a,closed,system,of,equations,for,the,evolved,quantities,.,,i,,p,ˆgi,,ˆgn,,ni,,nn,,p,,n},{,(cid:107),(cid:107),3.4.,Density,,parallel,ﬂow,and,parallel,pressure,evolution,In,this,subsection,,we,describe,a,moment-kinetic,model,in,which,the,particle,density,,parallel,ﬂow,and,parallel,pressure,are,all,evolved,separately,from,an,appropriately,normalised,particle,distribution,function.,To,separate,the,evolution,of,these,low-order,moments,from,that,of,the,particle,distribution,function,f,,,we,again,deﬁne,the,normalised,distribution,function,ˆgs(z,,ˆw,,,t),(cid:107),.,=,fs(z,,ˆw,,,t),(cid:107),vth,s(z,,t),ns(z,,t),,,(44),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,where,ˆgs,is,now,a,function,of,the,normalised,peculiar,velocity,.,=,us,v,(cid:107),−,vth,s,.,ˆw,(cid:107),With,these,deﬁnitions,,the,lowest,three,moments,of,ˆgs,satisfy,d,ˆw,(cid:107),1,,ˆw,(cid:107),,,ˆw2,(cid:107),(cid:0),(cid:1),(cid:90),ˆgs,=,1,,0,,(cid:18),1,2,.,(cid:19),The,kinetic,equation,for,ˆgs,,obtained,by,substituting,Eq.,(44),into,Eqs.,(1),and,(2),,is,identical,in,form,to,Eq.,(43):,∂ˆgs,∂t,+,vth,s,ns,vth,s,ˆw,(cid:107),+,us,∂fs,∂z,+,˙ˆw,(cid:107),(cid:0),(cid:1),(Rss(cid:48),+,δs,iRion),ns(cid:48),−,ˆgs(cid:48),ˆgs,−,(cid:18),,s,∂ˆgs,∂,ˆw,(cid:107),vth,s,vth,s(cid:48),=,ˆgsus,+,ˆgs,(cid:18),ns(cid:48),2,(cid:18),(cid:19),∂,ln,ns,∂z,−,∂,ln,vth,s,∂z,ˆgs,2p,∂q,,s,(cid:107),∂z,(Rss(cid:48),+,δs,iRion),,s,(cid:107),−,T,,s(cid:48),(cid:107),T,,s,−,(cid:107),(cid:19),(cid:18),,,1,(cid:19)(cid:19),(47),s,,s(cid:48),where,or,the,eﬀective,parallel,acceleration,for,species,s,is,n,,i,},{,s,,s(cid:48),{,i,,n,},=,=,},},{,{,,,the,z,and,t,derivatives,are,taken,at,ﬁxed,ˆw,,,(cid:107),˙ˆw,,s,=,(cid:107),ˆw2,(cid:107),−,+,ˆw,(cid:107),∂vth,s,∂z,1,2p,(cid:18),,s,(cid:107),+,1,vth,s,(cid:18),∂q,,s,(cid:107),∂z,1,msns,∂p,,s,(cid:107),∂z,−,Rss’ns(cid:48),(us(cid:48),+,(Rss’,+,δs,iRion),Rionns(cid:48),(un,−,us),(cid:19),(48),,,us),∓,−,T,,s(cid:48),(cid:107),T,,s,(cid:19)(cid:19),(cid:107),ns(cid:48),2,1,(cid:18),−,with,the,top,and,bottom,signs,in,Eq.,(48),corresponding,to,ions,and,neutrals,,respectively,,and,we,have,used,∂,∂v,(cid:107),1,vth,s,∂,∂,ˆw,,,(cid:107),=,∂,∂t,(cid:12),(cid:12),(cid:12),(cid:12),and,∂,∂z,∂,∂t,v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),=,v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),=,∂,∂t,ˆw(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),+,∂,ˆw,(cid:107),∂t,∂,∂,ˆw,(cid:107),=,v(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),1,vth,s,∂us,∂t,+,ˆw,∂,ln,vth,s,∂t,(cid:107),∂,∂,ˆw,(cid:107),(cid:19),−,ˆw(cid:107),(cid:18),(cid:12),(cid:12),(cid:12),(cid:12),∂,∂z,+,∂,ˆw,(cid:107),∂z,ˆw(cid:107),∂,∂,ˆw,(cid:107),v(cid:107),=,∂,∂z,1,vth,s,∂us,∂z,+,ˆw,∂,ln,vth,s,∂z,(cid:107),∂,∂,ˆw,.,(cid:107),(cid:19),−,ˆw(cid:107),(cid:18),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),Subject,to,the,speciﬁcation,of,boundary,conditions,in,Sec.,4,,Eqs.,(9),,(21),,(39),,(47),and,(48),,along,with,the,assumed,Boltzmann,response,given,by,Eq.,(4),and,the,relation,(44),between,f,and,g,,constitute,a,closed,system,of,equations,for,the,evolved,quantities,.,,i,,p,ˆgi,,ˆgn,,ni,,nn,,ui,,un,,p,,n},{,(cid:107),(cid:107),8,(45),(46),(49),(50),(51),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,9,4.,Boundary,conditions,→,,,t),(cid:107),→,±∞,To,ensure,that,the,solutions,to,the,model,equations,described,in,Secs.,2,and,3,are,unique,,we,must,specify,boundary,conditions,for,the,evolved,particle,distribution,function,in,z,and,in,the,parallel,velocity,coordinate.,The,physical,boundary,condition,in,v,is,that,(cid:107),0.,This,translates,with,little,diﬃculty,to,the,normalised,pdfs,gs,fs(z,,v,and,ˆgs,,regardless,of,the,choice,of,parallel,velocity,coordinate.,One,may,also,enforce,that,fs,is,periodic,in,v,domain,,which,will,be,equivalent,to,(cid:107),the,zero,boundary,condition,above,if,the,v,(cid:107),at,the,extremes,of,the,v,(cid:107),domain,is,suﬃciently,large.,As,for,the,boundary,condition,in,z,,there,are,(at,least),two,options,that,are,physically,interesting:,periodic,boundary,conditions,and,so-called,‘wall’,boundary,conditions.,The,former,are,applicable,for,plasma,streaming,along,magnetic,ﬁeld,lines,that,are,closed,,either,mapping,out,a,line,or,a,toroidal,surface.,Those,ﬁeld,lines,that,form,a,closed,line,are,physically,periodic,,while,those,ergodically,mapping,out,a,toroidal,surface,give,rise,to,dynamics,that,are,periodic,in,a,statistical,sense.,Wall,boundary,conditions,are,needed,when,considering,‘open’,ﬁeld,lines,that,terminate,at,the,vessel,wall.,Here,we,describe,the,wall,boundary,conditions,that,we,impose,on,our,model,equations.,Complicated,dynamics,occur,close,to,the,wall,,leading,to,a,hierarchy,of,narrow,layers,with,diﬀerent,dynamics.,Derivation,of,the,equations,that,describe,these,‘sheaths’,is,an,ongoing,research,activity,in,the,magnetic,conﬁnement,fusion,community.,We,avoid,such,complications,here,by,considering,a,plasma,domain,whose,boundaries,in,z,are,the,entrances,to,the,sheaths,furthest,from,the,wall.,Ions,that,exit,the,simulation,domain,are,assumed,to,continue,on,to,the,wall,,where,they,recombine.,As,a,result,,no,ions,enter,the,domain,from,the,walls,,giving,a,zero,incoming,BC,for,the,ions:,Fi(z,=,0,,v,(cid:107),>,0,,v,⊥,,,t),=,0,=,Fi(z,=,Lz,,v,(cid:107),<,0,,v,⊥,,,t),,(52),where,F,is,the,un-marginalised,particle,distribution,function,,and,the,boundaries,of,our,domain,(corresponding,to,the,sheath,entrances),are,taken,to,be,at,z,=,0,and,z,=,Lz.,Neutrals,that,leave,the,domain,are,assumed,to,hit,the,wall,and,thermalise,at,the,temperature,of,the,wall,,Tw.,Ions,that,recombine,at,the,wall,also,re-enter,as,neutrals.,The,resulting,boundary,condition,on,the,neutrals,is,Fn(z,=,0,,v,(cid:107),>,0,,v,⊥,,,t),=,Γ0FKw(v,(cid:107),,,v,⊥,),,Fn(z,=,Lz,,v,(cid:107),<,0,,v,⊥,,,t),=,ΓLz,FKw(v,(cid:107),where,mi,2Tw,(cid:19),is,the,Knudsen,cosine,distribution,,and,FKw(v,(cid:107),3,π,.,=,,,v,(cid:18),),⊥,2,v,(cid:107),+,v2,(cid:12),(cid:12),⊥,v2,(cid:12),(cid:12),(cid:107),(cid:113),exp,,−,,mi,+,v2,⊥,v2,(cid:107),2Tw,(cid:16),(cid:17),,,.,=,Γ0,0,2π,s=i,n,(cid:88),(cid:90),−∞,∞,dv,(cid:107),0,(cid:90),dv,⊥,v,⊥,v,(cid:107),Fs(z,=,0,,v,(cid:107),,,v,⊥,,,t),(cid:12),(cid:12),(cid:12),(cid:12),,,v,),,⊥,(53),(54),(55),10,(56),(57),(58),(59),(60),(61),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,and,.,=,ΓLz,∞,∞,dv,(cid:107),2π,0,(cid:90),0,(cid:90),s=i,n,(cid:88),dv,⊥,v,⊥,v,(cid:107),Fs(z,=,Lz,,v,(cid:107),,,v,⊥,,,t),(cid:12),(cid:12),(cid:12),(cid:12),are,the,combined,ﬂuxes,of,neutrals,and,ions,towards,the,walls,at,z,=,0,and,z,=,Lz,,respectively.,We,next,marginalise,the,above,distribution,functions,by,integrating,over,gyro-angle,and,v,⊥,to,get,fi(z,=,0,,v,(cid:107),>,0,,t),=,0,=,fi(z,=,Lz,,v,(cid:107),<,0,,t),and,with,fn(z,=,0,,v,(cid:107),>,0,,t),=,Γ0fKw(v,(cid:107),),,fn(z,=,Lz,,v,(cid:107),<,0,,t),=,ΓLz,fKw(v,(cid:107),),,fKw(v,(cid:107),),.,=,2π,∞,0,(cid:90),dv,⊥,v,⊥,FKw(v,(cid:107),,,v,⊥,),=,3√π,mi,2Tw,(cid:19),(cid:18),3/2,erfc,v,(cid:107),mi,2Tw,v,(cid:107),(cid:18)(cid:114),(cid:19),(cid:12),and,erfc,the,complementary,error,function.,The,ﬂuxes,toward,the,wall,at,the,domain,(cid:12),boundaries,can,be,recast,in,terms,of,the,marginalised,distribution,function:,(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),(cid:12),Γ0,=,0,s=i,n,(cid:90),(cid:88),−∞,dv,(cid:107),v,(cid:107),fs(z,=,0,,v,(cid:107),,,t),(cid:12),(cid:12),(cid:12),(cid:12),and,ΓLz,=,∞,dv,(cid:107),v,(cid:107),fs(z,=,Lz,,v,(cid:107),,,t).,0,s=i,n,(cid:90),(cid:88),(cid:12),(cid:12),It,is,worth,considering,the,constraint,imposed,by,these,boundary,conditions,on,.,Taking,the,z,average,of,the,(cid:12),(cid:12),the,evolution,of,the,line-averaged,species,densities,,continuity,equation,(9),,we,obtain,ns(cid:105),(cid:104),∂,ns(cid:105),(cid:104),∂t,=,1,Lz,(Γs(z,=,0),Γs(z,=,Lz)),Rion,(cid:104),ninn(cid:105),,,±,−,(62),=,(,A,(cid:104),with,respectively.,For,the,ions,(cid:82),(cid:105),dzA)/Lz,,and,the,+,and,-,signs,corresponding,to,ions,and,to,neutrals,,and,0,(cid:90),−∞,∞,Γi(0),=,Γi(Lz),=,dv,(cid:107),v,(cid:107),fi(z,=,0,,v,(cid:107),),<,0,,dv,(cid:107),v,(cid:107),fi(z,=,Lz,,v,(cid:107),),>,0,,0,(cid:90),where,we,have,used,the,boundary,conditions,on,fi,given,by,expression,(57).,For,the,neutrals,0,Γn(0),=,=,(cid:90),−∞,0,(cid:90),−∞,dv,(cid:107),v,(cid:107),fn(z,=,0,,v,(cid:107),dv,(cid:107),v,(cid:107),fn(z,=,0,,v,(cid:107),),+,Γ0,0,(cid:90),),+,Γ0,,∞,dv,(cid:107),v,(cid:107),fKw(v,(cid:107),),(63),(64),(65),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,11,and,∞,∞,Γn(Lz),=,=,0,(cid:90),0,(cid:90),dv,(cid:107),v,(cid:107),fn(z,=,Lz,,v,(cid:107),dv,(cid:107),v,(cid:107),fn(z,=,Lz,,v,(cid:107),),−,0,),+,ΓLz,−∞,(cid:90),ΓLz,,,dv,(cid:107),v,(cid:107),fKw(v,(cid:107),),(66),where,we,have,used,the,boundary,conditions,on,fn,given,by,expression,(58),and,the,fact,that,v,0,fKw,=,1.,fKw,=,Combining,the,results,for,the,ion,and,neutral,densities,and,noting,that,the,ionization,contributions,to,the,ion,and,neutral,densities,cancel,,we,obtain,a,constraint,on,the,evolution,of,the,total,(species-summed),,line-averaged,density:,(cid:82),v,(cid:107),0,dv,∞,(cid:107),(cid:82),−,−∞,dv,(cid:107),(cid:107),∂,∂t,s=i,n,(cid:88),=,ns(cid:105),(cid:104),1,Lz,s=i,n,(cid:88),(Γs(z,=,0),−,Γs(z,=,Lz)),=,1,Lz,(cid:32),=,0.,0,s=i,n,(cid:90),(cid:88),−∞,v,(cid:107),fs(z,=,0,,v,(cid:107),),+,Γ0,−,∞,v,(cid:107),fs(z,=,Lz,,v,(cid:107),),+,ΓLz,(cid:33),0,s=i,n,(cid:90),(cid:88),(67),This,is,a,consequence,of,the,assumed,wall,boundary,condition,,which,dictates,that,any,particles,leaving,the,domain,re-enter,as,neutrals,(and,thus,total,density,is,conserved).,It,can,be,used,to,test,the,numerical,implementation,of,the,wall,boundary,condition,,discussed,in,Sec.,6.,In,the,following,sub-sections,,we,re-cast,these,wall,boundary,conditions,in,terms,of,the,normalised,distribution,functions,and,modiﬁed,velocity,coordinates,described,in,Secs.,2,and,3.,4.1.,Analytical,solution,in,simpliﬁed,limit,We,can,derive,an,analytical,solution,for,the,electrostatic,potential,for,our,system,by,neglecting,charge,exchange,collisions,and,by,replacing,the,ionisation,source,term,appearing,in,Eq.,(1),with,a,simpliﬁed,source.,In,particular,,we,follow,the,approach,of,Ref.,[6],and,assume,that,ionisation,occurs,at,a,constant,rate,and,gives,birth,to,ions,with,zero,parallel,velocity.,The,resulting,ion,kinetic,equation,is,∂fi,∂t,+,v,(cid:107),∂fi,∂z,−,e,mi,∂φ,∂z,∂fi,∂v,(cid:107),=,RionN,2,e,δ(v,(cid:107),),,(68),with,δ(v,),the,Dirac,delta,distribution.,With,these,assumptions,,the,ion,kinetic,equation,(cid:107),decouples,from,the,kinetic,equation,for,the,neutrals,and,makes,the,problem,tractable.,Ions,that,are,formed,at,a,given,spatial,location,z0,are,accelerated,toward,the,walls,by,the,parallel,electric,ﬁeld,set,up,by,the,wall,boundary,condition.,The,parallel,speed,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,12,of,these,ions,after,travelling,to,a,location,z,that,is,closer,to,the,wall,,v,(cid:107),via,conservation,of,energy:,(z),,is,obtained,(z)2,miv,(cid:107),2,=,e,(φ(z0),φ(z)),.,−,(69),through,the,In,steady-state,,the,ﬂux,of,ions,with,speeds,in,the,range,v,(cid:107),location,z,must,equal,the,rate,at,which,these,ions,are,generated,between,z0,and,z0,+dz0:,+,dv,(cid:107),to,v,(cid:107),v,(cid:107),(z)fi(v,(cid:107),(z))dv,(cid:107),=,N,2,e,Riondz0.,Combining,Eqs.,(69),and,(70),and,imposing,quasineutrality,gives,Ne,exp,eφ(z),Te,(cid:19),(cid:18),=,(cid:90),dv,(cid:107),fi(z,,v,),=,(cid:107),Lz/2,(cid:90),z,(cid:114),φ(Lz/2),mi,2e,e,Rion,N,2,φ(z0),φ(z),dz0,−,N,2,e,Rion,φ(z0),−,dz0,dφ(z0),dφ(z0),,φ(z),=,φ(z),(cid:114),(cid:90),mi,(cid:112),2e,(70),(71),(cid:112),which,is,an,implicit,equation,for,φ(z).,Setting,our,gauge,so,that,φ(Lz/2),=,0,,and,eφ(z)/Te,,we,have,deﬁning,x,eφ(z0)/Te,and,y,.,=,.,=,−,−,Ne,exp,(,y),=,−,y,h(x),0,(cid:90),√y,x,−,dx,,where,h(x),.,=,N,2,e,Rion,cs,dz0,dx,.,(72),(73),The,density,integral,appearing,in,Eq.,(72),is,of,the,form,of,an,Abel,transform,[7],,which,can,be,inverted,to,yield,−,−,Equating,(73),and,(74),yields,an,expression,for,dz/dx:,0,(cid:90),h(x),=,dy,x,Ne,π,d,dx,exp,(,√x,y),y,.,dz,dx,=,cs,NeRionπ,d,dx,x,dy,exp,(,√x,−,−,y),y,.,0,(cid:90),Integrating,with,respect,to,x,yields,an,implicit,expression,for,φ(z):,Lz,2,z,−,=,±,=,±,cs,πRionNe,(cid:90),2cs,πRionNe,D,0,x,dy,y),y,exp,(,√x,−,−,eφ(z),,(cid:115)−,Te,,,,,,with,D(a),=,exp(,z,>,Lz/2,and,the,a2),sign,corresponds,to,z,<,Lz/2.,0,exp(b2)db,the,Dawson,function,,the,+,sign,corresponds,to,(cid:82),−,−,a,(74),(75),(76),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,13,4.2.,Density,evolution,We,consider,the,wall,boundary,conditions,in,terms,of,the,modiﬁed,distribution,function,gs,given,in,Eq.,(5).,The,boundary,conditions,on,the,ions,and,neutrals,are,gi(z,=,0,,v,(cid:107),>,0,,t),=,0,=,gi(z,=,Lz,,v,(cid:107),<,0,,t),and,gn(z,=,0,,v,(cid:107),>,0,,t),=,gn(z,=,Lz,,v,(cid:107),<,0,,t),=,Γ0,nn,ΓLz,nn,fKw(v,(cid:107),),,fKw(v,(cid:107),),,(77),(78),with,the,Knudsen,cosine,distribution,given,by,Eq.,(59),and,the,ﬂuxes,toward,the,wall,at,the,domain,boundaries,and,Γ0,=,ns,0,s=i,n,(cid:88),(cid:90),−∞,dv,(cid:107),v,(cid:107),gs(z,=,0,,v,(cid:107),,,t),(cid:12),(cid:12),(cid:12),(cid:12),ΓLz,=,∞,ns,0,(cid:90),s=i,n,(cid:88),dv,(cid:107),v,(cid:107),gs(z,=,Lz,,v,(cid:107),,,t).,(cid:12),(cid:12),(cid:12),(cid:12),(79),(80),4.3.,Density,and,parallel,ﬂow,evolution,We,consider,the,wall,boundary,conditions,in,terms,of,the,normalised,distribution,function,gs,given,in,Eq.,(12),and,the,peculiar,velocity,w,us.,The,boundary,conditions,on,the,ions,and,neutrals,are,=,v,(cid:107),−,(cid:107),gi(z,=,0,,w,(cid:107),>,ui,,t),=,0,=,gi(z,=,Lz,,w,(cid:107),−,<,ui,,t),−,and,gn(z,=,0,,w,(cid:107),>,−,un,,t),=,gn(z,=,Lz,,w,(cid:107),<,un,,t),=,−,Γ0,nn,ΓLz,nn,fKw(w,+,un),,(cid:107),fKw(w,(cid:107),+,un),,(81),(82),with,the,Knudsen,cosine,distribution,given,by,(59),and,the,ﬂuxes,toward,the,wall,at,the,domain,boundaries,Γ0,=,ns,us,−,s=i,n,(cid:88),(cid:90),−∞,dw,(cid:107),w,(cid:107),+,us,gs(z,=,0,,w,(cid:107),,,t),(cid:12),(cid:12),(cid:12),(cid:12),and,ΓLz,=,∞,ns,dw,(cid:107),w,(cid:107),+,us,gs(z,=,Lz,,w,(cid:107),,,t).,s=i,n,(cid:88),Note,that,the,region,in,w,(cid:12),(cid:12),over,which,the,boundary,conditions,are,imposed,depends,on,us,,which,evolves,in,time.,This,makes,imposition,of,wall,boundary,conditions,in,a,code,diﬃcult,,if,not,infeasible.,(cid:12),(cid:12),−,(cid:107),un,(cid:90),(83),(84),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,14,4.4.,Density,and,parallel,pressure,evolution,In,this,subsection,we,express,the,wall,boundary,conditions,in,terms,of,the,normalised,distribution,function,ˆgs,given,by,Eq.,(26),and,the,normalised,velocity,ˆv,/vth,s.,The,(cid:107),boundary,conditions,on,the,ions,and,neutrals,are,=,v,(cid:107),and,ˆgi(z,=,0,,ˆv,(cid:107),>,0,,t),=,0,=,ˆgi(z,=,Lz,,ˆv,(cid:107),<,0,,t),ˆgn(z,=,0,,ˆv,(cid:107),>,0,,t),=,ˆgn(z,=,Lz,,ˆv,(cid:107),<,0,,t),=,vth,n,nn,vth,n,nn,Γ0fKw(ˆv,(cid:107),vth,n),,ΓLz,fKw(ˆv,(cid:107),vth,n),,(85),(86),with,the,Knudsen,cosine,distribution,given,by,(59),and,the,ﬂuxes,toward,the,wall,at,the,domain,boundaries,and,Γ0,=,nsvth,s,s=i,n,(cid:88),0,(cid:90),−∞,dˆv,(cid:107),ˆv,(cid:107),ˆgs(z,=,0,,ˆv,(cid:107),,,t),(cid:12),(cid:12),(cid:12),(cid:12),ΓLz,=,nsvth,s,s=i,n,(cid:88),∞,0,(cid:90),dˆv,(cid:107),ˆv,(cid:107),ˆgs(z,=,Lz,,ˆv,(cid:107),,,t).,(cid:12),(cid:12),(cid:12),(cid:12),(87),(88),4.5.,Density,,parallel,ﬂow,and,parallel,pressure,evolution,In,this,subsection,we,express,the,wall,boundary,conditions,in,terms,of,the,normalised,distribution,function,ˆgs,given,by,Eq.,(44),and,the,normalised,velocity,ˆw,(cid:107),us)/vth,s.,The,boundary,conditions,on,the,ions,and,neutrals,are,=,(v,(cid:107),−,and,ˆgi(z,=,0,,ˆw,>,(cid:107),us/vth,s,,t),=,0,=,ˆgi(z,=,Lz,,ˆw,−,<,(cid:107),−,us/vth,s,,t),ˆgn(z,=,0,,ˆw,ˆgn(z,=,Lz,,ˆw,>,<,(cid:107),(cid:107),us/vth,s,,t),=,−,us/vth,s,,t),=,−,vth,n,nn,vth,n,nn,Γ0fKw(,ˆw,(cid:107),vth,n,+,un),,ΓLz,fKw(,ˆw,(cid:107),vth,n,+,un),,(89),(90),with,the,Knudsen,cosine,distribution,given,by,(59),and,the,ﬂuxes,toward,the,wall,at,the,domain,boundaries,Γ0,=,ns,us/vth,s,−,s=i,n,(cid:88),(cid:90),−∞,d,ˆw,(cid:107),ˆw,(cid:107),vth,s,+,us,ˆgs(z,=,0,,ˆw,,,t),(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),and,ΓLz,=,∞,ns,d,ˆw,(cid:107),ˆw,(cid:107),vth,s,+,us,ˆgs(z,=,Lz,,ˆw,,,t).,(cid:107),us/vth,s,s=i,n,(cid:88),(cid:90),Note,that,the,region,in,ˆw,−,(cid:12),(cid:12),over,which,the,boundary,conditions,are,imposed,depends,on,us,and,vth,s,,which,evolve,in,time.,This,makes,imposition,of,wall,boundary,conditions,in,a,code,diﬃcult,,if,not,infeasible.,(cid:12),(cid:12),(cid:107),(91),(92),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,15,(cid:107),normalised,variable,˜t,˜z,˜v,(cid:107),˜w,ˆv,(cid:107),˜ns,˜us,˜p,(cid:107),˜T,,s,(cid:107),˜vth,s,˜q,,s,(cid:107),˜φ,˜Rin,˜Rion,˜fs,,s,deﬁnition,t(cs/Lz),z/Lz,/cs,v,(cid:107),w,/cs,(cid:107),/vth,s,v,(cid:107),ns/Ne,us/cs,,s/(msNec2,s),(cid:107),,s/(msc2,s),T,(cid:107),vth,s/cs,,s/(msNec3,s),eφ/Te,Rin(NeLz/cs),Rion(NeLz/cs),fs(√πcs/Ne),p,q,(cid:107),Table,1.,Deﬁnitions,for,normalised,quantities,used,in,the,paper.,The,sound,speed,cs,=,2Te/mi,,and,Ne,and,Te,are,the,space-,and,time-independent,density,and,temperature,,respectively,,appearing,in,the,Boltzmann,response,(4).,(cid:112),5.,Normalisation,In,this,section,we,deﬁne,the,normalisations,used,when,solving,the,model,equations,from,Secs.,2,and,3,numerically.,A,set,of,normalisations,that,apply,regardless,of,the,choices,made,for,the,modiﬁed,distribution,function,and,the,parallel,velocity,coordinate,is,given,in,Table,1.,Model-speciﬁc,normalisations,and,the,normalised,equations,for,each,speciﬁc,moment,kinetic,model,are,provided,in,the,following,sub-sections.,Using,the,deﬁnitions,given,in,Table,1,in,the,standard,drift,kinetic,system,of,equations,(1)-(4),gives,∂,˜fi,∂˜t,∂,˜fi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,+,˜v,(cid:107),∂,˜fi,∂˜v,(cid:107),=,˜Rin,−,˜nn,˜fi,−,(cid:16),∂,˜fn,∂˜t,+,˜v,(cid:107),=,˜Rin,∂,˜fn,∂,˜z,−,e,˜φ,=,˜ni,=,˜ni,˜fn,+,˜Rion˜ni,˜fn,,(cid:17),˜Rion˜ni,˜fn,,−,(cid:17),˜fi,,˜ni,˜fn,−,˜nn,˜fi,(cid:16),1,√π,1,√π,(cid:90),∞,(cid:90),−∞,d˜v,(cid:107),∞,˜fn.,d˜v,(cid:107),and,˜nn,=,(93),(94),(95),(96),−∞,The,normalised,forms,for,the,wall,boundary,conditions,given,by,Eqs.,(57)-(61),are,˜fi,˜z,=,0,,˜v,(cid:107),>,0,,˜t,=,0,=,˜fi,˜z,=,1,,˜v,(cid:107),<,0,,˜t,(cid:0),(cid:1),(cid:0),(cid:1),(97),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,16,and,˜fn,˜z,=,0,,˜v,(cid:107),>,0,,˜t,=,˜Γ0(˜t),˜fKw(˜v,(cid:107),),,˜fn,˜z,=,1,,˜v,(cid:107),<,0,,˜t,=,˜ΓLz,(˜t),˜fKw(˜v,(cid:107),),,(98),where,(cid:0),and,(cid:1),˜fKw(˜v,(cid:107),),=,c2,sfKw(˜v,(cid:107),cs),=,(cid:0),3√π,˜T,3/2,w,˜Γ0(˜t),=,0,s=i,n,(cid:90),(cid:88),−∞,d˜v,(cid:107),˜v,(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),(cid:1),˜v,(cid:107),˜Tw,(cid:33),(cid:12),(cid:12),erfc,˜v,(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),˜fs(˜z,=,0,,˜v,(cid:32),(cid:12),(cid:12),(cid:112),,,˜t),,(cid:107),˜ΓLz,(˜t),=,0,s=i,n,(cid:90),(cid:88),∞,d˜v,(cid:107),˜v,(cid:107),˜fs(˜z,=,1,,˜v,(cid:107),,,˜t),,(cid:12),(cid:12),(cid:12),(cid:12),with,˜Tw,.,=,Tw/Te.,5.1.,Density,evolution,We,deﬁne,the,normalised,distribution,function,.,=,gscs√π.,˜gs,,,(99),(100),(101),(102),In,terms,of,this,normalised,distribution,function,and,the,normalised,quantities,deﬁned,in,Table,1,,Eqs.,(9)-(11),become,∂,˜ns,∂˜t,+,∂,˜ns,˜us,∂,˜z,=,˜Rion˜ni˜nn,±,and,∂˜gi,∂˜t,+,˜v,(cid:107),˜ni,∂,˜fi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,∂˜gi,∂˜v,(cid:107),=,˜gi,˜ni,∂,˜ni,˜ui,∂,˜z,+,˜Rin,+,˜Rion,(cid:16),(cid:17),˜nn,(˜gn,−,˜gi),,,∂˜gn,∂˜t,+,˜v,(cid:107),˜nn,∂,˜fn,∂,˜z,=,˜gn,˜nn,∂,˜nn,˜un,∂,˜z,−,˜Rin˜ni,(˜gn,−,˜gi),.,The,normalised,forms,for,the,wall,boundary,conditions,(77)-(80),are,˜gi(˜z,=,0,,˜v,(cid:107),>,0,,˜t),=,0,=,˜gi(˜z,=,1,,˜v,(cid:107),<,0,,˜t),,˜gn(˜z,=,0,,˜v,(cid:107),>,0,,˜t),=,˜gn(˜z,=,1,,˜v,(cid:107),<,0,,˜t),=,˜Γ0,˜nn,˜ΓLz,˜nn,˜fKw(˜v,),,(cid:107),˜fKw(˜v,(cid:107),),,(103),(104),(105),(106),(107),with,the,normalised,Knudsen,cosine,distribution,given,by,Eq.,(99),and,the,normalised,ﬂuxes,toward,the,walls,and,˜Γ0,=,˜ns,0,s=i,n,(cid:88),(cid:90),−∞,˜ΓLz,=,∞,˜ns,0,(cid:90),s=i,n,(cid:88),d˜v,(cid:107),˜v,(cid:107),˜gs(˜z,=,0,,˜v,(cid:107),,,˜t),(cid:12),(cid:12),(cid:12),(cid:12),d˜v,(cid:107),˜v,(cid:107),˜gs(˜z,=,1,,˜v,(cid:107),,,˜t).,(cid:12),(cid:12),(cid:12),(cid:12),(108),(109),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,17,5.2.,Density,and,parallel,ﬂow,evolution,We,use,the,normalised,distribution,function,(102),and,deﬁne,.,=,w,(cid:107),cs,.,˜w,(cid:107),(110),Using,these,normalised,quantities,and,the,deﬁnitions,given,in,Table,1,,Eqs.,(9),,(21),,(24),and,(25),become,∂,˜ns,∂˜t,+,∂,(˜ns,˜us),∂˜t,=,−,∂,and,,s,+,˜ns,˜u2,˜p,s,(cid:107),∂,˜z,(cid:0),δs,i,−,(cid:1),∂,˜ns,˜us,∂,˜z,∂,˜φ,∂,˜z,˜ns,2,=,˜Rion˜ni˜nn,±,(111),+,˜Rin˜ns˜ns(cid:48),(˜us(cid:48),˜us),−,±,˜Rion˜ns˜ns(cid:48),˜un,(112),∂˜gs,∂˜t,+,˜w,(cid:107),+,˜us,˜ns,(cid:0),(cid:1),∂,˜fs,∂,˜z,+,˜˙w,,s,(cid:107),∂˜gs,∂,˜w,(cid:107),=,˜gs,∂,˜ns,˜us,∂,˜z,+,˜Rin,+,δs,i,˜Rion,˜ns(cid:48),(˜gs(cid:48),(cid:16),(cid:17),˜gs),,,(113),−,where,the,top,(bottom),sign,in,Eq.,(112),corresponds,to,ions,(neutrals),,and,˜˙w,,s,(cid:107),.,=,˙w,Lz,c2,s,,s,(cid:107),=,1,˜ns,∂,˜p,,s,(cid:107),∂,˜z,−,˜Rin,+,δs,i,˜Rion,˜ns(cid:48),(˜us(cid:48),(cid:16),(cid:17),˜us),−,−,∂,˜us,∂,˜z,.,˜w,(cid:107),The,normalised,forms,for,the,wall,boundary,conditions,(81)-(84),are,˜gi(˜z,=,0,,˜w,>,(cid:107),˜ui,,˜t),=,0,=,˜gi(˜z,=,1,,˜w,−,<,(cid:107),˜ui,,˜t),,−,and,˜gn(˜z,=,0,,˜w,˜gn(˜z,=,1,,˜w,>,<,(cid:107),(cid:107),˜un,,˜t),=,−,˜un,,˜t),=,−,˜Γ0,˜nn,˜ΓLz,˜nn,˜fKw(,˜w,+,˜un),,(cid:107),˜fKw(,˜w,(cid:107),+,˜un),,(114),(115),(116),with,the,normalised,Knudsen,cosine,distribution,˜fKw,given,by,Eq.,(99),and,the,normalised,ﬂuxes,toward,the,walls,and,˜Γ0,=,˜ns,˜us,−,s=i,n,(cid:88),(cid:90),−∞,˜ΓLz,=,∞,˜ns,s=i,n,(cid:88),˜us,(cid:90),−,d,˜w,(cid:107),˜w,(cid:107),+,˜us,˜gs(˜z,=,0,,˜w,,,˜t),(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),d,˜w,(cid:107),˜w,(cid:107),+,˜us,˜gs(˜z,=,1,,˜w,,,˜t).,(cid:107),(cid:12),(cid:12),(cid:12),(cid:12),(117),(118),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,18,5.3.,Density,and,parallel,pressure,evolution,We,use,the,already-normalised,distribution,function,ˆgs,deﬁned,in,Eq.,(26).,In,terms,of,this,normalised,distribution,function,and,the,normalised,quantities,deﬁned,in,Table,1,,Eqs.,(9),,(39),,(42),and,(43),become,∂,˜ns,∂˜t,+,∂,˜ns,˜us,∂,˜z,=,˜Rion˜ni˜nn,,±,∂,˜p,,s,(cid:107),∂˜t,+,˜us,∂ˆgs,∂˜t,+,˜v2,th,s,˜ns,ˆv,(cid:107),∂,˜p,,s,(cid:107),∂,˜z,∂,˜fs,∂,˜z,=,−,+,˜˙ˆv,,s,(cid:107),∂,˜q,,s,(cid:107),∂,˜z,−,∂ˆgs,∂ˆv,(cid:107),=,ˆgs,˜us,3˜p,(cid:107),,s,˜Rss’,∂,˜us,∂,˜z,−,∂,ln,˜ns,∂,˜z,−,(cid:18),˜Rss’,+,δs,i,˜Rion,˜ns(cid:48),(cid:17),(cid:18),−,(cid:16),ˆgs,−,ˆgs(cid:48),˜vth,s,˜vth,s(cid:48),+,ˆgs,˜ns(cid:48),2,(cid:32),(cid:19),(cid:16),˜ns(cid:48),˜p,,s,−,(cid:107),˜ns,˜p,,s(cid:48),(cid:107),(cid:0),∂,ln,˜vth,s,∂,˜z,(cid:1),ˆgs,2˜p,(cid:107),,s,−,(cid:19),˜Rss’,+,δs,i,(119),,n,,(120),˜Rion˜ni,˜p,(cid:107),±,∂,˜q,,s,(cid:107),∂,˜z,˜Rion,˜T,,s(cid:48),(cid:107),˜T,,s,−,(cid:107),(cid:32),(cid:17),,,1,(cid:33)(cid:33),(121),and,˜˙ˆv,,s,=,(cid:107),−,(cid:32),δs,i,2˜vth,s,∂,˜φ,∂,˜z,+,˜vth,sˆv2,(cid:107),˜ns(cid:48),2,+,ˆv,(cid:107),(cid:32),˜Rss’,+,δs,i,˜Rion,∂,ln,˜vth,s,∂,˜z,(cid:33),˜T,(cid:107),˜T,,s,(cid:33),(cid:107),1,(cid:32),−,,s(cid:48),(cid:17),The,normalised,forms,for,the,wall,boundary,conditions,(85)-(88),are,(cid:16),+,1,˜vth,s,∂,˜us˜vth,s,∂,˜z,+,1,2˜p,(cid:107),,s,and,ˆgi(˜z,=,0,,ˆv,(cid:107),>,0,,˜t),=,0,=,ˆgi(˜z,=,1,,ˆv,(cid:107),<,0,,˜t),,ˆgn(˜z,=,0,,ˆv,(cid:107),>,0,,˜t),=,ˆgn(˜z,=,1,,ˆv,(cid:107),<,0,,˜t),=,˜vth,n,˜nn,˜vth,n,˜nn,˜Γ0,˜fKw(ˆv,(cid:107),˜vth,n),,˜ΓLz,˜fKw(ˆv,(cid:107),˜vth,n),,,s,∂,˜q,(cid:107),∂,˜z,(cid:33),.,(122),(123),(124),with,the,normalised,Knudsen,cosine,distribution,˜fKw,given,by,Eq.,(99),and,the,normalised,ﬂuxes,toward,the,walls,and,˜Γ0,=,˜ns˜vth,s,s=i,n,(cid:88),0,(cid:90),−∞,dˆv,(cid:107),˜vth,s,ˆv,(cid:107),ˆgs(˜z,=,0,,ˆv,(cid:107),,,˜t),(cid:12),(cid:12),(cid:12),(cid:12),˜ΓLz,=,˜ns˜vth,s,s=i,n,(cid:88),0,(cid:90),∞,dˆv,(cid:107),˜vth,s,ˆv,(cid:107),ˆgs(˜z,=,1,,ˆv,(cid:107),˜t).,(cid:12),(cid:12),(cid:12),(cid:12),(125),(126),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,19,5.4.,Density,,parallel,ﬂow,and,parallel,pressure,evolution,We,use,the,normalised,distribution,function,(44),and,the,normalised,peculiar,velocity,ˆw,/vth,s.,In,terms,of,these,normalised,quantities,and,those,deﬁned,in,Table,1,,Eqs.,(9),,(21),,(39),,(47),and,(48),become,Eqs.,(103),,(112),,(120),,=,w,(cid:107),(cid:107),∂ˆgs,∂˜t,+,˜vth,s,˜ns,˜vth,s,ˆw,(cid:107),+,˜us,(cid:0),˜Rss’,+,δs,iRion,(cid:1),˜ns(cid:48),(cid:17),−,(cid:16),∂,˜fs,∂,˜z,+,˜˙ˆw,(cid:107),,s,∂ˆgs,∂,ˆw,(cid:107),=,ˆgs,˜us,(cid:18),∂,ln,˜ns,∂,˜z,−,∂,ln,˜vth,s,∂,˜z,(cid:19),˜vth,s,˜vth,s(cid:48),ˆgs,−,(cid:18),ˆgs(cid:48),+,ˆgs,(cid:19),˜ns(cid:48),2,(cid:32),(cid:16),˜Rss’,+,δs,i,˜Rion,(cid:17),,s,ˆgs,2˜p,−,(cid:107),˜T,,s(cid:48),(cid:107),˜T,,s,−,(cid:107),(cid:32),∂,˜q,,s,(cid:107),∂,˜z,,,1,(cid:33)(cid:33),(127),and,˜˙ˆw,(cid:107),,s,=,+,+,∂˜vth,s,∂,˜z,∂,˜q,,s,(cid:107),∂z,w2,(cid:107),−,w,(cid:107),2˜p,,s,(cid:18),(cid:107),∂,˜p,,s,(cid:107),∂,˜z,−,1,˜vth,s,(cid:18),+,1,˜ns,˜Rss’,+,δsiRion,(cid:16),˜Rss’,+,δsi,(cid:16),˜ns(cid:48),˜p,(cid:107),,s,−,˜Rion,˜ns(cid:48),(˜us(cid:48),(cid:17),˜ns,˜p,,s(cid:48),(cid:107),,,(cid:19),(cid:1),(cid:17),(cid:0),˜us),−,(cid:19),(128),The,normalised,forms,for,the,wall,boundary,conditions,(89)-(92),are,ˆgi(˜z,=,0,,ˆw,(cid:107),>,−,˜us/˜vth,s,,˜t),=,0,=,ˆgi(˜z,=,1,,ˆw,<,(cid:107),−,˜us/˜vth,s,,˜t),(129),and,ˆgn(˜z,=,0,,ˆw,ˆgn(˜z,=,1,,ˆw,>,<,(cid:107),(cid:107),˜us/˜vth,s,,t),=,−,˜us/˜vth,s,,t),=,−,˜vth,n,˜nn,˜vth,n,˜nn,˜Γ0(˜t),˜fKw(,ˆw,˜vth,n,+,˜un),,(cid:107),˜ΓLz,(˜t),˜fKw(,ˆw,˜vth,n,+,˜un),,(cid:107),(130),with,the,normalised,Knudsen,cosine,distribution,˜fKw,given,by,Eq.,(99),and,the,normalised,ﬂuxes,toward,the,walls,˜Γ0(˜t),=,Γ0,Necs,=,˜us/˜vth,s,−,˜ns,s=i,n,(cid:88),(cid:90),−∞,d,ˆw,(cid:107),ˆw,(cid:107),˜vth,s,+,˜us,ˆgs(˜z,=,0,,ˆw,,,˜t),,(cid:107),(131),(cid:12),(cid:12),(cid:12),(cid:12),and,˜ΓLz,(˜t),=,ΓLz,Necs,=,s=i,n,(cid:88),∞,˜ns,˜us/˜vth,s,(cid:90),−,d,ˆw,(cid:107),ˆw,(cid:107),˜vth,s,+,˜us,ˆgs(˜z,=,1,,ˆw,,,˜t).,(cid:107),(132),(cid:12),(cid:12),(cid:12),(cid:12),6.,Numerical,implementation,The,algorithms,described,in,this,Section,have,been,implemented,in,the,code,,written,in,the,Julia,programming,language,,currently,available,on,GitHub,at,https://github.,com/mabarnes/moment_kinetics.,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,20,6.1.,Time,advance,We,evolve,the,normalised,systems,of,equations,described,in,Sec.,5,using,a,time-marching,scheme,(as,opposed,to,an,eigensolver),due,to,its,eﬃciency,and,due,to,the,nonlinear,nature,of,the,system,of,partial,diﬀerential,equations,under,consideration.,In,particular,,we,employ,a,member,of,the,family,of,Strong,Stability,Preserving,(SSP),Runge-Kutta,(RK),schemes;,see,,e.g.,,[8,,9,,10].,Current,SSPRK,options,implemented,in,the,code,are,SSPRK1,(forward,Euler),,SSPRK2,(Heun’s,method),SSPRK3,(Shu-Osher,method),and,four-stage,SSPRK3.,The,user,can,also,specify,the,use,of,‘ﬂip-ﬂop’,Lie,operator,splitting.,Operator,splitting,limits,the,time,advance,scheme,to,second,order,accuracy,in,step,size,,but,could,be,useful,for,separately,treating,diﬀerent,pieces,of,physics.,Here,we,describe,the,current,default,option,,which,is,the,four-stage,SSPRK3,method,without,operator,splitting.,For,convenience,of,notation,,we,express,the,normalised,drift,kinetic,and,moment,kinetic,equations,for,the,ions,and,neutrals,in,the,vector,form,∂f,∂t,=,G[f,],,(133),containing,the,evolved,quantities;,solution,vector,with,f,the,f,=,,n)T,if,all,of,the,low-order,moments,are,evolved,separately,,i,,˜p,(ˆgi,,ˆgn,,˜ni,,˜nn,,˜ui,,˜un,,˜p,(cid:107),(cid:107),from,the,pdf.,The,operator,G,accounts,for,all,eﬀects,that,lead,to,the,evolution,of,f,,,e.g.,,parallel,streaming,,parallel,acceleration,,charge,exchange,and,ionisation,collisions,,as,well,as,all,terms,in,the,continuity,,force,balance,and,energy,equations,if,they,are,sep-,arately,evolved.,The,four-stage,SSPRK3,method,for,advancing,this,system,of,equations,is,3rd,order,accurate,in,time,step,size,∆t,,with,a,Courant,number,of,two.,It,is,given,by,e.g.,,f,(1),=,f,(2),=,f,(3),=,f,n+1,=,1,2,1,2,2,3,1,2,f,n,+,1,2,1,f,(1),+,2,1,(cid:0),f,(2),+,6,1,f,(3),+,2,f,n,+,(f,n,+,∆tG,[f,n]),,,f,(1),+,∆tG,f,(1),,,(cid:2),(cid:3)(cid:1),f,(2),+,∆tG,1,6,(cid:0),f,(3),+,∆tG,f,(3),(cid:2),,,(cid:3)(cid:1),f,(2),,,(134),where,the,superscript,n,denotes,the,time,level.,(cid:0),(cid:2),(cid:3)(cid:1),We,have,tested,our,implementation,of,SSP,RK2,and,4-stage,SSP,RK3,by,calculating,the,rms,error,in,the,distribution,function,after,it,is,advected,in,one,dimension,with,constant,advection,speed,for,ten,transits,of,the,˜z,domain:,.,=,(cid:15)rms,1,Nz,Nz,j=1,(cid:88),(cid:118),(cid:117),(cid:117),(cid:116),fi(zj,,t,=,10),|,−,2.,fi(zj,,t,=,0),|,(135),Example,data,are,given,for,a,case,in,which,the,standard,drift,kinetic,equations,from,Sec.,5,are,solved,with,˜v,=,1.,The,results,when,paired,with,a,ﬁnite,diﬀerence,discretisation,(third,order,upwind),are,given,in,Fig.,1.,For,Chebyshev,pseudospectral,discretisation,on,a,single,element,with,4-stage,SSPRK3,,see,Fig.,2.,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,21,Figure,1.,RMS,error,as,a,function,of,time,step,size,∆t,and,varying,values,for,Nz,for,both,SSP,RK2,(solid,lines,and,circles),and,for,4-stage,SSP,RK3,(dashed,lines,and,squares),with,a,third,order,,upwinded,ﬁnite,diﬀerence,discretisation.,Due,to,the,CFL,restriction,that,ties,temporal,resolution,to,spatial,resolution,,the,range,in,∆t,over,which,time,domain,errors,dominate,is,limited,for,RK2,and,is,eﬀectively,non-existent,for,RK3.,6.2.,Spatial,discretisation,There,are,two,discretisation,schemes,implemented,in,the,code:,ﬁnite,diﬀerences,and,Chebyshev,(pseudo)spectral,elements.,The,user,can,choose,at,run-time,which,scheme,to,use,for,each,of,the,z,and,v,(cid:107),coordinates.,6.2.1.,Finite,diﬀerence,discretisation.,For,the,ﬁnite,diﬀerence,discretisation,,the,corresponding,coordinate,grid,is,uniform,on,the,domain,[,L/2,,L/2],,with,L,the,coordinate,box,length.,The,default,method,employed,for,derivatives,is,3rd,order,upwind,diﬀerences,,though,1st,and,2nd,order,schemes,are,also,available,as,options.,For,an,overview,of,upwind,diﬀerences,and,a,discussion,of,the,merits,of,the,diﬀerent,upwind,schemes,,see,,e.g.,[11].,The,associated,integration,weights,used,for,ﬁeld-line,averages,integration,required,for,obtaining,ﬁelds/moments,are,obtained,in,z,and/or,for,the,v,(cid:107),using,the,composite,Simpson’s,rule,(sometimes,referred,to,as,composite,Simpson’s,1/3,−,1×10−91×10−81×10−71×10−61×10−50.00010.0010.010.000100.001000.01000(cid:15)rms∆t50100200400800∝∆t2,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,22,Figure,2.,RMS,error,as,a,function,of,time,step,size,∆t,for,4-stage,SSP,RK3,with,a,Chebyshev,pseudospectral,discretisation.,rule):,L,0,(cid:90),dx,f,(x),h,3,≈,(N,−,1)/2,j=1,(cid:88),(f,(x2j,1),+,4f,(x2j),+,f,(x2j+1)),,,−,(136),where,N,is,the,number,of,grid,points,in,the,coordinate,x,,and,h,=,L/(N,1),is,the,uniform,grid,spacing.,The,composite,rule,(136),is,only,applicable,for,N,odd,,so,it,is,supplemented,at,the,boundary,by,Simpson’s,3/8,rule,when,N,is,even.,−,6.2.2.,Chebyshev,spectral,elements.,When,using,Chebyshev,spectral,elements,,the,corresponding,coordinate,grid,is,the,Gauss-Chebyshev-Lobatto,grid,on,each,element.,For,a,description,of,Chebyshev-Gauss,quadrature,,Inclusion,of,the,endpoints,within,each,element,facilitates,enforcement,of,continuity,at,element,boundaries,,and,the,use,of,Chebyshev,polynomials,as,a,basis,enables,the,use,of,Fast,Fourier,Transforms.,In,our,code,,these,transforms,are,done,using,the,widely-used,FFTW,library,[13].,The,associated,integration,weights,used,for,ﬁeld-line,averages,in,z,integration,required,for,obtaining,ﬁelds/moments,are,obtained,using,and/or,for,the,v,(cid:107),Clenshaw-Curtis,quadrature,rules,[14].,Clenshaw-Curtis,quadrature,is,convenient,,as,it,allows,for,the,use,of,endpoints,in,the,integration,domain,(which,is,dictated,by,the,use,see,,e.g.,[12].,1×10−91×10−81×10−71×10−61×10−50.00010.0010.01(cid:15)rms∆tspectral∝∆t3,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,23,−,of,a,Gauss-Chebyshev-Lobatto,grid),while,still,exactly,integrating,polynomials,up,to,degree,N,1,,with,N,the,number,of,points,within,the,element.,A,1D,advection,test,demonstrating,the,spectral,accuracy,of,the,Chebyshev,scheme,on,a,single,element,is,given,in,Fig.,3,,where,the,rms,error,is,given,by,Eq.,(135).,The,maximum,stable,time,step,subject,to,the,CFL,restriction,is,plotted,as,a,function,of,the,number,of,z,grid,points,on,a,single,element,in,Fig.,4,and,as,a,function,of,the,number,of,elements,Nelem,with,Nz,=,9,ﬁxed,in,Fig.,5.,Slight,deviations,from,the,expected,scalings,are,likely,due,to,the,numerical,dissipation,that,is,introduced,by,the,use,of,the,derivative,from,the,upwind,element,at,the,overlapping,point,at,element,boundaries,and,at,the,boundary,of,the,periodic,domain.,Figure,3.,RMS,error,as,a,function,of,the,number,of,grid,points,Nz.,The,time,advance,scheme,used,is,4-stage,SSP,RK3.,6.3.,Conservation,properties,Each,of,the,system,of,equations,detailed,in,Secs.,3,and,5,have,associated,quantities,that,should,be,conserved:,In,the,absence,of,ionisation,collisions,,particle,number,should,be,conserved,,and,certain,moments,of,the,evolved,pdf,should,evaluate,to,constants;,e.g.,,if,the,density,,parallel,ﬂow,and,parallel,pressure,are,evolved,separately,from,the,normalised,pdf,ˆgs,given,by,Eq.,(26),(as,detailed,in,Sec.,3.4),,then,the,system,has,the,1×10−101×10−81×10−60.00010.0116810121416(cid:15)rmsNzdata12(4Nz)Nz,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,24,Figure,4.,Maximum,stable,time,step,subject,to,the,CFL,restriction,as,a,function,of,the,number,of,Gauss-Chebyshev-Lobatto,grid,points.,The,max,stable,time,step,scales,a,bit,more,weakly,than,1/N,2,z,,,as,expected.,conserved,quantities,(cid:107),conservation,properties,are,preserved,by,the,numerical,scheme.,(1,,ˆw,d,ˆw,,,ˆw2,(cid:107),)ˆgs,=,(1,,0,,1/2).,We,would,like,to,ensure,that,such,(cid:107),The,currently-favoured,approach,in,the,code,for,satisfying,exactly,the,desired,conservation,properties,is,to,correct,the,numerical,solutions,for,˜ns,(if,it,is,appropriate,for,particle,number,to,be,conserved),and,for,˜gs,or,ˆgs,at,the,end,of,each,time,step.,For,the,particle,density,,one,can,set,(cid:82),d˜z,ˆnm+1,s,d˜z,˜nm,,,˜nm+1,s,=,ˆnm+1,s,+,˜nm,s,1,(cid:18),where,ˆnm+1,is,the,updated,solution,(at,time,level,m,+,1),to,the,continuity,equation,˜nm,before,applying,any,conserving,correction.,This,guarantees,that,s,),=,0.,The,additional,error,in,the,density,introduced,by,this,correction,is,(cid:82),˜nm+1,exact,+,(cid:15)m,d˜z,˜nm,d˜z,ˆnm+1,d˜z,˜nm,−,(cid:82),(cid:82),d˜z,(˜nm+1,s,−,=,˜nm,(137),s,(cid:19),˜nm,d˜z,1,1,(cid:33),(cid:1),(138),(cid:18),−,(cid:82),(cid:82),(cid:32),−,(cid:82),d˜z,(cid:15)m,d˜z,˜nm,(cid:0),(cid:82),O,=,((cid:15)m),,(cid:19),=,˜nm,(cid:82),(cid:82),0.0010.010.1110∆tCFLNzdata10N−9/5z,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,25,Figure,5.,Maximum,stable,time,step,subject,to,the,CFL,restriction,as,a,function,of,the,number,of,elements,with,the,number,of,grid,points,per,element,ﬁxed,at,9.,The,minimum,grid,spacing,scales,inversely,with,the,number,of,elements,,leading,to,a,max,stable,time,step,that,is,inversely,proportional,to,the,number,of,elements,Nelem.,where,(cid:15)m,is,the,error,in,˜nm+1,due,to,numerical,discretisation,,˜nm+1,exact,is,the,solution,for,ˆnm+1,in,the,limit,(cid:15)m,=,0,,and,species,subscripts,have,been,suppressed,for,convenience,of,notation.,(cid:107),(cid:107),d,ˆw,ˆg,=,0,and,A,similar,technique,can,be,applied,to,conserve,quantities,such,as,ˆw,ˆg,=,1,,ˆg,=,1/2.,As,this,case,,where,the,density,,parallel,ﬂow,and,parallel,pressure,are,all,evolved,separately,,encapsulates,all,of,the,issues,one,might,(cid:82),encounter,when,enforcing,exact,conservation,,we,present,our,conserving,treatment,for,it,here.,For,such,a,case,,we,set,ˆw2,(cid:107),d,ˆw,d,ˆw,(cid:82),(cid:82),(cid:107),(cid:107),ˆgm+1,=,gm+1,+,ˆgm,1,(cid:18),−,(cid:90),gm+1,d,ˆw,(cid:107),d,ˆw,ˆw2,1/2,∂,ˆw,ˆgm,(cid:107),∂,ˆw,−,d,ˆw,(cid:82),(cid:107),(cid:107),(cid:107),−,ˆw,∂,(cid:107),(cid:16),ˆw2,(cid:107),ˆgm,(cid:17),/∂,ˆw,(cid:107),(cid:107),−,(cid:19),gm+1,∂ˆgm,∂,ˆw,(cid:107),d,ˆw,(cid:107),ˆw,(cid:107),d,ˆw,(cid:82),(cid:107),gm+1,ˆw,(cid:107),∂ˆgm/∂,ˆw,(cid:107),(cid:82),,,(cid:0),(cid:1),(139),where,gm+1,is,the,updated,solution,to,the,drift,kinetic,equation,before,applying,any,(δm),,conserving,correction.,The,additional,error,in,ˆg,associated,with,this,correction,is,(cid:82),(cid:0),(cid:0),(cid:1),(cid:1),O,0.010.1110∆tCFLNelemdata1/(5Ne),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,26,where,δm,is,the,error,in,ˆgm+1,associated,with,discretisation.,The,correction,ensures,that,ˆgm+1,=,1/2,,provided,the,corresponding,ˆgm+1,=,0,and,ˆgm+1,=,1,,d,ˆw,d,ˆw,d,ˆw,ˆw,(cid:107),properties,are,satisﬁed,for,ˆgm.,(cid:82),(cid:82),(cid:107),(cid:107),ˆw2,(cid:107),(cid:107),(cid:82),It,is,thus,critical,to,carefully,choose,the,initial,conditions,in,the,code,so,that,these,properties,are,initially,satisﬁed,to,machine,precision.,To,do,this,we,ﬁrst,set,initial,conditions,on,the,density,,parallel,ﬂow,and,parallel,pressure,proﬁles,,and,then,construct,the,initial,,normalised,distribution,function,,g0.,This,initial,distribution,function,is,then,corrected,in,a,manner,analogous,to,gm+1,above:,ˆg0,=,g0,d,ˆw,(cid:107),g0,+,1,2,−,(cid:82),(cid:32),d,ˆw,g0,ˆw2,(cid:107),g0,(cid:107),d,ˆw,(cid:107),(cid:82),(cid:82),d,ˆw,(cid:107),ˆw2,(cid:107),(cid:32),(cid:30),(cid:32)(cid:90),ˆw2,(cid:107),d,ˆw,g0,ˆw2,(cid:107),(cid:107),g0,−,g0,d,ˆw,(cid:107),g0,(cid:33),g0,−,(cid:82),g0,g0,d,ˆw,(cid:107),(cid:33)(cid:33),(cid:33),(cid:32),ˆw2,(cid:107),d,ˆw,g0,(cid:82),ˆw2,(cid:107),(cid:107),(140),(cid:82),This,approach,is,simple,,does,not,change,the,order,of,accuracy,of,the,discretisation,scheme,and,allows,for,the,use,of,numerical,dissipation,to,improve,numerical,stability,properties.,Furthermore,,in,contrast,to,the,discretisation,errors,that,would,naturally,arise,when,relying,on,a,conservative,diﬀerencing,scheme,,the,error,arising,from,this,correction,is,easy,to,monitor,,as,it,is,explicitly,calculable.,Results,showing,the,eﬃcacy,of,these,corrections,are,given,in,Sec.,7,(cid:82),6.4.,Mixed,velocity,grids,due,to,collisions,(cid:107),(27),or,ˆw,(110),,ˆv,(45),,the,ion,When,employing,the,parallel,velocity,coordinates,˜w,(cid:107),(cid:107),grids.,This,is,because,the,and,neutral,pdfs,will,in,general,be,evaluated,on,diﬀerent,v,mapping,from,each,of,these,velocity,coordinates,to,v,depends,on,˜vth,s,and/or,˜us,,both,(cid:107),of,which,are,species,(and,time),dependent.,When,including,charge,exchange,and/or,ionisation,collisions,,one,must,evaluate,the,neutral,pdf,on,the,ion,velocity,grid,and,vice,versa.,To,achieve,this,when,using,one,of,the,aforementioned,velocity,coordinates,,one,must,interpolate,to,obtain,it.,When,using,the,Chebyshev,discretisation,,a,Chebysev,spectral,method,is,used,to,perform,the,interpolation;,when,using,ﬁnite,diﬀerences,,a,cubic,Hermite,spline,is,used.,Note,that,this,interpolation,is,only,necessary,when,evolving,the,parallel,ﬂow,and/or,parallel,pressure,separately,from,the,distribution,function.,(cid:107),6.5.,Wall,boundary,conditions,>,0,depends,on,the,Note,that,the,boundary,condition,(58),for,the,neutrals,at,z,=,0,for,v,(cid:107),<,0,through,Γ0.,This,distribution,function,neutral,distribution,function,at,z,=,0,for,v,<,0,,which,requires,speciﬁcation,of,the,neutral,boundary,condition,at,z,=,Lz,for,v,(cid:107),itself,depends,on,the,distribution,function,at,z,=,Lz,for,v,>,0.,Were,one,to,employ,an,implicit,time,advance,algorithm,,a,response,matrix,or,iterative,approach,would,be,required,to,address,this,inter-dependence.,For,the,explicit,time,advance,employed,in,the,code,,this,inter-dependence,is,straightforward,to,accommodate.,(cid:107),(cid:107),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,27,The,procedure,employed,is,to,ﬁrst,solve,for,fs(z,,v,>,0),and,(z,=,Lz,,v,(cid:107),),locations,,,tm+1),at,all,(z,,v,<,0).,As,the,time,advance,is,explicit,,this,<,0,,tm+1),and,>,0,,tm+1),are,then,used,to,compute,Γ0(tm+1),and,ΓLz,(tm+1).,These,ﬂuxes,>,0,,tm+1),<,0,,tm+1).,This,procedure,is,the,same,for,all,variants,of,the,drift,except,for,(z,=,0,,v,(cid:107),can,be,achieved,given,fs(z,=,Lz,,v,(cid:107),can,then,be,used,in,Eq.,(58),to,compute,the,boundary,values,fn(z,=,0,,v,(cid:107),and,fn(z,=,Lz,,v,(cid:107),kinetic,and,moment,kinetics,models.,}s=i,n.,The,solutions,for,fs(z,=,0,,v,fs(z,,v,,,tm),{,(cid:107),(cid:107),(cid:107),(cid:107),For,the,models,in,Sec.,3,where,the,parallel,ﬂow,is,advanced,via,force,balance,,by,the,the,parallel,velocity,coordinate,is,shifted,relative,to,the,true,parallel,velocity,v,parallel,ﬂow,velocity,us.,As,noted,in,Sec.,4,,this,introduces,a,numerical,diﬃculty:,The,wall,boundary,conditions,depend,on,which,side,of,the,v,=,0,boundary,one,is,on,,but,(cid:107),this,boundary,shifts,around,in,time,when,using,the,peculiar,velocity,as,a,coordinate.,<,0,Consequently,,a,given,w,(cid:107),at,time,level,m,+,1.,,,one,will,=,0,boundary,via,necessarily,be,mixing,regions,of,phase,space,on,either,side,of,the,v,(cid:107),time-stepping.,This,makes,enforcement,of,,e.g.,,the,zero-incoming,boundary,condition,for,ions,(81),challenging,if,not,infeasible.,In,the,absence,of,a,solution,to,this,problem,,the,use,of,the,peculiar,velocity,as,a,coordinate,for,the,ions,or,neutrals,should,be,avoided,for,the,open-ﬁeld,line,region,of,the,plasma.,(cid:107),If,taking,the,time,derivative,of,the,pdf,at,ﬁxed,w,value,may,correspond,to,v,(cid:107),>,0,at,time,level,m,and,to,v,(cid:107),(cid:107),It,is,worth,noting,that,in,order,to,ensure,the,conservation,of,the,ﬁeld-line-averaged,,species-summed,density,(as,shown,in,Sec.,4),,care,must,be,taken,to,ensure,that,the,fKw,=,1,are,exactly,satisﬁed,by,the,numerics.,properties,This,is,achieved,in,our,case,by,ﬁrst,obtaining,the,numerical,approximation,to,these,integrals,and,then,deﬁning,a,modiﬁed,fKw,that,is,normalised,by,this,result.,0,dv,∞,(cid:107),(cid:82),fKw,=,dv,(cid:107),−∞,−,v,v,(cid:82),(cid:107),0,(cid:107),7.,Numerical,results,In,this,section,we,present,data,demonstrating,that,our,numerical,implementation,of,the,model,equations,given,in,Sec.,5,is,able,to,reproduce,analytical,benchmarks,,to,preserve,the,desired,conservation,properties,and,to,produce,physically,sensible,results.,7.1.,Linear,Landau,damping,of,a,sound,wave,As,a,ﬁrst,test,of,the,code,,we,consider,the,linear,Landau,damping,of,a,sound,wave,for,a,closed-ﬁeld-line,system,(periodic,boundary,condition,in,z),with,charge,exchange,collisions,between,ions,and,neutrals,,but,no,ionisation.,We,initialise,the,distribution,function,for,species,s,to,be,of,the,form,fs,=,ns,√π,(cid:32),2,ms,T,(cid:107),,s,(cid:33),1/2,exp,(cid:32)−,msv2,(cid:107),T,2,,s,(cid:107),,,(cid:33),(141),with,ns,=,T,(cid:107),line,average.,The,piece,of,the,temperature,that,varies,along,z,,δT,(cid:10),,s,,with,the,angled,brackets,denoting,a,ﬁeld,(cid:107),,s,,is,initially,zero,,and,(cid:107),+,δns,and,Ts,=,ns(cid:105),(cid:104),(cid:11),(cid:10),,s,(cid:11),+,δT,(cid:10),(cid:11),Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,28,δns,is,chosen,to,be,small,compared,to,(t,=,0)),=,0.001.,ns(cid:105),The,system,of,equations,(1)-(4),can,thus,be,linearised,to,a,good,approximation.,This,facilitates,comparisons,with,the,linear,analytical,theory,for,this,system,,presented,in,Ref.,[5].,:,max(δns(z,,t,=,0)/,ns(cid:105),(cid:104),(cid:104),,i,(cid:104),,n,(cid:11),(cid:10),=,T,(cid:107),T,(cid:107),ni(cid:105),nn(cid:105),(cid:104),(t,=,0),=,=,Ne/2,and,For,all,cases,shown,here,,(t,=,0).,Both,the,electron-ion,temperature,ratio,and,the,charge,exchange,collision,frequency,are,varied,,and,damping,rates,and,frequencies,are,extracted,by,considering,the,time,evolution,of,the,spatially-varying,component,of,the,electrostatic,potential,,δφ.,In,particular,,a,least-squares,ﬁt,for,δφ(t)/δφ(t0),is,done,for,each,simulation,to,a,function,of,the,form,exp(γ(t,γ,,ϕ)/,cos(ωt0,−,frequency,ω,and,phase,ϕ.,The,results,for,solving,the,standard,drift,kinetic,system,of,equations,(93)-(96),are,given,in,Fig.,6.,There,is,excellent,agreement,across,a,wide,range,of,temperature,ratios,and,charge,exchange,collision,frequencies,,both,for,the,damping,of,ﬁnite,frequency,modes,(corresponding,to,the,solid,lines),and,to,a,zero,frequency,mode,that,appears,at,larger,collisionalities,(dashed-dotted,lines).,ϕ),to,obtain,the,damping,rate,t0)),cos(ωt,−,−,−,(cid:10),(cid:11),Figure,6.,Normalized,growth,rate,and,real,frequency,as,a,function,of,the,ion-electron,temperature,ratio.,The,minor,discrepancies,between,the,analytical,and,numerical,damping,rates,that,are,apparent,for,a,handful,of,the,cases,are,due,to,the,simultaneous,presence,of,both,modes,with,similar,damping,rates.,This,necessitates,in,some,cases,resolving,the,damping,of,both,modes,over,many,orders,of,magnitude,before,the,least,damped,mode,dominates,the,numerical,solution,–,a,challenging,task,given,the,ever-increasing,ﬁlamentation,of,the,velocity,space,due,to,phase,mixing.,This,should,be,possible,to,eliminate,by,carefully,initialising,the,simulation,so,that,only,the,least,damped,mode,is,present,,though,we,have,not,yet,attempted,this.,An,example,of,a,case,in,which,both,modes,are,present,,as,well,as,a,case,in,which,they,are,not,,is,given,in,Fig.,7.,,s(t,=,0),=,Te,,but,with,all,of,We,present,results,in,Fig.,8,for,the,same,case,with,T,(cid:107),the,low-order,moments,(density,,parallel,ﬂow,and,parallel,pressure),evolved,separately,from,the,pdf,(see,Secs.,3.4,and,5.4,for,details,of,the,model,equations).,There,is,again,00.511.522.500.511.52ω/kkvth(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkvth(cid:12)(cid:12)(cid:12)1/41/2124−1.4−1.2−1−0.8−0.6−0.4−0.200.511.52γ/kkvth(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkvth(cid:12)(cid:12)(cid:12)1/41/2124,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,29,Figure,7.,Time,evolutions,of,the,absolute,value,of,the,spatially-varying,electrostatic,potential,δφ,(blue),and,the,result,of,a,least-squares,ﬁt,(orange),to,obtain,the,damping,rate,,frequency,and,phase.,The,left,plot,corresponds,to,Te/T(cid:107),i,=,2,and,˜Rin,=,0,,and,the,right,plot,corresponds,to,Te/T(cid:107),i,=,1,and,˜Rin,=,4,(,0.7,in,terms,of,the,normalised,frequency,used,in,Fig.,6).,≈,good,agreement,across,a,wide,range,of,charge,exchange,collision,frequencies.,We,note,that,the,results,obtained,with,separate,evolution,of,only,the,density,(Secs.,3.1,and,5.1),and,of,only,the,density,and,parallel,ﬂow,(Secs.,3.2,and,5.2),are,almost,identical,to,the,ones,presented,here,in,which,all,three,of,the,lowest-order,moments,are,evolved,separately.,Testing,of,the,case,in,which,density,and,parallel,pressure,are,evolved,separately,is,ongoing.,The,results,reported,here,were,obtained,using,the,conserving,corrections,given,by,Eqs.,137,and,139.,Figure,8.,Normalized,damping,rate,and,real,frequency,as,a,function,of,the,charge,exchange,collision,frequency,for,cases,with,=,Te.,The,‘kinetic’,model,refers,to,the,standard,drift,kinetic,system,of,equations,,while,the,‘moment-based’,model,is,one,in,which,density,,parallel,ﬂow,and,parallel,pressure,are,evolved,separately,from,the,modiﬁed,pdf.,T(cid:107),s,(cid:11),(cid:10),In,Figure,9,we,show,the,diﬀerence,in,conservation,properties,between,cases,for,which,the,conservative,corrections,of,Eqs.,(137),and,139,are,employed,and,those,for,00.511.522.500.511.52ω/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)analyticalkineticmoment-based−1.4−1.2−1−0.8−0.6−0.4−0.200.511.52γ/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)(ni+nn)Rin/(cid:12)(cid:12)(cid:12)kkci(cid:12)(cid:12)(cid:12)analyticalkineticmoment-based,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,30,which,no,conserving,correction,is,applied.,With,the,conservative,implementation,,all,of,the,requisite,moments,of,the,modiﬁed,distribution,function,are,conserved,to,machine,precision,,regardless,of,numerical,resolution.,d,ˆw(cid:107),ˆwm,Figure,9.,Time,traces,of,the,deviation,from,exact,conservation,of,the,moments,(cid:107),ˆg,for,low-resolution,(Nz,=,9,on,one,element,,Nv,=,9,on,ﬁve,elements),Solid,and,dotted,lines,correspond,to,simulations,with,normalised,Rin,(cid:82),simulations,with,and,without,conserving,corrections,,respectively.,0.3.,≈,7.2.,Plasma,on,open,ﬁeld,lines:,analytical,comparison,We,next,compare,our,simulation,results,to,the,analytical,solution,presented,in,Sec.,4.1.,As,argued,in,Sec.,6.5,,the,moment-kinetic,models,in,which,the,parallel,ﬂow,are,evolved,are,not,conducive,to,simulations,of,plasma,on,open,ﬁeld,lines.,Consequently,,we,restrict,our,attention,to,the,drift,kinetic,model,here.,A,demonstration,of,the,other,moment,kinetic,approaches,(in,which,only,the,density,or,both,the,density,and,parallel,pressure,are,separately,evolved),for,open,ﬁeld,line,regions,is,underway.,The,ion,equation,being,solved,in,the,code,for,the,standard,drift,kinetic,model,is,∂,˜fi,∂˜t,∂,˜fi,∂,˜z,−,∂,˜φ,∂,˜z,1,2,+,˜v,(cid:107),exp,cs,vδ,=,˜Rion,∂,˜fi,∂˜v,(cid:107),(1/√πvδ),exp(,˜v2,(cid:107),−,c2,s,v2,δ,(cid:19),,,(142),δ,),with,the,proviso,that,(cid:18),v2,(cid:107),where,we,have,approximated,δ(v,vδ,(cid:28),/v2,(cid:107),cs.,In,terms,of,normalised,quantities,,the,solution,(76),is,−,≈,),˜z,=,1,2,±,2,π,˜Rion,D,.,˜φ,(cid:19),−,(cid:18)(cid:113),(143),For,our,benchmark,simulation,,we,use,a,Chebyshev,pseudo-spectral,method,in,both,z,and,v,.,The,z,grid,consists,of,two,z,elements,,each,containing,nine,grid,points,,and,(cid:107),grid,consists,of,ten,elements,,each,containing,seventeen,grid,points.,The,wall,the,v,(cid:107),1×10−201×10−181×10−161×10−141×10−121×10−101×10−81×10−60.0001012345conservationabsoluteerrortci/Lzm=0m=1m=2,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,31,Figure,10.,The,steady-state,electrostatic,potential,proﬁle,obtained,by,solving,Eq.,(142),(blue,line),and,by,using,the,analytical,solution,of,Eq.,(143),(red,line).,temperature,Tw,is,taken,to,be,equal,to,Te,,the,source,width,parameter,is,vδ,=,0.5cs,,˜Rion,=,0.688,and,the,ions,are,initialised,to,a,Maxwellian,velocity,distribution,with,initial,temperature,Te,and,an,initial,density,with,Gaussian,distribution,in,z.,The,resulting,steady-state,solution,for,˜φ(˜z),,along,with,a,comparison,to,the,analytical,solution,(143),is,given,in,Fig.,10.,Figure,11.,Time,trace,of,the,species-summed,,line-averaged,density,,normalised,by,its,initial,value.,7.3.,Plasma,on,open,ﬁeld,lines:,physics,study,We,ﬁnally,consider,the,drift,kinetic,system,of,equations,given,in,Sec.,5.,We,take,the,normalised,collision,frequency,factors,to,be,˜Rion,=,˜Rin,=,2,and,otherwise,use,the,same,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,32,numerical,parameters,and,initial,conditions,as,we,did,for,the,analytical,benchmark,,except,that,we,use,eight,z,elements,rather,than,two.,A,cross-section,of,the,numerical,results,are,presented,in,Figures,11-13.,In,Fig.,11,we,consider,the,evolution,of,the,species-,summed,,line-averaged,density.,As,shown,in,Sec.,4.1,,this,density,should,be,conserved,,and,this,is,indeed,the,case,in,the,simulation,to,machine,precision.,The,steady-state,electrostatic,potential,and,particle,distribution,functions,for,ions,and,neutrals,are,given,in,Figs.,12,and,13.,As,might,be,expected,,the,loss,of,electrons,to,the,walls,gives,rise,to,an,electric,ﬁeld,that,pulls,ions,out,of,the,simulation,domain.,These,ions,are,replaced,by,neutrals,traveling,back,into,the,simulation,domain,,leading,to,the,regions,of,high,neutral,density,near,the,walls,(with,neutral,velocities,away,from,the,walls),visible,in,Fig.,13.,The,phase,space,structure,in,the,ion,distribution,function,is,likely,a,result,of,the,ionisation,of,neutrals,in,the,high-density,regions,near,the,walls,,followed,by,an,acceleration,of,these,ions,towards,the,nearest,wall.,This,reduces,their,initial,speed,away,from,the,walls,and,eventually,changes,their,direction,of,motion,and,accelerates,them,into,the,wall,near,which,they,were,generated.,Conversely,,ions,generated,suﬃciently,far,from,the,nearest,wall,can,cross,the,symmetry,point,in,z,and,are,accelerated,towards,the,wall,furthest,from,where,they,were,generated.,As,an,aside,,we,note,that,the,kinetic,Bohm,criterion,,which,for,the,case,of,Boltzmann,electrons,can,be,written,[6],dv,(cid:107),c2,s,v2,(cid:107),(cid:90),fi(v,(cid:107),),≤,2ni,,(144),is,satisﬁed,for,this,simulation.,Figure,12.,Electrostatic,potential,proﬁle,in,steady,state.,8.,Conclusions,and,future,plans,There,are,a,few,conclusions,that,can,be,drawn,based,on,our,results.,First,,the,standard,drift,kinetic,system,of,equations,described,in,Secs.,2,,4,and,5,is,generally,well-behaved,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,33,Figure,13.,Phase,space,portraits,of,the,steady-state,,normalised,ion,(left),and,neutral,(right),particle,distribution,functions,,˜fi,and,˜fn.,both,for,periodic,and,wall,boundary,conditions,in,z.,Care,should,be,taken,where,possible,to,ensure,that,the,desired,conservation,properties,are,preserved,by,the,numerical,scheme,,and,we,have,outlined,ways,in,which,this,can,be,achieved.,Second,,the,moment,kinetic,model,variants,in,which,the,peculiar,velocity,is,used,as,a,coordinate,give,rise,to,numerical,diﬃculties,when,enforcing,wall,boundary,conditions.,In,the,absence,of,solutions,to,these,diﬃculties,,use,of,these,particular,moment,kinetic,models,in,not,recommended,for,the,plasma,in,open,ﬁeld,line,regions.,The,other,moment,kinetic,model,variants,–,in,which,only,the,density,or,both,the,density,and,parallel,pressure,are,evolved,for,the,ions,and,neutrals,–,should,work,for,both,open,and,closed,ﬁeld,line,regions.,We,have,veriﬁed,this,to,be,the,case,for,the,model,with,only,density,evolution,,but,our,work,on,the,case,with,density,and,parallel,pressure,evolution,is,ongoing.,In,all,cases,with,the,moment,kinetic,models,,we,found,it,important,to,apply,the,conserving,corrections,detailed,in,6.3.,In,addition,to,ensuring,conservation,to,machine,precision,,we,found,that,application,of,these,corrections,enhanced,numerical,stability.,The,advantages,of,evolving,only,the,density,separately,are,unclear:,such,a,model,cannot,work,as,a,standalone,ﬂuid,model,,even,in,the,collisional,limit,,and,it,does,not,possess,the,property,that,the,velocity,is,normalised,to,a,local,thermal,speed.,The,model,in,which,the,parallel,pressure,is,also,evolved,does,possess,this,latter,property,,which,may,make,it,worth,further,exploration,in,both,the,1D,and,2D,settings.,Consequently,,our,current,thinking,is,that,the,best,model,for,ions,and,neutrals,is,either,the,standard,drift,kinetic,model,or,the,moment,kinetic,variant,in,which,both,density,and,parallel,pressure,are,evolved.,The,immediate,plans,going,forward,should,be,to,extend,this,work,to,a,two-,spatial-dimension,system,consisting,of,a,helical,magnetic,ﬁeld,and,to,implement,a,ﬂuid,model,for,electron,dynamics.,The,latter,will,allow,for,a,more,realistic,solution,for,the,electrostatic,potential,than,that,provided,by,the,Boltzmann,response,of,Eq.,(4).,Numerical,study,of,1+1D,drift,kinetic,models,for,parallel,dynamics,34,[1],M.,Barnes,,F.,I.,Parra,,and,M.,R.,Hardman.,Numerical,study,of,1d,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,2:2047357–TN–01–02,M2.1,,2021.,[2],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,4:2047357–,TN–01–02,M2.2,,2021.,[3],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,6:2047357–,TN–01–02,M2.3,,2021.,[4],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,drift,kinetic,model,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,8:2047357–TN–02,M2.4,,2021.,[5],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,1d,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,1:2047357–TN–01–02,M1.1,,2021.,[6],E.,R.,Harrison,and,W.,B.,Thompson.,The,low,pressure,plane,symmetric,discharge.,Proc.,Phys.,Soc.,,74:145,,1959.,[7],N.,H.,Abel.,Journal,f¨ur,die,reine,und,angewandte,Mathematik,,1:153,,1826.,[8],C.-W.,Shu,and,S.,Osher.,Eﬃcient,implementation,of,essentially,non-oscillator,shock-capturing,schemes.,J.,Comp.,Phys.,,77:439–471,,1988.,[9],S.,Gottlieb,and,C.-W.,Shu.,Total,variation,diminishing,runge-kutta,methods.,Mathematics,of,Computation,,67:73–85,,1998.,[10],S.,Gottlieb,,C.-W.,Shu,,and,E.,Tadmor.,Strong,stability-preserving,high-order,time,discretization,methods.,SIAM,Rev.,,43:89,,2001.,[11],D.,R.,Durran.,Numerical,methods,for,ﬂuid,dynamics.,Springer,,2010.,[12],M.,Abramowitz,and,I.,A.,Stegun.,Handbook,of,Mathematical,Functions,with,Formulas,,Graphs,,and,Mathematical,Tables.,Dover,,New,York,,1972.,[13],Matteo,Frigo,and,Steven,G.,Johnson.,The,design,and,implementation,of,FFTW3.,Proceedings,of,the,IEEE,,93(2):216–231,,2005.,Special,issue,on,“Program,Generation,,Optimization,,and,Platform,Adaptation”.,[14],C.,W.,Clenshaw,and,A.,R,Curtis.,A,method,for,numerical,integration,on,an,automatic,computer.,Numerische,Mathematik,,2:197,,1960.

:pdfembed:`src:_static/TN-10_Numerical11DDriftKineticParallelDynamicsPlasmaEdge.pdf, height:1600, width:1100, align:middle`

