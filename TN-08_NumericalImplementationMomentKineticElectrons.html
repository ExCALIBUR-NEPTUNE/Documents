
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="Report,2070839-TN-06,Numerical,implementation,of,moment-kinetic,electrons,M.,Barnes1,,M.,R.,Hardman2,,S.,Newton3,,J.,Omotani3,and,F.,I.,Parra4,1,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,2,Tokamak,Energy,Ltd,,173,Brook,Drive,,Milton,Park,,Abingdon,OX14,4SD,,United,Kingdom,3,Culham,Centre,for,Fusion,Energy,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,United,Kingdom,4,Princeton,Plasma,Physics,Laboratory,,P.O.,Box,451,,Princeton,,New,Jersey,08540,,United,States,E-mail:,michael.barnes&#64;physics.ox.ac.uk,1.,Introduction,Calculation,of,the,electrostatic,potential,is,a,challenge,within,the,drift,kinetic,approximation.,This,is,because,,without,further,manipulation,of,the,drift,kinetic,system,of,equations,,there,is,no,explicit,equation,to,be,solved,for,the,potential:,Instead,,it,appears,as,a,parameter,in,the,drift,kinetic,equations,for,both,electrons,and,ions,,which,In,report,2047357-TN-07-01,[1],,are,then,related,to,one,another,via,quasineutrality.,we,showed,how,the,electrostatic,potential,could,be,calculated,self-consistently,for,a,2D,drift,kinetic,model,with,a,helical,magnetic,field,and,with,wall,boundary,conditions,appropriate,for,open,field,lines.,Considerable,care,had,to,be,taken,to,obtain,an,expression,for,the,electrostatic,potential.,In,particular,,a,set,of,fluid,equations,had,to,be,formulated,for,the,electron,dynamics,,with,closure,via,coupling,to,the,kinetic,equation,for,a,modified,electron,particle,distribution,function.,In,this,moment-kinetic,formulation,,the,parallel,electron,momentum,equation,becomes,the,equation,for,the,electrostatic,potential,,with,an,additional,complication,that,the,boundary,value,for,the,potential,must,be,determined,implicitly,as,it,enters,in,the,limits,of,integration,for,the,parallel,current,at,the,plasma,boundary.,Thus,far,we,have,mostly,side-stepped,the,issue,of,calculating,the,potential,in,our,ProxyApps,by,using,a,Boltzmann,response,for,the,electron,dynamics,so,that,no,electron,equations,need,to,be,solved,at,all.,In,report,2070839-TN-04,,we,made,a,start,on,addressing,this,limitation,by,implementing,electron,fluid,equations,for,the,1+1D,system,described,in,report,2047357-TN-05-01,[2],,with,a,Braginskii,fluid,closure,for,the,electrons,[3].,In,this,report,we,describe,our,numerical,implementation,of,a,moment-,kinetic,closure,for,the,electron,fluid,equations.,1,2,DRIFT,KINETIC,SYSTEM,OF,EQUATIONS,2,To,begin,we,will,provide,a,brief,overview,of,the,physical,system,we,aim,to,model,,and,provide,the,system,of,evolution,equations,for,the,various,plasma,species.,At,present,,we,are,unable,to,obtain,steady-state,solutions,for,the,electron,distribution,function:,We,provide,illustrative,examples,of,the,difficulties,we,have,encountered,and,discuss,possible,causes,of,and,solutions,to,the,problems,observed.,2.,Drift,kinetic,system,of,equations,We,consider,a,plasma,consisting,of,a,single,ion,species,of,charge,e,and,mass,mi,,a,single,neutral,species,with,mass,mn,=,mi,,and,electrons,with,charge,e,and,mass,me.,The,plasma,is,immersed,in,a,straight,,homogeneous,magnetic,field,of,the,form,−,B,=,Bˆz,,(1),where,z,is,the,field-aligned,coordinate,,and,ˆz,is,the,unit,vector,in,the,direction,of,z.,We,assume,that,the,plasma,is,electrostatic,and,that,the,magnetic,field,terminates,at,each,end,on,a,conducting,wall.,The,spatial,domain,we,consider,is,z,,,z+],,with,=,Lz.,The,boundaries,of,the,domain,in,z,are,assumed,to,be,the,entrances,to,z+,−,the,magnetic,pre-sheath.,z,−,∇,[z,∈,−,We,restrict,our,attention,to,parallel,dynamics,only,and,define,the,marginalised,distribution,function,fs(z,,v,,,t),∥,.,=,(cid:68),ˆfs(z,,v,,,v,⊥,∥,,,ϑ,,t),(cid:69),.,=,2π,(cid:90),∞,0,dv,⊥,ˆfs,,v,⊥,(2),with,ˆfs,the,particle,distribution,function,for,species,s,,t,the,time,,v,the,parallel,component,of,the,particle,velocity,v,,and,the,angle,brackets,denoting,integration,over,gyro-angle,ϑ,and,the,perpendicular,component,of,the,particle,velocity,v,.,To,facilitate,this,one-dimensional,treatment,of,the,velocity,space,,we,neglect,collisions,between,charged,particles,and,elastic,electron-neutral,collisions,,as,the,associated,operators,into,the,electron,drift,kinetic,equation.,would,introduce,non-trivial,dependence,on,v,⊥,As,described,in,,e.g.,,Report,2047537-TN-05-1,[2],,the,drift,kinetic,equations,describing,the,evolution,of,the,marginalised,particle,distribution,fs,for,the,ions,,electrons,and,neutrals,are,⊥,∥,∂fi,∂t,+,v,∥,∂fi,∂z,−,e,mi,∂ϕ,∂z,=,∂fi,∂v,∥,∂fe,∂t,+,v,∥,∂fe,∂z,+,e,me,and,Rin,(nnfi,−,−,∂fe,∂v,∂ϕ,∂z,∥,=,Ce,ion[fe,,fn],+,Se,,nifn),+,Rionnefn,+,Si,(3),(4),∂fn,∂t,∂fn,∂z,+,v,=,Rin,(nnfi,−,(cid:11),is,a,where,ϕ,is,the,electrostatic,potential,,ns,=,(cid:82),dv,marginalised,source,accounting,for,,e.g.,,heating,and,fueling,,Rin,and,Rion,are,constants,fs,is,the,particle,density,,Ss,=,(cid:10),ˆSs,Rionnefn,+,Sn,,nifn),−,∥,∥,(5),3,ELECTRON,FLUID,EQUATIONS,3,that,determine,the,ion-neutral,charge,exchange,and,ionisation,rates,,respectively,,and,Ce,ion,is,an,operator,accounting,for,the,effect,on,electrons,of,ionisation,collisions.,The,distribution,functions,fi,and,fe,are,related,to,one,another,via,quasineutrality:,(cid:90),∞,ni,=,fi,=,dv,∥,(cid:90),∞,−∞,−∞,fe,=,ne.,dv,∥,(6),One,of,the,main,challenges,in,solving,this,system,of,equations,is,that,there,is,no,explicit,equation,for,the,electrostatic,potential.,If,one,were,to,try,,e.g.,,to,solve,the,ion,and,electron,drift,kinetic,equations,(3)-(4),using,an,explicit,time,advance,algorithm,with,ϕ,at,the,previous,time,level,as,an,input,,then,in,general,the,solutions,for,fi,and,fe,so,obtained,would,not,satisfy,Eq.,(6).,This,procedure,could,be,iterated,,with,ϕ,varied,until,quasineutrality,were,satisfied,,or,one,could,develop,an,approach,that,guarantees,satisfaction,of,quasineutrality,from,the,outset.,We,have,presented,two,such,approaches,in,previous,reports:,The,first,assumes,a,Boltzmann,electron,response,and,thus,avoids,entirely,the,need,to,solve,for,the,electron,dynamics,,while,the,second,uses,a,novel,moment-kinetic,approach,in,which,the,electron,parallel,momentum,equation,can,be,used,to,solve,for,the,potential,explicitly,while,enforcing,quasineutrality.,In,this,report,we,describe,the,numerical,implementation,and,testing,of,the,moment-kinetic,treatment,for,electrons.,We,will,assume,in,this,report,that,fi,and,fn,can,be,obtained,,provided,ϕ,,either,via,direct,solution,of,the,above,drift,kinetic,equations,or,via,the,moment-kinetic,approach,derived,in,report,2047357-TN-05-01,[2].,Our,focus,here,will,be,on,describing,the,numerical,treatment,of,the,moment-kinetic,electron,equations,and,their,relationship,to,the,calculation,of,the,electrostatic,potential.,3.,Electron,fluid,equations,Electron,fluid,equations,are,obtained,by,taking,the,appropriate,velocity,moments,of,the,electron,drift,kinetic,equation,(4),and,expanding,in,the,small,parameter,me/mi.,Details,can,be,found,in,[2].,The,electron,continuity,equation,is,‡,(cid:90),∞,∂ne,∂t,+,∂neue,∂z,=,nennRion,+,Se,,dv,∥,(7),where,the,parallel,flow,of,species,s,is,given,by,(cid:90),∞,.,=,us,1,ns,−∞,fs.,v,∥,(8),dv,∥,−∞,The,charge,conservation,equation,,obtained,by,combining,the,electron,and,ion,continuity,equations,and,enforcing,quasineutrality,,is,∂,∂z,(ne,(ui,−,ue)),=,0.,(9),Here,we,have,corrected,a,typo,in,the,sign,of,the,electron,ionisation,particle,source,appearing,in,[2].,‡,3,ELECTRON,FLUID,EQUATIONS,4,Note,that,we,have,assumed,(cid:82),d3v,(Si,−,electron,parallel,momentum,equation,is,(after,using,me/mi,≪,Se),is,small,to,obtain,the,above,result.,The,1),∂p,,e,∥,∂z,−,+,ene,∂ϕ,∂z,=,0,,where,p,∥,,e,is,the,electron,parallel,pressure,,(cid:90),.,=,p,,e,∥,dv,∥,me,ˆw2,∥,fe,,(10),(11),.,=,v,v,∥,∥,−,ue,≈,and,ˆw,is,the,parallel,component,of,the,electron,peculiar,velocity.,The,∥,time,derivative,term,and,the,term,proportional,to,Se,have,been,neglected,in,(10),as,small,.,=,(cid:112)2Ti/mi,vth,i/Lz,and,Se,∼,in,me/mi,because,we,order,∂/∂t,and,Ts,fevth,i/Lz,,with,vth,i,.,=,p,∼,,s/ns.,∥,Finally,,the,electron,parallel,energy,equation,is,∂p,,e,∥,∂t,+,∂q,,e,∥,∂z,+,ue,∂p,,e,∥,∂z,+,3p,∂ue,∂z,,e,∥,=,nnRion,(cid:0)p,neEion,(cid:1),+,Sp,e,,,e,−,∥,where,q,∥,,e,is,the,electron,parallel,heat,flux,,(cid:90),.,=,q,,e,∥,d,ˆw,ms,ˆw3,∥,∥,fe,,(12),(13),Sp,e,=,(cid:82),dv,∥,me,ˆw2,∥,Se,is,the,electron,heat,source,,and,we,have,used,the,simple,model,(cid:90),dv,∥,me,ˆw2,∥,Ce,ion[fe,,fn],.,=,nnRion,(cid:0)p,(cid:1),neEion,,e,−,∥,(14),for,the,ionisation,source,,with,Eion,the,ionisation,energy,cost,(including,radiation,from,excited,states).,The,set,of,fluid,equations,(9),,(10),,(12),and,(13),require,some,form,of,closure,to,calculate,the,parallel,heat,flux.,We,use,a,1+1D,version,of,the,modified,electron,kinetic,equation,derived,in,[2],as,our,closure:,where,˙z,∂ge,∂z,+,˙w,∂ge,∂w,∥,∥,=,G,,.,=,ue,v,∥,−,vth,e,≈,v,∥,vth,e,,,w,∥,is,the,normalised,,parallel,component,of,the,electron,peculiar,velocity,,.,=,fe,ge,vth,e,ne,is,a,modified,particle,distribution,function,for,the,electrons,,˙z,=,w,vth,e,,∥,(15),(16),(17),(18),4,BOUNDARY,CONDITIONS,=,˙w,∥,1,menevth,e,∂p,,e,∥,∂z,+,w,2p,∥,,e,∥,∂q,,e,∂z,−,∥,∂vth,e,∂z,,,w2,∥,and,G,=,(cid:18),−,1,2p,,e,∥,∂q,,e,∂z,−,∥,vth,e,w,∥,(cid:18),∂,ln,ne,∂z,−,∂,ln,vth,e,∂z,(cid:19)(cid:19),ge.,5,(19),(20),With,the,definition,(17),,the,modified,distribution,function,ge,satisfies,the,following,integral,constraints:,(cid:90),dw,∥,(cid:0)1,,w,∥,,,w2,∥,(cid:1),ge,=,(cid:18),1,,0,,(cid:19),.,1,2,(21),The,set,of,equations,(3),,(5),,(6),,(9),,(10),,(12),,and,(15),constitute,a,closed,set,of,equations,for,fi,,fn,,ϕ,,ne,,ue,,p,,e,,and,ge,,provided,an,appropriate,set,of,boundary,∥,conditions.,We,turn,our,attention,to,these,boundary,conditions,next.,4.,Boundary,conditions,To,ensure,uniqueness,of,our,solution,,we,must,specify,boundary,conditions,in,z,on,the,ion,and,neutral,particle,distributions,,the,modified,electron,particle,distribution,(17),,and,on,the,electron,parallel,flow,and,pressure.,For,the,ions,,we,assume,that,all,ions,that,reach,the,end,of,the,domain,escape,to,the,wall,,where,they,recombine.,Thus,,no,ions,return;,i.e.,,and,fi(z+,,v,∥,&lt;,0,,t),=,0,,fi(z,−,,,v,∥,&gt;,0,,t),=,0.,(22),(23),Neutrals,that,leave,the,domain,are,assumed,to,hit,the,wall,and,thermalise,at,the,temperature,of,the,wall,,Tw.,Ions,that,recombine,at,the,wall,also,re-enter,as,neutrals.,The,resulting,boundary,condition,on,the,neutrals,is,and,where,fn(z,−,,,v,∥,&gt;,0,,t),=,Γ,−,fKw(v,∥,),,fn(z+,,v,∥,&lt;,0,,t),=,Γ+fKw(v,∥,),,fKw(v,),∥,.,=,3√π,(cid:19)3/2,(cid:18),mi,2Tw,(cid:12),(cid:12),erfc,(cid:12),(cid:12)v,∥,(cid:18)(cid:114),mi,2Tw,(cid:19),(cid:12),(cid:12),(cid:12),(cid:12)v,∥,is,the,(marginalised),Knudsen,cosine,distribution,[4],,and,and,Γ,−,(cid:90),0,(cid:88),.,=,s=i,n,−∞,.,=,Γ+,(cid:88),(cid:90),∞,s=i,n,0,dv,∥,(cid:12),(cid:12)v,∥,(cid:12),(cid:12),fs(z,−,,,v,∥,,,t),dv,∥,(cid:12),(cid:12)v,(cid:12),(cid:12),fs(z+,,v,∥,∥,,,t),(24),(25),(26),(27),(28),5,NORMALISATIONS,6,are,the,combined,fluxes,of,neutrals,and,ions,towards,the,walls,at,z,=,z,respectively.,−,and,z,=,z+,,For,electrons,that,leave,the,domain,,their,parallel,energy,eϕ,.,=,ϕw)/me,at,z+,reach,the,wall,,with,ϕw,the,potential,of,the,wall,beyond,−,is,conserved.,As,a,result,,electrons,with,parallel,speeds,greater,than,vc,+,(cid:112)2e(ϕ(z+,,t),z,=,z+;,electrons,with,speeds,less,than,vc,+,are,repelled,back,into,the,domain:,(cid:40),=,mev2,∥,/2,E∥,−,ge(z+,,v,∥,&lt;,0,,t),=,ge(z+,,0,,,,t),,v,∥,−,&lt;,vc,+,&gt;,vc,+.,v,|,∥|,v,∥|,|,The,boundary,condition,at,z,=,z,−,is,similar:,(cid:40),ge(z,−,,,v,∥,&gt;,0,,t),=,ge(z,−,0,,,,t),,,,v,∥,−,v,∥|,|,v,∥|,|,&lt;,vc,,&gt;,vc,,−,−,,,(29),(30),.,=,(cid:112)2eϕ(z,−,where,vc,,Note,that,while,we,have,formulated,the,boundary,conditions,in,terms,of,v,∥,w,that,ue,∼,.,,,t)/me,,and,we,have,chosen,ϕ,to,be,zero,at,the,wall,beyond,z,−,,,the,fact,Integrating,the,charge,conservation,equation,(9),and,using,(29)-(30),gives,a,vth,e,implies,that,v,ui,≪,vth,e.,∥,≈,−,∥,constraint,on,the,parallel,current,at,the,domain,boundaries:,0,=,J,(z+,,t),∥,J,∥,(z,−,−,,,t),=,(cid:90),∞,0,(cid:90),0,−,−∞,dv,∥,v,∥,fi(z+,,v,∥,,,t),−,dv,∥,v,∥,fi(z,−,,,v,∥,,,t),+,(cid:90),∞,vc,+,(cid:90),−,vc,−,−∞,dv,∥,v,∥,fe(z+,,v,∥,,,t),dv,∥,v,∥,fe(z,−,,,v,∥,,,t).,(31),Note,that,there,is,no,contribution,to,the,electron,current,from,particles,with,&lt;,vc,+,.,This,is,because,the,outgoing,at,z,=,z+,nor,from,particles,with,−,current,of,electrons,with,these,speeds,is,cancelled,by,the,return,current,of,these,electrons.,As,proposed,in,[2],,we,simplify,our,system,by,assuming,that,the,parallel,current,,,t),=,(z,,,t).,The,charge,into,the,wall,vanishes,individually,at,each,boundary;,0.,Combined,with,quasineutrality,,this,imposes,ue(z,±,conservation,equation,(9),can,then,be,integrated,to,find,ue,=,ui,for,all,z.,i.e.,,J,∥,,,t),=,ui(z,±,(z+,,t),=,J,∥,at,z,=,z,v,∥|,|,v,∥|,|,&lt;,vc,,−,−,Our,boundary,condition,on,p,,e,is,chosen,based,on,the,physics,we,intend,to,model;,∥,for,the,cases,considered,in,this,report,,we,either,set,Te(z,,,t),(when,νei,is,±,large),or,we,assume,that,the,electron,temperature,is,constant,throughout,the,sheath,,,t),=,Tw,(when,we,wish,to,force,a,Boltzmann,electron,response),,with,Tw,so,that,Te(z,±,the,temperature,of,the,wall.,,,t),=,Ti(z,±,5.,Normalisations,The,normalisations,used,in,the,code,are,given,in,Table,1.,The,normalised,drift,kinetic,equations,for,ions,and,neutrals,are,∂,˜fi,∂˜t,∂,˜fi,∂,˜z,−,∂,˜ϕ,∂,˜z,1,2,+,˜v,∥,∂,˜fi,∂˜v,∥,(cid:16),˜Rin,˜nn,˜fi,−,=,−,(cid:17),˜ni,˜fn,+,˜Rion˜ne,˜fn,+,˜Si,(32),6,NUMERICAL,APPROACH,and,∂,˜fn,∂˜t,∂,˜fn,∂,˜z,+,˜v,∥,The,normalised,electron,fluid,equations,are,˜nn,˜ni,˜fi,−,=,˜Rin,(cid:16),(cid:17),˜fn,−,˜Rion˜ne,˜fn,+,˜Sn.,˜ne,=,˜ni,,∂,∂,˜z,−,(˜ne,(˜ui,−,∂,˜p,˜ne,,e,∥,2,∂,˜z,+,˜ue)),=,0,,∂,˜ϕ,∂,˜z,=,0,,and,where,∂,˜p,,e,∥,∂˜t,+,∂,˜q,,e,∥,∂,˜z,+,˜ue,∂,˜p,,e,∥,∂,˜z,+,3˜p,∥,,e,∂,˜ue,∂,˜z,=,˜nn,˜Rion,(cid:16),˜p,,e,−,∥,(cid:17),˜ne,˜Eion,+,˜,Sp,e,,˜,Sp,e,.,=,Lref,cref,1,2nrefTref,Sp,e.,7,(33),(34),(35),(36),(37),(38),The,zero,current,boundary,condition,at,the,wall,,combined,with,quasineutrality,(34),and,charge,conservation,(35),,imposes,˜ue,=,˜ui.,Note,that,with,these,normalisations,the,electron,thermal,speed,and,parallel,pressure,are,related,via,˜vth,e,=,(cid:112)2(mi/me)˜p,,e/˜ne.,∥,Additionally,,the,electrostatic,potential,is,˜ϕ(z,and,˜Te,=,(me/mi)˜v2,th,e.,±,,,t),=,˜Te˜v2,c,,Finally,,the,normalised,parallel,heat,flux,is,obtained,from,±,,e,=,2˜p,˜q,∥,∥,,e˜vth,e,(cid:90),∞,−∞,dw,w3,∥,∥,ge,,(39),with,the,modified,distribution,function,ge,satisfying,and,˜vth,e,w,∥,∂ge,∂,˜z,+,(cid:18),˜vth,e,2˜p,∥,,e,∂,˜p,,e,∥,∂,˜z,+,w,2˜p,∥,∥,,e,∂,˜q,,e,∥,∂,˜z,−,∂˜vth,e,∂,˜z,w2,∥,(cid:19),∂ge,∂w,∥,=,˜G,,(40),˜G,.,=,Lref,cref,G,=,(cid:18),1,2˜p,∥,,e,−,∂,˜q,,e,∥,∂,˜z,−,˜vth,e,w,∥,(cid:18),∂,ln,˜ne,∂,˜z,−,∂,ln,˜vth,e,∂,˜z,(cid:19)(cid:19),ge.,(41),6.,Numerical,approach,A,detailed,description,of,the,space,and,time,discretisations,employed,in,the,code,can,be,found,in,report,2047357-TN-14,[5].,Briefly,,we,employ,an,explicit,time,advance,algorithm,(a,strong-stability-preserving,Runge-Kutta,variant),to,evolve,the,ion,and,neutral,particle,distribution,functions.,A,Chebyshev,spectral,element,scheme,is,used,for,the,spatial,discretisation.,An,iterative,method,is,used,to,solve,the,electron,energy,equation,,coupled,to,the,electron,kinetic,equation.,Solution,of,the,coupled,equations,proceeds,schematically,in,the,following,way:,6,NUMERICAL,APPROACH,8,normalised,variable,˜t,˜z,˜v,∥,˜w,,s,,e,˜ns,˜us,˜p,∥,˜q,∥,˜Ts,˜vth,s,˜ϕ,˜Ez,˜Rsn,˜Rion,˜Eion,˜νei,˜fs,˜F,∥,˜Ss,˜me,˜vc,,±,definition,q,p,t(cref/Lref),z/Lref,/cs,v,∥,w/cs,ns/nref,us/cref,,s/(2nrefTref),∥,,s/(2nrefTrefcref),∥,Ts/Tref,vth,s/cref,eϕ/Tref,eLrefEz/Tref,Rsn(nrefLref/cref),Rion(nrefLref/cref),Eion/(2Tref),νei(Lref/cref),fs(csπ1/2/nref),(Lref/2nrefTref),F,Ss(Lrefπ1/2/nref)(cs/cref),me/mi,/vth,e,vc,,∥,±,reference,quantity,Lref,=,Lz,Tref,nref,cref,mi,definition,ref.,length,ref.,temperature,ref.,density,(cid:112)2Tref/mi,ion,mass,Table,1.,Definitions,for,normalised,and,reference,quantities,used,in,the,report.,Note,that,cs,=,cref,mi/ms.,(cid:112),•,•,•,Solve,the,ion,(32),and,neutral,(33),drift,kinetic,equations,for,fi,and,fn,within,a,at,the,previous,time,step,,Runge-Kutta,stage,,provided,the,parallel,electric,field,E,∥,and,subject,to,the,appropriate,boundary,conditions,(22)-(25).,With,fi,and,fn,updated,,calculate,the,ion,density,and,parallel,flow,,and,set,ne,=,ni,and,ue,=,ui,at,the,new,Runge-Kutta,stage.,the,updated,electron,Iteratively,solve,the,coupled,equations,(37)-(41),distribution,ge,and,the,corresponding,heat,flux,q,,e.,The,∥,boundary,values,for,the,potential,ϕ,will,be,determined,such,that,the,moment,constraints,on,ge,are,satisfied,at,the,boundaries.,,e,and,parallel,pressure,p,∥,for,6,NUMERICAL,APPROACH,9,Solve,the,electron,parallel,momentum,equation,(36),for,the,parallel,electric,field,E,∥,.,Repeat.,•,•,There,are,various,options,for,solving,the,electron,kinetic,equation,(40).,We,have,tried,three,different,possibilities:,an,iterative,method,,a,shooting,method,,and,a,relaxation,method.,Thus,far,,none,of,the,methods,we,have,attempted,have,resulted,in,a,steady-state,solution,for,the,electron,distribution,function.,As,we,have,focused,primarily,on,the,relaxation,method,,we,describe,it,along,with,the,numerical,difficulties,we,have,encountered.,6.1.,Relaxation,method,The,relaxation,method,involves,adding,an,artificial,time,derivative,to,the,electron,kinetic,equation,and,evolving,it,in,time,until,a,steady-state,solution,is,obtained.,This,has,two,clear,advantages:,many,of,the,existing,techniques,for,solving,the,ion,kinetic,equation,can,be,re-used,,and,there,is,no,need,for,repeated,construction,and,decomposition,of,a,large,matrix,operator,as,may,be,the,case,for,an,iterative,method.,The,modified,,time-dependent,electron,kinetic,equation,to,be,solved,is,∂ge,∂˜t,+,w,˜vth,e,∥,∂ge,∂,˜z,+,(cid:18),˜vth,e,2˜p,∥,,e,∂,˜p,,e,∥,∂,˜z,+,w,2˜p,∥,∥,,e,∂,˜q,,e,∥,∂,˜z,−,∂˜vth,e,∂,˜z,w2,∥,(cid:19),∂ge,∂w,∥,=,˜G.,(42),This,equation,is,currently,solved,using,an,explicit,(forward,Euler),time,advance,method,,with,options,to,treat,the,derivatives,using,either,a,two-point,,upwinded,finite,difference,scheme,or,the,same,Chebyshev,spectral,element,scheme,employed,for,the,ion,and,neutral,kinetic,equations.,There,is,the,option,to,evolve,the,electron,kinetic,equation,with,a,fixed,,e,(obtained,via,explicit-in-time,solution,of,the,electron,energy,equation),or,to,evolve,p,∥,,e,in,tandem,with,the,kinetic,equation.,the,energy,equation,for,p,∥,In,the,rest,of,this,section,,we,will,discuss,some,other,notable,details,of,the,numerical,implementation,,including,treatment,of,the,initial,and,boundary,conditions.,We,will,then,describe,the,current,state,of,the,simulation,results,in,the,final,section.,6.2.,Initial,condition,for,ge,As,we,seek,a,solution,to,the,electron,kinetic,equation,that,is,time-independent,(for,given,values,of,the,ion,density,and,parallel,flow),,the,initial,conditions,on,ge,and,p,,e,are,in,∥,principle,unimportant.,However,,choosing,an,initial,condition,for,ge,with,discontinuities,or,other,unsavoury,behaviour,could,potentially,lead,to,numerical,instabilities,or,to,ge,going,negative,over,part,of,the,phase,space.,We,have,attempted,to,avoid,such,issues,by,choosing,a,distribution,function,that,smoothly,varies,from,a,Maxwellian,distribution,of,velocities,at,the,centre,of,the,domain,in,z,to,a,Maxwellian,with,a,cutoff,velocity,at,the,6,NUMERICAL,APPROACH,walls.,The,particular,form,we,use,is,ge(z,,w,∥,,,t,=,0),=,e−,(cid:16),1,−,e−,×,−,))/vth,e(z,±,w2,∥,(cid:16),1,b(z,e−,−,z−)2,tanh,(cid:0)a,(cid:0)w,b(z,z+)2,−,tanh,(cid:0),−,a,(cid:0)w,∥,−,∥,−,(cid:1)(cid:1)(cid:17),wc,,−,(cid:1)(cid:1)(cid:17),wc,+,,,±,=,(vc,,ue(z,±,where,wc,,),and,a,and,b,are,user-specified,parameters,(typically,chosen,to,be,10,and,100,,respectively).,We,then,normalise,ge,by,its,zeroth,velocity,moment.,A,visual,representation,of,this,distribution,function,is,provided,in,Fig.,1,for,a,case,with,wc,,±,−,1.,=,±,∓,10,(43),Figure,1.,A,sample,initial,condition,on,ge,,for,which,wc,±,=,1.,∓,6.3.,Enforcing,the,wall,BC,We,need,to,simultaneously,ensure,that,the,wall,boundary,conditions,and,the,integral,constraints,on,g,are,satisfied.,Here’s,how,we,do,this:,First,,we,interpolate,from,our,w,∥,=,0.,In,practice,,we,choose,to,use,the,same,grid,to,one,which,is,symmetric,about,v,∥,Gauss-Chebyshev-Lobatto,grid,in,v,.,Next,construct,the,distribution,∥,function,,g(0),that,is,used,in,w,=,0,via,∥,e,that,is,symmetric,about,v,∥,(cid:40),g(0),e,(z,±,,,v,∥,,,t),=,ˆge(z,±,ˆge(z,±,,,t),,,,t),,,,,,v,±,v,∓,∥,∥,&gt;,0,&lt;,0,,v,v,∥,∥,(44),−0.4−0.200.20.4z−4−3−2−101234w∥00.20.40.60.81,7,CURRENT,STATUS,11,where,ˆge,is,the,electron,distribution,function,from,the,previous,time,step,(or,iteration,,grid.,depending,on,the,algorithm,used).,Then,,interpolate,back,onto,the,original,w,∥,,,t),Next,,choose,the,cutoff,speeds,vc,,–,to,ensure,that,the,moment,constraint,(cid:82),dw,g(1),e,=,0,is,satisfied,,where,we,have,denoted,the,distribution,function,g(0),e,.,Finally,,we,ensure,satisfaction,of,the,remaining,moment,constraints,by,defining,our,final,distribution,function,ge,as,–,and,corresponding,electrostatic,potentials,ϕ(z,e,with,these,speed,cutoffs,as,g(1),w,±,±,∥,∥,ge(z,±,,,w,∥,,,t),=,(cid:0)A,±,+,B,±,v2,∥,exp,(cid:0),av2,∥,−,(cid:1),+,C,v4,∥,±,exp,(cid:0),bv2,∥,−,(cid:1)(cid:1),g(1),e,(z,±,,,w,∥,,,t),,(45),±,±,±,,,B,and,C,where,A,are,constants,that,will,be,fixed,by,demanding,that,the,moment,constraints,on,ge,be,satisfied.,The,form,of,the,velocity-dependent,pre-factor,is,arbitrary,,so,that,the,wall,boundary,condition,aside,from,the,fact,that,it,should,be,even,in,v,∥,continues,to,be,satisfied.,We,have,chosen,the,above,form,for,the,velocity-dependence,because,it,is,smooth,and,differentiable,(unlike,,e.g.,,terms,involving,),and,,with,appropriate,choices,for,a,and,b,,can,maintain,positivity,of,ge;,i.e.,,in,the,absence,of,the,Gaussian,weighting,factors,,we,found,that,the,modified,distribution,would,be,slightly,negative,at,larger,w,.,In,practice,,we,use,a,=,0.1,and,b,=,0.2.,By,imposing,the,moment,constraints,on,ge,,the,constants,are,found,to,be,v,∥|,|,∥,=,A,±,1,G00,,±,(cid:18),1,+,(cid:18),G21,,G40,,±,G41,,±,(cid:19),±,G20,,±,−,B,±,(cid:19),,,(46),G21,,G42,,±,G41,,±,±,+,G02,,G00,,±,±,(cid:18),G21,,G40,,±,G41,,±,(cid:19)(cid:19)−,1,,,(47),±,G20,,±,−,(cid:18),1,2,−,G02,,G00,,±,±,(cid:19),(cid:18),G22,,±,−,=,B,±,and,with,=,C,±,B,±,−,G21,,G41,,±,,,±,(cid:90),vj,∥,With,these,choices,,one,can,verify,that,Gjk,,dw,=,±,∥,wk,∥,g(1),e,(z,±,,,w,∥,,,t).,(cid:90),dw,∥,(cid:0)1,,w,∥,,,w2,∥,(cid:1),ge(z,±,,,w,∥,(cid:18),,,t),=,1,,0,,(cid:19),,,1,2,as,required.,An,example,of,this,process,is,illustrated,in,Fig.,2.,7.,Current,status,(48),(49),(50),We,have,tried,solving,this,equation,using,an,explicit,(forward,Euler),time,advance,,using,both,the,Chebyshev,spectral,element,scheme,employed,successfully,for,the,ion,and,neutral,kinetic,equations,and,a,two-point,,upwind,finite,difference,scheme.,We,have,also,tried,solving,the,equation,with,a,fixed,p,,e,obtained,via,explicit,advance,of,∥,the,electron,energy,equation,and,by,evolving,the,energy,equation,in,tandem,with,the,7,CURRENT,STATUS,12,Figure,2.,Illustration,of,the,process,for,ensuring,that,ge,satisfies,both,the,wall,boundary,conditions,and,the,moment,constraints.,Shown,in,red,is,the,initial,distribution,at,z−,,with,the,symmetrised,distribution,in,blue,,inclusion,of,the,cutoff,in,purple,and,the,final,distribution,satisfying,all,of,the,constraints,in,black.,electron,kinetic,equation.,In,all,cases,,we,have,been,unable,to,find,a,steady-state,solution,for,ge,at,the,initial,ion-time-scale,step.,Indicative,data,showing,how,the,simulations,evolve,is,given,in,Fig.,3.,Generally,,we,find,that,the,time,step,required,to,satisfy,the,CFL,condition,for,the,electron,kinetic,equation,becomes,prohibitively,small,,and,this,is,accompanied,by,the,development,of,sharp,changes,in,the,parallel,heat,flux,at,the,boundaries,in,z,,followed,by,sharp,changes,of,the,parallel,pressure,at,the,boundaries.,These,oscillations,then,spread,into,the,rest,of,the,z,domain.,The,distribution,function,at,the,boundaries,also,develop,grid-scale,oscillations,in,w,=,0.,∥,and,z,have,been,implemented,Artificial,dissipation,terms,in,the,form,of,diffusion,in,w,in,the,electron,kinetic,equation,,but,they,do,not,seem,to,eliminate,these,sharp,features.,There,are,numerous,possibilities,for,why,we,have,been,unable,to,obtain,a,steady-,that,originate,near,v,∥,∥,state,solution,for,ge.,We,provide,a,non-exhaustive,list,here:,•,There,is,a,bug,in,the,code.,We,have,tried,to,minimise,the,likelihood,of,this,by,performing,three,main,tests.,First,,we,artificially,set,the,advection,speeds,in,z,and,w,so,that,we,could,solve,analytically,for,ge,(and,this,test,passed).,Second,,we,verified,that,the,time-evolved,solution,to,the,electron,to,be,independent,of,z,and,w,∥,∥,00.20.40.60.81−4−3−2−101234gew∥initialsymmetriccutofffinal,7,CURRENT,STATUS,13,Figure,3.,Snapshots,showing,the,evolution,of,the,electron,parallel,heat,flux,(top,left),,pressure,(top,right),,thermal,speed,(bottom,right),and,modified,distribution,function.,The,three,fluid,quantities,are,plotted,as,a,function,of,location,along,the,field,line,,z,at,the,same,five,time,slices.,The,pressure,and,thermal,speed,increase,in,magnitude,and,develop,strong,gradients,near,the,boundaries,in,z,before,ringing,behaviour,appears,at,the,boundaries.,The,modified,distribution,function,ge,at,the,right,boundary,in,z,is,shown,as,a,function,of,w∥.,The,first,three,time,slices,are,the,same,as,for,the,fluid,quantities,,and,one,can,see,ge,develop,a,dip,at,w∥,=,0,that,is,the,consequence,of,forcing,a,symmetric,distribution,about,v∥,=,0.,The,final,time,slice,at,which,ge,is,plotted,is,earlier,than,the,corresponding,slices,for,the,fluid,quantities:,This,is,because,ge,has,already,developed,grid-scale,oscillations,around,w∥,=,0,that,quickly,grow,in,amplitude,as,time,continues.,kinetic,equation,satisfies,the,required,moment,constraints,to,within,the,accuracy,of,the,numerical,scheme.,Third,,we,verified,that,with,the,appropriate,source,,a,Maxwellian,manufactured,solution,satisfied,the,steady-state,kinetic,equation,with,a,residual,that,decreased,with,increasing,resolution.,However,,the,manufactured,solution,could,not,be,obtained,when,initialising,with,a,ge,different,from,the,expected,solution.,Related,to,the,first,item,,it,may,be,that,steady-state,solutions,for,ge,with,the,specified,ion,plasma,profiles,are,unstable.,Another,possibility,is,that,the,use,of,fixed,profiles,for,the,ion,density,and,parallel,•,•,−15−10−50510−0.4−0.200.20.4˜q∥,ezt=0.000005t=0.000031t=0.000067t=0.000080t=0.00009000.511.522.53−0.4−0.200.20.4˜p∥,ezt=0.000005t=0.000031t=0.000067t=0.000080t=0.0000902030405060708090100110−0.4−0.200.20.4˜vth,ez00.20.40.60.811.21.4−4−3−2−101234ge(z+)w∥t=0.000005t=0.000031t=0.000067t=0.000074,7,CURRENT,STATUS,14,flow,prohibit,steady-state,solutions,(or,maybe,just,stable,solutions),of,the,electron,kinetic,equation,with,the,specified,wall,boundary,conditions.,One,possible,solution,for,this,would,be,to,evolve,the,ion,quantities,at,the,same,time,as,the,electron,ones,,though,this,would,be,numerically,costly.,•,•,The,initial,condition,on,the,electron,parallel,pressure,may,not,be,conducive,to,finding,a,steady-state,ge,,and,obtaining,such,a,solution,via,coupled,evolution,of,p,,e,may,simply,be,prohibitively,expensive.,∥,The,numerical,approach,taken,to,ensure,satisfaction,of,the,wall,boundary,conditions,and,the,moment,constraints,may,be,problematic.,Fig.,3,suggests,this,could,be,the,case.,Modifications,could,be,made,to,the,procedure,described,in,Section,6.3,to,try,to,improve,the,robustness,of,the,boundary,condition.,As,the,numerical,issues,appear,to,originate,at,the,boundaries,,it,seems,like,the,natural,place,to,probe,next,to,overcome,the,numerical,difficulties.,Ultimately,,we,should,identify,the,source,of,the,oscillations,in,the,boundary,distribution,,but,an,intermediate,solution,may,be,to,simply,smooth,the,boundary,distribution,every,time,step,via,,e.g.,,filtering,out,high,frequency,components,in,w,.,∥,7,CURRENT,STATUS,15,[1],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,2d,drift,kinetic,model,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,7:2047357–TN–07–02,M1.4,,2021.,[2],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,1d,drift,kinetic,models,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,5:2047357–TN–05–01,M1.3,,2021.,[3],S.,I.,Braginskii.,Transport,phenomena,in,a,completely,ionized,two-temperature,plasma.,Sov.,Phys.,JETP,,6:358,,1958.,[4],M.,Knudsen.,Das,cosinusgesetz,in,der,kinetischen,gastheorie.,Annal.,Phys.,,353:1113,,1916.,[5],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,drift,kinetic,models,for,parallel,dynamics,in,the,plasma,edge.,Excalibur/Neptune,Report,,14:2047357–TN–14,D2.2,,2022.,[6],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,boltzmann.toml.,[7],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,braginskii_boltzmann_test.toml.,[8],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,braginskii_colls.toml." name="keywords" />

    <title>TN-08_NumericalImplementationMomentKineticElectrons &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tn-08-numericalimplementationmomentkineticelectrons">
<h1>TN-08_NumericalImplementationMomentKineticElectrons<a class="headerlink" href="#tn-08-numericalimplementationmomentkineticelectrons" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/TN-08_NumericalImplementationMomentKineticElectrons.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TN-08_NumericalImplementationMomentKineticElectrons.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>