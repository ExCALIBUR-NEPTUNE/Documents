
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="Excalibur-Neptune,report,2047356-TN-11-1,Task,3,Considerations,for,1D1V,models,Report,covering,tasks,3.1,,3.2,and,3.3,Ben,Dudson,,Peter,Hill,,Ed,Higgins,,David,Dickinson,,and,Steven,Wright,University,of,York,David,Moxey,KCL,March,31,,2022,Contents,1,Executive,summary,2,Introduction,3,Test,cases,3.1,Uncoupled,species,:,Simple,1D,advection,.,.,.,.,.,.,.,.,.,.,.,.,.,3.1.1,Single,velocity,advection,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,3.1.2,Multiple,velocity,advection,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,3.1.3,Multiple,velocity,advection,-,phase,mixing,.,.,.,.,.,.,.,.,.,3.2,Uncoupled,species,:,Imposed,potential,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,3.2.1,Uniform,electric,ﬁeld,,uniform,density,.,.,.,.,.,.,.,.,.,.,.,3.2.2,Uniform,electric,ﬁeld,,varying,density,.,.,.,.,.,.,.,.,.,.,.,3.2.3,Spatially,uniform,electric,ﬁeld,with,temporal,variation,.,.,3.2.4,Spatially,varying,electric,ﬁeld,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,2,2,5,5,5,6,7,7,8,8,9,9,3.3,Self-consistent,electric,ﬁeld,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,10,3.3.1,Coupled,species,:,Stationary,ions,-,Electron,plasma,wave,-,Landau,damping,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,10,3.3.2,Coupled,species,:,Mobile,ions,-,Sound,wave,.,.,.,.,.,.,.,.,11,4,Phase,space,11,4.1,Finite,diﬀerence,implementation,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,14,4.2,Finite,volume,implementation,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,16,4.3,Brief,comment,on,performance,of,python,implementations,.,.,.,.,18,4.4,Community,codes,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,20,5,Time,integration,20,1,6,Summary,7,References,A,Example,GS2,input,ﬁle,:,Periodic,slab,test,case,1,Executive,summary,23,25,30,This,report,documents,some,of,the,work,around,tasks,83-3.1,,83-3.2,and,83-3.3,looking,at,the,Vlasov-Ampere,system,in,a,periodic,1D+1V,domain.,A,num-,ber,of,test,cases,are,deﬁned,and,some,of,the,considerations,around,phase-space,representations,and,time,integration,are,discussed.,Whilst,simple,python,im-,plemenations,of,this,system,have,been,produced,,it,is,likely,that,future,work,should,seek,to,move,towards,the,use,of,existing,realistic,production,codes,,fur-,ther,building,on,the,lessons,learned,in,their,development.,2,Introduction,In,this,work,we,are,considering,the,Vlasov-Ampere,system,in,one,dimension.,This,is,a,kinetic,problem,and,we,refer,to,the,domain,as,1D1V.,The,goal,of,this,work,is,to,explore,some,of,the,considerations,that,should,be,made,in,designing,a,code,to,model,such,a,system,and,to,provide,some,reference,implementations,as,a,basis,for,future,study.,The,document,is,structured,as,follows;,suitable,test,cases,of,increasing,complexity,are,outlined,in,section,3,,considerations,around,the,representation,of,phase-space,and,numerical,approaches,are,discussed,in,section,4,,a,brief,discussion,of,diﬀerent,time,integration,approaches,is,given,in,section,5,and,we,ﬁnish,with,a,summary,and,look,to,the,future,in,section,6.,Before,we,progress,it,is,helpful,to,set,out,the,system,and,discuss,normalisations.,The,Vlasov-Ampere,system,we,study,(system,2-4,of,reference,[1]),evolves,the,Vlasov,equation,for,ions,and,electrons,and,Ampere’s,equation,for,the,electric,ﬁeld.,In,one,dimension,we,may,write,the,Vlasov,equation,for,species,s,as,∂fs,∂t,+,vs,∂fs,∂x,+,qs,ms,E,∂fs,∂v,=,0,(1),2,and,Ampere’s,equations,as,(cid:15)0,∂E,∂t,+,J,−,J,=,0,(2),where,the,overline,indicates,a,spatially,average,quantity,and,the,current,denisty,,J,,is,given,by,with,J,=,(cid:88),s,qsnsus,nsus,=,(cid:90),∞,−∞,vfsdv,(3),(4),is,the,ﬁrst,ﬂuid,moment,of,the,distribution,function,(i.e.,bulk,ﬂow,density).,Due,to,the,short,temporal,and,spatial,scales,typically,associated,with,electron,dynamics,we,use,these,as,the,source,of,our,relevant,normalisations.,We,nor-,malise,charge,,mass,,density,and,temperature,to,the,corresponding,electron,values,,qe,,me,,ne,0,and,Te,0,respectively.,We,normalise,spatial,scales,to,the,Debye,length,,λD,,λD,=,(cid:115),(cid:15)0Te,neq2,e,and,velocity,scales,to,the,electron,thermal,velocity1,,vth,e,vth,e,=,(cid:114),Te,me,.,This,leads,to,a,natural,temporal,scale,length,of,1/ωpe,,with,ωpe,=,(cid:115),neq2,e,(cid:15)0me,The,electric,ﬁeld,is,normalised,to,EN,where,EN,=,(cid:114),2neTe,(cid:15)0,(5),(6),(7),(8),We,can,note,that,this,is,equivalent,to,normalising,the,energy,density,of,the,electric,ﬁeld,,U,=,(cid:15)0E2/2,,to,the,electron,thermal,energy,density,(i.e.,electron,pressure,,pe,=,neTe).,the,1Note,there,is,no,√,2,appearing,here.,3,This,leaves,the,distribution,function,and,related,current,density,requiring,nor-,malisation.,Whilst,one,may,choose,to,simply,normalise,the,distribution,func-,tion,to,a,scalar,(e.g.,ne/vth,e),,it,may,be,convenient,to,normalise,to,a,velocity,dependent,function.,Mapping,fs,→,ˆfsfN,,,with,fN,the,distribution,function,normalisation,and,hats,representing,normalised,quantities,,we,can,note,that,∂fs,∂vs,→,1,vth,e,∂,ˆfsfN,∂ˆvs,Allowing,for,velocity,dependence,in,fN,this,becomes,fN,vth,e,(cid:34),∂,ˆfs,∂ˆvs,+,ˆfs,fN,∂fN,∂ˆvs,(cid:35),=,fN,vth,e,(cid:34),∂,ˆfs,∂ˆvs,+,ˆfs,∂,log,fN,∂ˆvs,(cid:35),(9),(10),with,the,latter,form,preferred,due,to,avoiding,the,explicit,division,by,fN,,,which,may,become,small.,It,should,be,possible,to,analyically,precompute,the,constant,∂,log,fN,for,common,choices,of,normalising,function.,We,retain,this,form,of,∂vth,e,the,derivative,here,,noting,that,choosing,a,scalar,fN,will,naturally,result,in,∂,log,fN,∂vth,e,→,0.,The,ﬂuid,ﬂow,velocity,can,be,normalised,similarly,nsus,=,ˆns,ˆusnevth,e,=,(cid:90),∞,−∞,dvvfs,=,(cid:90),∞,−∞,dˆvˆv,ˆfsfN,v2,th,e,(11),Here,we,see,ˆns,ˆus,=,vth,e,ne,(cid:90),∞,−∞,dˆvˆv,ˆfsfN,Introducing,ˆfN,=,fN,vth,e/ne,this,reduces,to,ˆns,ˆus,=,(cid:90),∞,−∞,dˆvˆv,ˆfs,ˆfN,and,we,can,deﬁne,ˆJ,=,(cid:80),s,ˆqs,ˆns,ˆus.,Under,these,normalisations,the,Vlasov,equation,becomes,∂,ˆfs,∂ˆt,+,ˆvs,∂,ˆfs,∂,ˆx,+,ˆqs,ˆms,ˆE,(cid:34),∂,ˆfs,∂ˆvs,+,ˆfs,∂,log,ˆfN,∂ˆvs,(cid:35),=,0,(12),(13),(14),4,and,Ampere’s,equation,is,√,2,∂,ˆE,∂ˆt,+,ˆJ,−,ˆJ,=,0,(15),Within,this,work,we,choose,to,study,our,normalised,system,,deﬁned,by,equa-,tions,14,,15,and,13,,in,a,periodic,one,dimensional,domain,with,zero,boundaries,at,v,→,±∞,and,up,to,two,plasma,species.,One,may,relax,these,constraints,readily,without,changing,the,form,of,the,equations.,3,Test,cases,The,Vlasov-Ampere,system,considered,here,evolves,the,distribution,function,for,ions,and,electrons,along,with,the,consistent,electric,ﬁeld.,Whilst,relatively,simple,in,appearance,,this,system,can,capture,a,number,of,interesting,and,com-,plex,physics,behaviours.,Here,,we,outline,some,useful,test,cases,for,exploring,the,behaviour,of,speciﬁc,implementations,of,this,system.,3.1,Uncoupled,species,:,Simple,1D,advection,We,note,that,for,systems,in,which,the,electric,ﬁeld,is,zero,(either,physically,or,artiﬁcially,imposed),,the,ions,and,electrons,are,uncoupled,and,the,individual,Vlasov,equations,reduce,to,advection,in,one,dimension.,Here,we,propose,several,tests,in,this,limit.,3.1.1,Single,velocity,advection,Advection,of,initial,conditions,at,a,single,,ﬁxed,speed,,v,in,a,periodic,box,of,length,L,=,1,for,t,=,N,L/v,with,N,∈,[1,,2,,5,,10],(for,example).,Here,we,expect,to,ﬁnd,the,initial,condition,is,rigidly,advected,back,to,the,starting,location.,One,can,therefore,measure,the,error,by,comparing,the,ﬁnal,result,with,the,initial,conditions.,This,should,be,tested,for,both,smooth,and,non-smooth,initial,conditions.,Speciﬁc,examples,are,a,sin,wave,,f,(x),=,sin,2πx/L,,a,Gaussian,,f,(x),=,exp,−(x,−,L/2)2,,and,a,top-hat,,f,(x),=,H(0.4L)[1,−,H(0.6L)],,with,H,5,the,Heaviside,step,function.,An,example,for,N,=,1,is,shown,in,ﬁgure,1,for,the,Finite,Volume,solver,discussed,in,section,4.2.,A,small,extension,to,this,test,is,to,change,from,periodic,to,Dirichlet,boundary,conditions.,Rather,than,testing,the,function,once,it,returns,to,the,starting,point,one,will,need,to,calculate,the,expected,location,after,a,given,time,and,then,compare,the,numerical,result,against,the,initial,condition,shifted,by,the,expected,amount.,(a),(b),(c),Figure,1:,Comparison,of,the,results,from,a,ﬁnite-volume,1D,solver,for,periodic,advection,of,sin,(a),,Gaussian,(b),and,top-hat,(c),initial,conditions,for,diﬀerent,ﬂux,limiters.,3.1.2,Multiple,velocity,advection,Advection,of,initial,conditions,for,a,grid,of,velocities.,Each,velocity,is,indepen-,dent,of,all,others,in,this,system.,As,such,,this,should,be,equivalent,to,running,the,ﬁrst,test,for,a,range,of,speeds.,This,test,case,enables,exploration,of,1D,advection,in,the,1D1V,grid,setup,and,also,introduces,the,impact,of,having,a,range,of,velocities,on,the,time,integration,,for,example.,6,3.1.3,Multiple,velocity,advection,-,phase,mixing,Repeating,the,test,of,section,3.1.2,with,initial,conditions,representing,a,Maxwellian,multiplied,by,a,sinusoidal,variation,one,expects,the,distribution,function,to,simply,advect,,remaining,undamped.,However,,the,moments,of,the,distribution,function,are,expected,to,damp,out,due,to,phase-mixing.,For,example,,it,can,be,shown,by,taking,the,zeroth,moment,of,the,Vlasov,equation,,that,the,density,is,expected,to,look,like,n(t),=,n(0),exp,(cid:104),−,(cid:0)k(cid:107)vtht(cid:1)2,(cid:105),/2,(16),This,phase,mixing,is,apparent,in,plots,of,the,distribution,function,as,structures,becoming,increasingly,sheared.,This,test,case,tests,the,ability,to,resolve,these,structures,for,a,given,implementation,as,well,as,allowing,tests,of,the,velocity,space,integration.,An,example,of,the,density,dependence,on,time,from,such,a,system,simulated,by,GS2,[2],is,shown,in,ﬁgure,2,for,various,velocity,resolutions.,One,can,see,that,the,numerical,solutions,track,the,analytic,result,for,increasing,amounts,of,time,as,the,velocity,resolution,is,increased.,Here,the,velocity,reso-,lution,only,impacts,on,the,calculation,of,the,density,and,does,not,enter,the,rest,of,the,simulation,in,this,setup,in,which,the,electric,ﬁeld,has,been,removed2.,The,input,ﬁle,for,the,medium,resolution,simulation,is,provided,in,section,A.,The,output,of,this,test,will,be,sensitive,to,numerical,dissipation.,3.2,Uncoupled,species,:,Imposed,potential,The,next,set,of,test,cases,aim,to,test,the,advection,is,to,explore,the,advection,in,the,presence,of,an,imposed,potential,or,electric,ﬁeld.,This,allows,one,to,test,the,coupled,advection,in,x,and,v,whilst,avoiding,complications,introduced,by,the,inclusion,of,a,self-consistently,calculated,electric,ﬁeld.,This,keeps,the,two,plasma,species,uncoupled,such,that,we,can,study,either,in,isolation.,2In,other,words,,each,velocity,point,is,independent,in,the,evolution,of,the,distribution,function.,7,Figure,2:,The,density,as,a,function,of,time,from,a,periodic,slab,simulated,by,the,gyrokinetic,code,GS2,for,varying,velocity,resolutions,,alongside,the,analytic,solution,n(0),exp,(−t2/2).,3.2.1,Uniform,electric,ﬁeld,,uniform,density,The,simplest,test,case,is,introduce,an,initial,distribution,function,which,is,uni-,form,in,the,parallel,direction,and,has,arbitrary,structure,in,velocity.,Introducing,a,uniform,electric,ﬁeld,into,this,system,we,expect,to,see,rigid,advection,in,the,±v,direction,depending,on,the,relative,sign,of,the,ﬁeld,and,charge.,This,pro-,vides,a,simple,sanity,check,of,the,implementation,,but,also,allows,the,impact,of,the,velocity,space,boundary,conditions,to,be,explored.,3.2.2,Uniform,electric,ﬁeld,,varying,density,A,small,extension,to,the,test,of,section,3.2.1,is,to,modify,the,initial,distribution,to,include,smooth,spatial,variation.,This,should,initially,provide,similar,results,to,the,earlier,test,described,in,section,3.1.2,,except,with,shift,in,the,velocity,8,which,occurs,at,a,constant,rate.,This,should,accelerate,the,rate,at,which,phase,mixing,occurs.,3.2.3,Spatially,uniform,electric,ﬁeld,with,temporal,variation,The,test,of,section,3.2.1,can,be,further,modiﬁed,to,make,the,imposed,electric,ﬁeld,time,dependent.,This,will,cause,sinusoidal,motion,in,the,velocity,direction,and,,for,appropriate,settings,,can,take,structure,close,to,one,boundary,and,then,away,from,it,again.,This,can,be,a,good,test,of,the,numerical,stability,near,to,the,boundary.,3.2.4,Spatially,varying,electric,ﬁeld,Adding,a,spatially,varying,,constant,in,time,,electric,ﬁeld,to,the,system,modiﬁes,the,contours,of,constant,total,energy,(∼,v2/2,+,φ),such,that,they,no,longer,run,parallel,to,the,spatial,direction.,This,can,lead,to,the,introduction,of,potential,wells,,seen,as,contours,of,constant,total,energy,which,are,closed,without,crossing,the,parallel,boundary.,Particles,can,then,become,trapped,in,these,wells,and,they,are,no,longer,free,to,sample,the,entire,parallel,space.,Instead,they,follow,closed,trajectories,in,phase,space,which,take,them,from,positive,velocity,,to,negative,and,back,again.,This,is,generally,seen,as,rotating,structures,in,phase,space.,The,nature,of,this,rotation,depends,on,the,structure,of,the,imposed,potential.,Here,we,propose,two,main,cases,to,test.,Firstly,an,imposed,potential,of,the,form,cos(x),which,satisﬁes,our,periodic,boundary,conditions,and,is,likely,to,play,a,role,in,realistic,simulations3.,Secondly,we,propose,a,potential,of,the,form,(x,−,L/2)2.,This,is,motivated,to,make,the,contours,of,total,energy,concentric,circles.,As,a,result,,structures,within,the,last,closed,contour,(where,the,kinetic,energy,just,matches,the,maximum,potential,energy),should,rotate,as,a,solid,body.,Examples,of,these,two,cases,are,given,in,reference,[3],and,sample,results,from,a,ﬁnite,volume,solver,are,shown,in,ﬁgure,3.,One,further,test,case,would,be,to,introduce,a,non-smooth,electric,ﬁeld,,such,as,a,top-hat,function.,This,will,help,test,the,ability,to,handle,sharp,features.,3This,is,the,fundamental,mode,of,the,Fourier,basis,and,a,Fourier,representation,is,likely,to,do,a,good,job,of,representing,all,solutions,in,our,simple,periodic,system.,9,(a),(b),(c),(d),Figure,3:,The,distribution,function,as,a,function,of,x,(x-axis),and,v,(y-axis),for,two,diﬀerent,times,in,simulations,with,imposed,potentials,of,the,form,cos,2πx,(a/b),and,(x,−,L/2)2,(c/d).,3.3,Self-consistent,electric,ﬁeld,We,now,turn,our,attention,to,simulations,with,an,electric,ﬁeld,calculated,self-,consistently,from,Ampere’s,equation.,This,case,now,allows,electrons,and,ions,to,be,coupled,together,and,we,can,start,to,observe,physical,behaviour.,We,therefore,propose,simple,test,cases,based,on,capturing,physics,phenomena.,3.3.1,Coupled,species,:,Stationary,ions,-,Electron,plasma,wave,-,Landau,damping,We,begin,by,considering,cases,in,which,the,ions,are,considered,stationary,due,to,their,relatively,large,mass.,This,is,a,good,approximation,for,high,frequency,behaviour,(i.e.,ω,∼,ωpe),and,short,scale,lengths,(i.e.,L,∼,λD).,Noting,our,10,choice,to,normalise,temporal,scales,to,ωpe,and,length,scales,to,λD,we,expect,stationary,ions,to,be,a,good,approximation,whilst,we,consider,O(1),normalised,times,and,lengths.,As,ions,are,stationary,they,do,not,contribute,to,the,current,density,,J,,and,one,most,simply,ensure,that,their,contribution,is,included,in,the,calculation,of,the,initial,electric,ﬁeld,to,ensure,self-consistent,initial,conditions.,One,of,the,most,basic,plasma,behaviour,is,the,electron,plasma,oscillation.,Here,,a,small,perturbation,to,the,electron,density,results,in,a,perturbed,electric,ﬁeld,out,of,phase,with,the,density,perturbation.,This,acts,to,rectify,the,density,perturbation,,accelerating,electrons,back,to,the,uniform,equilibrium.,The,elec-,trons,overshoot,,however,,and,the,system,reverses.,This,results,in,an,oscillation,with,a,characteristic,frequency,given,by,ωpe.,In,a,simple,two-ﬂuid,picture,this,oscillation,should,continue,unabated.,In,a,kinetic,system,it’s,possible,for,wave-,particle,interactions,to,damp,the,wave,through,a,process,known,as,Landau,damping.,Taking,the,wavenumber,of,the,perturbation,small,compared,to,the,Debye,length,should,minimise,the,damping,and,allow,one,to,observe,the,plasma,oscillation,,whilst,taking,k,∼,λD,will,result,in,damping,,for,which,there,are,an-,alytic,approximations[4].,This,helps,to,test,the,performance,of,the,phase-space,treatment.,It,may,be,helpful,to,apply,a,parallel,ﬁlter,such,that,only,one,Fourier,harmonic,is,permitted,in,the,system.,3.3.2,Coupled,species,:,Mobile,ions,-,Sound,wave,Finally,we,consider,lower,frequency,oscillations,such,that,ions,can,dominate,the,dynamics.,In,particular,the,plasma,sound,wave,,in,which,electrons,follow,the,ions,to,maintain,quasineutrality,,is,a,suitable,test,case.,This,has,a,similar,setup,to,the,electron,plasma,wave,system,,except,the,problem,scale,is,diﬀerent.,4,Phase,space,Now,that,suitable,test,cases,have,been,set,out,we,can,turn,our,attention,to,the,numerical,representation,and,solution,of,the,system.,There,are,many,aspects,which,must,be,considered,when,deciding,which,approach,to,take,and,the,re-,sulting,choice,will,vary,depending,on,the,motivation,at,hand.,Here,we,brieﬂy,discuss,some,of,the,diﬀerent,competing,factors,before,turning,our,attention,to,11,the,diﬀerent,numerical,approaches.,Generally,,time,to,solution,is,a,primary,metric,motivating,design,decisions,when,developing,new,code.,This,is,often,a,balance,between,the,time,to,design,,im-,plement,and,test,the,code,against,the,time,it,takes,for,the,resulting,code,to,run,to,completion.,For,any,code,which,will,be,used,by,a,large,community,it,is,generally,worth,time,to,carefully,design,and,test,the,code,,as,the,perfor-,mance,and,robustness,improvements,gained,from,this,will,beneﬁt,many,users,over,many,simulations.,The,design,of,such,a,code,will,further,be,inﬂuenced,by,how,well,the,problems,to,be,solved,can,be,constrained,-,in,other,words,is,there,one,clear,system,to,be,solved,in,all,cases,,or,can,the,system,of,equations,be,varied,somewhat.,Finally,,one,must,also,consider,the,extensibility,of,the,code,-,will,the,capability,of,the,code,be,frozen,or,do,the,developers,envisage,this,evolving,signiﬁcantly,in,time.,Whilst,these,considerations,may,not,immediately,appear,to,directly,inﬂuence,the,choice,of,phase-space,treatment,,these,aspects,can,in,fact,be,closely,coupled.,For,example,,whilst,a,Fourier,treatment,of,the,periodic,parallel,direction,may,appear,appealing,within,system,2-4,,building,a,code,around,this,choice,would,prohibit,a,future,change,to,non-periodic,bound-,aries,and,would,also,have,implications,for,the,potential,parallelisation,of,the,code.,From,a,performance,perspective,,we,wish,for,a,treatment,of,phase-space,which,allows,for,eﬃcient,parallel,scaling,(e.g.,neighbour,limited,communication),and,high,arithmetic,intensity,with,loop,kernels,which,can,make,eﬃcient,use,of,accel-,erators.,At,the,same,time,,the,approach,should,be,memory,eﬃcient,Our,choice,must,also,be,able,to,robustly,treat,relevant,physical,behaviours,,such,as,the,appearance,of,shocks.,We,begin,by,comparing,broad,approaches,to,the,solution,of,partial,diﬀerential,equations,(PDE);,ﬁnite,diﬀerence,(FD),,ﬁnite,volume,(FV),and,ﬁnite,element,method,(FEM).,For,all,such,methods,one,must,consider,how,one,uses,an,approx-,imate,solution,to,represent,the,true,solution,and,how,this,approximate,solution,satisﬁes,the,PDE.,Let,us,consider,the,simple,advection,problem,∂f,∂t,+,∇,·,(uf,),=,0,(17),In,the,FD,approach,we,span,the,domain,with,a,grid,and,can,approximate,derivatives,using,discrete,diﬀerence,of,values,associated,on,this,grid.,We,as-,12,sume,the,solution,is,locally,smooth,,approximated,by,local,polynomials,,and,that,our,approximate,solution,satisﬁes,the,PDE,on,the,grid,points,but,not,be-,tween,them.,Such,schemes,are,relatively,intuitive,and,it,is,typically,simple,to,implement,compact,stencils,,limiting,the,direct,coupling,across,the,grid.,Unfor-,tunately,such,methods,are,not,well,suited,to,capturing,sharp,transitions,,can,struggle,with,complex,boundaries,and,can,be,diﬃcult,to,adapt,in,response,to,the,evolution,of,the,system.,Finite,volume,methods,move,from,the,point,based,approach,of,FD,to,an,element,based,approach,,in,which,we,split,the,domain,into,“cells”,and,represent,the,solution,as,the,average,across,the,cell.,This,al-,lows,greater,ﬂexibility,in,adapting,the,cells,to,the,geometry,of,the,system.,In,these,methods,the,time,derivative,of,the,cell,averaged,value,is,dependent,on,the,ﬂuxes,,uf,,,evaluated,at,the,interfaces,with,neighbouring,cells.,This,allows,for,better,conservation,properties,than,FD,schemes,,but,adds,the,complication,of,evaluating,the,ﬂuxes,on,the,interface,,where,the,cell,averages,are,discontinuous.,There,are,several,possible,approaches,to,this.,One,is,to,assume,the,solution,takes,the,cell,average,at,the,centre,of,the,cell,and,to,then,extrapolate,from,this,point,to,the,interface,using,an,approximation,of,the,derivative,at,this,point.,This,provides,diﬀerent,estimates,of,the,ﬂux,either,side,of,the,interface,and,one,must,solve,a,Riemann,problem,to,determine,a,unique,value,here4.,Such,meth-,ods,are,typically,equivalent,to,FD,in,practice,but,provide,a,more,convenient,formulation.,Alternatively,one,may,seek,a,continuous,interpolating,polynomial,,known,as,reconstruction.,Consider,seeking,a,quadratic,approximation,within,the,cell.,To,uniquely,deﬁne,a,quadratic,one,requires,three,pieces,of,informa-,tion.,In,a,FD,approach,,one,may,take,the,value,of,the,solution,on,the,grid,point,of,interest,and,either,side,of,it.,In,FV,rather,than,choosing,the,value,of,the,function,at,three,locations,we,choose,to,use,the,function,average,over,three,regions,,specicially,this,cell,and,the,cell,either,side.,This,provides,a,quadratic,approximation,valid,within,the,cell,of,interest,,giving,a,second,order,method,for,evaluating,the,function,on,the,interface.,The,extrapolation/interpolation,used,in,FV,methods,to,ﬁnd,interface,values,,at,second,order,,are,prone,to,in-,troducing,additional,extrema,into,the,solution,when,the,solution,is,not,smooth.,To,avoid,this,FV,methods,are,typically,used,in,conjunction,with,ﬂux,limiters,,which,eﬀectively,apply,further,constraints,to,the,calculation,of,the,interface,values,in,order,to,avoid,new,extrema,and,preserve,positivity.,Whilst,it,is,pos-,sible,to,extend,the,FV,approach,to,higher,orders,,such,as,through,higher,order,reconstruction,like,the,PPM,method,[5],,at,the,expensive,of,coupling,to,more,cells,,this,becomes,increasingly,challenging,when,going,beyond,one,dimension.,13,Finite,element,methods,seek,to,improve,on,this,further.,Rather,than,consider-,ing,a,cell,to,be,a,bounded,region,centred,on,a,grid,point,,with,a,single,value,across,this,range,,in,a,FEM,method,the,cells,(or,elements),are,bounded,by,grid,points,and,we,choose,to,represent,the,local,solution,in,terms,of,a,local,basis.,The,ability,to,adapt,the,order,of,the,basis,and,size,of,the,elements,is,an,ap-,pealing,beneﬁt,of,this,classical,FEM,scheme.,However,,diﬀerent,elements,share,one,grid,point,,coupling,together,all,elements,and,resulting,in,a,global,implicit,problem,to,be,solved.,There,is,also,the,complexity,in,choosing,an,appropriate,basis,function,for,the,problem,at,hand.,A,ﬁnal,extension,to,this,is,the,Discon-,tinuous,Galerkin,approach,to,FEM,(DG-FEM).,Here,we,decouple,the,values,on,the,nodes,,such,that,each,element,may,hold,a,diﬀerent,value,here,as,in,the,FV,approach.,This,then,requires,a,Riemann,like,solve,to,construct,a,unique,global,solution,,following,similar,methods,as,in,FV.,Such,approaches,are,often,referred,to,as,spectral-hp,methods,,to,reﬂect,the,fact,that,it,uses,high,order,polynomials,and,it,is,possible,to,adapt,both,the,size,of,the,elements,and,the,order,of,the,local,basis,as,required.,Overall,DG-FEM,appears,to,oﬀer,many,of,the,attractive,advantages,that,we,seek,,and,this,approach,is,likely,to,be,used,within,future,Neptune,codes.,For,more,information,on,diﬀerent,approaches,and,details,of,the,DG-FEM,approach,see,reference,[6].,Whilst,the,DG-FEM,approach,is,a,long,term,goal,,here,we,are,interested,in,implementations,that,allow,for,the,exploration,of,the,test,cases,outlined,in,section,3,and,are,less,concerned,with,the,performance,characteristics,of,the,resulting,implementation.,We,therefore,discuss,some,of,the,choices,to,be,made,in,FD,and,FV,schemes,for,this,system.,Implementations,of,these,approaches,have,been,produced,in,python,to,allow,exploration,of,some,of,these,aspects.,We,also,,however,,highlight,some,examples,of,“real”,community,codes,implementing,diﬀerent,approaches,in,section,4.4,which,could,be,used,in,the,next,stage,of,investigations.,4.1,Finite,diﬀerence,implementation,Here,we,consider,some,of,the,choices,to,be,made,in,the,construction,of,a,FD,approach,to,the,1D1V,system.,Firstly,we,consider,the,velocity,space,treatment.,4In,simple,problems,this,can,be,as,simple,as,taking,the,value,from,down,stream,of,the,ﬂow,,this,is,a,form,of,upwinding.,14,This,impacts,on,two,aspects;,the,advection,in,velocity,by,the,electric,ﬁeld,and,the,velocity,space,integrals,used,in,the,calculation,of,the,ﬂow,density,and,the,charge,density,for,us,in,the,calculation,of,the,evolving,and,initial,electric,ﬁeld,respectively.,The,simplest,approach,is,to,select,a,uniform,grid,spanning,the,region,v,∈,[−vl,,vl].,This,results,in,a,very,simple,system,which,can,make,use,of,standard,uniform,ﬁnite,diﬀerencing,approaches.,Considering,the,integration,,an,eﬃcient,choice,of,velocity,space,grid,is,determined,by,Gauss,quadrature,rules.,In,particular,,our,integration,is,over,v,∈,[−∞,,∞],and,a,Gauss-Hermite,quadrature,is,appealing.,This,quadrature,can,be,used,for,integrals,of,the,form,We,wish,to,evaluate,I,=,(cid:90),∞,−∞,exp,(cid:2)−v2(cid:3)f,(v)dv,I,=,(cid:90),∞,−∞,vfs(v)dv,(18),(19),If,one,evolves,the,full,distribution,function,fs,then,it,is,necessary,to,rescale,this,by,exp,v2,to,use,Gauss-Hermite,quadrature.,This,has,the,potential,to,greatly,amplify,small,amplitude,errors,near,the,velocity,boundaries.,To,avoid,this,recall,our,earlier,choice,to,map,fs,→,ˆfsfN,with,fN,a,potentially,velocity,dependent,normalisation.,By,choosing,fN,∝,exp,−v2,one,sees,that,I,=,(cid:90),∞,−∞,vfs(v)dv,=,(cid:90),∞,−∞,exp,(cid:2)−v2(cid:3)v,ˆfs(v)dv,(20),and,one,can,use,a,Gauss-Hermite,quadrature,with,argument,v,ˆfs.,Such,grids,al-,low,for,highly,accurate,integrals,but,one,notes,that,this,results,in,a,non-uniform,grid,spacing,and,removes,the,freedom,to,pack,points,aribtrarily.,One,possible,approach,to,improve,on,this,is,to,consider,switching,the,velocity,coordinate,to,energy,and,sign,of,parallel,velocity.,The,energy,domain,can,then,be,split,into,two,regions.,The,lower,,closed,,region,can,be,handled,with,a,Legendre,approach,,whilst,the,upper,region,can,utilites,a,Laguerre,approach.,Such,an,approach,is,used,by,GS2,[2],and,is,detailed,in,reference,[7].,Whilst,such,schemes,give,a,bit,more,ﬂexibility,we,fundamentally,give,up,control,over,our,grid,placement,in,exchange,for,accurate,integration.,This,can,pose,problems,if,one,wishes,to,pack,points,in,a,certain,region.,Furthermore,,increasing,the,number,of,grid,points,in,order,to,improve,the,resolution,in,one,region,impacts,all,other,points,and,can,cause,the,allowable,time,step,to,drop,rapidly,,due,to,a,combination,of,larger,maximum,velocities,on,the,grid,and,ﬁner,grid,spacing.,When,considering,the,15,test,cases,such,as,those,in,section,3.2,where,a,potential,is,imposed,,there,is,no,need,to,perform,velocity,integration.,Turning,to,the,spatial,direction,,one,can,note,that,for,a,periodic,system,a,natu-,ral,approach,to,the,periodic,direction,is,in,fact,the,use,of,a,Fourier,basis.,Such,an,approach,should,be,spectrally,accurate,and,can,be,highly,eﬃcient,when,run,in,serial.,This,is,appropriate,for,the,small,scale,systems,considered,here,,un-,fortunately,such,“global”,spectral,approaches,do,not,parallelise,well,unless,one,can,remain,in,spectral,space,throughout,and,the,wavenumbers,are,independent,(i.e.,a,linear,problem).,Instead,,a,ﬁnite,diﬀerence,method,should,oﬀer,improved,scaling,eﬃciency,due,to,a,local,communication,pattern,(implemented,through,halo,exchange).,Furthermore,,this,is,more,readily,adapted,to,a,non-uniform,grid,which,may,become,more,useful,if,the,periodic,boundary,conditions,are,replaced,with,more,realistic,options.,A,python,implementation,of,the,normalised,Vlasov-Ampere,system,deﬁned,by,equations,14,,15,and,13,,has,been,constructed,as,a,part,of,this,work.,This,implements,uniform,ﬁnite,diﬀerence,treatments,for,both,directions,as,well,as,oﬀering,the,option,to,use,quadrature,points,in,v,or,a,Fourier,treatment,in,x.,4.2,Finite,volume,implementation,As,discussed,previously,,the,FV,approach,oﬀers,several,advantages,over,FD,and,here,we,discuss,some,of,the,choices,made,in,seeking,a,python,implementation,of,a,FV,treatment,of,the,Vlasov-Ampere,system.,Firstly,,one,may,note,that,whilst,the,system,involves,simultaneous,advection,in,two,directions,,the,advection,rate,in,each,direction,is,a,constant.,In,other,words,the,velocity,is,independent,of,position,and,the,electric,ﬁeld,is,independent,of,velocity.,This,allows,one,to,consider,this,as,two,separate,1D,advection,problems.,The,FV,approach,to,1D,advection,of,f,in,x,at,speed,u,is,∂,¯fi,∂t,+,1,δxi,(cid:2)Fxi+1/2,−,Fxi−1/2,(cid:3),=,0,(21),where,¯fi,is,the,average,value,stored,in,cell,with,index,i,,F,is,the,ﬂux,uf,and,δxi,=,xi+1/2,−,xi−1/2,is,the,size,of,the,cell.,One,may,then,choose,to,either,discretise,the,time,derivative,to,produce,a,time,advance,scheme,,or,adopt,the,16,method,of,lines,(MoL),and,use,a,generic,ODE,integrator,to,evolve,¯fi.,Here,we,prefer,to,take,the,MoL,approach,such,that,we,may,adopt,library,implementa-,tions,for,ODE,integration,,allowing,us,to,explore,diﬀerent,time,integrators,with,ease.,We,note,that,some,approaches,to,FV,schemes,,such,as,MUSCL,[8],,require,one,to,discretise,the,time,derivative,directly,to,allow,one,to,obtain,information,at,the,time,mid-point,,rather,than,use,MoL.,Whilst,such,approaches,can,oﬀer,tempting,beneﬁts,,it,can,become,harder,to,maintain,the,run,time,ﬂexibility,that,may,be,desired,in,a,code,designed,to,tackle,a,wide,range,of,problems.,All,that,remains,,therefore,,is,to,determine,how,to,calculate,the,ﬂux,,or,equiv-,alently,f,,,at,the,cell,interfaces.,Here,we,choose,to,use,second,order,upwinded,extrapolation,with,ﬂux,limiters.,In,practice,this,means,that,we,follow,the,fol-,lowing,steps,1.,Assume,the,function,takes,the,cell,average,value,at,the,cell,centre.,2.,Calculate,the,one-sided,ﬁnite,diﬀerence,approximation,of,the,derivative,at,the,cell,centre,,with,the,direction,determined,by,the,sign,of,the,velocity.,For,example,,if,v,&gt;,0,we,calculate,dfi/dx,∼,(fi,−,fi−1)/dx.,3.,Extrapolate,from,the,cell,centre,to,both,interfaces,using,fi±1/2,≈,fi,±,0.5dxdfi/dx,=,fi,±,0.5(fi,−,fi−1),(for,v,&gt;,0).,This,gives,us,a,second,order,estimate,of,the,interface,value,for,the,current,cell.,4.,A,ﬁrst,order,estimate,can,be,obtained,as,fi±1/2,=,fi.,5.,Combine,the,low,and,high,order,interface,values,with,weight,determined,by,a,ﬂux,limiter,,φ.,In,other,words,fi+1/2,=,fi+1/2,low,+φ(ri)(fi+1/2,high−,fi+1/2,low).,Here,ri,is,the,ratio,of,the,left,and,right,sided,derivatives.,6.,Repeat,for,all,cells.,7.,The,ﬂux,estimate,may,be,diﬀerent,on,either,side,of,each,interface.,Here,we,choose,a,unique,value,by,selecting,the,value,downstream,of,the,ﬂow.,The,overall,approach,is,not,overly,complicated,to,implement,but,one,can,see,that,there,is,signiﬁcantly,more,logic,involved,than,in,a,FD,approach.,This,can,manifest,as,more,branches,within,loops,over,cells.,This,can,have,a,signiﬁcant,impact,on,performance,through,preventing,vectorisation,and,costs,due,to,branch,17,misprediction.,Furthermore,,one,must,choose,an,appropriate,ﬂux,limiter.,There,are,many,available,options,and,generally,one,seeks,a,total,variation,diminishing,limiter,in,order,to,avoid,the,introduction,of,new,extrema.,Unfortunately,no,one,limiter,is,the,optimal,choice,for,all,systems,and,one,will,generally,need,to,experiment,for,a,given,system.,We,also,note,that,one,may,choose,φ(r),=,0,or,φ(r),=,1,to,always,select,the,low,or,high,order,method.,Doing,so,one,can,often,observe,that,the,time,integrator,has,to,do,more,work,when,using,a,true,limiter,,rather,than,either,ﬁxed,order,approach.,Figure,4,demonstrates,the,convergence,of,the,FV,advection,solver,for,the,test,case,set,out,in,section,3.1.1,for,a,range,of,ﬂux,limiters.,One,can,note,that,the,limited,approaches,typically,converge,with,rate,in,between,the,low,(ﬁrst),and,high,(second),order,schemes,for,smooth,advecting,functions.,In,the,case,with,the,top,hat,the,RMS,convergence,order,is,drastically,reduced,and,the,ﬂux,limiters,before,better,than,the,ﬁxed,order,schemes.,Unsurprisingly,,this,error,is,dominated,by,the,region,around,the,sharp,gradients.,If,instead,one,considers,the,local,error,away,from,these,points,one,ﬁnd,extremely,rapid,convergence,in,the,limited,cases.,It,is,relatively,straightforward,to,replace,the,extrapolation,method,with,a,recon-,struction,based,approach,whilst,keep,the,remainder,of,the,algorithm,unchanged.,This,can,allow,for,the,study,of,higher,order,representations,such,as,the,PPM,method,[5],and,we,note,a,simple,fortran,implementation,allowing,the,compar-,ison,of,constant,,linear,and,parabolic,treatments,is,available,at,[9].,Further,discussion,of,such,methods,for,a,similar,system,is,given,in,reference,[10],,more,detail,on,FV,schemes,can,be,found,in,reference,[11],and,[12].,Other,python,examples,can,be,found,as,a,part,of,the,Pyro,code,[13],,for,example.,4.3,Brief,comment,on,performance,of,python,implemen-,tations,The,use,of,python,is,commonplace,when,writing,prototype,codes,due,to,the,fast,implementation,cycle,arising,from,the,vast,array,of,support,packages,and,clear,language.,We,note,,however,,the,python,is,not,typically,considered,especially,performant.,When,working,with,numeric,problems,in,python,it,is,generally,advised,that,one,uses,numpy,arrays,and,avoids,elementwise,operations.,Many,numpy,operations,are,implemented,in,a,low,level,backend,and,as,such,should,of-,fer,eﬃcient,behaviour.,In,implementing,and,testing,the,FD,and,FV,codes,intro-,18,(a),(b),(c),(d),Figure,4:,The,RMS,error,as,a,function,of,grid,size,for,the,FV,1D,advection,solver,with,sin,(a),,Gaussian,(b),and,top,hat,(c),initial,conditions.,The,local,error,at,the,centre,of,the,top,hat,is,shown,in,(d).,duced,here,it,was,noted,that,performance,was,rather,low.,Using,proﬁling,it,was,identiﬁed,that,a,large,fraction,of,the,run,time,was,spent,in,various,simple,numpy,routines,,such,as,roll.,It,numpy,version,1.17,a,new,interface,was,introduced,to,allow,external,libraries,to,oﬀer,numpy,like,functionality,in,a,transparent,way,[14].,Unfortunately,,this,appears,to,have,introduced,substantial,overhead,in,all,numpy,operations.,This,can,be,seen,in,proﬁling,by,a,prominent,appearnce,of,the,method,numpy.core.,multiarray,umath.implement,array,function.,It,was,found,that,setting,the,environment,variable,NUMPY,EXPERIMENTAL,ARRAY,FUNCTION,to,0,disables,this,feature,and,saved,around,60%,of,run,time,in,some,test,cases.,19,4.4,Community,codes,Whilst,we,have,discussed,some,of,the,design,decisions,behind,the,python,FD,and,FV,implementations,,it,is,important,to,acknowledge,the,large,array,of,existing,production,codes,which,exist,in,the,community.,Here,we,brieﬂy,refer,to,codes,with,which,one,may,explore,the,diﬀerent,numerical,approaches,in,a,more,realistic,setting.,Future,work,should,look,to,incorporate,some,of,these,into,the,set,of,reference,implementations.,There,are,many,gyrokinetic,ﬁnite,diﬀerence,codes,which,one,may,make,use,of.,The,GS2,code,[2],can,readily,treat,the,1D1V,system,explored,here,and,an,exam-,ple,for,one,of,the,test,cases,is,shown,in,section,3.1.3.,The,stella,code,[15],is,an,actively,developed,ﬂux,tube,gyrokinetic,code.,Whilst,this,shares,some,heritage,with,GS2,,it,is,being,used,to,explore,diﬀerent,numerical,approaches.,In,partic-,ular,it,uses,a,third,order,strong,stability,preserving,RK,time,integrator,rather,than,the,custom,implicit,scheme,of,GS2.,Furthermore,,a,non-interpolating,semi-,Lagrangian,(NISL),scheme,[16],is,currently,being,developed,for,stella,,oﬀering,the,removal,of,smoothing,associated,with,traditional,semi-Lagrangian,schemes,and,improving,associated,CFL,limits.,There,are,fewer,FV,production,gyroki-,netic,codes,,but,the,ESVM,code,[17],provides,a,useful,reference,implementation,of,the,Vlasov-Maxwell,system,in,addition,to,those,mentioned,in,section,4.2.,Finally,it,is,important,to,highlight,the,Gkeyll,code,[18,,19].,This,is,a,discontin-,uous,Galerkin,gyrokinetic,code,designed,for,application,in,the,tokamak,edge.,This,shares,many,of,the,use,cases,of,the,intended,Neptune,code.,As,such,,it,may,be,useful,to,use,this,existing,implementation,to,further,explore,relevant,aspects,of,the,numerical,approach.,It,may,be,useful,for,the,Neptune,team,to,discuss,and,explore,collaboration,with,the,Gkeyll,team.,5,Time,integration,Having,constructed,a,discrete,representation,of,phase-space,,one,needs,to,in-,tegrate,the,system,in,time,in,order,to,explore,the,dynamics.,There,are,many,choices,of,time,integrator,which,could,be,used,with,each,of,the,phase-space,schemes.,Within,the,python,FD,and,FV,implementations,we,make,use,of,the,solve,ivp,method,of,scipy,[20],which,provides,a,consistent,interface,with,which,20,one,can,employ,diﬀerent,time,integrators.,For,the,FV,scheme,we,found,that,the,three,diﬀerent,RK,schemes,(RK23,,RK45,and,DOP853),provided,comparable,behaviour,with,the,lower,order,schemes,being,slightly,faster,but,typically,ex-,hibiting,larger,error,for,the,same,tolerances.,The,ﬂexibility,to,change,the,time,integrator,without,large,changes,to,the,code,is,incredibly,helpful,for,testing,out,diﬀerent,schemes.,This,is,particularly,important,when,considering,codes,for,which,diﬀerent,problems,may,be,tackled.,For,example,,in,systems,where,a,steady,state,is,sought,a,low,order,backwards,Euler,method,can,be,a,good,choice;,the,dissipation,from,the,implicit,scheme,helping,to,damp,out,small,rapid,ﬂuc-,tuations,and,the,low,order,resulting,in,a,stable,method,with,large,time,step.,However,,such,an,integrator,is,less,likely,to,be,the,optimal,choice,for,a,dynamic,turbulent,system.,With,the,Neptune,code,having,a,range,of,possible,applica-,tions,it,is,appropriate,to,consider,how,one,may,design,the,code,such,as,to,enable,easy,run,time,selection,of,diﬀerent,integrators,,similar,to,solve,ivp.,The,PETSc,library,[21],provides,one,such,interface,,allowing,the,user,full,run,time,control,over,the,integrator,and,the,corresponding,setup.,It,may,be,of,interest,however,to,explore,novel,integrators,not,yet,available,through,PETSc.,The,BOUT++,code,[22],addresses,this,problem,with,a,level,of,abstraction,such,that,there,is,a,generic,solver,interface,,for,which,PETSc,is,one,of,the,available,options.,A,similar,approach,to,this,may,be,useful,in,the,Neptune,code.,We,note,that,it,is,possible,to,utilise,PETSc,directly,from,python,and,it,is,possible,to,use,cus-,tom,integrators,within,the,solve,ivp,framework.,Putting,these,together,,it,may,be,helpful,to,construct,a,wrapper,to,PETSc,which,can,be,used,with,solve,ivp.,This,would,enable,a,study,of,the,diﬀerent,time,solvers,available,through,PETSc,within,the,simple,python,reference,implementations.,Strong,stability,preserving,Runge-Kutta,(SSP-RK),schemes,[12,,23],are,a,popu-,lar,choice,of,explicit,time,integrator.,These,are,constructed,such,as,to,maintain,conservation,properties,of,the,underlying,system.,For,example,,in,the,ND,gen-,eralisations,of,the,FV,schemes,discussed,earlier,,one,can,guarantee,conservation,provided,care,is,taken,in,the,time,discretisation,used.,This,is,often,based,around,two,ﬁrst,order,forward-Euler,half,steps.,This,limits,such,approaches,to,ﬁrst,order,accuracy,,potentially,negating,some,of,the,beneﬁts,of,higher,order,represenations.,The,SSP-RK,schemes,are,constructed,from,weighted,combina-,tions,of,forward,Euler,steps,with,weights,selected,to,ensure,conservation,,good,accuracy,and,optimal,time,steps.,These,schemes,are,therefore,higher,order,,with,a,four,stage,third,order,scheme,being,particularly,popular,due,to,the,relatively,21,large,time,step,it,aﬀords.,The,Vlasov-Ampere,system,contains,a,wide,range,of,scales.,In,particular,,the,large,ion,to,electron,mass,ratio,can,result,in,the,timescales,associated,with,electron,dynamics,being,more,than,an,order,of,magnitude,shorter,than,the,ion,scales.,In,systems,in,which,the,electrons,are,required,for,consistency,but,their,fast,dynamics,do,not,impact,the,bulk,behaviour,this,can,result,in,a,restrictive,time,step,when,using,explicit,methods.,More,generally,when,there,are,irrele-,vant,fast,timescales,implicit,integrators,may,oﬀer,substantially,larger,time,steps,without,degrading,the,ability,to,capture,the,relevant,behaviour.,Such,schemes,generally,involve,the,solution,of,a,nonlinear,problem,M,·,xn+1,=,xn,(22),The,matrix,M,will,typically,be,sparse,,but,of,course,its,inverse,will,be,dense.,For,anything,other,than,small,problems,it,is,often,impractical,to,directly,solve,this,problemand,instead,iterative,approaches,are,commonly,used.,These,are,often,implemented,as,a,nested,iterative,structure,,with,each,nonlinear,solver,iteration,using,a,,potentially,preconditioned,,linear,solver.,These,linear,solvers,are,often,based,on,iterative,Krylov,subspace,methods.,PETSc,provides,a,vast,array,of,such,nonlinear,and,linear,solvers.,CVODE,of,SUNDIALS,[24],is,another,commonly,used,nonlinear,solver.,Like,the,SSP-RK,schemes,,CVODE,can,ensure,positivity,is,preserved,through,the,use,of,constraints.,There,are,many,variants,of,these,approaches,and,it,can,be,possible,to,avoid,storing,the,matrix,M,at,all,,in,so,called,matrix-free,methods.,The,performance,of,such,solvers,is,often,heavily,dependent,on,the,number,of,iterations,required,in,the,linear,solve,stage.,This,can,be,strongly,inﬂuenced,by,the,preconditioning,of,this,system.,It,is,possible,to,employ,generic,preconditioners,,such,as,those,provided,by,HYPRE,[25],,or,physics,based,preconditioners,(e.g.,solving,the,bounce/transit,averaged,problem).,Some,discussion,of,preconditioner,approaches,is,given,in,[26,,27,,28,,29].,The,optimal,choice,is,often,highly,problem,dependent,and,vastly,diﬀerent,performance,can,be,achieved,depending,on,how,such,preconditioners,are,set,up.,Typically,time,integrators,adapt,the,time,step,taken,in,order,to,keep,the,es-,timated,error,on,the,step,below,some,speciﬁed,tolerance.,This,can,introduce,challenges,for,the,eﬃcient,scaling,of,such,methods,–,if,a,global,commuincation,is,needed,at,each,trial,time,step,in,order,to,agree,an,error,/,time,step,then,one,might,expect,poor,performance,at,large,scale.,Iterative,schemes,may,oﬀer,22,a,way,to,side,step,this,by,choosing,to,iterate,a,suﬃciently,large,number,of,times,,the,scheme,may,be,able,to,assume,that,the,tolerance,is,satisﬁed,with-,out,communication.,This,may,work,well,for,well,behaved,systems,,but,not,all,approaches,are,guaranteed,to,converge,at,a,ﬁxed,rate.,One,might,anticipate,that,implicit,schemes,,able,to,take,fewer,larger,time,steps,,will,be,less,sensitive,to,this,than,explicit,methods,taking,many,small,time,steps.,However,,there,will,typically,be,communication,involved,in,evaluating,the,right,hand,side,of,the,system.,One,may,be,able,to,construct,schemes,where,error,estimates,are,propagated,alongside,these,other,communications,such,that,the,information,can,propagate,across,the,communicators,within,a,certain,number,of,iterations.,This,may,allow,an,approach,where,the,time,step,is,adjusted,every,N,steps,(possi-,bly,with,the,rejection,of,already,attempted,steps).,In,addition,to,adapting,the,time,step,it,may,also,be,helpful,to,adapt,the,order,of,the,scheme.,The,domain,of,stability,for,a,particular,method,is,typically,dependent,on,the,order,of,the,scheme5.,An,example,of,an,adapative-,step,adaptive-order,Adams-Bashforth,solver,is,provided,in,BOUT++,[30].,An,alternative,approach,is,that,of,local,time,stepping,[31].,Here,diﬀerent,time,steps,can,be,used,for,diﬀerent,regions,of,the,domain.,This,may,be,particu-,larly,helpful,in,conjuction,with,non-uniform/adapative,phase-space,approaches,where,a,traditional,time,integrator,may,be,limited,everywhere,by,the,ﬁnest,res-,olution,in,the,domain.,Finally,,we,note,that,parallel-in-time,approaches,,such,as,ParaReal,[32],and,MGRIT,[33],,oﬀer,the,appealing,ability,to,parallelise,over,the,temporal,domain,as,well,as,the,spatial,domain,and,this,may,be,able,to,make,eﬀective,use,of,exascale,resources.,We,note,the,ExCALIBUR,activity,in,this,area,[34],which,may,provide,useful,input,to,Neptune.,6,Summary,In,this,report,we,have,discussed,the,1D1V,system,2-4,of,[1].,We,begin,by,discussing,the,normalisation,approach,identifying,the,ﬁrst,area,where,the,treat-,ment,of,the,phase-space,may,impact,on,the,form,of,the,system,solved.,Following,this,we,summarise,a,number,of,increasingly,challenging,test,cases,,demonstrat-,ing,sample,results,for,some,of,these,using,both,existing,production,codes,and,5Multi-stage,methods,tend,to,have,an,increasing,stable,domain,as,the,order,increases,,whilst,multi-step,methods,see,the,opposite,trend.,23,a,simple,python,based,ﬁnite,volume,code.,Following,this,a,general,discussion,of,diﬀerent,numerical,approaches,was,given,introducing,some,of,the,diﬀerences,between,ﬁnite,diﬀerence,,ﬁnite,volume,and,ﬁnite,element,methods.,Some,of,the,options,around,the,treatment,of,phase,space,were,discussed,in,the,context,of,simple,ﬁnite,diﬀerence,and,ﬁnite,volume.,Examples,of,community,codes,representing,these,diﬀerent,approaches,was,also,given,and,it,is,suggested,that,future,work,may,wish,to,develop,reference,cases,building,on,some,of,these,ex-,isting,codes,,and,particularly,Gkeyll.,We,ﬁnished,with,a,brief,discussion,of,some,of,the,diﬀerent,approaches,to,time,integration,and,some,of,the,associ-,ated,challenges,with,going,to,exa-scale.,Overall,with,the,intended,ﬂexibility,of,the,Neptune,code,it,appears,advisable,to,develop,structures,which,allow,easy,testing,of,diﬀerent,approaches,,utilising,existing,libraries,whilst,allowing,novel,methods,to,be,trialled.,24,7,References,[1],Wayne,Arter,and,Benjamin,Dudson.,Equations,for,Ex-,CALIBUR/NEPTUNE,Proxyapps.,https://github.com/,ExCALIBUR-NEPTUNE/Documents/blob/main/reports/ukaea_reports/,CD-EXCALIBUR-FMS0021-1.20-M1.2.1.pdf.,[2],Michael,Barnes,,David,Dickinson,,William,Dorland,,Peter,Alec,Hill,,Joseph,Thomas,Parker,,Colin,Malcolm,Roach,,Stephen,Biggs-Fox,,Nicolas,Christen,,Ryusuke,Numata,,Jason,Parisi,,George,Wilkie,,Lucian,Anton,,Justin,Ball,,Jessica,Baumgaertel,,Greg,Colyer,,Michael,Hardman,,Joachim,Hein,,Edmund,Highcock,,Gregory,Howes,,Adrian,Jackson,,Michael,T.,Kotschenreuther,,Jungpyo,Lee,,Huw,Leggate,,Noah,Mandell,,Adwiteey,Mauriya,,Tomo,Tatsuno,,and,Ferdinand,Van,Wyk.,Gs2,v8.1.0,,De-,cember,2021.,Supported,by,CCP,Plasma,(https://gow.epsrc.ukri.or,g/NGBOViewGrant.aspx?GrantRef=EP/M022463/1),and,HEC,Plasma,(https://gow.epsrc.ukri.org/NGBOViewGra,nt.aspx?GrantRef=EP/R029148/1).,[3],Ammar,Hakim.,A,DG,scheme,for,Vlasov,equation,with,ﬁxed,potential.,http://ammar-hakim.org/sj/je/je14/je14-vlasov-fixed-pot.html.,[4],Richard,Fitzpatrick.,Landau,Damping.,https://farside.ph.utexas.,edu/teaching/plasma/lectures1/node85.html.,[5],Phillip,Colella,and,Paul,R.,Woodward.,The,Piecewise,Parabolic,Method,(PPM),for,gas-dynamical,simulations.,Journal,of,Computational,Physics,,54(1):174–201,,1984,,doi:10.1016/0021-9991(84)90143-8.,[6],Jan,S.,Hesthaven,and,Tim,Warburton.,Nodal,Discontinuous,Galerkin,Methods,,volume,54,of,Texts,in,Applied,Mathematics.,Springer,New,York,,2008.,[7],Ryusuke,Numata,,Gregory,G.,Howes,,Tomoya,Tatsuno,,Michael,Barnes,,and,William,Dorland.,Astrogk:,Astrophysical,gyrokinetics,code.,Journal,of,Computational,Physics,,229(24):9347–9372,,2010,,doi:https://doi.org/10.1016/j.jcp.2010.09.006.,[8],Bram,van,Leer.,Towards,the,ultimate,conservative,diﬀerence,scheme.,V.,A,second-order,sequel,to,Godunov’s,method.,Journal,of,Computational,Physics,,32(1):101–136,,jul,1979,,doi:10.1016/0021-9991(79)90145-1.,25,[9],Michael,Zingale.,Hydro,1D.,https://github.com/zingale/hydro1d.,[10],T.D.,Arber,and,R.G.L.,Vann.,A,Critical,Comparison,of,Eulerian-Grid-,Based,Vlasov,Solvers.,Journal,of,Computational,Physics,,180(1):339–357,,jul,2002,,doi:10.1006/jcph.2002.7098.,[11],Michael,Zingale.,Introduction,to,Computational,Astrophysical,Hy-,drodynamics.,CompHydroTutorial.pdf.,http://bender.astro.sunysb.edu/hydro_by_example/,[12],Dale,R.,Durran.,Numerical,Methods,for,Fluid,Dynamics,,volume,32,of,Texts,in,Applied,Mathematics.,Springer,New,York,,New,York,,NY,,2010.,[13],Alice,Harpole,,Michael,Zingale,,Ian,Hawke,,and,Taher,Chegini.,pyro,:,a,framework,for,hydrodynamics,explorations,and,prototyping.,The,Journal,of,Open,Source,Software,,4(34):1265,,2019,,doi:10.21105/joss.01265.,[14],Stephan,Hoyer,and,Matthew,Rocklin,and,Marten,van,Kerkwijk,and,Hameer,Abbasi,and,Eric,Wieser.,NEP,18,—,A,dispatch,mechanism,for,NumPy’s,high,level,array,functions.,nep-0018-array-function-protocol.html.,https://numpy.org/neps/,[15],Michael,Barnes,,Denis,St-Onge,,Alexander,von,Boetticher,,Robert,Davies,,Jos´e,Manuel,Garc´ıa,Rega˜na,,David,Dickinson,,William,Dorland,,Peter,Alec,Hill,,Joseph,Thomas,Parker,,Colin,Malcolm,Roach,,Matt,Landreman,,Hanne,Thienpondt,,Ryusuke,Numata,,Jason,Parisi,,Michael,Hardman,,Michael,T.,Kotschenreuther,,and,Tomo,Tatsuno.,stella.,[16],Harold,Ritchie.,Eliminating,the,interpolation,associated,with,the,semi-,lagrangian,scheme.,Monthly,Weather,Review,,114(1):135,–,146,,1986,,doi:10.1175/1520-0493(1986)114¡0135:ETIAWT¿2.0.CO;2.,[17],Micha¨el,J.,Touati.,Esvm:,an,open-source,ﬁnite,volume,electrostatic,vlasov-maxwell,code.,Journal,of,Open,Source,Software,,6(67):3618,,2021,,doi:10.21105/joss.03618.,[18],Gkeyll,Team.,Gkeyll.,https://github.com/ammarhakim/gkyl.,[19],Ammar,H.,Hakim,,Noah,R.,Mandell,,T.,N.,Bernard,,M.,Francisquez,,G.,W.,Hammett,,and,E.,L.,Shi.,Continuum,electromagnetic,gyrokinetic,simula-,tions,of,turbulence,in,the,tokamak,scrape-oﬀ,layer,and,laboratory,devices.,Physics,of,Plasmas,,27(4):042304,,2020,,doi:10.1063/1.5141157.,26,[20],Pauli,Virtanen,,Ralf,Gommers,,Travis,E.,Oliphant,,Matt,Haberland,,Tyler,Reddy,,David,Cournapeau,,Evgeni,Burovski,,Pearu,Peterson,,War-,ren,Weckesser,,Jonathan,Bright,,St´efan,J.,van,der,Walt,,Matthew,Brett,,Joshua,Wilson,,K.,Jarrod,Millman,,Nikolay,Mayorov,,Andrew,R.,J.,Nel-,˙Ilhan,Polat,,son,,Eric,Jones,,Robert,Kern,,Eric,Larson,,C,J,Carey,,Yu,Feng,,Eric,W.,Moore,,Jake,VanderPlas,,Denis,Laxalde,,Josef,Perk-,told,,Robert,Cimrman,,Ian,Henriksen,,E.,A.,Quintero,,Charles,R.,Harris,,Anne,M.,Archibald,,Antˆonio,H.,Ribeiro,,Fabian,Pedregosa,,Paul,van,Mul-,bregt,,and,SciPy,1.0,Contributors.,SciPy,1.0:,Fundamental,Algorithms,for,Scientiﬁc,Computing,in,Python.,Nature,Methods,,17:261–272,,2020,,doi:10.1038/s41592-019-0686-2.,[21],Satish,Balay,,Shrirang,Abhyankar,,Mark,F.,Adams,,Steven,Benson,,Jed,Brown,,Peter,Brune,,Kris,Buschelman,,Emil,M.,Constantinescu,,Lisandro,Dalcin,,Alp,Dener,,Victor,Eijkhout,,William,D.,Gropp,,V´aclav,Hapla,,Tobin,Isaac,,Pierre,Jolivet,,Dmitry,Karpeev,,Dinesh,Kaushik,,Matthew,G.,Knepley,,Fande,Kong,,Scott,Kruger,,Dave,A.,May,,Lois,Curfman,McInnes,,Richard,Tran,Mills,,Lawrence,Mitchell,,Todd,Munson,,Jose,E.,Roman,,Karl,Rupp,,Patrick,Sanan,,Jason,Sarich,,Barry,F.,Smith,,Stefano,Zampini,,Hong,Zhang,,Hong,Zhang,,and,Junchao,Zhang.,PETSc,Web,page.,https:,//petsc.org/,,2021.,[22],Benjamin,Daniel,Dudson,,Peter,Alec,Hill,,David,Dickinson,,Joseph,Parker,,Adam,Dempsey,,Andrew,Allen,,Arka,Bokshi,,Brendan,Shanahan,,Brett,Friedman,,Chenhao,Ma,,David,Bold,,Dmitry,Meyerson,,Eric,Grinaker,,George,Breyiannis,,Hasan,Muhammed,,Haruki,Seto,,Hong,Zhang,,Ilon,Joseph,,Jarrod,Leddy,,Jed,Brown,,Jens,Madsen,,John,Omotani,,Joshua,Sauppe,,Kevin,Savage,,Licheng,Wang,,Luke,Easy,,Marta,Estarellas,,Matt,Thomas,,Maxim,Umansky,,Michael,Løiten,,Minwoo,Kim,,M,Leconte,,Nicholas,Walkden,,Olivier,Izacard,,Pengwei,Xi,,Peter,Naylor,,Fabio,Riva,,Sanat,Tiwari,,Sean,Farley,,Simon,Myers,,Tianyang,Xia,,Tongnyeol,Rhee,,Xiang,Liu,,Xueqiao,Xu,,Zhanhui,Wang,,Sajidah,Ahmed,,and,Toby,James.,BOUT++,,3,2022.,[23],Chi-Wang,Shu,and,Stanley,Osher.,Eﬃcient,implementation,of,es-,sentially,non-oscillatory,shock-capturing,schemes.,Journal,of,Compu-,tational,Physics,,77(2):439–471,,1988,,doi:https://doi.org/10.1016/0021-,9991(88)90177-5.,27,[24],Alan,C,Hindmarsh,,Peter,N,Brown,,Keith,E,Grant,,Steven,L,Lee,,Radu,Serban,,Dan,E,Shumaker,,and,Carol,S,Woodward.,SUNDIALS:,Suite,of,nonlinear,and,diﬀerential/algebraic,equation,solvers.,ACM,Transactions,on,Mathematical,Software,(TOMS),,31(3):363–396,,2005.,[25],Chow,,E,and,Cleary,,A,and,Falgout,,R.,Design,of,the,HYPRE,precondi-,tioner,library.,9,1998.,[26],S,Thorne.,Priority,equations,and,Test,Cases.,https://github.com/,ExCALIBUR-NEPTUNE/Documents/blob/main/reports/2047353/TN-01.,pdf.,[27],V,Alexandrov,,A,Lebedev,,E,Sahin,,S,Thorne.,Linear,systems,of,equations,and,preconditioners,relating,to,the,NEPTUNE,Pro-,gramme.,main/reports/2047353/TN-02.pdf.,https://github.com/ExCALIBUR-NEPTUNE/Documents/blob/,[28],M,Abalenkovs,,V,Alexandrov,,A,Lebedve,,E,Sahin,,S,Thorne.,Implicit,factorisation,preconditioners,for,NEPTUNE,programme.,https://github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/,reports/2047353/TN-03.pdf.,[29],M,Abalenkovs,,V,Alexandrov,,A,Lebedve,,E,Sahin,,S,Thorne.,Im-,plicit,factorisation,preconditioners,for,non-symmetric,problems.,https://github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/,reports/2047353/TN-04.pdf.,[30],David,Dickinson.,Adaptive,Adams-Bashforth,solver,in,BOUT++.,https://github.com/boutproject/BOUT-dev/tree/next/src/solver/,impls/adams_bashforth.,[31],Siegfried,M¨uller,and,Youssef,Stiriba.,Fully,adaptive,multiscale,schemes,for,conservation,laws,employing,locally,varying,time,stepping.,J.,Sci.,Comput.,,30(3):493–531,,mar,2007,,doi:10.1007/s10915-006-9102-z.,[32],Jacques-Louis,Lions,,Yvon,Maday,,and,Gabriel,Turinici.,Resolu-,tion,d’edp,par,un,schema,en,temps,parareel.,Comptes,Rendus,de,l’Academie,des,Sciences,-,Series,I,-,Mathematics,,332(7):661–668,,2001,,doi:https://doi.org/10.1016/S0764-4442(00)01793-6.,28,[33],S,Friedhoﬀ,,R,D,Falgout,,T,V,Kolev,,S,MacLachlan,,and,J,B,Schroder.,A,multigrid-in-time,algorithm,for,solving,evolution,equations,in,parallel.,12,2012.,[34],Exposing,parallelism:,Parallel,in,Time.,https://excalibur.ac.uk/,projects/exposing-parallelism-parallel-in-time/.,29,A,Example,GS2,input,ﬁle,:,Periodic,slab,test,=,=,0.00000000000E+00,0.50000000000E+00,case,&amp;collisions_knobs,collision_model,=,'none',/,&amp;dist_fn_knobs,boundary_option,=,'self-periodic',opt_source,=,T,/,&amp;dist_fn_species_knobs_1,bakdif,fexpr,/,&amp;gs2_diagnostics_knobs,nwrite,=,10,omegatol,=,-1.0,write_moments,=,T,write_ascii,=,F,/,&amp;init_g_knobs,ginit_option,=,'single_parallel_mode',ikpar_init,=,1,chop_side,=,F,phiinit,=,1.0,/,&amp;knobs,delt,=,0.003,nstep,=,5000,fphi,=,1.0,/,30,&amp;kt_grids_knobs,grid_option,=,'single',/,&amp;kt_grids_single_parameters,aky,theta0,/,&amp;le_grids_knobs,nesub,nesuper,npassing,/,&amp;source_knobs,source_option,/,&amp;species_knobs,nspec,/,&amp;species_parameters_1,bess_fac,fprim,mass,tprim,type,z,/,&amp;theta_grid_knobs,equilibrium_option,/,&amp;theta_grid_parameters,eps,epsl,kp,nperiod,ntheta,=,=,=,=,=,1.0e-3,0.00000000000E+00,12,4,16,=,&quot;homogeneous&quot;,=,1,=,=,=,=,=,=,0.10000000000!E-03,0.0,0.10000000000E+01,0.0,&quot;ion&quot;,0.10000000000E+01,=,&quot;s-alpha&quot;,=,=,=,=,=,0.0,0.0,1.0,1,32,31,qinp,shat,/,&amp;theta_grid_salpha_knobs,model_option,/,=,=,0.0,0.0,=,&quot;no-curvature&quot;,32" name="keywords" />

    <title>TN-11-1_ExcaliburNeptuneConsiderations1D1V &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tn-11-1-excaliburneptuneconsiderations1d1v">
<h1>TN-11-1_ExcaliburNeptuneConsiderations1D1V<a class="headerlink" href="#tn-11-1-excaliburneptuneconsiderations1d1v" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/TN-11-1_ExcaliburNeptuneConsiderations1D1V.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TN-11-1_ExcaliburNeptuneConsiderations1D1V.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>