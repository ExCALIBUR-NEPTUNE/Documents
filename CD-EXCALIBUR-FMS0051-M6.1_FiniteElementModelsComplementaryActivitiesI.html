
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="ExCALIBUR,Finite,Element,Models:,Complementary,Activities,I,M6.1,Abstract,This,report,describes,work,for,ExCALIBUR,project,NEPTUNE,at,Milestone,6.1.,It,includes,an,application,of,the,Nektar++,ﬁnite-element,software,to,the,classic,problem,of,vertical,natural,con-,vection,,with,the,aims,of,assessing,the,validity,of,the,code,in,the,context,of,equilibrium,(non-kinetic),heat,transport,,and,attempting,to,detect,relevant,challenges,and,issues.,Numerical,solutions,for,convective,ﬁelds,are,obtained,for,a,range,of,values,of,the,Rayleigh,number,,the,parameter,gov-,erning,the,strength,of,the,buoyancy,force,driving,the,convection;,several,regimes,are,observed,,representing,heat,transport,dominated,by,either,diffusion,or,boundary-layer,convective,ﬂow,,and,exhibiting,complex,time-dependent,structures,for,larger,Rayleigh,number.,The,dependence,of,the,rate,of,heat,transfer,on,the,Rayleigh,number,is,examined.,Also,included,in,the,report,is,an,outline,of,the,complementary,experimental,programme,Smallab,,and,a,brief,mention,of,the,work,of,the,Oxford-led,discussion,group,that,focusses,on,the,further,development,of,ﬂuid,and,kinetic,models,using,ﬁnite,elements.,Appendices,contain,some,technical,details,of,the,numerics,,collect,some,work,reproducing,early,studies,of,convection,in,water-ﬁlled,tanks,,and,provide,some,initial,estimates,for,the,number,of,ﬁnite,elements,that,may,be,mandated,by,the,requirement,to,mesh,accurately,a,complicated,ﬁrst,wall,geometry.,UKAEA,REFERENCE,AND,APPROVAL,SHEET,Client,Reference:,UKAEA,Reference:,CD/EXCALIBUR-FMS/0051,Issue:,Date:,1.00,September,30,,2021,Project,Name:,ExCALIBUR,Fusion,Modelling,System,Prepared,By:,Name,and,Department,Ed,Threlfall,Wayne,Arter,Signature,N/A,N/A,Date,September,30,,2021,September,30,,2021,BD,Reviewed,By:,Rob,Akers,September,30,,2021,Advanced,Dept.,Manager,Computing,2,1,Introduction,High-order,methods,,which,offer,the,potential,for,exponential,improvement,in,accuracy,given,poly-,nomial,increase,in,computation,time,,are,seen,as,essential,for,maximizing,the,performance,of,next-generation,software,intended,to,run,on,forthcoming,exascale,machines.,They,are,a,natu-,ral,ﬁt,to,modern,HPC,due,to,the,high,arithmetic,intensity,of,the,algorithms,-,broadly,,a,relatively,large,number,of,ﬂoating,point,operations,are,applied,per,degree,of,freedom,,thereby,reducing,the,requirement,for,computer,memory,and,,crucially,,the,expected,demands,on,data,throughput.,One,speciﬁc,example,of,such,an,approach,is,the,spectral,/,hp,ﬁnite,element,method,[1],,of,which,a,modern,C++,implementation,is,the,software,Nektar++,[2],co-written,and,maintained,by,one,of,the,NEPTUNE,grantees.,The,Nektar++,framework,forms,the,basis,for,some,of,the,core,NEPTUNE,proxyapps,and,is,currently,being,augmented,with,capabilities,to,handle,fusion-relevant,problems,([3],,[4]),and,also,extension,to,allow,optimized,operation,on,a,wider,range,of,computational,ar-,chitectures.,This,dependency,motivates,an,examination,of,the,software,by,UKAEA,staff,,included,here,in,the,application,to,vertical,natural,convection,,a,classic,and,historied,problem,which,never-,theless,has,relevance,to,the,issue,of,heat,transport,in,the,scrape-off,layer,(not,to,mention,more,direct,applicability,to,fusion,reactor,components,designed,to,handle,large,heat,ﬂuxes).,In,this,pre-,liminary,work,,results,are,obtained,for,two-dimensional,convective,ﬂows.,An,attempt,was,made,during,the,course,of,this,work,to,detect,any,relevant,issues,with,Nektar,and,one,numerical,prob-,lem,is,presented,in,an,appendix.,An,account,of,planned,experimental,work,concerning,convective,ﬂows,(Smallab),is,included;,the,numerics,are,expected,to,complement,this.,A,brief,account,of,the,ﬁnite-element,work,of,the,Oxford-led,discussion,group,(which,meets,regu-,larly,and,includes,the,Oxford,NEPTUNE,grantee),is,given,,with,reference,to,a,growing,codebase,for,gyrokinetic,simulations,written,in,the,Julia,language.,Any,conclusions,of,the,work,with,Nektar++,are,subject,to,the,constraint,placed,on,the,framework,by,the,need,to,mesh,complicated,ﬁrst-wall,geometries,in,a,realistic,simulation.,An,appendix,contains,brief,estimates,of,the,number,of,ﬁnite,elements,required,in,a,realistic,NEPTUNE,simulation.,3,2,Vertical,natural,convection,in,Nektar++,One,of,the,main,problems,of,Earth-bound,,controlled,nuclear,fusion,is,how,to,sustain,a,very,large,temperature,gradient,for,a,signiﬁcant,time,,i.e.,a,problem,of,heat,transport.,It,has,long,been,known,that,classical,(and,neo-classical),transport,calculations,fail,to,account,for,the,magnitude,of,the,experimentally-observed,rates,of,heat,loss,from,magnetically-conﬁned,fusion,plasmas,,leading,to,the,conclusion,that,turbulent,and,other,phenomena,are,responsible,for,the,bulk,of,the,cross-ﬁeld,transport;,the,gradients,in,a,tokamak,(in,temperature,,pressure,and,magnetic,ﬁeld),are,sufﬁciently,extreme,-,e.g.,approx.,seven,decades,variation,in,temperature,within,the,space,of,a,few,metres,-,that,the,system,is,a,prime,candidate,for,turbulent,phenomena,(which,act,universally,to,suppress,large,gradients).,This,invites,study,of,simpler,problems,exhibiting,qualitatively-similar,behaviour.,One,such,example,is,vertical,natural,convection,,in,which,an,upright,cavity,has,a,hot,side,and,a,cold,side,,and,is,ﬁlled,with,a,ﬂuid,that,experiences,a,vertical,buoyancy,force,when,heated.,The,strength,of,this,force,then,leads,to,different,regimes,of,ﬂow,and,heat,transport.,When,the,force,is,negligible,,heat,is,transferred,diffusively,from,the,hot,surface,to,the,cold,one,,in,rough,analogy,with,classical,transport.,Greater,buoyancy,leads,to,ﬂuid,moving,up,the,hot,side,,across,the,top,of,the,cell,,and,down,the,cold,side,,creating,a,steady,(laminar,,or,‘classical’),circulation,and,transporting,heat,by,advection.,As,the,force,is,increased,,the,vertical,ﬂow,becomes,increasingly,conﬁned,to,a,kinetic,boundary,layer,near,the,vertical,walls;,likewise,,the,temperature,gradients,are,increasingly,restricted,to,a,thermal,boundary,layer,near,the,vertical,walls.,Further,increasing,the,force,,one,ﬁnds,that,the,sheared,ﬂow,near,the,vertical,boundaries,leads,to,an,instability,of,Kelvin-Helmholtz,type,that,takes,the,form,of,waves,that,co-move,with,the,convective,ﬂow,,and,which,are,chaotic,in,nature;,these,boundary,effects,also,lead,ultimately,to,complicated,,also-chaotic,,time-dependent,ﬂow,structures,in,the,bulk,-,turbulent,ﬂow.,The,systems,simulated,in,this,study,are,purely,two-dimensional,,a,fact,which,affects,the,results,because,three-dimensional,ﬂow,instabilities,are,automatically,excluded;,also,,there,are,important,differences,between,turbulent,ﬂows,in,two,dimensions,and,those,in,three.,It,might,be,noted,that,the,two-dimensional,property,seems,rather,compatible,with,the,fusion,use,case,,with,the,turbulent,and,other,transport,phenomena,-,e.g.,the,well-known,ﬁlaments,-,in,a,tokamak,being,strongly,elongated,along,the,magnetic,ﬁeld,lines,and,so,the,dynamics,of,the,scrape-off,layer,is,,in,this,sense,,two-dimensional.,In,dimensionless,form,,the,system,of,equations,describing,vertical,natural,convection,is,,for,ﬂuid,velocity,u,,temperature,T,and,pressure,p,,for,a,system,coordinatized,such,that,the,vertical,,gravity-,opposing,direction,is,ˆy,,1,P,r,(cid:18),∂u,∂t,(cid:18),∂T,∂t,(cid:19),(cid:19),+,u,·,∇u,+,u,·,∇T,=,−∇p,+,Ra,T,ˆy,+,∇2u,,=,∇2T,,∇,·,u,=,0.,(1),(2),(3),The,Boussinesq,approximation,is,assumed,,with,the,density,ﬂuctuation,entering,only,as,a,temperature-,dependent,buoyancy,force,(hence,the,incompressibility,condition),-,for,this,reason,,the,system,is,4,simulated,using,the,incompressible,Navier-Stokes,solver,of,Nektar++.,Dirichlet,boundary,condi-,tions,were,used,for,the,vertical,wall,temperatures,(T,=,1,on,the,left,and,T,=,0,on,the,right),and,zero,Neumann,conditions,(i.e.,no,heat,ﬂux),on,the,horizontal,walls,(top,and,bottom).,The,ve-,locity,boundary,conditions,were,no-slip,/,no-penetration,and,the,pressure,used,a,zero,Neumann,condition,,for,all,walls.,The,dimensionless,parameters,are,the,Rayleigh,number,,where,β,is,the,thermal,expansion,coef-,ﬁcient,,∆T,the,temperature,difference,across,cavity,width,L,,Ra,=,βg∆T,L3,κν,(4),and,the,Prandtl,number:,the,ratio,of,kinematic,viscosity,ν,to,thermal,diffusivity,κ,(a,property,of,the,ﬂuid,ﬁlling,the,cavity,-,small,e.g.,0.01,for,something,like,a,liquid,metal,,rising,to,c.105,for,viscous,oils),,P,r,=,ν,κ,.,(5),The,other,relevant,parameter,is,the,aspect,ratio,λ,=,L,H,of,the,cavity,(width,L,,height,H).,The,main,output,that,is,studied,is,the,averaged,Nusselt,number,,the,physical,meaning,of,which,is,that,it,measures,the,per-unit,length,heat,ﬂux,through,the,cavity,(i.e.,going,in,to,the,left-hand,side,and,out,from,the,right-hand,side),at,any,instant,of,time,,deﬁned,as,N,u,=,(cid:82),H,0,−∇xT,(x0,,y),+,∇xT,(x1,,y)dy,(cid:82),H,0,−∇xT,(x0,,y),+,∇xT,(x1,,y)dy|Ra=0,.,(6),Computational,parameters,enter,as,the,mesh,resolution,(for,simplicity,,meshes,comprising,uniform,squares,are,used,for,this,study,,with,h,denoting,the,size,of,a,single,element),and,the,global,order,p,(a,natural,number),of,the,spectral,elements,,with,the,lowest,allowed,value,(p,=,1),meaning,that,linear,intra-element,basis,functions,are,used,,and,greater,p,corresponding,to,higher-order,Lagrange,polynomials.,For,reference,,a,continuous,Galerkin,formulation,was,employed.,The,open-source,software,Nektar++,gives,the,ability,to,tackle,research-grade,problems,in,ﬂuid,mechanics,on,hardware,ranging,from,a,single,PC,to,thousands-of-core,HPC,(note,that,,writing,in,the,year,2021,,it,is,quite,possible,to,execute,the,supercomputer-class,calculations,of,the,1980s,and,the,early,1990s,on,a,single,modern,PC,-,in,the,case,of,the,results,in,this,preliminary,report,,an,Intel,Core,i7-10700KF,3.8GHz,with,16,logical,cores).,Brieﬂy,,the,software,implements,the,spectral,/,hp,element,method,for,a,range,of,problems.,The,convergence,is,,in,ideal,cases,,expected,to,lead,to,L2,error,scaling,as,∼,hp+1,(see,Appendix,A,for,a,demonstration).,Note,also,that,certain,simulation,data,are,efﬁciently,extracted,from,Nektar++,using,ﬁlters;,because,ﬁlters,for,the,quanti-,ties,of,interest,needed,in,this,investigation,are,not,included,in,the,source,code,,the,software,was,modiﬁed,in,order,to,calculate,the,Nusselt,number,,and,the,temperature,and,location,of,the,hottest,point,on,the,cold,wall,as,time,series.,Nektar++,contains,a,number,of,different,solvers,built,on,the,same,underlying,ﬁnite-element,framework;,the,one,used,here,is,the,incompressible,Navier-Stokes,solver,(details,of,the,implementation,can,be,found,in,[1]).,5,During,the,work,presented,in,this,report,,a,small,anomaly,was,found,in,one,part,of,the,Nektar++,incompressible,Navier-Stokes,algorithm,(the,pressure-solver,option,VelocityCorrectionScheme);,an,account,is,given,in,Appendix,B.,2.1,Brief,literature,review,Historically,,problems,in,convection,have,examined,the,output,Nusselt,number,N,u,as,a,function,of,the,Rayleigh,number,Ra,,typically,concluding,in,a,power-law,relation,of,the,type,N,u,∼,Raγ,(7),and,proposing,various,values,for,the,exponent,γ,,typically,in,the,range,1,4,−,1,2,.,Early,studies,were,undertaken,by,Elder,in,the,1960s.,Numerical,calculations,were,able,at,that,time,to,access,only,low-Ra,laminar,ﬂows,([5]);,experiments,with,water-ﬁlled,(P,r,=,7.0),tanks,allowed,investigation,of,the,phenomenology,of,more,active,ﬂows,,including,a,demonstration,of,the,wall-wave,instability,([6]).,See,Appendix,C,for,some,examples,revisited,using,Nektar++.,More,recent,studies,have,focussed,on,air-ﬁlled,cavities,(P,r,=,0.71),in,the,contexts,of,double-,glazing,and,building,cooling,systems.,The,1989,review,[7],by,Wright,and,Sullivan,includes,a,survey,of,experimental,results,for,various,values,of,the,aspect,ratio,in,the,range,1,110,.,The,2005,paper,[8],by,Xam,´an,and,collaborators,obtained,an,approximate,scaling,exponent,of,0.25,for,a,two-dimensional,laminar,convective,model,,rising,to,0.3,when,a,three-dimensional,turbulence,model,was,included.,5,to,1,The,current,state-of-the-art,appears,to,be,the,work,of,Lohse,and,collaborators,[9].,An,earlier,work,by,Grossmann,and,Lohse,[10],,treating,the,related,case,of,Rayleigh-B,´enard,convection,,where,the,heating,is,applied,from,beneath,,rather,than,from,the,side,,included,an,analysis,that,revealed,a,range,of,physics-motivated,scaling,laws,N,u,∼,RaγP,rδ,for,various,regimes,differentiated,by,whether,the,boundary,layer,or,the,bulk,dominates,the,global,kinetic,and,thermal,dissipation,,and,by,which,of,the,thermal,or,kinetic,boundary,layers,is,thicker.,This,theory,led,to,an,instructive,‘phase,diagram’,of,various,ﬂow,regimes,in,the,two-dimensional,P,r,,Ra,parameter,space,,with,their,own,values,of,γ,and,δ,,the,boundaries,between,regimes,being,determined,by,numerical,experiment.,It,is,notable,that,the,same,calculations,are,not,possible,in,the,case,of,vertical,natural,convection,due,to,the,lack,of,closure,of,the,system,of,equations,in,that,case.,One,might,nevertheless,expect,something,similar,to,exist,in,the,case,of,vertical,natural,convection,,viz.,a,collection,of,physically-,motivated,power,laws,that,change,as,the,parameter,space,in,Ra,and,P,r,is,navigated;,the,authors,of,[9],state,that,they,are,working,on,this,problem.,A,solution,would,rationalize,the,jumble,of,historic,power-law,ﬁts.,It,is,to,be,emphasized,that,much,of,the,literature,,including,the,state-of-the-art,mentioned,above,,is,concerned,with,the,three-dimensional,case,,whereas,the,results,presented,in,this,report,are,two-dimensional.,Also,recently,,the,paper,[11],has,exposed,an,analogy,between,the,Rayleigh-B,´enard,problem,and,the,heat,transport,in,a,tokamak.,6,2.2,Air-ﬁlled,cavity:,simulation,outputs,2.5,,,1,5,,,and,1,Matching,the,studies,in,[7],,[8],,and,[9],a,value,of,P,r,=,0.71,was,selected,,this,corresponding,to,the,cavity,being,ﬁlled,with,air.,Aspect,ratios,λ,of,1,10,were,studied.,In,the,initial,work,,a,two-dimensional,mesh,of,uniform,squares,was,used,as,the,ﬁnite-element,discretization,,with,48,squares,across,the,width,of,the,cavity;,thus,h,=,1,48,and,the,cavity,meshes,comprised,5760,,11520,,and,23040,elements.,The,lower-Ra,simulations,are,easily,simulated,using,as,initial,data,the,diffusive,-,Ra,=,0,-,solution,(i.e.,a,uniform,temperature,gradient,from,the,hot,to,the,cold,side,,zero,velocity,,and,no,pressure,gradient),though,note,it,is,advisable,to,add,a,small,perturbation,to,this,in,order,to,avoid,simulations,getting,‘stuck’,on,the,diffusive,solution.,At,higher,Ra,of,c.104,and,above,,this,choice,of,initial,condition,leads,to,a,violent,transition,to,the,new,ﬂow,state,,which,is,prone,to,numerical,instability,,and,so,the,ﬁelds,from,a,lower-Ra,simulation,(typically,one,decade,less,in,Ra),are,used,as,initial,data.,Note,also,that,,for,values,of,Ra,below,the,critical,value,for,the,appearance,of,wall-wave,instabilities,,the,problem,is,simply,one,of,ﬁnding,a,stable,steady,state;,for,higher,Ra,,the,system,ﬂuctuates,about,what,is,termed,a,‘quasi-steady,state’,in,which,statistical,properties,(e.g.,the,time-averaged,value,of,N,u),are,time-independent.,Plots,of,the,temperature,ﬁeld,in,the,steady,state,,or,,in,higher-Ra,cases,,the,quasi-steady,state,,are,shown,in,Figs.1,,2,,and,3,for,the,three,different,aspect,ratios.,These,demonstrate,the,transi-,tion,from,a,diffusion-dominated,solution,(with,temperature,gradient,in,the,horizontal,direction),to,a,steady,laminar,(aka,classical),convective,cell,solution,(where,the,temperature,gradient,is,increas-,ingly,in,the,vertical,direction),and,later,to,an,unsteady,ﬂow,which,displays,wall-wave,instabilities,,which,are,waves,travelling,up,the,hot,wall,and,down,the,cold,one,(the,properties,of,the,boundary-,layer,waves,are,examined,brieﬂy,in,2.3).,It,is,obvious,that,the,diffusive,solution,represents,a,strict,minimum,in,heat,transfer,rate,,and,that,increased,Ra,gives,,in,all,cases,studied,here,,increased,heat,transport.,It,is,apparent,that,the,smaller,aspect,ratio,cavity,retains,its,classical,ﬂow,for,greater,values,of,Ra,than,the,larger,aspect,ratio,cases,-,this,probably,due,to,the,fact,that,the,near-wall,velocities,are,greater,for,larger,aspect,ratio,(Fig.5),,since,in,that,case,the,ﬂuid,is,acted,on,by,the,buoyancy,force,over,a,greater,distance;,one,also,notes,that,the,wall,waves,tend,to,appear,ﬁrst,near,the,top,of,the,hot,wall,and,the,bottom,of,the,cold,,where,the,vertical,speed,is,expected,to,be,maximal.,The,data,used,in,Figs.1-6,were,taken,from,the,most,accurate,simulation,run,for,each,choice,of,parameters,(for,the,λ,=,1,2.5,cavity,,p,=,3,for,Ra,=,105,,p,=,4,for,the,higher-Ra,ones,,with,the,exception,of,the,Ra,=,109,case,which,was,simulated,using,a,h,=,1,6,mesh,with,p,=,15,,and,checked,by,repeating,the,calculation,for,p,=,10,−,14,,after,it,was,found,that,using,high,order,in,this,way,was,more,time-efﬁcient);,for,the,λ,=,1,10,cavity,,p,=,2,for,for,Ra,≥,105;,and,the,unquoted,lower-Ra,ﬂows,all,used,p,=,1).,See,also,2.2.1.,5,cavity,,p,=,3,for,Ra,≥,105;,for,the,λ,=,1,The,dependency,of,the,averaged,Nusselt,number,N,u,on,Ra,is,shown,in,Fig.4.,This,shows,ap-,proximate,power,laws,valid,over,much,of,the,range;,exponents,of,0.2579,,0.2550,,and,0.2701,were,obtained,over,the,Ra,ranges,104,−,108,,104,−,107,,and,104,−,107,for,aspect,ratios,1,10,re-,spectively.,For,quasi-steady,cases,,N,u,was,calculated,using,an,average,over,the,trend-free,region,of,the,Nusselt,number,time,series.,The,reason,why,these,numerics,do,not,give,exponents,≈,0.3,,as,found,in,[8],,[10],,is,because,the,simulations,presented,here,are,two-dimensional,,whereas,those,works,refer,to,the,three-dimensional,case.,5,,,and,1,2.5,,,1,The,dependency,of,the,maximum,mid-height,vertical,velocity,on,Ra,is,shown,in,Fig.5.,The,max-,7,Figure,1:,Temperature,ﬁelds,for,the,λ,=,1,2.5,cavity,(blue:,cold;,red:,hot;,range,0,to,1).,Ra,increases,from,102,to,105,in,decades,from,left,to,right,across,the,upper,row,,and,from,106,to,109,across,the,lower.,Instability-driven,wall,waves,appear,in,the,Ra,=,108,case,near,the,top,of,the,hot,side,and,bottom,of,the,cold,side,,occurring,over,a,larger,portion,of,the,vertical,walls,in,the,Ra,=,109,case.,8,Figure,2:,Temperature,ﬁelds,for,the,λ,=,1,Wall,waves,appear,in,the,Ra,=,107,case,near,the,top,of,the,hot,side,and,bottom,of,the,cold,side.,5,cavity.,Ra,increases,from,102,to,107,in,decades,from,left,to,right.,9,Figure,3:,Temperature,ﬁelds,for,the,λ,=,1,10,cavity.,Ra,increases,from,102,to,107,in,decades,from,left,to,right.,Wall,waves,appear,in,the,Ra,=,106,case,near,the,top,of,the,hot,side,and,bottom,of,the,cold,side;,for,this,aspect,ratio,they,are,capable,of,developing,into,‘prominences’,capable,of,advecting,heat,signiﬁcant,distances,into,the,bulk,(not,seen,for,the,smaller,aspect,ratio,cases,here).,10,Figure,4:,Dependence,of,N,u,on,Ra,for,cavities,with,aspect,ratios,1,2.5,,,1,5,,,and,1,10,.,imum,velocity,appears,rather,well-ﬁtted,by,a,power,law,,with,exponents,0.496,,0.490,,and,0.515,being,found,over,the,Ra,ranges,104,−,109,,104,−,107,,and,104,−,106,for,aspect,ratios,1,5,,,and,1,10,respectively.,There,is,no,signiﬁcant,deviation,from,these,power,laws,at,higher,Ra.,Note,that,the,dependency,is,linear,for,smaller,Ra,due,to,the,linear,growth,of,the,convective,mode.,2.5,,,1,1,4,and,vmax,∼,Ra,1,This,discovery,of,the,approximate,relations,N,u,∼,Ra,2,is,consistent,with,the,low-,P,r,Regime,Il,for,Rayleigh-B,´enard,convection,found,in,[10],,in,their,eqs,(2.31),and,(2.32),(note,that,vmax,here,stands,as,a,proxy,for,the,Reynolds,number).,This,regime,corresponds,to,viscous,and,thermal,dissipations,being,dominated,by,the,boundary,layer,,as,opposed,to,the,bulk,,region,,and,the,velocity,boundary,layer,being,less,wide,than,the,thermal,boundary,layer,(i.e.,small,P,r),-,though,caution,is,advised,applying,these,criteria,to,the,present,case,as,their,derivation,assumed,the,Rayleigh-B,´enard,case.,It,is,also,stated,in,that,paper,than,the,same,relations,have,been,found,to,be,valid,for,low-P,r,two-dimensional,convection,in,[12].,The,horizontal,proﬁles,of,temperature,and,vertical,velocity,component,(normalized,to,the,maxi-,mum,value),at,the,mid-height,of,the,cavity,are,shown,in,Fig.6.,It,is,evident,that,the,temperature,proﬁle,is,linear,in,the,diffusion-dominated,regime,,changing,to,something,that,is,remarkably,uni-,form,except,in,the,thermal,boundary,layers,near,the,cavity,walls,,i.e.,the,gradients,in,the,bulk,are,suppressed,in,the,classical,convective,solutions;,larger-Ra,ﬂows,show,signiﬁcant,disruption,due,to,the,non-steady,phenomena.,The,vertical,velocity,proﬁle,varies,from,a,sinusoid-like,proﬁle,at,low,Ra,to,a,ﬂow,dominated,by,boundary,layer,transport,,before,again,becoming,disrupted,by,non-steadiness.,Large,gradients,in,temperature,and,velocity,become,apparent,near,the,boundary,and,these,appear,to,increase,monotonically,with,increasing,Ra;,note,that,the,near-boundary,tem-,perature,exhibits,apparently,monotonic,decrease,with,distance,from,the,boundary,,whereas,the,no-slip,condition,means,that,the,vertical,velocity,rises,to,a,sharp,peak,and,then,falls,back.,Note,that,time-averaging,over,the,quasi-steady,state,can,be,performed,to,uncover,the,mean,proﬁles,in,the,unsteady,cases,,as,done,in,[9].,The,proﬁles,in,the,ﬁgure,are,for,the,λ,=,1,2.5,cavity,but,11,Figure,5:,Dependence,of,maximum,mid-height,vertical,ﬂow,velocity,on,Ra,for,cavities,with,aspect,ratios,2.5,,,1,1,5,,,and,1,10,.,are,expected,to,be,broadly,similar,for,the,other,two,cases,,subject,to,rescalings,in,the,Ra,values,demarcating,the,transitions,between,regimes.,2.2.1,Air-ﬁlled,cavity:,convergence,,and,pathways,to,convergence,,and,stability,The,calculations,ultimately,become,limited,in,terms,of,accessible,Ra,by,the,numerical,resolution,needed,to,simulate,the,velocity,and,temperature,gradients:,high-Ra,is,thus,a,computational,chal-,lenge.,In,order,to,achieve,convergence,using,the,initial,h,=,1,48,meshes,,the,element,order,was,increased,until,the,Nusselt,number,changed,by,less,than,a,few,percent.,One,point,is,that,the,convergence,is,harder,to,assess,for,the,non-steady,solutions,since,the,averaged,Nusselt,num-,ber,varies,in,time,in,the,quasi-steady,state,(as,an,example,,±10%,variation,in,N,u,is,seen,for,the,Ra,=,109,case).,Note,the,the,graphs,plotted,in,order,to,obtain,the,power,laws,are,rather,forgiving,in,their,response,to,errors,(due,to,the,logarithm).,It,was,assumed,that,the,convergence,results,for,the,smallest,cavity,ought,to,apply,also,to,the,larger,cases,(subject,to,rescalings,of,Ra,e.g.,it,was,assumed,the,ﬂow,corresponding,to,the,onset,of,wall,waves,mandated,a,similar,level,of,numerical,precision,in,all,cases).,The,ability,to,change,both,h-,and,p-reﬁnement,seems,currently,to,be,under-explored,in,the,convec-,tion,literature,(e.g.,[9],uses,a,fully,conservative,fourth-order,staggered,ﬁnite,difference,scheme,for,the,velocity,ﬁeld,and,the,QUICK,scheme,to,advect,the,temperature,ﬁeld,,and,the,two-dimensional,study,in,[8],uses,a,ﬁnite-volume,method,based,on,the,method,of,Patankar).,Initial,results,ob-,tained,during,this,work,incline,toward,p-reﬁnement:,to,cite,the,case,of,the,Ra,=,107,case,for,the,12,Figure,6:,Mid-height,horizontal,temperature,proﬁle,(left),and,mid-height,velocity,normalized,to,maximum,in,proﬁle,(right),for,λ,=,1,2.5,cavity.,p,N,u,(Ra,=,105),N,u,(Ra,=,106),N,u,(Ra,=,107),N,u,(Ra,=,108),1,2,3,4,12.286,14.222,13.711,−,18.231,26.613,25.222,−,4.123,4.173,4.167,−,7.279,7.601,7.523,7.554,Table,1:,Convergence,of,N,u,values,with,increasing,element,order,p,,for,various,Ra,and,λ,=,1,h,=,1,2.5,cavity,/,48,mesh.,2.5,cavity,,the,h,=,1,λ,=,1,48,p,=,3,case,(note,(p,+,1)2,degrees,of,freedom,(DOFs),per,element),using,48,×,120,×,42,=,92,,160,DOFs,and,∆t,=,2,×,10−6,took,3392s,to,propagate,for,0.1,time,units,,while,the,apparently,as-accurate,h,=,1,6,p,=,11,case,(see,Tables,1,,2),needed,796s,using,6,×,15,×,122,=,12,,960,DOFs,with,∆t,=,5,×,10−6,to,evolve,for,the,same,amount,of,time,(exe-,cuted,on,the,same,hardware).,The,advantage,here,stems,from,the,very,signiﬁcant,reduction,in,the,number,of,degrees,of,freedom,needed,to,achieve,a,given,level,of,accuracy,,which,is,really,the,beauty,of,high-order,methods.,Note,however,that,the,simple,structure,here,has,no,constraints,on,the,level,of,h-reﬁnement,arising,from,the,requirement,to,mesh,a,complicated,surface,accurately,(see,D.1,for,some,initial,estimates,in,this,direction).,Note,also,that,the,question,of,performance-,optimal,discretization,depends,on,machine,architecture:,in,a,massively-parallel,system,,it,is,likely,that,a,decent,number,of,elements,will,need,to,be,associated,with,each,compute,core,for,efﬁcient,operation,,and,one,certainly,cannot,have,fewer,than,one,element,per,core.,It,may,be,of,beneﬁt,to,reﬁne,selectively,the,mesh,near,the,wall,,as,,at,least,for,the,laminar,ﬂows,,the,largest,velocity,and,temperature,gradients,are,to,be,found,there.,For,larger,Ra,,the,existence,of,complicated,time-dependent,structures,in,the,bulk,(see,the,right-most,case,in,Fig.1),probably,means,that,a,ﬁne,grid,is,needed,everywhere.,Note,that,it,may,be,possible,to,increase,element,order,p,locally,as,well,as,performing,local,h-reﬁnement.,It,is,also,the,case,that,the,simulations,encounter,numerical,instability,that,grows,worse,as,Ra,is,increased,(though,this,can,be,mitigated,by,matching,the,initial,data,closely,to,the,quasi-steady,state,,where,possible,-,as,mentioned,above).,The,precise,determination,of,the,maximum,stable,time,step,size,is,complicated,and,problem-dependent,(see,,for,example,,§6.3.1,of,[1]),for,these,types,of,simulation,(for,purely,linear,systems,the,question,is,much,easier,,and,indeed,analytic,13,p,N,u,(Ra,=,107),3,4,5,6,7,8,9,10,11,12,13,13.936,16.405,15.286,14.024,13.509,13.461,13.557,13.657,13.716,13.738,13.750,run,time,/,s,46,52,88,94,109,360,467,678,796,1198,1418,∆t,5,×,10−6,5,×,10−6,5,×,10−6,5,×,10−6,5,×,10−6,1.25,×,10−6,1.25,×,10−6,1.25,×,10−6,1.25,×,10−6,5,×,10−7,5,×,10−7,Table,2:,Convergence,of,N,u,values,with,increasing,element,order,p,,for,Ra,=,107,and,λ,=,1,2.5,cavity,/,h,=,1,6,mesh.,Also,included,are,wall-clock,run,times,in,seconds,(these,are,not,deﬁnitive,,as,the,time,step,size,∆t,was,likely,smaller,than,necessary,,especially,for,the,lower,orders,(&lt;,8);,also,,some,set-up,time,was,included,in,the,timings).,Ra,∆t,(p,=,1),∆t,(p,=,2),∆t,(p,=,3),∆t,(p,=,4),105,106,107,108,−,5,×,10−6,1.5,×,10−6,2.5,×,10−7,10−5,5,×,10−6,2,×,10−6,5,×,10−7,10−5,10−5,2,×,10−6,10−6,10−5,10−5,10−5,2,×,10−6,Table,3:,Table,of,stable,time,step,sizes,used,for,various,Ra,and,λ,=,1,2.5,cavity,/,h,=,1,48,mesh.,for,uniform,computational,meshes),,and,Nektar++,seems,to,have,no,facility,for,obtaining,even,an,estimate,of,a,stable,time,step,size,-,it,is,,to,the,author’s,knowledge,,currently,a,case,of,trial,and,error.,It,might,be,noted,that,,from,the,aforementioned,reference,,the,maximum,stable,time,step,size,is,expected,to,scale,linearly,with,the,size,of,the,ﬁnite,elements,and,inversely,with,the,maximum,1,local,velocity,(note,the,approximate,scaling,law,vmax,∼,Ra,2,found,in,the,preceding,subsection),,with,an,additional,penalty,factor,depending,on,the,element,order,p.,Some,empirically-found,stable,time,step,sizes,used,in,the,simulations,herein,are,presented,in,Table,3,(these,represent,lower,bounds,as,a,detailed,search,for,the,boundary,between,stable,and,unstable,was,not,performed;,also,,‘stable’,here,means,only,that,simulations,run,with,these,time,step,sizes,showed,no,evidence,of,instability).,The,question,of,performance,is,further,muddied,by,the,number,of,iterations,in,part,of,the,solver,being,reduced,as,the,time,step,size,is,reduced,-,thus,a,simulation,with,a,larger,number,of,time,steps,may,potentially,execute,more,quickly,than,one,with,fewer.,2.3,Transient,time,series,and,extreme,event,characterization,The,time-dependent,convective,instabilities,have,implications,for,the,time-variation,in,the,global,heat,transport,and,also,the,variation,in,the,local,amount,of,heat,transfer,as,a,function,of,position,14,Figure,7:,Transient,behaviour,associated,to,boundary-layer,waves.,The,left-hand-side,plot,shows,the,maximum,temperature,at,a,small,displacement,from,the,cold-side,wall,and,the,right-hand-side,one,shows,the,vertical,position,of,the,hottest,point,near,the,cold,wall,,both,as,time,series.,on,the,walls.,This,is,of,interest,in,the,sense,of,study,of,‘extreme,events’,-,the,amount,of,local,heating,determines,whether,damage,might,result,to,a,heat-absorbing,engineering,structure,such,as,a,tokamak,ﬁrst,wall.,The,two-dimensional,waves,also,have,something,of,the,character,of,the,‘ﬁlaments’,that,have,in,recent,years,been,observed,near,the,outer,boundary,of,tokamak,plasmas.,To,this,purpose,,a,custom,ﬁlter,was,added,to,Nektar++,,designed,to,output,the,maximum,near-wall,temperature,over,a,speciﬁed,portion,of,the,cavity,side,at,regular,time-intervals,,and,to,output,sim-,ilarly,the,location,of,such,a,‘hot,spot’.,Technically,,the,ﬁlter,ﬁnds,the,maximum,value,of,the,normal,derivative,of,the,temperature,ﬁeld,at,the,boundary,(because,of,the,ﬁxed,T,values,on,the,vertical,boundaries,,the,temperature,very,close,to,the,boundary,is,approximated,as,the,boundary,value,minus,(cid:15)∇nT,where,∇n,represents,the,outward,normal,derivative,and,(cid:15),a,small,spatial,displace-,ment),,and,note,that,this,is,in,spirit,a,maximum,value,of,the,‘local’,version,of,the,averaged,Nusselt,number,used,above.,Of,course,,in,the,steady,state,,the,resulting,time,series,are,featureless,,but,in,the,cases,exhibiting,the,wall-wave,instability,the,outputs,track,e.g.,cooling,blobs,of,ﬂuid,as,they,descend,the,cold,side.,The,outputs,(Fig.7),,which,were,recorded,in,all,cases,for,the,lower,0.5,units,of,the,cold-side,wall,,show,clearly,an,increasing,degree,of,variability,in,the,maximum,near-wall,temperature,as,Ra,is,increased.,The,gradients,of,the,hotspot,position,graph,on,the,right-hand,side,show,also,that,the,wall,waves,move,with,greater,velocity,(represented,by,the,gradient,of,these,time,series),for,larger,Ra,(the,graphs,show,hotter,parts,of,ﬂuid,descending,,cooling,as,they,go,,and,ultimately,being,supplanted,by,the,next,hot,wave,entering,the,top,of,the,monitored,region).,Note,that,the,discrete,character,of,the,position,graph,comes,from,the,fact,that,the,ﬁlter,currently,outputs,only,the,position,of,the,intra-element,Lagrange,basis,node,and,not,the,precise,maximum.,Note,also,that,the,Ra,=,109,time,series,was,excluded,from,the,right-hand,plot,as,it,is,sufﬁciently,chaotic,to,obscure,the,other,data;,sufﬁce,it,to,say,that,the,motion,is,a,great,deal,more,rapid,in,this,case.,It,is,also,possible,to,obtain,time,series,for,the,averaged,Nusselt,number.,One,issue,is,that,the,ﬁlter,described,in,this,section,is,currently,not,compatible,with,MPI,execution,of,Nektar++,due,to,its,use,of,code,that,sums,across,threads,(this,is,clearly,not,a,problem,for,additive,quantities,such,as,the,Nusselt,number,integrals,described,in,the,preceding,section).,15,These,time,series,have,been,used,as,the,basis,for,uncertainty,quantiﬁcation,and,as,training,data,for,a,Gaussian,process.,Further,work,could,characterize,the,effect,on,heat,transfer,of,the,‘promi-,nences’,seen,in,the,larger,aspect,ratio,cavity,(Fig.3),as,these,are,expected,to,give,rise,to,signiﬁcant,local,heating,events.,2.4,Conclusion,The,incompressible,Navier-Stokes,solver,of,Nektar++,was,used,to,obtain,plausible,results,for,the,problem,of,two-dimensional,vertical,natural,convection.,The,relation,between,the,Rayleigh,number,control,parameter,Ra,and,the,heat,transport,as,quantiﬁed,by,the,averaged,Nusselt,number,N,u,was,obtained,for,regimes,ranging,from,the,diffusive,up,to,and,beyond,the,onset,of,wall-wave,instability,and,two-dimensional,turbulence,,for,cavities,of,aspect,ratio,1,10,.,Nektar++,ﬁlters,capable,of,producing,time,series,for,N,u,,as,well,as,for,diagnostics,of,the,near-wall,dynamics,,were,demonstrated.,5,,,and,1,2.5,,,1,The,main,useful,conclusion,of,this,work,is,the,indication,that,p-reﬁnement,is,likely,to,lead,to,sig-,niﬁcant,efﬁciency,gains,if,used,in,preference,to,h-reﬁnement.,Another,key,issue,is,that,of,the,maximum,stable,time,step,size,which,is,one,of,the,main,criteria,determining,how,much,compu-,tational,effort,is,entailed,by,a,calculation,and,which,was,found,to,depend,on,the,ﬁneness,of,the,discretization,and,on,details,of,the,ﬂow,through,the,Rayleigh,number.,Additionally,,expertise,in,using,Nektar++,has,been,cultivated.,This,two-dimensional,work,prepares,the,path,to,more,exten-,sive,simulations,in,more,complicated,geometries,and,in,three,dimensions,,and,is,likely,to,prove,a,valuable,guide,to,how,best,to,organize,future,work,on,HPC.,3,Smallab,experimental,programme,In,a,cutting-edge,technology,programme,such,as,fusion,reactor,development,for,STEP,or,DEMO,,test,facilities,must,be,ﬂexible,to,deal,with,issues,which,perhaps,were,not,initially,regarded,as,important,and,may,require,rapid,resolution,,for,example,in,the,light,of,new,experimental,data,or,during,construction,work.,UKAEA’s,Yorkshire,Fusion,Technology,Facility,FTF,will,be,home,to,the,CHIMERA,test,rig,,to,help,develop,and,test,materials,and,components,that,can,cope,with,the,con-,ditions,of,high,magnetic-ﬁeld,and,heat-ﬂux,found,inside,a,fusion,power,plant.,FTF,helps,address,critical,STEP,and,DEMO,design,issues,identiﬁed,by,Bachmann,et,al,[13],,viz.,integrated,design,of,breeding,blanket,and,ancillary,systems,(their,point,ii),and,power,exhaust,taking,advantage,of,advanced,divertor,conﬁgurations,(point,iii).,In,support,of,CHIMERA,,to,verify,scaling,properties,and,provide,physical,insight,,will,be,smaller,,simpler,table-top,experiments,such,as,Smallab.,New,experiments,,focussing,on,the,key,physics,are,justiﬁed,because,of,better,diagnostics,enabled,by,greater,data,handling,capability,,advances,in,remote,measurement,techniques,etc.,For,exam-,ple,,many,of,the,key,heat,transport,correlations,are,ripe,for,updating,,as,they,date,back,40,to,80,years,,apply,to,a,relatively,restricted,set,of,geometrical,conﬁgurations,,and,come,with,little,or,no,information,as,to,their,accuracy.,Preliminary,studies,for,NEPTUNE,illustrate,that,there,have,been,even,greater,advances,in,techniques,for,ﬁtting,models,to,data,,in,ﬁelds,such,as,optimisation,,un-,certainty,quantiﬁcation,and,data,assimilation,,now,often,bracketed,as,Machine,Learning,,expected,16,to,give,more,robust,ﬁtting,with,improved,error,estimates,,relative,to,the,old,power-law,scalings.,Increased,computational,power,and,the,greater,accuracy,expected,from,NEPTUNE,codes,en-,ables,the,use,of,more,complex,2-D,,3-D,and,time-dependent,physical,models,expected,to,be,more,robust,under,extrapolation,to,new,situations,and,regimes.,Nonetheless,the,presence,of,in,particular,turbulent,behaviour,means,that,there,is,still,a,need,for,cross-validation,capabilities,such,as,represented,in,particular,by,Smallab.,The,concept,is,that,Smallab,experimental,ﬂows,will,be,quick,and,easy,to,set,up,,not,much,more,than,the,assembling,of,pipes,,small,vessels,and,heaters,from,stock.,A,typical,example,is,the,prob-,lem,of,convection,in,a,slot,with,a,heated,sidewall,,already,investigated,as,part,of,NEPTUNE,UQ,activities,[14],(and,also,in,this,report),,a,slightly,more,complex,example,is,that,of,an,annular,pipe,with,a,heated,central,core.,Flow,speeds,of,5,m/s,or,less,will,be,typical,and,similarly,temparature,differences,limited,to,a,few,tens,of,degrees,C.,The,main,outlay,(near,six-ﬁgure,sum),has,been,to,the,LaVision,company,for,a,ﬂow,imaging,system,,speciﬁcally,a,MiniShaker,+,LED300,system.,This,itself,may,be,rapidly,set,up,and,calibrated,on,timescales,as,little,as,20,minutes.,In,the,supplied,diagnostic,system,,ﬂuid,ﬂow,is,measured,by,Doppler,effects,in,strong,LED,illumination.,The,raw,data,is,processed,by,the,DaVis,10,software,supplied,by,LaVision,to,return,ﬂow,vectors,as,high-resolution,volumetric,data,sampled,in,time,at,up,to,500,Hz.,The,DaVis,10,is,capable,of,using,knowledge,of,the,equations,of,classical,hydrodynamics,to,reﬁne,the,ﬂow-ﬁeld,information,,which,should,be,particularly,interesting,for,comparison,with,Nektar++,software.,Any,such,comparison,is,promised,to,be,made,easier,by,the,DaVis,ability,to,output,in,a,wide,range,of,formats,for,visualisation,and,similar,software,on,both,Windows,and,linux.,Should,more,complex,analyses,be,required,,the,software,is,opensource,C++,and,therefore,might,be,customised,by,skills,widely,available,to,project,NEPTUNE.,It,is,to,be,noted,that,the,numerics,described,in,the,preceding,sections,would,have,to,be,extended,to,three,dimensions,in,order,to,apply,to,larger-Ra,Smallab,experiments,,due,to,three-dimensional,instabilities,and,turbulence.,4,Oxford-led,discussion,group,meetings,The,group,have,been,meeting,roughly,fortnightly,over,Zoom.,The,meetings,were,chaired,by,Felix,Parra,until,his,departure,for,PPPL,,and,are,now,chaired,by,Michael,Barnes.,Other,regular,attendees,are,Michael,Hardman,and,Javier,Maurino-Alperovich,(from,the,University,of,Oxford),and,John,Omotani,,Sarah,Newton,,Stefan,Mijin,and,Joseph,Parker,(from,UKAEA),,along,with,members,of,other,NEPTUNE,projects,,Ben,McMillan,,Ben,Dudson,and,David,Dickinson.,The,meetings,were,primary,focused,on,Felix,Parra,and,Michael,Barnes,presenting,their,respective,progress,with,the,development,of,the,referent,equations,and,their,implementation,,and,to,discuss,challenges,arising.,The,progress,is,presented,in,the,project’s,technical,reports.,In,addition,,the,project’s,source,code,is,available,at,the,GitHub,repository,[15],The,code,is,presently,1+1D,for,space,and,velocity,space,parallel,to,the,magnetic,ﬁeld,line.,In,both,dimensions,,the,user,may,choose,a,ﬁnite,difference,or,Chebyshev,(pseudo)spectral,element,discretization,at,run,time.,The,code,is,written,in,Julia,,making,extensive,use,of,external,libraries,(which,in,Julia,are,automatically,managed,and,may,be,precompiled).,The,project,has,good,software,practices,,making,use,of,17,GitHub,issues,and,peer-reviewed,pull,requests.,The,code,has,unit,and,regression,test,suites,that,are,automatically,run,on,pull,requests,,as,well,as,frameworks,for,code,proﬁling,and,performance,regression.,18,5,Summary,This,report,has,provided,an,overview,of,preliminary,application,of,Nektar++,to,a,problem,in,thermal,convection.,It,has,identiﬁed,that,the,dynamics,of,the,system,in,question,become,more,challeng-,ing,for,larger,temperature,differences,(encoded,in,the,dimensionless,Rayleigh,number),and,the,consequent,greater,rates,of,heat,transfer,(measured,by,the,dimensionless,averaged,Nusselt,num-,ber).,The,main,challenges,are,the,need,to,resolve,steep,gradients,in,the,boundary,regions,and,the,fact,that,the,maximum,stable,time,step,size,decreases,as,the,Rayleigh,number,is,increased,and,also,as,the,accuracy,of,the,calculation,is,increased.,Probably,the,main,conclusion,is,the,effectiveness,of,p-reﬁnement,in,favour,of,h-reﬁnement.,In,addition,,attention,was,drawn,to,the,re-,strictions,on,the,maximum,stable,time,step,size,imposed,by,the,spatial,discretization,and,also,as,a,result,of,increasing,the,Rayleigh,number,(a,more,detailed,study,of,this,issue,is,clearly,indicated).,The,complementary,experimental,programme,Smallab,was,outlined,with,reference,to,its,operlap,with,the,Nektar++,numerical,simulations.,In,addition,to,this,application,of,ﬁnite,element,methods,,the,Oxford-led,discussion,group,continues,to,innovate,in,terms,of,applying,ﬁnite,element,to,more,advanced,referent,models,of,the,exotic,ﬂuids,found,in,magnetically-conﬁned,fusion,plasmas.,The,numerical,simulations,outlined,in,this,report,used,a,very,simple,geometry;,one,eye,is,kept,on,the,case,of,realistic,ﬁrst-wall,geometries,and,the,additional,constraints,applied,by,accurate,mesh-,ing,requirements;,a,small,excursion,in,this,direction,is,presented,in,Appendix,D.,Such,geometrical,considerations,lead,to,the,proliferation,of,elements,and,perhaps,consequent,moderation,of,the,choice,of,element,order,,though,more,study,needs,to,be,done,in,order,to,uncover,ﬁrm,conclusions,in,this,area.,The,main,author,of,this,report,would,like,to,cite,support,received,via,the,Nektar++,mail,list,,from,in,particular,Dr.,Abhishek,Kumar,(Centre,for,Fluid,and,Complex,Systems,,Coventry,University),who,provided,an,example,Nektar++,session,ﬁle,for,the,Rayleigh-B,´enard,problem.,The,author,would,like,to,thank,also,the,developers,of,Nektar++,for,useful,discussions.,Acknowledgement,The,support,of,the,UK,Meteorological,Ofﬁce,and,Strategic,Priorities,Fund,is,acknowledged.,A,Convergence,In,this,appendix,,the,theoretical,exponential,convergence,of,the,Nektar++,software,is,demon-,strated,for,the,steady,state,of,a,classical,convection,problem,solved,on,a,ﬁxed,uniform,2D,quadri-,lateral,mesh.,For,a,smooth,convecting,solution,in,a,cavity,,the,logarithmic,error,in,the,calculation,(evaluated,against,a,‘converged’,high-order,calculation,for,this,simple,smooth,ﬂow),was,plotted,against,the,element,order.,The,error,here,is,the,global,L2,error,in,the,solution,ﬁelds,i.e.,the,squared,error,integrated,over,the,entire,domain,,which,is,output,automatically,by,Nektar++.,19,Figure,8:,Error,scaling,with,element,order,showing,exponential,convergence.,The,results,(Fig.8),show,that,this,error,decreases,exponentially,with,increasing,element,order,,in,line,with,the,theoretical,promise,for,spectral,/,hp,methods,as,applied,to,a,smooth,solution.,Note,that,this,method,cannot,be,applied,directly,to,the,higher-Ra,,quasi-steady,cases,,as,these,are,chaotic,and,only,statistical,properties,of,the,ﬂows,are,expected,to,remain,consistent,between,simulations,with,different,computational,parameters,(i.e.,one,cannot,meaningfully,compare,indi-,vidual,instantaneous,ﬁeld,values).,B,Nektar++,VelocityCorrectionScheme,pressure,anomaly,Simulations,of,smooth,convective,ﬁelds,showed,an,obvious,anomaly,in,the,pressure,ﬁeld,(left-,hand-side,plot,in,Fig.9):,using,the,VelocityCorrectionScheme,option,for,the,incompressible,Navier-Stokes,solver,resulted,in,a,single,boundary,point,having,a,pressure,value,ﬁxed,at,zero,,dif-,fering,in,a,large,amount,from,all,neighbouring,nodal,values,(note,that,the,VelocityCorrectionScheme,is,a,component,of,the,incompressible,Navier-Stokes,algorithm,that,deals,with,decoupling,the,ve-,locity,and,the,pressure,systems;,the,latter,is,solved,using,a,Poisson,equation,with,a,homogeneous,Neumann,boundary,condition).,In,fact,,the,same,problem,as,seen,here,can,be,created,artiﬁcially,using,a,Poisson,equation,where,the,Neumann,boundary,condition,is,inconsistent,with,the,right-hand-side,of,the,equation.,The,Neumann,problem,has,a,compatibility,condition:,if,∇2u,=,−f,in,a,domain,Ω,and,the,boundary,condition,is,αu,+,β∇nu,=,g,on,∂Ω,then,the,divergence,theorem,gives,the,constraint,(cid:82),Ω,f,=,0.,As,a,test,,this,problem,was,set,up,in,the,two-dimensional,advection-diffusion-reaction,solver,of,Nektar++,and,it,was,seen,that,an,inconsistent,case,gives,a,similar,anomaly,to,that,observed,in,the,incompressible,Navier-Stokes,solver,pressure,ﬁeld;,also,that,the,anomaly,disappears,if,the,right-hand-side,term,term,is,offset,to,give,a,volume,integral,of,zero.,The,hypothesis,is,that,a,It,is,similar,inconsistency,is,present,within,the,implementation,of,VelocityCorrectionScheme.,∂Ω,g,+,(cid:82),20,Figure,9:,Left:,pressure,anomaly,in,the,top-right,domain,corner,using,VelocityCorrectionScheme,in,Nektar++.,Right:,the,same,system,solved,using,VCSWeakPressure,instead,,showing,no,issue.,Figure,10:,Temperature,contours,(Fig.7(a),from,[5]),on,the,left,(Ra,=,2,×,104;,P,r,=,1;,λ,=,1,and,note,that,the,aspect,ratio,of,the,simulated,cavity,is,actually,unity,,though,not,shown,as,such,in,the,ﬁgure).,The,middle,plot,shows,the,Nektar++,temperature,proﬁle,at,the,end,of,the,p,=,3,simulation,(steady,state,reached),and,the,rightmost,image,shows,(if,not,very,well),the,20,×,20,grid,of,ﬁnite,elements.,presumably,straightforward,to,perform,the,relevant,integrals,in,the,Nektar++,framework,to,conﬁrm,this,,though,this,is,yet,to,be,done.,The,need,to,solve,this,issue,is,tempered,by,the,availability,within,Nektar++,of,an,alternative,to,the,VelocityCorrectionScheme,,called,VCSWeakPressure:,this,alternate,does,not,show,the,anomaly.,C,Elder’s,results,C.1,Elder’s,results,Early,numerical,work,by,Elder,on,classical,convection,,using,P,r,=,1,,shows,plots,of,the,tempera-,ture,ﬁeld,that,concur,well,with,the,output,of,Nektar++,(Fig.10).,However,,an,accompanying,graph,of,N,u,as,a,function,of,Ra,disagrees,in,the,size,of,Nusselt,number,obtained,for,given,Rayleigh,number,(Fig.11).,The,difference,is,probably,due,to,a,choice,of,boundary,condition,,given,that,the,historic,simulation,used,different,degrees,of,freedom,(namely,velocity,potential,and,vorticity).,21,Figure,11:,Overlay,of,Elder’s,graph,(from,[5]),and,Nektar++,results,(blue,spots),for,the,dependence,of,N,u,on,Ra.,Note,that,larger-Ra,Nektar++,simulations,using,P,r,=,7.0,(the,value,for,water),show,ﬂow,patterns,(Fig.12),that,compare,quite,well,with,water-tank,experiments,by,the,same,author,[6].,D,Estimates,for,the,number,of,ﬁnite,elements,in,a,NEPTUNE,simu-,lation,D.1,Estimate,of,number,of,elements,required,on,surface,meshing,grounds,This,subsection,contains,an,estimate,of,the,number,of,elements,necessitated,by,surface,meshing,accuracy,requirements,found,in,the,NEPTUNE,grantee,report,[16].,The,following,assumptions,are,made:,•,There,are,500,structures,to,be,meshed,in,the,tokamak,,each,of,which,approximates,a,sphere,or,a,box,section,as,treated,in,[16].,•,There,are,20,elements,needed,to,mesh,away,from,the,meshed,surface,to,give,a,3D,mesh.,These,assumptions,together,give,an,uplift,of,10,000,above,the,number,of,elements,needed,to,mesh,the,surface,of,a,single,structure,such,that,there,are,no,deviations,between,the,mesh,and,the,CAD,greater,than,0.1◦.,Note,that,the,box,section,structure,treated,in,[16],may,be,a,reasonable,proxy,for,some,of,the,components,in,a,real,tokamak,e.g.,the,plasma-facing,Faraday,screen,of,the,RF,antennae,used,for,ICRF,heating,and,current,drive,,and,also,the,ITER,divertor,support,structure.,The,number,of,elements,needed,to,mesh,an,individual,object,is,estimated,from,Tables,1,and,2,in,[16],by,interpolating,or,extrapolating,the,relation,between,the,worst,angle,deviation,and,the,number,of,needed,elements,to,give,the,number,of,elements,needed,for,a,0.1◦,worst,deviation,(the,average,angle,deviation,could,also,be,considered).,This,interpolation,/,extrapolation,was,done,22,Figure,12:,On,the,left,is,Fig.2(a),of,[6],showing,ﬂow,pattern,for,Ra,=,2.2,×,107,in,a,tank,of,water,,visualized,using,dye,injection.,On,the,right,is,the,quasi-steady,state,for,the,corresponding,Nektar++,simulation;,this,simulation,used,a,uniform,mesh,12,quadrilaterals,across,the,horizontal,axis,and,p,=,3.,23,structure,order,num,elts,in,mesh,num,DOFs,in,computation,sphere,sphere,sphere,box,box,box,box,4.7,×,109,1.2,×,109,3.2,×,108,1.6,×,1011,1.4,×,1011,4.1,×,1010,4.7,×,1010,4.7,×,107,6.0,×,106,9.2,×,105,1.6,×,109,6.7,×,108,1.2,×,108,8.3,×,107,2,3,4,2,3,4,5,Table,4:,Estimates,of,the,number,of,elements,required,to,achieve,surface,normal,accuracy,of,0.1◦,or,better,for,the,two,structures,tested,in,[16].,Figure,13:,Log-linear,ﬁts,for,interpolating,/,extrapolating,the,number,of,elements,needed,to,give,θmax,=,0.1◦,,for,sphere.,by,constructing,a,plot,of,log10,θmax,against,log10,Nelmt,where,θmax,is,the,worst,angle,and,Nelmt,the,number,of,elements,in,the,surface,mesh,-,the,resulting,plots,are,near,linear,(i.e.,approximate,power-law,relations).,Note,that,the,90◦,anomalies,and,also,the,highest-res,p,=,4,sphere,mesh,were,excluded,from,these,ﬁts.,For,the,sphere,case,,see,Fig.13.,The,results,are,shown,in,Table,4.,Numbers,include,the,uplift,mentioned,above.,The,DOF,count,assumes,the,3D,element,computational,order,matches,the,geometrical,order,of,the,surface,for,all,elements,(and,includes,also,an,uplift,of,10,to,allow,for,multiple,ﬁelds,e.g.,Maxwell,,pressure,,temperature,...),-,for,a,single,ﬁeld,the,number,of,degrees,of,freedom,is,NDOF,=,1,6,(p+3)(p+2)(p+1),for,an,element,of,order,p,i.e.,assuming,tetrahedral,elements,(other,element,geometries,modify,this,formula,but,all,scale,∼,p3).,Simple,explanation,-,order-2,sphere,-,look,at,Fig.13,and,see,that,the,blue,curve,crosses,log10,θmax,=,−1,(i.e.,0.1◦),at,about,5,000,elements,,then,multiply,by,the,uplift,of,10,000,to,get,the,number,4.7,∗,107;,for,the,DOFs,multiply,this,by,10,DOFs,per,elt,at,p,=,2,and,a,factor,of,10,to,allow,for,all,the,different,ﬁelds.,24,D.2,Order-of-magnitude,estimates,for,tokamak,edge,modelling,This,subsection,contains,some,ballpark,estimates,of,the,computational,feasibility,of,an,anticipated,full-scale,NEPTUNE,calculation.,Suppose,plasma,number,density,n,≈,1018,m−3.,Order,of,magnitude,dimensions,are,L,≈,0.1,m,for,SOL,thickness,,reactor,minor,and,major,radii,say,a,=,3,m,and,R0,=,10,m,,so,volume,of,SOL,≈,4π2aR0L,≈,100,m3.,Hence,total,number,of,electrons,≈,1020.,Shortest,timescale,is,inverse,eB/me,,the,electron,cyclotron,frequency,,where,e/me,=,1.76×1011,C,kg−1,,and,B,≈,10,T,,so,τBe,≈,10−12,s.,Hence,number,of,particle-steps,to,evolve,1,s,of,physical,time,is,1020+12+1,,and,assuming,1000,ﬂop,per,update,,need,1036,ﬂops.,So,to,complete,in,1,s,on,Exascale,machine,,only,allowed,to,sample,1,particle-step,in,1018.,(Unlikely,to,be,adequate,because,of,electrostatic,and,other,effects.),Suppose,ﬂuid,instead,,ie.,representing,electron,distribution,by,ﬁrst,3,moments.,Electron,tempera-,ture,Te,≈,10,eV,,thermal,speed,VT,e,≈,106,m,s−1.,Sample,SOL,at,uniform,1,mm,interval,,number,of,sample-points,≈,1011,,timestep,for,explicit,scheme,≈,0.1,×,(10−3/106),so,number,of,sample-point,updates,is,1011+10,,assume,1000,ﬂop,each,update,,need,1024,ﬂops.,Another,way,,suppose,numerical,problem,is,D-dimensional,,need,1000,ﬂop,each,sample,update,and,allowed,ND,samples,per,spatial,dimension,and,N,2,D,in,time.,Then,to,update,in,1,s,,have,N,D+2,≈,1015.,Thus,if,D,=,3,,N3,≈,1,000,,and,N5,≈,100.,Accuracy,controlled,,unstructured,,D,implicit,ﬂuid,models,should,be,possible.,References,[1],G.,Karniadakis,and,S.,Sherwin.,Spectral/hp,element,methods,for,computational,ﬂuid,dy-,namics,2nd,Ed.,Oxford,University,Press,,2005.,https://doi.org/10.1093/acprof:oso/,9780198528692.001.0001.,[2],D.,Moxey,et,al.,Nektar++,website.,https://www.nektar.info,,2020.,Accessed:,June,2020.,[3],Nektar-diffusion,proxyapp.,https://github.com/ExCALIBUR-NEPTUNE/nektar-diffusion,,2021.,Accessed:,September,2021.,[4],Nektar++,solver,for,Hasegawa-Wakatani,equations.,https://github.com/,ExCALIBUR-NEPTUNE/nektar-driftwave,,2021.,Accessed:,September,2021.,[5],J.W.,Elder.,Numerical,experiments,with,free,convection,in,a,vertical,slot.,Journal,of,Fluid,Mechanics,,24:823–843,,1965.,[6],J.W.,Elder.,Turbulent,free,convection,in,a,vertical,slot.,Journal,of,Fluid,Mechanics,,23(1):99–,111,,1965.,https://doi.org/10.1017/S0022112065001258.,[7],J.L.,Wright,and,H.F.,Sullivan.,Natural,convection,in,sealed,glazing,units:,a,review.,ASHRAE,Transactions,,95,,1989.,25,[8],J.,Xam,´an,,G.,`Alvarez,,L.,Lira,,and,C.,Estrada.,Numerical,study,of,heat,transfer,by,laminar,and,turbulent,natural,convection,in,tall,cavities,of,fac¸ade,elements.,Energy,and,Buildings,,37:787–794,,2005.,[9],C.S.,Ng,,A.,Ooi,,D.,Lohse,,and,D.,Chung.,Vertical,natural,convection:,application,of,the,unifying,theory,of,thermal,convection.,Journal,of,Fluid,Mechanics,,764:349–361,,2015.,[10],S.,Grossmann,and,D.,Lohse.,Scaling,in,thermal,convection:,a,unifying,theory.,Journal,of,Fluid,Mechanics,,407:27–56,,2000.,[11],F.,Wilczynski,,D.W.,Hughes,,S.,Van,Loo,,W.,Arter,,and,F.,Militello.,Stability,of,scrape-off,layer,plasma:,A,modiﬁed,Rayleigh–B,´enard,problem.,Physics,of,Plasmas,,26(2):022510,,2019.,https://doi.org/10.1063/1.5064765.,[12],F.H.,Busse,and,R.M.,Clever.,An,asymptotic,model,of,two-dimensional,convection,in,the,limit,of,low,prandtl,number.,Journal,of,Fluid,Mechanics,,102:75–83,,1981.,[13],C.,Bachmann,,S.,Ciattaglia,,F.,Cismondi,,G.,Federici,,G.,Keech,,F.,Maviglia,,and,M.,Siccinio.,Critical,Design,Issues,in,DEMO,and,Solution,Strategies.,Paper,presented,at,SOFT,2018,,2018.,[14],E.,Threlfall,and,W.,Arter.,Assessment,of,which,UQ,methods,are,required,to,make,NEPTUNE,software,actionable.,Technical,Report,CD/EXCALIBUR-FMS/0035-M2.4.1,,UKAEA,,2021.,[15],Moment,kinetics.,September,2021.,https://github.com/mabarnes/moment_kinetics,,2021.,Accessed:,[16],D.,Moxey,,C.,Cantwell,,and,S.,Sherwin.,Surface,mesh,generation.,Technical,Report,2048465-,TN-01-1,,UKAEA,Project,Neptune,,2021.,26" name="keywords" />

    <title>CD-EXCALIBUR-FMS0051-M6.1_FiniteElementModelsComplementaryActivitiesI &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cd-excalibur-fms0051-m6-1-finiteelementmodelscomplementaryactivitiesi">
<h1>CD-EXCALIBUR-FMS0051-M6.1_FiniteElementModelsComplementaryActivitiesI<a class="headerlink" href="#cd-excalibur-fms0051-m6-1-finiteelementmodelscomplementaryactivitiesi" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/CD-EXCALIBUR-FMS0051-M6.1_FiniteElementModelsComplementaryActivitiesI.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/CD-EXCALIBUR-FMS0051-M6.1_FiniteElementModelsComplementaryActivitiesI.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>