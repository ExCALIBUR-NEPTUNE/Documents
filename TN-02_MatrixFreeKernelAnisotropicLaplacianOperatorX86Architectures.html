
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="Matrix-free,kernel,for,the,anisotropic,Laplacian,operator,for,x86,architectures,1,Motivation,The,development,of,robust,solvers,for,partial,diﬀerential,equations,(PDEs),using,high-order,spectral/hp,element,methods,has,been,an,area,gaining,momentum,among,research,communities,over,recent,years,[1,,2].,The,spectral/hp,element,method,utilises,high-order,polynomial,expansions,which,leads,to,a,number,of,ad-,vantages,over,low-order,numerical,methods,,including,a,signiﬁcantly,lower,level,of,numerical,dispersion,and,dissipation.,In,addition,,memory,bandwidth,,rather,than,clock,speed,,has,become,the,bottleneck,in,achieving,high,throughput,on,modern,processes,in,recent,years.,This,favours,high-order,numerical,methods,which,have,higher,arithmetic,intensity,,performing,more,ﬂoating-point,opera-,tions,for,each,byte,transferred,from,memory.,To,maximise,this,arithmetic,intensity,when,using,the,high-order,spectral/hp,element,methods,to,solve,the,anisotropic,thermal,conduction,formulation,un-,der,the,Nektar++,framework,[3],,an,eﬃcient,matrix-free,operator,together,with,the,single-instruction,multiple-data,(SIMD),vectorization,methodology,is,imple-,mented.,The,matrix-free,operator,avoids,the,explicit,construction,of,either,large,assembled,global,matrices,or,many,dense,local,matrices.,It,utilizes,the,tensor,product,construction,of,the,basis,functions,in,the,spectral/hp,element,to,apply,a,sum-factorization,technique,[4].,2,Implementation,in,Nektar++,Nektar++,[3],is,a,cross-platform,spectral/hp,element,framework,for,solving,a,range,of,scientiﬁc,and,engineering,problems,where,high-ﬁdelity,solutions,are,required.,To,implement,the,matrix-free,operator,and,SIMD,technique,for,the,anisotropic,thermal,conduction,formulation,in,the,Nektar++,framework,,the,following,changes,are,made,in,its,architecture:,–,a,matrix-free,implementation,of,Helmholtz,operator,supporting,anisotropic,diﬀusion,is,created;,–,single-instruction,multiple-data,(SIMD),vectorisation,is,implemented,for,this,Helmholtz,operator.,2.1,Helmholtz,equation,and,its,variational,form,The,anisotropic,steady,diﬀusion,equation,can,be,formulated,as,the,inhomoge-,neous,Helmholtz,equation,with,the,scalar,constant,λ,=,0,,given,by,(κc,T,),−,·,∇,∇,·,λT,=,Q,(1),2,where,κc,,λ,and,Q,are,the,anisotropic,diﬀusion,tensor,,reaction,coeﬃcient,and,a,forcing,term,in,the,ﬁeld,,respectively.,Applying,the,Galerkin,method,of,weighted,residuals,to,Equation,(1),and,the,divergence,theorem,on,the,Laplacian,operator,,its,variational,form,satisﬁes,(cid:90),Ω,vh(κc,[,∇,·,∇,T,h)]dΩ,+,λ,(cid:90),Ω,[vhT,h]dΩ,=,(cid:90),−,+,Ω,(cid:90),Γ,[vhQ]dΩ,[vh(κc,T,h),·,·,∇,n]dΓ,(2),for,all,test,functions,vh.,Now,dropping,the,h,superscript,for,clarify,,we,can,expand,T,h,and,vh,in,terms,of,the,basis,functions,on,each,element,,(cid:88),T,e,=,ˆT,eψe,i,,,i,where,the,superscript,(”e”),refers,to,elemental,quantities.,Expressing,as,a,matrix,system,,we,arrive,at,Le,ˆT,e,+,λM,e,ˆT,e,=,H,e,=,Le,+,λM,e,BeW,eQe,+,Γ,−,=,⇒,(3),where,the,matrices,Le,,M,e,and,Be,respectively,are,the,discrete,representations,of,Laplacian,,mass,and,basis,evaluation,operators.,W,e,is,a,diagonal,matrix,of,quadrature,weights,and,ˆT,e,is,the,matrix,of,elemental,basis,functions,φi,evaluated,at,the,quadrature,points,,ξj.,For,the,non-zero,surface,ﬂux,,the,vector,Γ,is,introduced,to,represent,the,boundary,integral,term,in,equation,(2).,Therefore,,the,Helmholtz,operator,for,each,element,can,be,deﬁned,as,H,e,in,equation,(3).,The,detailed,formulation,of,Le,and,M,e,can,be,written,as,Le,=,(DeBe)ge(DeBe)T,W,e,M,e,=,BeW,e(Be)T,(4a),(4b),where,D,,B,and,W,respectively,are,the,one-dimensional,derivative,matrix,,basis,matrix,and,diagonal,weight,of,numerical,integration,in,the,standard,region,1,,1]d,(uniquely,deﬁned,for,each,element,type).,The,metric,,ge,,element,Ξ,incorporates,the,diﬀusion,tensor,κc,and,the,inverse,of,Jacobian,matrix,J,,,as,[,−,⊂,ge,=,(J,e)−1κc(J,e)−T,=,(cid:21),(cid:20)g00,g01,g10,g11,κc,=,(cid:21),(cid:20)κ00,κ01,κ10,κ11,;,(J,e)−1,=,(cid:21),(cid:20)j00,j01,j10,j11,(5),00,+,2κ01j00j01,+,κ11j2,01,g00,=,κ00j2,g01,=,g10,=,κ00j00j10,+,κ01(j01j10,+,j00j11),+,κ11j01j11,g11,=,κ00j2,10,+,2κ01j10j11,+,κ11j2,11,Matrix-free,x86,implementation,3,2.2,Matrix-free,operator,By,noting,that,the,expansions,are,tensor,products,of,one-dimensional,functions,,an,eﬃcient,matrix-free,operator,can,be,constructed,with,the,technique,of,sum-,factorisation.,For,instance,,considering,the,backward,transformation,that,maps,spectral/hp,element,coeﬃcients,to,their,physical,representation,,which,in,two,dimensions,is,expressed,as,T,e(ξi,,ξj),=,pq,(cid:88),i,j,ˆT,e,ijψe,ij(ξi,,ξj),=,p,(cid:88),q,(cid:88),i,j,ˆT,e,ijφe,i,(ξi)φe,j(ξj),,(6),where,ˆT,represents,the,coeﬃcients,of,basis,expansion.,Therefore,,the,matrix-free,operation,can,be,performed,by,recasting,Equation,(6),as,T,e(ξi,,ξj),=,p,(cid:88),i,φe,i,(ξi),(cid:104),q,(cid:88),j,(cid:105),ˆT,e,ijφe,j(ξj),(7),The,summation,term,in,the,square,brackets,can,be,evaluated,and,stored,ﬁrst.,Subsequently,,the,physical,representation,,T,e(ξi,,ξj),,can,be,computed,by,itera-,tively,summing,the,terms,outside,the,square,bracket.,In,such,a,way,,the,original,(P,3),operations,during,back-,O,ward,transformation,inside,the,matrix-free,operator.,The,complete,algorithm,of,matrix-free,evaluation,of,Helmholtz,operator,is,described,in,Section,2.4,(P,4),operation,has,been,replaced,with,two,O,2.3,SIMD,Vectorisation,Traditional,processor,registers,only,have,suﬃcient,space,to,hold,one,value,at,a,time.,However,,the,modern,CPU,registers,are,capable,of,holding,vectors,of,multiple,values.,With,the,use,of,instruction,set,extensions,,it,has,become,possible,to,run,one,operation,on,multiple,pieces,of,data,at,the,same,time.,These,types,of,operations,are,known,as,single-instruction,multiple-data,(SIMD),operations,and,lead,to,a,type,of,parallelism,which,is,known,as,vectorisation.,2.4,Implementation,To,leverage,vectorisation,in,the,matrix-free,operator,in,the,anisotropic,thermal,conduction,formulation,,the,Helmholtz,operator,in,Nektar++,is,re-formulated,as,shown,in,Algorithm,1.,In,Algorithm,1,,deformed,refers,to,a,non-linear,reference-to-world,mapping,,for,which,we,require,the,calculation,of,the,metric,g,for,each,quadrature,point.,BwdTrans,,PhysDeriv,and,IProduct,are,the,backward,transformation,,partial,derivative,of,the,physical,solution,and,inner,product,operations,,respectively.,Therefore,,the,Helmholtz,operator,can,be,re-written,as,,H,e,=,qp,(cid:88),[,n=0,∇,ψh(ηn),(J,e(ηn))−1[κc(ηn),(J,e(ηn))−T,ψh(ηn)],∇,·,ωh(ηn),J,e(ηn),+λψh(ηn)ψh(ηn)],|,|,(8),4,for,each,quadrature,point,η,do,g,←,(J,(η))−1κc(η)(J,(η))−T,DT,h(η),←,gDT,h(η),Algorithm,1,Overview,of,matrix-free,evaluation,of,Helmholtz,operator,1:,Helmholtz(,ˆT,,,ω,,B,,∇B,,J,,,κc),2:,for,each,element,group,do,T,h,←,BwdTrans(,ˆT,,,B),3:,out,←,λ·,IProduct(,ˆT,,,B,,ω,,|J,|),4:,DT,h,←,PhysDeriv(T,h,,D,,(J,)−1),5:,6:,if,element,is,deformed,then,7:,8:,9:,10:,11:,12:,13:,14:,15:,16:,17:,end,for,18:,for,each,dimension,d,do,19:,20:,end,for,21:,return,out,g,←,(J,)−1κc(J,)−T,for,each,quadrature,point,η,do,out,←,out,+,IProduct(DT,h,,∂dB,,ω,,|J,|),DT,h(η),←,gDT,h(η),end,for,end,for,end,if,else,Here,,the,symbol,η,refers,to,the,location,of,Gauss,points,in,the,quadrature,rule,and,qp,is,the,total,number,of,Gauss,quadrature,points.,Line,9,and,14,in,Algorithm,1,refer,to,the,sum-factorisation,operation,in,the,matrix-free,operator,,similar,to,the,term,in,the,square,bracket,in,Equation,(7).,After,it,has,been,com-,puted,for,all,elements,in,one,dimension,,the,matrix-free,operator,is,constructed,by,iteratively,summing,the,tensor,products,in,all,direction,,as,shown,in,line,19,in,Algorithm,1.,The,resultant,algorithm,is,an,optimization,matrix-free,operator,with,SIMD,vectorisation.,3,Problem,setup,In,Nektar++,,simulations,are,conﬁgured,using,XML,session,ﬁles.,In,order,to,employ,the,matrix-free,operator,and,SIMD,vectorisation,in,simulations,,the,following,elements,should,be,included,in,the,.xml,ﬁles:,&lt;COLLECTIONS,DEFAULT=&quot;MatrixFree&quot;,/&gt;,and,&lt;SOLVERINFO&gt;,&lt;I,PROPERTY=&quot;EQTYPE&quot;,VALUE=&quot;SteadyDiffusion&quot;/&gt;,&lt;I,PROPERTY=&quot;Projection&quot;,VALUE=&quot;Continuous&quot;/&gt;,&lt;I,PROPERTY=&quot;GlobalSysSoln&quot;,VALUE=&quot;IterativeFull&quot;/&gt;,Matrix-free,x86,implementation,5,&lt;I,PROPERTY=&quot;Preconditioner&quot;,VALUE=&quot;Diagonal&quot;/&gt;,&lt;/SOLVERINFO&gt;,&lt;GLOBALSYSSOLNINFO&gt;,&lt;V,VAR=&quot;u&quot;&gt;,&lt;I,PROPERTY=&quot;GlobalSysSoln&quot;,VALUE=&quot;IterativeFull&quot;/&gt;,&lt;I,PROPERTY=&quot;LinSysIterSolver&quot;,VALUE=&quot;ConjugateGradient&quot;/&gt;,&lt;I,PROPERTY=&quot;Preconditioner&quot;,VALUE=&quot;Diagonal&quot;/&gt;,&lt;I,PROPERTY=&quot;MaxIterations&quot;,VALUE=&quot;5000&quot;/&gt;,&lt;I,PROPERTY=&quot;IterativeSolverTolerance&quot;,VALUE=&quot;1e-6&quot;/&gt;,&lt;/V&gt;,&lt;/GLOBALSYSSOLNINFO&gt;,The,&lt;COLLECTIONS,DEFAULT=&quot;MatrixFree&quot;/&gt;,element,should,be,added,di-,rectly,under,the,root,element,,&lt;NEKTAR&gt;,,which,forces,the,Nektar++,library,to,use,the,matrix-free,operator,implementation,for,the,computations.,In,the,.xml,ﬁle,,the,&lt;GLOBALSYSSOLNINFO&gt;,is,added,as,a,sub-element,into,the,&lt;CONDITIONS&gt;,element.,It,deﬁnes,the,parameters,to,control,the,convergence,of,the,chosen,iter-,ative,solver.,The,Conjugate,Gradient,(ConjugateGradient),or,Generalized,Min-,imal,Residual,method,(GMRES),iterative,solver,can,be,used,together,with,the,matrix-free,operators,by,specifying,the,LinSysIterSovler,tag,in,.xml,session,ﬁle.,For,instance,,the,values,of,IterativeSolverTolerance,and,MaxIterations,tags,control,the,convergence,tolerance,,the,maximum,number,of,iteration,in,the,employed,iterative,solver.,The,value,of,GMRESMaxStorage,tag,deﬁnes,the,dimen-,sion,of,the,Krylov,subspace,of,the,GMRES,solver,,and,the,maximum,restart,of,GMRES,algorithm,is,controlled,by,the,value,of,IterativeSolverTolerance,divided,by,GMRESMaxStorage.,The,performance,of,the,optimized,matrix-free,operator,with,SIMD,vectoris-,tion,is,compared,with,the,basic,matrix-free,operator,,IterativeFull,,and,multi-,level,static,condensation,method,in,this,study.,In,the,basic,matrix-free,operator,,each,arithmetic,operation,is,performed,individually,without,the,vectorisation,or,optimisation,for,multiple,elements.,To,switch,oﬀ,the,optimized,matrix-free,oper-,ator,,the,element,&lt;COLLECTIONS,DEFAULT=&quot;MatrixFree&quot;/&gt;should,be,removed,in,the,.xml,session,ﬁle.,However,for,both,cases,of,basic,and,optimized,matrix-free,operators,,the,element,&lt;I,PROPERTY=&quot;GlobalSysSoln&quot;,VALUE=&quot;IterativeFull&quot;/&gt;,must,be,present,in,the,.xml,session,ﬁle.,In,addition,to,the,aforementioned,tags,,the,value,of,the,GlobalSysSoln,tag,can,be,set,as,IterativeMultiLevelStaticCond,or,XxtMultiLevelStaticCond,to,activate,the,multilevel,static,condensation,method.,Furthermore,,to,investigate,the,unsteady,cases,,the,value,of,EQTYPE,should,be,changed,to,UnsteadyDiffusion,and,the,.xml,session,ﬁle,will,incor-,porates,the,following,parameters,,TimeStep,,FinalTime,and,NumSteps.,For,the,detailed,conﬁgurations,of,the,cases,of,basic,and,optimized,matrix-free,operators,and,multilevel,static,condensation,methods,,please,refer,to,the,.xml,session,ﬁles,in,example,folder,in,the,repository.,6,4,Performance,evaluation,In,this,section,,the,performance,of,the,matrix-free,with/without,SIMD,vectori-,sation,is,compared,with,the,basic,matrix-free,operator,(using,GMRES,iterative,solver),and,Multi-Level,Static,Condensation,method,in,the,steady,and,unsteady,cases.,Those,testing,cases,can,be,found,in,the,directory,,example,,in,the,reposi-,tory.,In,all,the,testing,cases,,the,CPU,used,is,an,Intel,i7-8550U,with,a,standard,clock,speed,of,1.8Hz,and,support,for,AVX2,instructions.,The,numerical,examples,are,run,in,parallel,using,1-4,processes.,The,parameters,of,the,full,iterative,solver,are,shown,in,the,above,&lt;GLOBALSYSSOLNINFO&gt;,element.,The,size,of,the,com-,putational,domain,for,the,steady,and,unsteady,cases,is,5,5,and,the,employed,×,mesh,resolutions,are,40,80,elements.,The,order,of,the,expansion,basis,ranges,from,2,to,8.,The,same,iterative,solver,parameters,are,used,for,all,numerical,examples,,e.g.,,the,tolerance,,maximum,iteration,number,and,so,on.,The,obtained,results,are,presented,in,the,subsequent,sections.,40,and,80,×,×,4.1,Steady,cases,The,execution,speeds,of,the,basic,and,optimized,matrix-free,operators,are,ﬁrst,compared,in,serial,in,Figure,1.,The,orange,and,blue,curves,show,the,speed-up,of,the,optimized,matrix-free,operator,(ratios,of,the,execution,time,of,the,basic,matrix-free,operator,to,the,optimized,one).,It,can,be,seen,that,the,optimized,matrix-free,operator,is,always,more,eﬃcient,than,the,basic,one,for,all,expansion,orders,in,this,study.,Figure,1,shows,that,the,optimised,operator,is,signiﬁcantly,faster,for,low,polynomial,orders.,The,performance,gain,reduces,as,the,expansion,order,increases.,Furthermore,,as,the,mesh,resolution,increases,,e.g.,,the,blue,line,in,Figure,1,for,80,80,,the,performance,diﬀerence,increases,further.,×,Fig.,1:,Speedup,(ratio,of,execution,time,of,basic,,relative,to,optimized,matrix-free,operators),with,SIMD,for,steady,cases,in,serial.,2345678ExpansionOrder010203040506070Speedup40×4080×80,Matrix-free,x86,implementation,7,Similarly,,the,speedup,is,compared,for,the,steady,cases,running,in,parallel,on,diﬀerent,numbers,of,processes.,It,is,found,that,the,highest,ratio,is,observed,for,the,cases,using,the,low,expansion,orders,and,dense,mesh,resolution,,as,shown,in,Figure,2a,and,Figure,2b.,Even,for,high,expansion,orders,,the,speedup,of,the,optimized,matrix-free,operator,is,still,approximately,one,order,of,magnitude,higher,than,the,basic,matrix-free,operator.,Furthermore,,except,for,low,expan-,sion,orders,,the,speedup,does,not,change,signiﬁcantly,as,the,number,of,processes,increases.,(a),(b),Fig.,2:,Speedup,(ratio,of,execution,time,of,basic,and,optimized,matrix-free,operators),with,SIMD,for,steady,cases,in,parallel:,(a),40,element,meshes.,40,and,(b),80,80,×,×,2345678ExpansionOrder01020304050Speedupprocesses=1processes=2processes=3processes=42345678ExpansionOrder010203040506070Speedupprocesses=1processes=2processes=3processes=4,8,The,superior,performance,of,the,optimized,matrix-free,operator,manifests,in,the,construction,of,operators,and,backward,transformation,operations.,The,detailed,analyses,of,the,execution,time,of,the,basic,and,optimized,matrix-free,operators,on,the,aforementioned,operations,can,be,found,in,Figure,3.,Figure,3a,presents,the,ratio,of,execution,time,of,the,basic,matrix,operator,to,the,opti-,mized,one,to,construct,the,system,operators.,This,operation,is,accomplished,by,calling,the,GeneralMatrixOp,function,in,Nektar++,library.,It,shows,that,the,time,taken,by,the,basic,matrix-free,operator,to,assemble,the,matrices,is,at,least,an,order,of,magnitude,higher,than,the,optimized,matrix-free,operator,across,all,expansion,orders.,On,the,other,hand,,the,performance,gained,by,the,optimized,matrix-free,backward-transform,operator,is,less,pronounced.,Figure,3b,shows,that,the,speedup,of,the,backward,transformation,increases,signiﬁcantly,when,the,expansion,order,exceeds,4.,In,contrast,,the,time,taken,by,the,optimized,matrix-free,operator,does,not,exceed,the,factor,of,2,for,all,expansion,orders,in,this,study.,Overall,,the,eﬃciency,of,the,optimized,matrix-free,operator,is,ap-,proximately,one,order,of,magnitude,higher,than,the,basic,one,to,construct,the,system,operator,and,perform,the,backward,transformation.,The,SIMD,vectorisation,is,another,important,feature,to,enhance,the,eﬃ-,ciency,of,parallelism,,in,which,an,arithmetic,operation,is,actioned,simultane-,ously,on,several,data,using,one,instruction,in,code.,It,can,be,seen,in,Figure,4,that,the,overall,speedup,of,the,code,when,using,optimized,matrix-free,oper-,ators,with,SIMD,vectorisation,typically,increases,by,0.1,to,0.4,compared,with,the,optimized,matrix-free,operator,without,SIMD,,since,the,arithmetic,intensity,increases,proportionally,with,the,expansion,order.,This,characteristic,of,SIMD,vectorisation,can,be,used,to,maximize,the,potential,of,high-order,numerical,methods,for,large-scale,problems.,If,more,processes,and,high,expansion,order,are,used,to,run,the,simulation,in,parallel,,the,ratio,of,execution,time,is,stabilized,around,1.3.,Note,that,these,timings,are,for,the,entire,execution,of,the,code,and,that,the,vectorised,operators,only,account,for,a,portion,of,the,runtime.,The,static,condensation,technique,is,frequently,applied,in,high-order,numer-,ical,methods,,because,it,makes,use,of,the,natural,boundary/interior,decompo-,sition,of,the,spectral/hp,element,expansion,to,decouple,the,interior,modes,from,the,boundary,degrees,of,freedom,in,order,to,eﬃciently,compute,the,inversion,of,the,global,matrix.,The,multilevel,static,condensation,methods,[5],apply,the,static,condensation,technique,recursively,to,further,reduce,the,system,size,and,improve,overall,performance.,Although,using,fewer,operations,,this,approach,does,lead,to,memory,access,incoherence,and,consequently,an,increase,in,cache,misses.,The,performance,of,the,optimized,matrix-free,operator,with,SIMD,is,compared,with,the,multilevel,static,condensation,method.,In,Figure,5,,the,curves,speedup,of,the,optimized,matrix-free,operator,with,SIMD,relative,to,the,multilevel,static,condensation,method.,For,the,steady,case,,it,shows,that,the,optimized,matrix-,free,operator,with,SIMD,is,more,eﬃcient,than,the,multilevel,static,condensation,method,in,serial,execution,(process=1).,It,becomes,more,signiﬁcant,as,the,ex-,pansion,order,increases,,i.e.,,the,orange,line,in,Figure,5.,If,multiple,processes,are,used,in,parallel,,the,eﬃciency,of,the,optimized,matrix-free,operator,with,Matrix-free,x86,implementation,9,(a),(b),Fig.,3:,Speedup,of,the,optimized,matrix-free,operators,with,SIMD,for,constructing,the,system,operator,and,performing,the,backward,transformation:,(a),construction,of,operator,and,(b),backward,transformation,2345678ExpansionOrder1015202530Speedupprocesses=1processes=2processes=3processes=42345678ExpansionOrder024681012Speedupprocesses=1processes=2processes=3processes=4,10,Fig.,4:,Speedup,of,the,optimized,matrix-free,operators,with,SIMD,relative,to,the,version,without,SIMD,,using,diﬀerent,numbers,of,processes,(proc=1-4),,for,a,mesh,resolution,of,80,80.,×,Fig.,5:,Overall,speedup,of,the,optimized,matrix-free,operator,with,SIMD,over,the,multilevel,static,condensation,approach,for,steady,cases,(mesh,resolution,80),80,×,2345678ExpansionOrder0.81.01.21.41.6Speedupprocesses=1processes=2processes=3processes=42345678ExpansionOrder0.51.01.52.02.53.03.5Speedupprocesses=1processes=2processes=3processes=4,Matrix-free,x86,implementation,11,SIMD,is,still,higher,than,the,multilevel,static,condensation,method,by,a,factor,of,1.5,to,2.0,,e.g.,,the,blue,and,green,lines.,However,,it,is,noteworthy,that,the,overall,execution,time,taken,by,an,optimized,matrix-free,operator,and,multi-,level,static,condensation,method,is,inﬂuenced,by,many,factors,,including,the,process,of,constructing,the,matrix,operator,,solving,the,global,linear,system,and,its,implementation.,In,some,cases,,the,speed,of,an,optimized,matrix-free,operator,can,be,slower,than,the,multilevel,static,condensation,method,,for,ex-,ample,,the,transient,cases,discussed,in,Section,4.2.,If,the,time,taken,to,construct,the,local,dense,matrices,is,signiﬁcant,,a,matrix-free,operator,approach,can,be,advantageous,,such,as,in,the,steady,cases,presented,here.,4.2,Unsteady,cases,In,this,section,,the,performance,of,the,basic,and,optimized,matrix-free,opera-,tors,with,SIMD,and,Multilevel,Static,Condensation,method,is,analysed,for,the,unsteady,cases,of,anisotropic,thermal,conduction.,The,following,parameters,are,set,for,the,unsteady,case,in,the,.xml,ﬁle.,&lt;PARAMETERS&gt;,&lt;P&gt;,TimeStep,=,0.001&lt;/P&gt;,&lt;P&gt;,FinalTime,=,0.005&lt;/P&gt;,&lt;P&gt;,NumSteps,=,FinalTime/TimeStep&lt;/P&gt;,&lt;P&gt;,IO_CheckSteps,=,5&lt;/P&gt;,&lt;P&gt;,IO_InfoSteps,=,5&lt;/P&gt;,&lt;/PARAMETERS&gt;,&lt;SOLVERINFO&gt;,&lt;I,PROPERTY=&quot;EQTYPE&quot;,VALUE=&quot;UnsteadyDiffusion&quot;/&gt;,&lt;I,PROPERTY=&quot;Projection&quot;,VALUE=&quot;Continuous&quot;/&gt;,&lt;I,PROPERTY=&quot;GlobalSysSoln&quot;,VALUE=&quot;IterativeFull&quot;/&gt;,&lt;I,PROPERTY=&quot;TimeIntegrationMethod&quot;,VALUE=&quot;BDFImplicitOrder1&quot;/&gt;,&lt;/SOLVERINFO&gt;,&lt;GLOBALSYSSOLNINFO&gt;,&lt;V,VAR=&quot;u&quot;&gt;,&lt;I,PROPERTY=&quot;GlobalSysSoln&quot;,VALUE=&quot;IterativeFull&quot;/&gt;,&lt;I,PROPERTY=&quot;LinSysIterSolver&quot;,VALUE=&quot;ConjugateGradient&quot;/&gt;,&lt;I,PROPERTY=&quot;Preconditioner&quot;,VALUE=&quot;Diagonal&quot;/&gt;,&lt;I,PROPERTY=&quot;MaxIterations&quot;,VALUE=&quot;5000&quot;/&gt;,&lt;I,PROPERTY=&quot;IterativeSolverTolerance&quot;,VALUE=&quot;1e-6&quot;/&gt;,&lt;/V&gt;,&lt;/GLOBALSYSSOLNINFO&gt;,Similar,to,the,steady,cases,,the,results,in,Figure,6,are,the,speedup,of,the,optimized,matrix-free,operators,with,SIMD,relative,to,the,basic,operators.,It,shows,that,the,optimized,matrix-free,operator,with,SIMD,is,much,more,eﬃcient,12,Fig.,6:,Speedup,of,the,optimized,matrix-free,operators,with,SIMD,over,the,basic,operator,for,unsteady,cases,(mesh,resolution,40,40),×,than,the,unoptimized,version,in,unsteady,cases.,For,the,expansion,order,lower,than,4,using,multiple,processes,,the,speed-up,of,the,optimized,matrix-free,op-,erator,is,beyond,one,order,of,magnitude,of,the,basic,matrix-free,operator.,As,the,expansion,order,increases,further,,the,eﬃciency,of,the,optimized,matrix-free,operator,with,SIMD,is,still,about,5,times,faster.,Overall,,for,the,unsteady,cases,,the,ratio,of,performance,between,the,basic,and,optimized,matrix-free,opera-,tors,does,not,change,signiﬁcantly,using,the,diﬀerent,number,of,processes,in,this,study.,Fig.,7:,Ratio,of,execution,time,of,optimized,matrix-free,operator,with,SIMD,to,Multilevel,Static,Condensation,method,for,unsteady,cases,(mesh,resolution,40),40,×,2345678ExpansionOrder0102030405060Speedupprocesses=1processes=2processes=3processes=42345678ExpansionOrder010203040Speedupprocesses=1processes=2processes=3processes=4,Matrix-free,x86,implementation,13,In,addition,,the,performance,of,the,Multilevel,Static,Condensation,method,is,also,compared,with,the,matrix-free,approach,for,the,unsteady,cases.,As,shown,in,Figure,7,,the,plotted,results,are,the,ratio,of,execution,time,of,the,opti-,mized,matrix-free,operator,with,SIMD,to,that,of,Multilevel,Static,Condensation,method.,For,the,unsteady,cases,in,this,study,,it,can,be,seen,that,the,Multilevel,Static,Condensation,method,is,much,more,eﬃcient,than,the,matrix-free,ap-,proach.,Overall,,the,speed,of,the,matrix-free,approach,is,10-30,times,slower.,As,the,number,of,processes,increases,in,parallel,execution,,the,speed,up,of,multi-,level,static,condensation,method,becomes,more,overt.,This,is,opposite,to,the,observation,in,the,steady,cases,in,previous,sections,,because,the,system,matrix,is,signiﬁcantly,condensed,in,the,static,condensation,method,and,the,resultant,system,matrix,must,be,solved,repetitively,at,each,time,step.,Therefore,,its,ef-,ﬁciency,surpasses,the,matrix-free,approach.,In,addition,,the,matrix,operator,is,only,constructed,once,at,the,ﬁrst,time,step,in,current,implementation,of,the,multilevel,static,condensation,method,,which,further,increases,its,overall,eﬃ-,ciency,over,the,matrix-free,approach,in,those,unsteady,cases.,If,either,the,scale,of,the,problem,and,the,dimensions,of,the,global,sparse,matrices,are,large,,or,the,global,system,must,be,solved,multiple,times,,the,performance,of,the,multilevel,static,condensation,method,may,be,more,eﬃcient.,This,is,because,the,dimen-,sions,of,the,matrix,is,reduced,signiﬁcantly,by,the,condensation,technique,and,the,initial,setup,cost,of,this,is,absorbed,by,the,many,applications,of,the,opera-,tor.,However,,the,static,condensation,approach,comes,at,a,higher,memory,cost,due,to,the,need,to,construct,all,local,matrix,operators,,as,well,as,an,increased,number,of,communications,,which,may,make,the,method,less,eﬃcient,in,large,parallel,simulations.,5,Concluding,remarks,The,performance,of,basic,and,optimized,matrix-free,operators,and,multilevel,static,condensation,method,were,compared,in,this,study.,The,execution,time,of,either,the,overall,simulation,or,the,time,taken,by,the,operator,construction,and,backward,transformation,were,employed,as,the,metrics,to,assess,their,eﬃcien-,cies.,Overall,,the,optimized,matrix-free,operator,with,SIMD,is,always,much,more,eﬃcient,,about,one,order,of,magnitude,higher,,than,the,basic,matrix-free,opera-,tor.,The,SIMD,vectorization,technique,accounts,for,about,0.2,to,0.4%,speed,up,of,current,implementation,of,the,optimized,matrix-free,operator;,however,,the,performance,of,SIMD,drops,if,the,computing,resource,is,limited,and,the,CPU,cores,are,all,utilised,during,a,parallel,execution.,In,some,cases,,e.g.,,the,steady,cases,in,this,study,,the,matrix-free,approach,is,slightly,more,eﬃcient,than,the,multilevel,static,condensation,method.,For,transient,cases,,the,implementation,of,multilevel,static,condensation,can,signiﬁcantly,outperform,the,matrix-free,approach.,However,,it,should,be,noted,that,the,conclusion,drawn,above,about,the,multilevel,static,condensation,method,and,matrix-free,operator,depends,on,many,factors,,e.g.,,the,number,of,time,steps,in,transient,cases,,the,scale,of,14,the,problem,or,the,expansion,order,and,this,may,not,carry,over,to,larger-scale,calculations.,Bibliography,[1],Hui,Xu,,Chris,D,Cantwell,,Carlos,Monteserin,,Claes,Eskilsson,,Allan,P,Engsig-Karup,,and,Spencer,J,Sherwin.,Spectral/hp,element,methods:,Recent,developments,,applications,,and,perspectives.,Journal,of,Hydrodynamics,,30(1):1–22,,2018.,[2],David,Moxey,,Roman,Amici,,and,Mike,Kirby.,Eﬃcient,matrix-free,high-,order,ﬁnite,element,evaluation,for,simplicial,elements.,SIAM,Journal,on,Scientiﬁc,Computing,,42(3):C97–C123,,2020.,[3],Chris,D,Cantwell,,David,Moxey,,Andrew,Comerford,,Alessandro,Bolis,,Gabriele,Rocco,,Gianmarco,Mengaldo,,Daniele,De,Grazia,,Sergey,Yakovlev,,J-E,Lombard,,Dirk,Ekelschot,,et,al.,Nektar++:,An,open-source,spectral/hp,element,framework.,Computer,physics,communications,,192:205–219,,2015.,[4],George,Karniadakis,and,Spencer,Sherwin.,Spectral/hp,element,methods,for,computational,ﬂuid,dynamics.,Oxford,University,Press,,2013.,[5],Barry,Smith,,Petter,E.,Bjrstad,,and,William,Gropp.,Domain,decomposition:,parallel,multilevel,methods,for,elliptic,partial,diﬀerential,equations.,Cam-,bridge,University,Press,,New,York,,1996." name="keywords" />

    <title>TN-02_MatrixFreeKernelAnisotropicLaplacianOperatorX86Architectures &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tn-02-matrixfreekernelanisotropiclaplacianoperatorx86architectures">
<h1>TN-02_MatrixFreeKernelAnisotropicLaplacianOperatorX86Architectures<a class="headerlink" href="#tn-02-matrixfreekernelanisotropiclaplacianoperatorx86architectures" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/TN-02_MatrixFreeKernelAnisotropicLaplacianOperatorX86Architectures.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TN-02_MatrixFreeKernelAnisotropicLaplacianOperatorX86Architectures.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>