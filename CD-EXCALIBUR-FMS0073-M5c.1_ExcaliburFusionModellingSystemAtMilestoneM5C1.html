
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="ExCALIBUR,Complementary,actions.,Uncertainty,Quantiﬁ-,cation,Code,integration,,acceptance,and,oper-,ation,1.,M5c.1,Version,1.00,Abstract,The,report,describes,work,for,ExCALIBUR,project,NEPTUNE,at,Mile-,stone,M5c.1.,It,outlines,work,on,uncertainty,quantiﬁcation,(UQ),and,reduced-,order,modelling,for,NEPTUNE.,This,includes,a,simple,reduced-order,model,describing,convective,heat,transfer,coupled,to,diffusion,,in,which,one-way,and,two-way,coupling,is,demonstrated.,Two-dimensional,heat,transfer,is,studied,,with,the,calculation,of,a,stability,boundary,between,steady,and,time-dependent,solutions.,The,UQ,software,EASYVVUQ,is,applied,to,a,simple,test,problem,in,the,NESO-PARTICLES,framework,in,anticipation,of,more,complicated,examples.,Work,by,the,holder,of,the,grant,T/AW085/21,is,brieﬂy,summarized.,UKAEA,REFERENCE,AND,APPROVAL,SHEET,Client,Reference:,UKAEA,Reference:,CD/EXCALIBUR-FMS/0073,Issue:,Date:,1.00,27,March,2023,Project,Name:,ExCALIBUR,Fusion,Modelling,System,Prepared,By:,Name,and,Department,Ed,Threlfall,Seimon,Powell,Signature,N/A,N/A,Date,27,March,2023,27,March,2023,BD,Reviewed,By:,Wayne,Arter,27,March,2023,BD,1,1,Introduction,Uncertainty,quantiﬁcation,(UQ),in,NEPTUNE,is,to,be,performed,non-intrusively,,which,means,that,the,UQ,functionality,can,be,developed,largely,independently,of,the,main,NEPTUNE,code,base.,Since,the,main,NEPTUNE,code,is,still,in,development,,the,ﬁrst,part,of,this,report,outlines,some,relevant,problems,in,heat,transfer,as,targets,for,UQ,and,presents,implementations,using,the,FIREDRAKE,PDE,solver.,The,case,for,this,approach,is,strengthened,by,the,fact,that,these,examples,include,material,on,one-way,and,two-way,coupled,models,(Sec.2),and,reduced-order,modelling.,In,addition,,the,analysis,of,the,three-dimensional,version,of,the,heat,transfer,problem,in,Sec.3,provides,HPC-level,problems,suitable,for,use,as,examples,by,the,holder,of,the,numerical,analysis,grant,T/AW087/22,(speciﬁcally,,to,apply,to,preconditioners,and,solution,continuation),as,well,as,subjects,for,UQ,campaigns,and,surrogate,construction.,The,report,also,outlines,an,initial,application,of,the,EASYVVUQ,software,to,the,NESO-PARTICLES,code,developed,under,NEPTUNE,(Sec.4).,The,UQ,work,has,been,defrayed,under,Grant,T/AW085/21.,Much,of,this,grantee’s,work,during,the,past,year,has,taken,the,form,of,code,development,and,related,hackathons,,rather,than,written,re-,ports.,This,material,,which,covers,UQ,,reduced-order,models,,and,data,assimilation,,is,described,brieﬂy,in,Sec.5.,2,Coupled,models,of,heat,transport,The,experimental,campaign,of,the,SmalLab,programme,includes,simulations,of,a,convecting,ﬂuid,in,a,tank,,in,which,the,tank,walls,have,a,nonzero,thickness,and,are,themselves,part,of,the,heat,transfer,problem,,giving,a,coupled,system,that,is,a,prime,candidate,for,the,application,of,UQ,techniques,for,studying,discrepancies,between,theoretical,models,and,experimental,results.,This,system,is,related,to,the,problem,of,heat,transfer,in,a,fusion,machine,,in,which,the,main,challenge,is,to,keep,the,heat,localized,where,the,fusion,reactions,are,intended,to,occur,,see,eg.,the,thesis,work,of,F.,Wilczynski,and,resulting,publications,such,as,ref,[1].,It,is,well-known,that,the,rate,of,heat,transfer,in,a,ﬂuid,is,enhanced,by,turbulence,and,so,one,worthwhile,goal,is,to,control,and,suppress,turbulence.,The,latter,can,be,achieved,by,reducing,the,temperature,gradient,across,the,ﬂuid,region,by,adding,insulation,(large,gradients,are,the,drivers,of,turbulence).,Work,is,currently,in,progress,to,enable,the,coupling,of,the,incompressible,Navier-Stokes,solver,and,the,diffusion,solver,of,NEKTAR++,in,order,to,enable,the,simulation,of,a,ﬂuid,region,(tank,interior),coupled,to,a,solid,conducting,model,(tank,wall).,These,modiﬁcations,are,not,completed,at,the,time,of,writing,and,so,a,reduced,model,of,heat,transfer,by,turbulent,ﬂuids,and,conductors,,and,their,coupling,,is,considered.,The,study,begins,by,examining,a,one-dimensional,toy,system,with,heat,moving,from,left,to,right,,with,temperature,equal,to,unity,on,the,left,and,zero,on,the,right.,Let,there,be,two,conducting,regions,,each,of,unit,width,and,of,thermal,conductivity,κ1,(left),and,κ2,(right).,The,law,determining,the,effective,conductivity,κ,of,the,composite,is,2,Figure,1:,Temperature,proﬁle,across,a,composite,region,with,thermal,conductivities,κ1,for,x,&lt;,1,and,κ2,for,x,&gt;,1.,The,left-hand,plot,shows,the,case,κ1,=,4κ2,and,the,right,4κ1,=,κ2.,κ,=,2,κ1κ2,κ1,+,κ2,(1),reminiscent,of,the,law,for,the,combination,of,electrical,resistances,in,parallel,,except,for,the,extra,factor,of,2.,The,heat,ﬂux,through,the,combined,system,is,F,=,κ1κ2,κ1,+,κ2,(which,is,symmetric,under,the,interchange,of,κ1,and,κ2).,The,temperature,at,the,midpoint,is,Tmid,=,κ1,κ1,+,κ2,(2),(3),(which,is,not,symmetric,under,the,interchange,of,κ1,and,κ2).,The,midpoint,temperature,is,greater,than,1,2,if,κ1,&gt;,κ2,,in,which,case,most,of,the,temperature,drop,occurs,across,the,second,(ie.,the,rightmost),region,ie.,the,temperature,gradient,across,the,ﬁrst,region,is,reduced,(see,Fig.1).,If,the,ﬁrst,region,is,actually,a,tank,of,ﬂuid,,this,means,that,the,Rayleigh,number,for,the,convective,system,will,be,decreased,the,poorer,conductor,the,second,region,is,-,the,ﬂuid,will,be,hotter,on,average,but,the,temperature,gradient,across,it,will,be,reduced.,This,means,the,ﬂuid,is,less,likely,to,be,turbulent,,and,,given,the,usual,laws,for,heat,transfer,by,ﬂuids,,will,transport,heat,at,a,lesser,rate.,2.1,One-dimensional,models,-,one-way,coupled,The,model,of,this,section,and,the,next,will,consist,of,a,zero-dimensional,(ie.,ODE),surrogate,for,the,convecting,ﬂuid,,coupled,to,a,one-dimensional,diffusion,model.,3,A,proxy,for,the,potentially,turbulent,ﬂuid,is,the,Lorenz,equations,,also,known,as,the,Lorenz,’63,model,[2],,obtained,by,considering,Rayleigh-B,´enard,convection,and,retaining,only,the,ﬁrst,trigono-,metric,eigenmode,associated,with,departure,from,the,purely-conducting,state,and,its,quadratic,self-interaction.,The,equations,are,˙X,=,σ(Y,−,X);,˙Y,=,ρX,−,Y,−,XZ;,˙Z,=,−βZ,+,XY.,(4),This,model,retains,some,of,the,characteristics,of,a,turbulent,ﬂuid,problem,ie.,it,exhibits,smooth,behaviour,for,some,parameter,choices,and,chaotic,behaviour,for,others.,In,addition,,two,of,the,three,free,parameters,in,the,model,,respectively,ρ,and,σ,,correspond,to,the,Rayleigh,(Ra),and,Prandtl,(Pr),numbers,derived,from,the,progenitor,problem,(the,remaining,parameter,,β,,is,of,lesser,interest,in,this,study).,As,a,reminder,,the,Rayleigh,number,is,the,dimensionless,temperature,difference,(eg.,between,the,hot,and,cold,sides,of,a,ﬂuid-ﬁlled,cavity),driving,the,convection,and,the,Prandtl,number,is,the,dimensionless,ratio,of,momentum,diffusivity,to,thermal,diffusivity.,It,is,possible,to,extract,the,quantity,which,in,the,full,problem,represents,the,Nusselt,number,(ie.,the,rate,of,heat,transfer),as,Nu,=,1,+,2Z,ρ,.,The,Lorenz,model,is,itself,an,useful,candidate,for,UQ,studies,due,to,its,simplicity,(three,parameters),and,the,fact,that,its,response,surfaces,may,exhibit,discontinuous,behaviour,[3].,A,simple,C++,ODE,solver,implementation,of,the,Lorenz,model,was,written.,A,canonical,choice,was,made,for,the,model,parameters,ρ,=,28,,σ,=,10,,β,=,8,3,;,this,choice,is,one,that,enables,chaotic,behaviour.,(More,generally,,the,paper,[3],exposes,the,behaviour,of,the,system,in,(Ra,,Pr)-space,as,an,interesting,‘phase,diagram’.),The,outputs,are,a,plausible,representation,of,the,familiar,Lorenz,system,behaviour,(Fig.2),and,this,was,deemed,sufﬁcient,as,a,unit,test.,The,diffusion,model,is,a,simple,implementation,of,a,time-dependent,diffusion,across,a,one-,dimensional,domain,of,unit,width.,The,code,was,written,in,C++,and,follows,the,unconditionally-,stable,implementation,in,[4],(which,uses,forward,spatial,differences,and,a,Crank-Nicolson,time-,stepping,method).,The,solver,can,use,Dirichlet,or,Neumann,boundary,conditions,and,a,simple,unit,test,of,the,former,case,against,analytic,results,was,performed:,the,solver,was,run,for,t,=,0.1,using,D,=,0.1,,starting,from,zero,temperature,everywhere,in,the,volume,and,T,(x,=,0),=,1,,T,(x,=,1),=,0,Dirichlet,conditions.,The,analytic,temperature,proﬁle,is,T,(t,,x),=,1,−,x,−,∞,(cid:88),n=1,2,πn,e−n2π2Dt,sin,nπx.,(5),(This,tends,to,the,obvious,steady-state,solution,1,−,x,as,t,(cid:29),D−1,and,the,subtraction,is,at,t,=,0,simply,the,Fourier,series,for,that,function;,the,Fourier,modes,each,decay,on,a,timescale,set,by,the,wavenumber;,the,function,can,be,approximated,for,t,(cid:28),D−1,by,1,−,erf(,),which,is,the,solution,x√,4Dt,4,Figure,2:,(Left),output,of,Lorenz,ODE,solver,displaying,the,well-known,Lorenz,attractor.,(Right),unit,test,of,the,output,of,the,diffusion,solver,against,theory;,there,is,no,visible,discrepancy,between,the,code,output,and,the,theory,curve.,Figure,3:,Behaviour,of,the,coupled,Lorenz-diffusion,system,as,the,diffusivity,is,varied.,The,time,series,used,is,the,heat,ﬂux.,The,conducting,region,acts,as,basically,a,low-pass,ﬁlter,on,the,heat,ﬂux,time,series.,to,the,same,problem,on,a,semi-inﬁnite,interval.,These,analytic,forms,agree,with,the,code,outputs,in,Fig.2.),In,the,coupled,system,,the,Nusselt,number,from,the,Lorenz,model,is,used,to,provide,a,Neumann,boundary,condition,on,the,left-hand,side,of,the,diffusion,problem,(speciﬁcally,the,value,of,∂T,∂x,is,set,equal,to,Nu,D,).,The,other,side,of,the,domain,of,the,diffusion,problem,(this,domain,is,called,the,conducting,region),is,given,a,homogeneous,Dirichlet,condition,(T,=,0).,The,behaviour,of,the,coupled,system,for,different,values,of,diffusivity,is,show,in,Fig.3.,There,is,no,coupling,of,the,diffusion,model,back,into,the,Lorenz,model,-,this,would,be,valid,only,in,the,trivial,limit,where,the,solid,is,a,much,better,conductor,than,the,ﬂuid,(ie.,the,temperature,is,near-uniform,across,the,solid).,2.2,One-dimensional,models,-,two-way,coupled,Two-way,coupling,is,necessary,in,order,to,study,the,effect,of,the,insulation,on,the,ﬂuid,system.,The,diffusion,problem,can,be,made,to,back-react,on,the,Lorenz,model,by,allowing,the,temperature,5,TL,at,the,entry,point,to,the,conducting,region,to,determine,the,Rayleigh,number,ρ,in,the,Lorenz,model,(recall,that,for,vertical,natural,convection,the,Rayleigh,number,is,the,non-dimensionalized,temperature,difference,horizontally,across,the,cavity).,The,connection,needs,to,be,made,via,some,function,that,avoids,pathological,behaviours;,reasonable,properties,would,seem,to,be,that,ρ,decreases,monotonically,with,increasing,TL,and,that,ρ,cannot,become,negative,(this,means,the,minimum,Nusselt,number,is,1,and,there,cannot,be,less-than-unity,heat,ﬂuxes).,In,practice,,a,function,that,ensures,ρ,≥,1,appears,to,work,better,than,one,that,is,allowed,to,decrease,to,zero,,giving,better,numerical,stability,and,avoiding,features,such,as,negative,temperatures,in,the,conducting,region,,heat,ﬂux,from,right,to,left,,and,large,‘spikes’,in,heat,ﬂux.,The,function,ρ,=,1,+,27e−TL,was,chosen,empirically,and,was,found,to,give,no,obvious,numerical,difﬁculties;,for,the,initial,condition,TL,=,0,this,choice,represents,the,same,parameter,values,as,used,in,the,previous,section.,(Note,that,,with,this,function,and,positive,temperatures,,the,Rayleigh,number,has,a,maximum,value,of,28.),It,seems,likely,that,there,are,more,sensible,choices,of,this,function,as,not,much,experimentation,was,done,with,other,choices,-,work,was,stopped,once,a,bounded-,response,choice,was,found.,Note,possible,similarity,to,the,activation,functions,chosen,in,neural,networks.,The,parameters,σ,and,β,take,the,same,ﬁxed,values,as,in,the,previous,section.,Outputs,can,be,seen,in,Fig.4;,these,are,the,time,series,for,the,heat,ﬂux,into,and,out,the,other,side,of,the,diffusive,region.,It,can,be,seen,that,for,large,values,of,D,the,coupled,response,preserves,well,the,no-coupling,input,heat,ﬂux,(the,diffusion,is,rapid,,therefore,the,temperature,is,near-uniform,-,indeed,near-zero,-,across,the,diffusive,region).,Small,values,of,D,result,in,a,‘turning,off’,of,the,turbulence,,which,physically,is,supposed,to,represent,the,fact,that,insulating,the,turbulent,region,reduces,the,temperature,gradient,across,it,(the,ﬂuid,is,hotter,but,recall,that,turbulence,is,driven,by,temperature,gradients),-,one,sees,that,the,turbulent,time,series,is,brought,into,a,quiescent,state,and,the,heat,ﬂux,(Nusselt,number),tends,to,unity,,which,is,the,minimum,possible,rate,of,In,between,these,regimes,there,heat,transfer,in,this,model,,corresponding,to,pure,conduction.,is,an,oscillatory,regime,(amusingly,,this,sort,of,thing,is,seen,in,the,transition,to,turbulence,in,real,systems),in,which,,strangely,,the,average,heat,ﬂux,is,enhanced,over,the,turbulent,case,-,it,is,expected,that,this,non-monotonicity,reﬂects,the,non-physical,nature,of,the,model,,either,from,the,extrapolation,of,the,Lorenz,single-mode,approximation,beyond,its,region,of,validity,or,from,the,empirical,choice,of,coupling,function.,It,is,clear,that,it,is,in,reality,not,possible,to,enhance,heat,ﬂux,by,adding,further,insulation,in,a,one-dimensional,system.,(Though,note,that,this,is,not,true,in,higher,dimensions;,consider,heat,sinks.),It,is,also,possible,to,visualize,how,the,back-reaction,affects,the,behaviour,of,the,Lorenz,oscillator,(Fig.5).,The,interesting,thing,here,is,the,recovery,of,the,usual,sort,of,Lorenz,attractor,for,large,values,of,D,,and,apparently,simpler,attractors,for,reduced,values,of,D,,down,to,ﬁxed,points,for,sufﬁciently,small,D.,Note,that,the,intermediate,attractors,display,nonmonotonicity,in,D,as,to,whether,they,are,able,to,access,both,‘lobes’,of,the,original,Lorenz,attractor.,There,is,scope,for,further,investigation,of,simple,models,of,this,sort,(note,the,compute,times,for,all,the,examples,above,are,typically,one,second,or,less,on,a,single,core,of,a,laptop).,It,is,possible,to,imagine,simple,control,strategies,by,varying,the,temperature,used,as,the,Dirichlet,boundary,on,the,right-hand,side,of,the,conducting,region.,It,is,possible,to,imagine,coupling,additional,‘convecting’,,ie.,Lorenz,,systems,and,additional,conducting,regions.,6,Figure,4:,Time,series,heat,ﬂux,inputs,(blue),and,outputs,(orange),for,the,conducting,region,of,the,coupled,Lorenz,and,diffusion,model,for,various,values,of,the,diffusivity,D,,ie.,the,heat,ﬂux,entering,the,diffusive,region,from,the,turbulent,model,,which,is,affected,by,the,back-reaction,of,the,diffusion,problem,on,the,Lorenz,series,in,the,way,explained,in,the,main,text.,The,main,phenomenon,of,in-,terest,is,the,fact,that,sufﬁcient,insulation,(,small,D),results,in,suppression,of,the,chaotic,behaviour,,which,is,interpreted,loosely,as,the,suppression,of,turbulence.,Note,the,plots,are,not,shown,here,but,the,time,series,for,the,temperature,at,the,left-hand,side,of,the,conductor,show,similar,time-,dependence,,and,the,average,entry,temperature,seems,to,be,a,monotonically-decreasing,function,of,D,,which,is,physically,consistent.,Figure,5:,(Modiﬁed),Lorenz,attractor,part,of,the,two-way,coupled,Lorenz,and,diffusion,model,for,various,values,of,the,diffusivity,D.,Top,(L-R),D,=,10,,4,,3.16;,bottom,D,=,2,,1,,0.1.,Note,the,attractor,is,largely,as,in,the,classic,non-coupled,case,for,D,=,10,and,it,degenerates,to,a,single,ﬁgure-of-eight,attractor,track,as,D,is,reduced,to,3.16.,Below,about,3.13,the,attractor,is,conﬁned,to,one,lobe,of,the,classic,structure,,but,this,behavior,changes,with,the,D,=,1,case,exploring,two,lobes.,Very,small,values,of,D,lead,to,the,attractor,becoming,a,ﬁxed,point,with,Z,=,0,corresponding,to,a,pure,conducting,Nu,=,1,situation.,All,cases,are,2-D,projections,with,the,positive,X-axis,oriented,into,the,page,(and,right-handed,Cartesian,axes).,7,The,implementation,used,to,generate,the,results,in,this,section,is,tightly,coupled,but,there,is,no,reason,,other,than,convenience,,not,to,use,a,value-passing,approach,to,couple,separate,Lorenz,and,diffusion,software,modules.,3,Convection,models,as,proxyapps,for,UQ,Attention,is,now,shifted,to,study,of,two-dimensional,convecting,ﬂuids,as,targets,for,UQ,and,reduced-order,models.,The,well-cited,paper,[5],presents,a,‘phase,diagram’,charting,the,expected,behaviour,of,Rayleigh-,B,´enard,convection,as,a,function,of,the,two,parameters,Ra,and,Pr.,The,diagram,is,reproduced,here,as,Fig.6.,The,analysis,in,that,paper,is,possible,due,to,a,systematic,theory,based,on,analytic,results,for,global,averages,of,kinetic,and,thermal,dissipation,rates,(eg.,Eqs.2.5,,2.6,in,[5]).,This,allows,consideration,of,the,system,behaviour,depending,on,whether,the,boundary,layer,or,the,bulk,dominates,the,kinetic,and,thermal,dissipation,and,on,whether,the,kinetic,or,thermal,boundary,layer,is,thicker.,The,case,of,vertical,natural,convection,(also,known,as,side-heated,or,slot,convection),,in,which,the,temperature,gradient,is,applied,horizontally,,is,more,challenging,as,the,same,approach,does,not,work,(the,global,relations,for,dissipation,rates,do,not,exist).,There,does,not,seem,to,exist,in,the,current,literature,a,vertical,natural,convection,analogue,of,the,diagram,in,[5],,motivating,a,study,of,this,system.,Note,that,phase,transitions,are,interesting,from,a,UQ,standpoint,,not,least,because,a,small,uncertainty,in,a,control,parameter,value,can,lead,to,a,very,large,change,in,the,physical,response,of,the,system,in,the,vicinity,of,a,phase,boundary,(or,,in,the,case,in,[5],,a,boundary,between,two,scaling,regimes).,The,vertical,natural,convection,problem,is,directly,relevant,to,the,SmalLab,experiments,,and,it,is,of,interest,in,the,context,of,uncertainty,quantiﬁcation,,as,will,now,be,discussed.,This,work,provides,an,opportunity,to,test,the,impact,of,parameter,uncertainty,in,an,interesting,model,that,possesses,different,physical,regimes,which,furthermore,may,be,demarcated,by,boundaries,at,which,the,response,or,its,derivatives,are,discontinuous.,(A,discontinuous,response,poses,a,chal-,lenge,for,polynomial,ﬁtting,techniques,which,tend,to,work,well,only,in,rather,smooth,cases.),There,is,also,opportunity,to,construct,useful,surrogates,of,response,surfaces,that,depend,on,potentially,large,amounts,of,computation,-,the,examples,presented,here,will,be,two-dimensional,,but,the,three-dimensional,versions,are,a,supercomputer-level,challenge.,Even,the,two-dimensional,case,is,helpful,in,highlighting,some,features,of,the,computation,that,are,germane,to,the,construction,of,the,ensemble-based,campaign,that,is,necessary,in,order,to,perform,non-intrusive,UQ.,Namely:,•,UQ,campaigns,generally,aim,to,achieve,a,meaningful,coverage,of,a,parameter,space,of,some,dimensionality,,size,,and,shape.,In,many,cases,,coverage,is,achieved,by,trivial,par-,allelization,of,individual,calculations.,However,,it,is,sometimes,advantageous,,or,even,es-,sential,,to,perform,the,computations,in,some,sort,of,ordered,pattern,-,the,‘continuation’,approach,to,solving,elliptic,problems,means,that,the,next,calculation,may,need,the,results,from,an,earlier,one,from,nearby,in,parameter,space,(eg.,to,provide,the,initial,guess),and,so,some,degree,of,serialization,is,mandated.,•,A,speciﬁc,example,of,the,above,is,the,performance,of,numerical,eigensolvers,,which,can,8,Figure,6:,The,phase,diagram,of,Rayleigh-B,´enard,convection,(Fig.2,in,[5]).,The,differently-labelled,regimes,correspond,to,a,different,scaling,law,of,the,Nusselt,number,(and,/,or,Reynolds,number),with,Rayleigh,and,Prandtl,numbers,Nu,∼,RaαPrβ.,9,depend,strongly,on,the,initial,guess,of,the,eigenvalue.,This,value,can,come,,as,above,,from,a,nearby,solution.,•,A,reduced-order,model,can,be,used,to,inform,initial,values,of,the,type,mentioned,above,,for,example,it,may,be,known,how,an,eigenvalue,is,expected,to,scale,with,a,control,parameter.,The,need,for,expensive,solution,continuation,may,be,removed,by,using,a,reduced-order,model,to,initialize,the,solver,at,an,arbitrary,point,in,parameter,space.,•,One,might,consider,a,simple,line-based,ordering,of,simulations,in,order,to,achieve,coverage,of,a,multi-dimensional,parameter,space,,though,this,is,at,odds,with,Latin-hypercube,type,approaches.,An,alternative,is,to,consider,placing,simulation,attempts,along,a,space-ﬁlling,curve,(eg.,the,Hilbert,curve).,•,An,alternative,to,serialization,is,to,store,the,state,of,previous,simulations,and,to,make,this,data,available,to,solvers,performing,new,simulations,(data,from,a,‘nearby’,past,run,could,be,used,as,an,initial,state).,This,approach,would,favour,algorithms,where,a,large,amount,of,arithmetic,work,is,needed,per,unit,of,stored,state,data.,•,As,a,general,principle,,understanding,gained,using,a,two-dimensional,ﬂuid,system,may,be,applied,to,a,larger,study,of,the,three-dimensional,problem,and,may,speciﬁcally,reduce,the,amount,of,trial-and-error,needed,when,working,with,expensive,supercomputer,runtime.,It,is,possible,to,use,NEKTAR++,to,obtain,the,Nusselt,number,as,a,function,of,position,in,(Ra,,Pr),space.,A,general,analysis,is,challenging,due,to,the,need,to,tune,the,parameters,of,the,simulation,in,order,to,preserve,numerical,stability,and,to,ensure,that,the,results,are,not,contaminated,by,transients.,It,is,expedient,to,start,on,the,problem,using,the,FIREDRAKE,PDE,solver,framework,[6],to,solve,for,the,steady,state,and,this,is,the,approach,taken,here.,With,the,use,of,a,time-independent,solver,,only,the,conducting,and,laminar,convecting,regimes,are,accessible.,What,can,usefully,be,determined,from,such,analysis,is,the,onset,of,linear,instability,in,the,laminar,solutions,-,this,gives,a,bound,on,the,stability,of,the,laminar,regime,as,there,the,system,transitions,to,an,oscillatory,solution,,which,tends,to,lie,between,the,laminar,and,turbulent,regimes,,in,what,is,referred,to,(The,transition,to,turbulence,occurs,at,higher,Ra,and,is,associated,to,as,a,Hopf,bifurcation.,the,excitation,of,many,incommensurate,linear,modes.),The,goal,then,is,the,discovery,of,a,one-,dimensional,stability,frontier,between,stationary,and,oscillatory,states,in,the,(Ra,,Pr),plane.,The,stability,of,a,given,stationary,laminar,solution,is,studied,by,determining,the,most,negative,eigenvalue,for,a,linear,perturbation,about,the,laminar,convecting,background,states.,The,criterion,for,a,linear,instability,is,that,the,real,part,of,the,eigenvalue,is,negative.,Here,the,eigen-analysis,is,done,with,the,aid,of,the,SLEPc,eigensolver,library,[7].,Two,techniques,were,tried:,•,Simple,scans,of,(Ra,,Pr),space,to,determine,where,eigenvalues,with,negative,real,parts,occur.,•,A,nonlinear,analysis,technique,to,determine,directly,the,value,of,Ra,at,which,the,system,exhibits,a,Hopf,bifurcation.,The,method,is,outlined,in,a,paper,by,Griewank,and,Reddien,[8].,The,FIREDRAKE,implementation,,which,will,not,be,detailed,here,,was,largely,copied,from,[9],with,minor,differences,,eg.,in,the,pressure,condition,where,[9],evades,the,constant-,pressure,null,space,by,ﬁxing,the,pressure,at,a,boundary,point,,while,the,present,study,used,the,nullspace,feature,of,FIREDRAKE.,10,The,scripts,here,employ,a,direct,solver,for,the,linear,systems,as,in,[9].,This,is,expedient,and,is,effective,for,small,problems,but,uses,more,memory,than,iterative-based,approaches.,Note,that,convergence,failures,here,mentioned,refer,to,failure,of,nonlinear,algorithms,to,converge,,rather,than,the,direct,linear,solver.,One,complicating,factor,is,the,need,to,perform,solution,continuation,in,order,to,cover,the,necessary,regions,of,parameter,space,(if,this,is,not,used,,then,it,is,likely,that,only,a,small,part,of,the,laminar-,to-non-stationary,stability,frontier,can,be,found).,It,might,be,noted,that,this,system,is,known,to,exhibit,a,rich,variety,of,instability,phenomena,eg.,internal,gravity,waves,,instabilities,at,the,corners,,and,instabilities,at,the,walls;,see,the,literature,cited,in,the,sequels,for,details.,A,few,useful,test,cases,are,available,in,the,literature;,these,are,outlined,in,the,following,subsections,in,order,to,provide,some,veriﬁcation,of,the,methods.,3.1,Rayleigh-B,´enard,convection,The,simplest,test,is,to,obtain,the,stability,limit,of,the,Rayleigh-B,´enard,problem.,It,is,well-known,that,the,inﬁnite,layer,version,of,this,problem,becomes,unstable,to,convection,at,Rac,≈,1708,([10]),and,textbook,that,the,Lorenz,equations,capture,its,behaviour,close,to,onset,correctly,as,a,pitchfork,bifurcation,(see,[11,,§,11.2]).,Here,,it,is,easier,to,perform,the,analysis,for,a,unit,square,cavity,with,no-slip,boundary,conditions,at,all,walls,and,insulating,(the,term,‘adiabatic’,is,equivalent),vertical,walls.,The,paper,[12],by,Farrell,et,al.,contains,an,analysis,of,this,problem,and,there,a,value,of,Rac,=,2586,is,found,using,a,50,×,50,element,mesh,of,uniform,squares,with,order-2,elements,used,to,discretize,the,velocity,and,order-1,for,the,pressure,and,temperature,(called,Taylor-Hood,elements).,Note,that,the,aforementioned,paper,uses,Pr,=,1,,though,in,fact,the,value,of,the,critical,Rayleigh,number,does,not,depend,on,the,value,of,the,Prandtl,number,because,the,background,state,does,not,depend,on,that,value.,A,Griewank-Reddien,analysis,was,done,using,FIREDRAKE,and,starting,the,eigenvalue,search,from,a,value,of,2550.,Note,that,the,background,state,for,this,problem,is,trivial,-,a,linear,variation,in,temperature,from,T,=,1,at,the,bottom,to,T,=,0,at,the,top,,with,the,appropriate,pressure,gradient,,and,zero,ﬂuid,velocity.,The,results,(Table,1),,obtained,using,a,50,×,50,element,mesh,of,uniform,squares,,show,good,agreement,with,those,of,[12].,The,instability,mode,is,illustrated,in,Fig.7.,3.2,Vertical,natural,convection,with,unit,aspect,ratio,Of,course,,the,R-B,problem,is,simpler,and,numerically,easier,than,the,vertical,convection,case,since,the,former,involves,a,perturbation,to,a,trivial,,non-moving,background,solution.,The,vertical,case,is,more,challenging,as,a,moving,solution,appears,for,at,a,very,small,value,of,the,Rayleigh,number,and,the,moving,background,means,both,that,the,position,of,the,Hopf,bifurcation,depends,on,the,value,of,the,Prandtl,number,,and,that,the,eigenvalue,of,the,ﬁrst,instability,mode,is,not,purely,real.,The,nontrivial,background,also,introduces,local,anisotropy,into,the,system,(in,the,directional,ﬂow,,that,is,,not,anisotropic,diffusion).,11,Author,Farrell,et,al.,([12]),this,report,this,report,this,report,this,report,this,report,element,orders,Rac,value,2,,1,,1,2,,1,,1,3,,2,,2,4,,3,,3,5,,4,,4,6,,5,,5,2586,2586.2227,2585.0189,2585.0187,2585.0187,did,not,run,Table,1:,Table,of,critical,Rayleigh,number,for,the,Rayleigh-B,´enard,problem,,where,instability,is,always,direct,,ie.,growth,rates,are,all,real.,The,notation,2,,1,,1,refers,to,the,element,orders,used,for,respectively,the,velocity,,the,pressure,,and,the,temperature.,All,computations,used,a,50,×,50,mesh,of,uniform,squares.,The,6,,5,,5,case,failed,to,run,due,to,an,out-of-memory,error.,Figure,7:,Velocity,magnitude,(left),and,temperature,proﬁle,of,the,instability,mode,found,for,Rayleigh-B,´enard,convection.,Overall,scale,omitted,as,the,eigenmode,is,deﬁned,up,to,a,multi-,plicative,factor.,The,computational,mesh,is,overlaid,on,the,velocity,proﬁle.,12,Author,Winters,([13]),this,report,this,report,this,report,element,orders,2,,1,,2,2,,1,,1,3,,2,,2,4,,3,,3,Rac,value,2.1092,×,106,ωc,value,1949.4,did,not,converge,did,not,converge,2.1103,×,106,2.1080,×,106,1950.0,1949.1,Table,2:,Table,of,critical,Rayleigh,number,and,corresponding,oscillation,angular,frequency,for,the,vertical,convection,problem,with,conducting,ﬂoor,and,ceiling.,The,value,from,Winters,is,for,the,most,accurate,grid,used,for,the,ﬁrst,eigenvalue,(28,×,28),and,note,that,Winters,used,discontinuous,ﬁrst-order,elements,to,discretize,the,pressure.,There,are,two,choices,of,boundary,conditions,in,the,literature,,with,the,use,of,insulating,conditions,on,the,ﬂoor,and,ceiling,boundaries,being,the,more,common,whereas,the,relatively,early,paper,[13],used,a,conducting,condition.,3.2.1,Conducting,ﬂoor,and,ceiling,The,vertical,convection,problem,was,treated,in,1987,by,Winters,[13],,who,used,a,ﬁnite-element,discretization,with,up,to,32,×,32,grids,of,nine-noded,(ie.,second,order),elements,with,a,degree,of,reﬁnement,near,the,boundaries.,The,background,steady-state,and,the,eigenvalue,problem,were,solved,using,the,ENTWIFE,ﬁnite-element,code,developed,at,Harwell,running,on,a,Cray,S-2200.,A,unit,square,cavity,was,used,and,the,ﬂuid,had,Pr,=,0.71,,the,value,for,air,(due,to,the,application,of,this,problem,to,heat,transfer,across,double,glazing,units).,Note,one,detail,here,is,the,use,of,a,linear,temperature,proﬁle,as,a,Dirichlet,boundary,condition,T,=,1,−,x,on,the,ﬂoor,and,ceiling,(called,a,conducting,condition,above).,In,the,FIREDRAKE,implementation,,the,nontrivial,background,solution,(Fig.8),was,computed,using,a,continuation,method,(see,[14]),to,reach,a,value,known,to,be,near,the,ﬁrst,Hopf,bifurcation,(Ra,=,2,×,106,was,used).,A,40,×,40,mesh,with,boundary,reﬁnement,was,used.,The,results,(Table,2),show,very,good,agreement,with,those,of,[13].,The,instability,mode,is,illus-,trated,in,Fig.9.,3.2.2,Insulating,horizontal,boundaries,The,same,problem,with,homogeneous,Neumann,(called,insulating),boundary,conditions,on,the,ﬂoor,and,ceiling,temperatures,was,treated,by,le,Qu,´er,´e,and,Behnia,in,[15],,also,using,a,Cray,machine.,The,background,solution,is,shown,in,Fig.,10,,from,which,it,is,clear,that,there,is,a,nontrivial,ﬂow,at,two,of,the,corners,,and,the,Griewank-Reddien,analysis,produced,the,ﬁrst,unstable,mode,shown,in,Fig.11,,which,shows,that,those,interesting,ﬂows,source,the,initial,instability.,The,choice,of,boundary,conditions,for,the,temperature,can,now,be,seen,to,have,a,very,large,effect,,at,least,for,Pr,=,0.71.,Winters’,[13],result,is,Rac,≈,2.1,×,106,using,the,conducting,boundary,condition,on,the,ﬂoor,and,ceiling,of,the,cavity;,by,contrast,,using,insulating,conditions,on,those,13,Figure,8:,(L-R),Streamlines,,velocity,magnitude,,and,temperature,proﬁle,near,the,ﬁrst,Hopf,bi-,furcation,(the,actual,value,of,Ra,used,is,2,×,106),for,vertical,convection,using,the,conducting,ﬂoor,and,ceiling,boundary,conditions.,Overall,scale,omitted,as,the,eigenmode,is,deﬁned,up,to,a,multiplicative,factor.,The,computational,mesh,is,overlaid,on,the,temperature,proﬁle.,Figure,9:,(L-R),Velocity,components,x,and,y,and,temperature,proﬁle,of,the,ﬁrst,instability,mode,found,for,vertical,convection,using,the,conducting,ﬂoor,and,ceiling,boundary,conditions.,Overall,scale,omitted,as,the,eigenmode,is,deﬁned,up,to,a,multiplicative,factor.,14,Figure,10:,(L-R),Streamlines,,velocity,magnitude,,and,temperature,proﬁle,of,the,background,ﬂow,near,the,ﬁrst,Hopf,bifurcation,of,the,Pr,=,0.71,unit,square,vertical,natural,convection,using,the,insulating,ﬂoor,and,ceiling,boundary,conditions;,Ra,=,1.91,×,108.,Figure,11:,(L-R),Streamlines,,velocity,magnitude,,and,temperature,proﬁle,of,the,ﬁrst,unstable,mode,of,the,Pr,=,0.71,unit,square,vertical,natural,convection,using,the,insulating,ﬂoor,and,ceiling,boundary,conditions;,Ra,=,1.91,×,108.,boundaries,gives,Rac,≈,1.9,×,108,,which,is,close,to,the,le,Qu,´er,´e,et,al.,[15],result,that,Rac,≈,1.82,×,108.,This,represents,two,orders,of,magnitude,difference,in,the,value,of,Rac,(and,is,another,example,of,a,well-insulated,system,retaining,a,steady,ﬂow,better,than,an,un-insulated,one).,A,Biot,type,boundary,condition,could,be,imposed,with,parameter,αB,,eg.,(1,−,αB)(T,−,T0(x)),+,αB,ˆn,·,∇,·,T,=,0,and,presumably,a,UQ,analysis,would,show,a,large,sensitivity,to,the,parameter,αB.,3.3,Vertical,natural,convection,with,8,:,1,aspect,ratio,The,paper,by,Zucatti,et,al.,[16],treats,the,vertical,natural,convection,problem,in,a,tall,(8,:,1,ratio),cavity,,again,air-ﬁlled:,Pr,=,0.71.,The,ﬂoor,and,ceiling,boundary,conditions,are,insulating,(but,presumably,this,has,less,effect,than,for,the,unit,aspect,ratio,case,due,to,the,relative,shortness,of,the,ﬂoor,and,ceiling,boundaries,here).,Using,orders,3,,2,,2,the,Griewank-Reddien,solver,converges,to,Rac,=,304176.22,with,ωc,=,735.66.,15,The,results,(12),can,be,compared,with,those,illustrated,for,a,value,of,Ra,slightly,above,the,Hopf,bifurcation,in,[17],which,were,obtained,using,NEKTAR++,,as,well,as,those,in,Zucatti,et,al.,[16].,3.4,Towards,a,phase,diagram,for,vertical,natural,convection,An,exploration,of,(Ra,,Pr),space,was,performed,in,order,to,study,the,transition,between,steady,laminar,and,non-steady,oscillatory,ﬂows.,A,range,of,log10Pr,from,−2,to,2,is,chosen,(to,make,this,more,meaningful,,a,viscous,oil,such,as,glycerol,has,Pr,≈,103,,water,≈,7,,air,≈,0.7,,Mercury,≈,0.015).,For,plasma,,see,[18,,§,2.3],,the,story,is,complicated,by,the,presence,of,at,least,two,different,charged,species,,the,Braginskii,theory,is,argued,as,giving,a,Prandtl,number,of,0.23,based,on,perpendicular,coefﬁcients,and,0.33,for,parallel,transport,in,the,edge.,The,set-up,,including,boundary,conditions,,is,largely,equivalent,to,that,used,in,the,paper,by,Farrell,et,al.,([12]),ie.,a,square,cavity,,but,with,a,choice,of,conducting,or,insulating,ﬂoor,and,ceiling,bound-,ary,conditions,as,outlined,in,the,preceding,subsections.,Note,that,the,corresponding,Rayleigh-,B,´enard,problems,were,also,studied,and,both,cases,showed,a,stability,frontier,independent,of,Pr.,The,parameter,space,was,scanned,by,choosing,a,value,for,Pr,and,solving,for,the,lowest,eigen-,value,at,increasing,values,of,Ra,until,a,negative,eigenvalue,was,discovered,(the,corresponding,values,of,(Ra,,Pr),were,recorded).,This,simple,line-based,scanning,technique,was,chosen,be-,cause,the,initial,implementation,of,the,Griewank-Reddien,solver,seemed,not,particularly,reliable,,with,convergence,often,not,being,achieved;,the,author,has,been,informed,[19],that,the,nonlinear,system,may,require,a,fairly,good,initial,guess,of,the,critical,value,of,the,Rayleigh,number,in,order,to,converge,,so,perhaps,the,best,approach,is,to,use,the,Griewank-Reddien,solver,to,reﬁne,initial,values,obtained,by,a,crude,parameter,scan.,The,results,of,the,parameter,space,scan,are,shown,in,Fig.13,for,the,case,of,the,conducting,ﬂoor,and,ceiling,boundaries,and,Fig.14,for,the,insulating,(adiabatic),ﬂoor,and,ceiling,boundaries.,(The,results,indicate,that,the,departure,from,steady,laminar,convection,occurs,at,much,lower,Ra,for,ﬂuids,like,Mercury,than,for,air,/,water,/,viscous,oils,,which,is,the,case,in,reality.),Also,shown,in,both,cases,is,the,result,from,the,equivalent,Rayleigh-B,´enard,problem,in,which,the,boundary,conditions,are,basically,rotated,by,90◦,and,in,both,Rayleigh-B,´enard,cases,the,stability,frontier,is,independent,of,Prandtl,number.,Both,graphs,also,include,data,points,from,the,literature,,with,agreement,being,good,for,the,conducting,case,(already,seen,in,Table,2),and,for,both,Rayleigh-,B,´enard,cases.,Agreement,is,less,good,for,the,value,from,[20],for,the,insulating,case,,which,is,more,challenging,due,to,the,larger,values,obtained,for,the,critical,Rayleigh,number.,The,insulating,case,is,the,more,interesting,,with,the,appearance,of,a,very,rapid,change,in,Rac,for,Pr,≈,100.21,and,possibly,a,cusp,at,the,end,of,this,region,(there,may,be,additional,cusps,in,the,graph,and,indeed,may,be,one,or,more,in,the,conducting,case).,The,region,of,rapid,change,is,apparently,associated,to,a,rescaling,of,the,ﬂow,(Fig.15).,This,feature,may,be,present,for,other,choices,of,the,aspect,ratio,given,that,the,feature,is,localized,to,the,vertical,walls,with,apparently,little,coupling,between,the,walls.,Note,that,the,most,interesting,part,of,the,curve,,for,Pr,∈,[0,,0.5],,lies,within,the,Pr,range,for,probably,the,most,important,coolants,used,on,Earth,-,air,and,water.,(The,apparent,structure,of,this,curve,makes,it,an,interesting,subject,for,reduced-order,modelling,and,surrogate,construction.),It,is,clear,that,more,data,points,are,needed,along,with,a,proper,analysis,of,convergence.,Note,the,step,size,used,in,the,horizontal,scan,of,Ra,at,ﬁxed,Pr,was,1,64,in,all,cases,-,larger,step,sizes,meant,that,the,method,would,sometimes,‘miss’,a,negative,eigenvalue,and,ﬁnd,one,at,a,larger,16,Figure,12:,(L-R),Streamlines,,velocity,magnitude,,and,temperature,proﬁle,very,near,the,ﬁrst,Hopf,bifurcation,for,the,system,in,[16].,Overall,scale,omitted,as,the,eigenmode,is,deﬁned,up,to,a,multiplicative,factor.,The,three,plots,on,the,right,are,x,,y-components,of,velocity,and,T,for,the,ﬁrst,eigenmode.,The,computational,mesh,is,a,10,×,80,mesh,of,uniform,squares.,17,Figure,13:,Phase,diagram,for,vertical,natural,convection,using,the,conducting,ﬂoor,and,ceiling,boundary,conditions,of,[13],(the,value,for,the,ﬁrst,Hopf,bifurcation,from,which,is,indicated,by,the,red,cross).,The,yellow,points,indicate,where,the,same,method,has,been,applied,to,the,ﬁrst,Hopf,bifurcation,of,the,Rayleigh-B,´enard,problem,and,the,result,in,that,case,does,not,to,depend,on,the,value,of,the,Prandtl,number.,In,both,cases,,the,time-stationary,solution,is,stable,to,the,left,of,the,stability,frontier,and,is,assumed,to,remain,unstable,to,the,right,of,it.,18,Figure,14:,Phase,diagram,for,vertical,natural,convection,using,the,insulating,ﬂoor,and,ceiling,boundary,conditions,as,in,most,of,the,literature,,including,[15].,The,orange,circles,indicate,where,the,same,method,has,been,applied,to,the,ﬁrst,Hopf,bifurcation,of,the,Rayleigh-B,´enard,problem,and,the,value,of,Rac,there,is,seen,to,agree,with,the,value,of,2586,obtained,in,[12],(indicated,by,the,green,cross),and,not,to,depend,on,the,value,of,the,Prandtl,number.,Two,other,values,from,the,literature,are,plotted:,The,value,at,(non-log),(10,,6,×,1010),from,[20],,and,the,value,at,(0.71,,1.82,×,108),from,[15].,19,Figure,15:,Proﬁles,of,ﬂow,velocity,magnitude,at,Rac,for,log10Pr,=,0.205,(left),and,log10Pr,=,0.225,(right),for,the,insulating,ﬂoor,and,ceiling,boundary,conditions.,Note,the,abrupt,change,in,scale,of,the,corner,ﬂows,between,the,two,plots.,The,scale,bars,are,not,shown,but,the,peak,speed,in,the,right-hand,plot,is,≈,20,times,that,in,the,left-hand,one.,The,difference,in,Rac,between,the,two,plots,is,more,than,two,orders,of,magnitude.,value,of,Ra,(perhaps,a,higher,Hopf,bifurcation),or,would,crash.,Note,the,computations,used,the,boundary-reﬁned,40,×,40,mesh,shown,in,the,right-most,plot,of,Fig.8,with,element,orders,5,,4,,4,for,velocity,,pressure,,and,temperature.,Fig.16,shows,temperature,and,velocity,proﬁles,of,background,ﬂows,for,a,range,of,Pr,values,at,or,near,ﬁrst,Hopf,bifurcations,for,the,insulating,ﬂoor,and,ceiling,boundary,case.,It,is,clear,that,the,vicinity,of,Pr,≈,100.25,is,associated,to,very,thin,thermal,boundary,layers.,Note,that,this,‘phase,diagram’,is,a,very,good,candidate,for,reduced-order,modelling,because,a),it,condenses,a,lot,of,simulation,time,into,a,single,response,surface,(particularly,true,for,the,three-,dimensional,case),and,b),the,richness,of,physics,in,the,problem,and,the,nonlinearity,make,it,very,hard,to,predict,without,solving,the,full,problem.,The,author,admits,to,not,being,a,numerical,analysis,expert,and,plans,to,have,the,scripts,used,in,this,section,reviewed,by,eg.,the,holder,of,the,grant,T/AW087/22,(numerical,analysis).,The,author,also,offers,apologies,for,including,in,a,report,on,UQ,results,without,error,bars.,3.5,Three-dimensional,convective,heat,transport,The,3-D,version,of,the,above,problem,is,more,challenging,and,will,be,run,on,Archer2.,Studies,are,also,being,performed,using,NEKTAR++,-,Fig.17,shows,a,preliminary,output,from,a,simulation,on,Archer2,where,the,3-D,geometry,is,a,model,for,an,actual,ﬂuid,tank,experiment,being,performed,under,the,SmalLab,programme.,It,is,hoped,that,this,investigation,will,provide,a,valuable,addition,to,existing,literature,in,addition,to,theoretical,support,for,SmalLab.,20,Figure,16:,Temperature,(top),and,magnitude,of,velocity,(bottom),proﬁles,for,Pr,=,−2,,−1,,0,,1,,2,(L-R),showing,the,background,ﬁelds,at,or,near,ﬁrst,Hopf,bifurcations,for,the,insulating,horizontal,boundary,case.,Figure,17:,Temperature,near,hot,and,cold,faces,of,3-D,convecting,ﬂuid,tank,(gravity,acts,in,the,negative,z-direction,and,note,the,axes,label,on,the,ﬁgure).,Obtained,using,NEKTAR++,on,Archer2;,the,computational,mesh,comprises,189,,000,cuboidal,elements.,21,Figure,18:,(Left),mean,,variance,and,conﬁdence,intervals,for,the,electrostatic,potential,φ,evaluated,using,the,PCE,sampler.,(Right),ﬁrst-order,Sobol,indices,for,the,potential.,4,Uncertainty,quantiﬁcation,applied,to,NESO-Particles,It,is,expected,that,interesting,and,meaningful,applications,of,non-intrusive,UQ,will,be,possible,as,the,complexity,of,the,code,written,under,NEPTUNE,develops;,much,focus,in,UQ,is,on,analyz-,ing,systems,with,large,numbers,of,control,parameters,,and,once,the,atomic,reactions,,collision,dynamics,,and,multiple,species,are,included,in,the,NEPTUNE,code,this,will,be,a,major,topic,of,investigation.,For,now,,a,preliminary,study,has,been,set,up,,representing,a,successful,initial,integration,of,EasyVVUQ,,NESO-Particles,[21],,and,NEKTAR++,(which,is,used,to,perform,the,electrostatic,solve,in,the,particles,code),,and,which,is,ready,for,future,extension.,In,this,investigation,,a,polynomial,chaos,expansion,(PCE),was,ﬁtted,to,the,electrostatic,potential,generated,by,running,a,two-stream,instability,to,a,quasi-stationary,state,,for,which,it,is,known,that,the,potential,has,an,approximately,sinusoidal,form,(see,eg.,Fig.6,of,[22]).,The,PCE,(which,really,does,not,have,anything,intrinsically,to,do,with,chaos),means,expanding,the,output,quantity,of,interest,(QoI),in,a,set,of,polynomials,in,the,input,variables,,and,the,latter,are,taken,to,be,random,variables,with,some,probability,distribution,function,(PDF);,the,nice,property,is,the,easy,of,computation,of,moments,(mean,,variance,,etc.),as,the,cross,terms,cancel,out,by,orthogonality.,It,is,thus,seen,that,the,appropriate,polynomial,set,is,the,Sturm-Liouville,polynomial,with,weight,function,corresponding,to,the,PDF,of,the,random,variables.,The,particular,input,parameters,used,here,are,the,initial,particle,density,and,the,stream,velocity,,both,being,taken,to,have,uniform,distributions,(this,means,the,polynomials,of,choice,are,the,Legendre,polynomials).,The,ﬁrst-order,Sobol,indices,are,also,available,in,the,example;,these,tell,the,how,much,of,the,variance,in,the,QoI,comes,from,each,input.,Some,details,of,the,campaign,were:,4,×,105,particles,,particle,density,uniformly,distributed,on,[94.5,,115.5],,initial,velocity,uniformly,distributed,on,[0.9,,1.1].,The,number,of,runs,required,for,the,campaign,is,deﬁned,by,N,=,(p,+,1)d,where,p,is,the,polynomial,order,(p,=,3,was,chosen,,on,the,basis,that,it,gave,very,similar,outputs,to,p,=,2),and,d,=,2,is,the,number,of,uncertain,input,parameters,,so,16,runs,were,required,for,this,exercise.,22,These,scripts,can,be,found,in,the,GitHub,repository,[23].,5,Grantee,work,Expertise,in,uncertainty,quantiﬁcation,and,reduced-order,modelling,is,being,provided,to,the,NEP-,TUNE,project,by,the,holder,of,the,grant,T/AW085-21,,University,College,London,,via,the,AQUIFER,project,(the,acronym,derives,from,Advanced,Quantiﬁcation,of,Uncertainties,In,Fusion,at,the,Ex-,ascale,with,model,order,Reduction)).,That,grantee,is,also,responsible,for,the,SEAVEA,project,[24],(the,acronym,stands,for,Software,Environment,for,Actionable,and,VVUQ-evaluated,Exascale,Applications),under,which,is,developed,and,maintained,the,SEAVEA,Toolkit,,a,signiﬁcant,body,of,open-source,software,for,uncertainty,quantiﬁcation;,this,will,be,described,brieﬂy.,Note,much,of,this,software,was,formerly,under,the,guise,of,the,VECMA,Toolkit.,A,simple,summary,of,the,components,of,the,SEAVEA,Toolkit,is:,•,EasyVVUQ,-,provides,tools,for,non-intrusive,uncertainty,quantiﬁcation,,including,the,con-,struction,of,polynomial,chaos,surrogates,and,the,calculation,of,Sobol,indices.,•,MUSCLE3,-,A,framework,for,coupling,codes,and,propagating,uncertainty,through,the,cou-,pling.,•,FabSim3,-,a,framework,for,automating,UQ,workﬂows,on,HPC.,•,QCG-Client,and,Broker,-,manages,different,job,types,,including,complex,workﬂows,using,supercomputers.,•,QCG-PilotJob,-,tool,enabling,the,submission,of,large,numbers,(eg.,108),of,individual,jobs,to,a,supercomputer.,•,QCG-Now,-,aims,to,enable,getting,quick,and,convenient,use,of,a,supercomputer.,•,EasySurrogate,and,MOGP,-,tools,for,constructing,cheaper,surrogate,models;,MOGP,(for,Multi-Output,Gaussian,Process),computes,Gaussian,process,surrogates.,The,toolkit,is,being,actively,developed,and,some,additions,have,been,made,to,target,speciﬁc,problems,raised,by,UKAEA,eg.,surrogates,for,models,with,discontinuous,response,surfaces,via,the,simplex-stochastic,correlation,method,as,explained,in,[25].,It,is,notable,that,many,of,the,VVUQ,tools,in,EasyVVUQ,deal,only,with,forward,uncertainty,propa-,gation,,ie.,they,do,not,work,in,cases,where,there,is,two-way,coupling,between,models.,A,particle,ﬁlter-based,data,assimilation,package,,ParticleDA.jl,[26],,was,released,during,2022,and,is,currently,being,integrated,with,the,above,tools.,An,initial,version,,which,provides,data,assimilation,capability,linked,to,the,other,capabilities,of,the,SEAVEA,Toolkit,,can,be,found,at,[27].,The,grantee,has,implemented,a,plug-in,for,FabSim3,which,uses,as,target,problem,a,choice,of,two-dimensional,and,three-dimensional,ﬂuid,convection,problems,in,NEKTAR++.,This,facilitates,applying,the,SEAVEA,toolkit,to,NEPTUNE,-speciﬁc,problems.,23,Two,hackathons,were,held,(24,June,and,8-9,December,2022).,The,ﬁrst,of,these,was,attended,remotely,by,ET,and,Owen,Parry,of,UKAEA,and,focussed,on,running,FabNEPTUNE,both,lo-,cally,and,on,Archer2.,The,second,was,held,at,UCL;,authors,ET,and,SP,attended,in-person,and,focussed,on,integrating,EasyVVUQ,with,NESO-Particles.,In,December,2022,,James,Cook,gave,a,presentation,at,the,SEAVEA,Applications,Meeting,,which,was,attended,by,other,UKAEA,per-,sonnel,,on,the,topic,of,FEM-Particle,Coupling,with,NESO-Particles,being,the,main,focus.,A,high,level,overview,of,the,implementation,of,NESO-Particles,was,given:,the,L2,Galerkin,projection,of,particle,quantities,to,a,ﬂuid,representation,of,the,density,of,that,quantity;,the,capability,to,store,arbitrary,data,on,particles;,the,ideas,behind,how,particle,movement,is,formed,between,cells,and,across,MPI,ranks;,and,ﬁnally,favourable,scaling,of,both,local,and,global,particle,transfer,across,the,MPI,domain,is,shown.,The,grantee,has,performed,an,initial,comparison,between,linked,and,deep,Gaussian,Process,approaches,for,an,example,problem.,The,grantee,has,also,performed,a,study,of,data,assimilation,as,applied,to,the,outputs,of,a,nonlinear,ODE,system,containing,two,time-scales,-,this,model,replaces,actual,physical,data,that,,due,to,delays,in,getting,the,SmalLab,experimental,campaign,working,,is,not,yet,available.,The,grantee,has,provided,HPC,allocations,including,Archer2,and,also,the,future,prospect,of,Fron-,tier,and,its,testbed,proxy,Crusher,,the,latter,of,which,will,be,exploited,as,soon,as,a,scaleable,NEPTUNE,GPU,code,is,available.,6,Summary,A,computationally-cheap,one-dimensional,system,of,a,reduced,convection,model,coupled,to,a,diffusion,model,was,demonstrated,and,was,shown,to,exhibit,the,phenomenologically-plausible,behaviour,of,more,insulation,suppressing,chaotic,behaviour.,It,is,worth,noting,however,that,the,models,assume,a,uniform,temperature,of,insulator,,which,may,be,difﬁcult,to,achieve,in,prac-,tice,(D.,Buta,,private,communication).,A,two-dimensional,case,of,vertical,natural,convection,was,studied,and,the,boundary,in,parameter,space,between,steady,laminar,ﬂows,and,oscillatory,ﬂows,,which,is,the,start,of,the,transition,to,turbulence,,was,uncovered,for,two,choices,of,boundary,con-,ditions,on,the,horizontal,boundaries,of,the,domain.,The,ensemble,UQ,package,EASYVVUQ,was,applied,to,the,NEPTUNE,particles,code,NESO-PARTICLES.,The,work,of,the,holder,of,grant,T/AW085/21,on,UQ,and,reduced-order,models,was,brieﬂy,summarized.,Acknowledgement,ET,acknowledges,assistance,from,Wayne,Arter,and,Owen,Parry,of,UKAEA,,Patrick,Farrell,of,Oxford,University,Mathematical,Institute,,and,Derek,Groen,of,Brunel,University.,The,support,of,the,UK,Meteorological,Ofﬁce,and,Strategic,Priorities,Fund,is,acknowledged.,24,References,[1],F.,Wilczynski,,D.W.,Hughes,,W.,Arter,,and,F.,Militello.,Onset,of,interchange,instability,in,a,coupled,core-SOL,plasma.,Physics,of,Plasmas,,27(7):072508,,2020.,[2],Lorenz,E.N.,Deterministic,nonperiodic,ﬂow.,J.,Atmos.,Sci.,20,,pages,130–141,,1963.,[3],Dullin,H.,,Schmidt,S.,,Richter,P.H.,,and,Grossmann,S.K.,Extended,phase,diagram,of,the,International,Journal,of,Bifurcation,and,Chaos,Vol.17,No.09,,pp.3013-3033,,Lorenz,model.,2007.,[4],N.,Gershenfeld.,The,Nature,of,Mathematical,Modelling.,Cambridge,University,Press,,1999.,[5],S.,Grossmann,and,D.,Lohse.,Scaling,in,thermal,convection:,a,unifying,theory.,Journal,of,Fluid,Mechanics,,407:27–56,,2000.,[6],Florian,Rathgeber,,David,A.,Ham,,Lawrence,Mitchell,,Michael,Lange,,Fabio,Luporini,,An-,drew,T.,T.,Mcrae,,Gheorghe-Teodor,Bercea,,Graham,R.,Markall,,and,Paul,H.,J.,Kelly.,Fire-,drake:,automating,the,ﬁnite,element,method,by,composing,abstractions.,ACM,Trans.,Math.,Softw.,,43(3):24:124:27,,2016.,URL:,http://arxiv.org/abs/1501.01809,,arXiv:1501.01809,,doi:10.1145/2998441.,,2015.,[7],Scalable,Library,for,Eigenvalue,Problem,Computations.,https://slepc.upv.es/.,Accessed:,September,2022.,[8],Griewank,A.,and,Reddien,G.,The,calculation,of,Hopf,points,by,a,direct,method.,IMA,J.,Numer.,Anal.,,Vol.3,,pp.295-303.,,1983.,[9],Boulle,N.,,Farrell,P.E.,,and,Rognes,M.E.,Optimization,of,Hopf,bifurcation,points.,arXiv,preprint,arXiv:2201.11684,,2022.,[10],S.,Chandrasekhar.,Hydrodynamic,and,Hydromagnetic,Stability.,Clarendon,Press,,1961.,[11],J.M.T.,Thompson,and,H.B.,Stewart.,Nonlinear,Dynamics,and,Chaos,,2nd,Edition.,John,Wiley,&amp;,Sons,Inc,,2002.,[12],N.,Boull,´e,,V.,Dallas,,and,P.,E.,Farrell.,Bifurcation,analysis,of,two-dimensional,rayleigh-b,´enard,convection,using,deﬂation.,Phys.,Rev.,E,,105:055106,,May,2022.,[13],Winters,K.H.,Hopf,bifurcation,in,the,double-glazing,problem,with,conducting,boundaries.,Transactions,of,the,ASME,894,/,Vol.109,,November,1987.,,1987.,[14],Arter,W.,,Parry,O.,,and,E.,Threlfall.,Finite,element,models:,complementary,actions,3.,Tech-,nical,Report,CD/EXCALIBUR-FMS/0074,,UKAEA,Project,Neptune.,[15],le,Qu,´er,´e,P.,and,Behnia,M.,From,onset,of,unsteadiness,to,chaos,in,a,differentially,heated,square,cavity.,J.,Fluid,Mech.,(1998),vol.359,pp81-107,,1998.,[16],Zucatti,V.,,Lui,H.F.S.,,Pitz,D.B.,,and,Wolf,W.R.,Assessment,of,reduced-order,modelling,strate-,gies,for,convective,heat,transfer.,Numerical,Heat,Transfer:,Part,A:,Applications,77:7.,,pages,702–729,,2020.,25,[17],E.,Threlfall.,Finite,element,models:,complementary,actions,2.,Report,CD/EXCALIBUR-FMS/0064,,UKAEA,Project,Neptune,,//github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/reports/ukaea_reports/,CD-EXCALIBUR-FMS0046-M6.2.pdf.,2022.,Technical,https:,[18],W.,Arter,et,al.,Equations,for,EXCALIBUR/NEPTUNE,Proxyapps.,cal,Report,CD/EXCALIBUR-FMS/0021-1.26-M1.2.1,,UKAEA,,1,2023.,//github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/reports/ukaea_reports/,CD-EXCALIBUR-FMS0021-1.26-M1.2.1.pdf.,Techni-,https:,[19],Farrell,P.E.,Private,communication,,2023.,[20],Wang,Q.,,Liu,H-R.,,Verzicco,R.,,Shishkina,O.,,and,Lohse,D.,Regime,transitions,in,ther-,mally,driven,high-Rayleigh,number,vertical,convection.,J.,Fluid,Mech.,(2021),Vol.197,A.6,doi:10.1017/jfm.2021.262,,2021.,[21],NESO-Particles,code,repository.,https://github.com/ExCALIBUR-NEPTUNE/,NESO-Particles.,Accessed:,September,2022.,[22],E.,Threlfall,and,W.,Saunders.,Support,high-dimensional,procurement.,cal,Report,CD/EXCALIBUR-FMS/0066,,UKAEA,Project,Neptune,,2022.,//github.com/ExCALIBUR-NEPTUNE/Documents/blob/main/reports/ukaea_reports/,CD-EXCALIBUR-FMS0066-M4.1.pdf.,Techni-,https:,[23],NESO-UQ,code,repository.,https://github.com/ExCALIBUR-NEPTUNE/NESO-UQ.,Accessed:,March,2023.,[24],SEAVEAtk.,https://www.seavea-project.org/seaveatk/.,Accessed:,March,2023.,[25],Edeling,W.N,,Dwight,R.P.,,and,Cinella,P.,Simplex-stochastic,collocation,method,with,improved,scalability,,2016.,[26],ParticleDA.jl.,https://github.com/Team-RADDISH/ParticleDA.jl.,Accessed:,March,2023.,[27],FABParticleDA.,https://github.com/djgroen/FabParticleDA/tree/master.,Accessed:,March,2023.,26" name="keywords" />

    <title>CD-EXCALIBUR-FMS0073-M5c.1_ExcaliburFusionModellingSystemAtMilestoneM5C1 &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cd-excalibur-fms0073-m5c-1-excaliburfusionmodellingsystematmilestonem5c1">
<h1>CD-EXCALIBUR-FMS0073-M5c.1_ExcaliburFusionModellingSystemAtMilestoneM5C1<a class="headerlink" href="#cd-excalibur-fms0073-m5c-1-excaliburfusionmodellingsystematmilestonem5c1" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/CD-EXCALIBUR-FMS0073-M5c.1_ExcaliburFusionModellingSystemAtMilestoneM5C1.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/CD-EXCALIBUR-FMS0073-M5c.1_ExcaliburFusionModellingSystemAtMilestoneM5C1.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>