
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="Report,2070839-TN-05,Numerical,implementation,of,a,fluid,model,for,electrons,in,a,drift,kinetic,code,M.,Barnes1,,M.,R.,Hardman2,,S.,Newton3,,J.,Omotani3,and,F.,I.,Parra4,1,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,2,Tokamak,Energy,Ltd,,173,Brook,Drive,,Milton,Park,,Abingdon,OX14,4SD,,United,Kingdom,3,Culham,Centre,for,Fusion,Energy,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,United,Kingdom,4,Princeton,Plasma,Physics,Laboratory,,P.O.,Box,451,,Princeton,,New,Jersey,08540,,United,States,E-mail:,michael.barnes&#64;physics.ox.ac.uk,1.,Introduction,Calculation,of,the,electrostatic,potential,is,a,challenge,within,the,drift,kinetic,approximation.,This,is,because,,without,further,manipulation,of,the,drift,kinetic,system,of,equations,,there,is,no,explicit,equation,to,be,solved,for,the,potential:,Instead,,it,appears,as,a,parameter,in,the,drift,kinetic,equations,for,both,electrons,and,ions,,which,In,report,2047357-TN-07-01,[1],,are,then,related,to,one,another,via,quasineutrality.,we,showed,how,the,electrostatic,potential,could,be,calculated,self-consistently,for,a,2D,drift,kinetic,model,with,a,helical,magnetic,field,and,with,wall,boundary,conditions,appropriate,for,open,field,lines.,Considerable,care,had,to,be,taken,to,obtain,an,expression,for,the,electrostatic,potential.,In,particular,,a,set,of,fluid,equations,had,to,be,formulated,for,the,electron,dynamics,,with,closure,via,coupling,to,the,kinetic,equation,for,a,modified,electron,particle,distribution,function.,In,this,moment-kinetic,formulation,,the,parallel,electron,momentum,equation,becomes,the,equation,for,the,electrostatic,potential,,with,an,additional,complication,that,the,boundary,value,for,the,potential,must,be,determined,implicitly,as,it,enters,in,the,limits,of,integration,for,the,parallel,current,at,the,plasma,boundary.,Thus,far,we,have,side-stepped,the,issue,of,calculating,the,potential,in,our,ProxyApps,by,using,a,Boltzmann,response,for,the,electron,dynamics,so,that,no,electron,equations,need,to,be,solved,at,all.,We,are,now,seeking,to,address,this,limitation,,as,we,describe,in,this,report.,In,particular,,we,have,implemented,the,electron,fluid,equations,for,the,1+1D,system,described,in,report,2047357-TN-05-01,[2],,with,a,Braginskii,fluid,closure,for,the,electrons,[3].,The,main,advantage,of,restricting,our,attention,to,the,1+1D,case,is,the,fact,that,in,such,a,system,there,is,no,need,to,solve,for,the,electrostatic,1,2,DRIFT,KINETIC,SYSTEM,OF,EQUATIONS,2,potential,itself:,Instead,,we,need,only,compute,the,parallel,electric,field,,and,this,allows,us,to,avoid,for,the,moment,the,issue,of,how,to,solve,for,the,electrostatic,potential,at,the,boundary,of,the,domain.,To,begin,we,will,provide,a,brief,overview,of,the,physical,system,we,aim,to,model,,and,provide,the,system,of,evolution,equations,for,the,various,plasma,species.,We,then,demonstrate,that,the,implementation,appears,to,be,working,by,providing,numerical,results,and,comparing,with,a,test,case.,2.,Drift,kinetic,system,of,equations,We,consider,a,plasma,consisting,of,a,single,ion,species,of,charge,e,and,mass,mi,,a,single,neutral,species,with,mass,mn,=,mi,,and,electrons,with,charge,e,and,mass,me.,The,plasma,is,immersed,in,a,straight,,homogeneous,magnetic,field,of,the,form,−,B,=,Bˆz,,(1),where,z,is,the,field-aligned,coordinate,,and,ˆz,is,the,unit,vector,in,the,direction,of,z.,We,assume,that,the,plasma,is,electrostatic,and,that,the,magnetic,field,terminates,on,[z−,,z+],,with,each,end,at,a,conducting,wall.,The,spatial,domain,we,consider,is,z,z+,z−,=,Lz.,The,boundaries,of,the,domain,in,z,are,assumed,to,be,the,entrances,to,the,magnetic,pre-sheath.,∇,−,∈,We,restrict,our,attention,to,parallel,dynamics,only,and,define,the,marginalised,distribution,function,fs(z,,v∥,,t),.,=,(cid:68),ˆfs(z,,v∥,,v⊥,,ϑ,,t),(cid:69),.,=,2π,(cid:90),∞,0,dv⊥v⊥,ˆfs,,(2),with,ˆfs,the,particle,distribution,function,for,species,s,,t,the,time,,v∥,the,parallel,component,of,the,particle,velocity,v,,and,the,angle,brackets,denoting,integration,over,gyro-angle,ϑ,and,the,perpendicular,component,of,the,particle,velocity,v⊥.,As,described,in,,e.g.,,Report,2047537-TN-05-1,[2],,the,drift,kinetic,equations,describing,the,evolution,of,the,marginalised,particle,distribution,fs,for,the,ions,and,neutrals,are,∂fi,∂t,+,v∥,∂fi,∂z,−,e,mi,∂ϕ,∂z,∂fi,∂v∥,=,Rin,(nnfi,−,−,nifn),+,Rionnefn,+,Si,(3),and,∂fn,∂t,+,v∥,∂fn,∂z,=,Rin,(nnfi,−,nifn),−,Rionnefn,+,Sn,,(4),where,ϕ,is,the,electrostatic,potential,,ns,=,(cid:82),dv∥fs,is,the,particle,density,,Ss,=,(cid:10),ˆSs,is,a,marginalised,source,accounting,for,,e.g.,,heating,and,fueling,,and,Rin,and,Rion,are,constants,that,determine,the,ion-neutral,charge,exchange,and,ionisation,rates,,(cid:11),3,ELECTRON,FLUID,EQUATIONS,3,respectively.,The,distribution,function,fi,quasineutrality:,(cid:90),∞,is,related,to,the,electron,density,ne,via,ni,=,dv∥fi,=,ne.,(5),−∞,One,of,the,main,challenges,in,solving,this,system,of,equations,is,that,there,is,no,explicit,equation,for,the,electrostatic,potential.,If,one,were,to,try,,e.g.,,to,solve,the,ion,drift,kinetic,equation,(3),and,a,corresponding,electron,drift,kinetic,equation,using,an,explicit,time,advance,algorithm,with,ϕ,at,the,previous,time,level,as,an,input,,then,in,general,the,solutions,for,fi,and,fe,so,obtained,would,not,satisfy,Eq.,(5).,This,procedure,could,be,iterated,,with,ϕ,varied,until,quasineutrality,were,satisfied,,or,one,could,develop,an,approach,that,guarantees,satisfaction,of,quasineutrality,from,the,outset.,We,have,presented,two,such,approaches,in,previous,reports:,The,first,assumes,a,Boltzmann,electron,response,and,thus,avoids,entirely,the,need,to,solve,for,the,electron,dynamics,,while,the,second,uses,a,novel,moment-kinetic,approach,in,which,the,electron,parallel,momentum,equation,can,be,used,to,solve,for,the,potential,explicitly,while,enforcing,quasineutrality.,In,this,report,we,describe,the,numerical,implementation,and,testing,of,a,set,of,electron,fluid,equations,that,can,be,used,as,the,basis,for,the,moment-kinetic,approach,alluded,to,above.,We,will,assume,in,this,report,that,fi,and,fn,can,be,obtained,,provided,ϕ,,either,via,direct,solution,of,the,above,drift,kinetic,equations,or,via,the,moment-kinetic,approach,derived,in,report,2047357-TN-05-01,[2].,Our,focus,here,will,be,on,describing,the,numerical,treatment,of,the,electron,fluid,equations,and,their,relationship,to,the,calculation,of,the,electrostatic,potential.,3.,Electron,fluid,equations,Electron,fluid,equations,are,obtained,by,taking,the,appropriate,velocity,moments,of,the,electron,drift,kinetic,equation.,Details,can,be,found,in,[2].,The,electron,continuity,equation,is,‡,∂ne,∂t,+,∂neue,∂z,=,nennRion,+,(cid:90),∞,−∞,where,the,parallel,flow,of,species,s,is,given,by,.,=,us,1,ns,(cid:90),∞,−∞,dv∥v∥fs.,dv∥Se,,(6),(7),The,charge,conservation,equation,,obtained,by,combining,the,electron,and,ion,continuity,equations,and,enforcing,quasineutrality,,is,∂,∂z,(ne,(ui,−,ue)),=,0.,(8),Here,we,have,corrected,a,typo,in,the,sign,of,the,electron,ionisation,particle,source,appearing,in,[2].,‡,3,ELECTRON,FLUID,EQUATIONS,Note,that,we,have,assumed,(cid:82),d3v,(Si,−,electron,parallel,momentum,equation,is,Se),is,small,to,obtain,the,above,result.,The,4,∂p∥,e,∂z,−,+,ene,∂ϕ,∂z,+,F∥[fe,,fi],+,nemennRen,(un,−,ue),=,0,,where,p∥,e,is,the,electron,parallel,pressure,,(cid:90),.,=,p∥,e,d3v,mew2,∥fe,,(9),(10),.,=,v∥,w∥,that,determines,the,electron-neutral,elastic,collision,rate,,and,ue,is,the,parallel,component,of,the,electron,peculiar,velocity,,Ren,is,a,constant,−,F∥,=,F∥[fe,,fi](z,,t),(cid:90),.,=,d3v,mev∥Cei[,ˆfe,,ˆfi],(11),is,the,parallel,friction,force,between,electrons,and,ions,,with,Cei,the,electron-ion,collision,operator.,The,term,proportional,to,Se,has,been,neglected,in,(9),as,small,in,me/mi,.,=,(cid:112)2Ti/mi.,because,we,order,Se,∼,fevth,i/Lz,,with,vth,i,Finally,,the,electron,energy,equation,is,(cid:18),∂Te,∂t,(cid:18),∂q∥,e,∂z,∂Te,∂z,∂ue,∂z,+,p∥,e,+,ue,=,(cid:19),−,3,2,ne,(cid:19),+,3nemeνei,mi,(Ti,−,Te),+,F∥,(ui,−,ue)2,ue),(12),3nemennRen,mi,(cid:18),mew2,(cid:90),d3v,+,+,Te),+,nemennRen,(un,−,(Tn,−,(cid:19),3,nennRionEion,,Te,2,ˆSe,−,2,−,.,=,where,w,radiation,from,excited,states),,and,q∥,e,is,the,electron,parallel,heat,flux,,is,the,peculiar,speed,,Eion,is,the,ionisation,energy,cost,(including,ueˆz,|,v,|,−,(cid:90),.,=,q∥,e,d3wmsw3,∥fe.,(13),The,electron,energy,equation,(12),can,also,be,expressed,in,terms,of,the,electron,pressure:,∂pe,∂t,=,2,3,2,3,−,+,(cid:18),2,3,∂q∥,e,∂z,−,F∥,(ui,−,(cid:18),pe,−,(cid:19),∂ue,p∥,e,+,pe,∂z,−,2nemennRen,mi,(cid:19),(cid:90),neEion,+,2,3,ue),+,ue,∂pe,∂z,+,Te),+,(Tn,−,d3v,mew2,3,ˆSe.,+,nnRion,Ti),2nemeνei,(Te,−,mi,2,nemennRen,(un,−,3,ue)2,(14),To,facilitate,our,1+1D,treatment,,we,assume,that,the,particle,distribution,ˆfs,and,∥Ss.,With,source,ˆSs,are,isotropic,,so,that,ps,=,p∥,s,and,(cid:82),d3v(msw2/3),ˆSs,=,(cid:82),dv∥msw2,4,BOUNDARY,CONDITIONS,5,these,approximations,,the,electron,energy,equation,is,∂p∥,e,∂t,=,−,+,2,3,2,3,∂q∥,e,∂z,−,F∥,(ui,−,(cid:18),5,3,p∥,e,ue),+,ue,∂ue,∂z,−,2meRen,mi,∂p∥,e,∂z,+,2meνei,mini,(cid:0)nep∥,n,−,(cid:19),(cid:90),∞,nnp∥,e,(cid:0)nip∥,e,−,(cid:1),+,2,3,+,nnRion,p∥,e,−,2,3,neEion,+,dv∥mew2,∥Se.,−∞,(cid:1),nep∥,i,nemennRen,(un,−,ue)2,(15),The,set,of,fluid,equations,(8)-(11),and,(13)-(15),require,some,form,of,closure,to,calculate,the,parallel,friction,and,heat,flux.,Ultimately,,we,intend,to,use,the,moment-,kinetic,treatment,proposed,in,[2],,but,for,this,report,we,employ,the,simple,Braginskii,closure,[3]:,and,F∥,=,0.51nemeνei,(ui,−,ue),−,0.71ne,∂Te,∂z,q∥,e,=,3.16,−,p∥,e,meνei,∂Te,∂z,−,0.71p∥,e,(ui,−,ue),.,(16),(17),The,set,of,equations,(3)-(5),,(8),,(9),,(15),and,(16)-(17),constitute,a,closed,set,of,equations,for,fi,,fn,,ϕ,,ne,,ue,and,p∥,e,,provided,an,appropriate,set,of,boundary,conditions.,We,turn,our,attention,to,these,boundary,conditions,next.,4.,Boundary,conditions,To,ensure,uniqueness,of,our,solution,,we,must,specify,boundary,conditions,in,z,on,the,ion,and,neutral,particle,distributions,,and,on,the,electron,parallel,flow,and,pressure.,For,the,ions,,we,assume,that,all,ions,that,reach,the,end,of,the,domain,escape,to,the,wall,,where,they,recombine.,Thus,,no,ions,return;,i.e.,,and,fi(z+,,v∥,&lt;,0,,t),=,0,,fi(z−,,v∥,&gt;,0,,t),=,0.,(18),(19),Neutrals,that,leave,the,domain,are,assumed,to,hit,the,wall,and,thermalise,at,the,temperature,of,the,wall,,Tw.,Ions,that,recombine,at,the,wall,also,re-enter,as,neutrals.,The,resulting,boundary,condition,on,the,neutrals,is,and,where,fn(z−,,v∥,&gt;,0,,t),=,Γ−fKw(v∥),,fn(z+,,v∥,&lt;,0,,t),=,Γ+fKw(v∥),,fKw(v∥),.,=,3√π,(cid:19)3/2,(cid:18),mi,2Tw,(cid:12),(cid:12)v∥,(cid:12),(cid:12),erfc,(cid:18)(cid:114),mi,2Tw,(cid:19),(cid:12),(cid:12)v∥,(cid:12),(cid:12),(20),(21),(22),4,BOUNDARY,CONDITIONS,is,the,(marginalised),Knudsen,cosine,distribution,[4],,and,and,.,=,Γ−,(cid:90),0,(cid:88),s=i,n,−∞,.,=,Γ+,(cid:88),(cid:90),∞,s=i,n,0,dv∥,(cid:12),(cid:12)v∥,(cid:12),(cid:12),fs(z−,,v∥,,t),dv∥,(cid:12),(cid:12)v∥,(cid:12),(cid:12),fs(z+,,v∥,,t),6,(23),(24),are,the,combined,fluxes,of,neutrals,and,ions,towards,the,walls,at,z,=,z−,and,z,=,z+,,respectively.,For,electrons,that,leave,the,domain,,their,parallel,energy,−,is,conserved.,As,a,result,,electrons,with,parallel,speeds,greater,than,vc,+,(cid:112)2e(ϕ(z+,,t),z,=,z+;,electrons,with,speeds,less,than,vc,+,are,repelled,back,into,the,domain:,eϕ,.,=,ϕw)/me,at,z+,reach,the,wall,,with,ϕw,the,potential,of,the,wall,beyond,∥,=,mev2,∥/2,−,E,fe(z+,,v∥,&lt;,0,,t),=,(cid:40),fe(z+,,0,,v∥,,t),,−,&lt;,vc,+,&gt;,vc,+.,v∥,|,v∥,|,|,|,The,boundary,condition,at,z,=,z−,is,similar:,fe(z−,,v∥,&gt;,0,,t),=,(cid:40),fe(z−,,0,,v∥,,t),,−,&lt;,vc,−,&gt;,vc,−,,v∥,|,v∥,|,|,|,(25),(26),where,vc,−,.,=,(cid:112)2eϕ(z−,,t)/me,,and,we,have,chosen,ϕ,to,be,zero,at,the,wall,beyond,z−.,Integrating,the,charge,conservation,equation,(8),and,using,(25)-(26),gives,a,constraint,on,the,parallel,current,at,the,domain,boundaries:,0,=,J∥(z+,,t),J∥(z−,,t),=,−,(cid:90),∞,0,(cid:90),0,−,−∞,dv∥v∥fi(z+,,v∥,,t),−,dv∥v∥fi(z−,,v∥,,t),+,(cid:90),∞,dv∥v∥fe(z+,,v∥,,t),vc,+,(cid:90),−vc,−,−∞,dv∥v∥fe(z−,,v∥,,t).,(27),&lt;,vc,+,Note,that,there,is,no,contribution,to,the,electron,current,from,particles,with,at,z,=,z+,nor,from,particles,with,&lt;,vc,−,at,z,=,z−.,This,is,because,the,outgoing,current,of,electrons,with,these,speeds,is,cancelled,by,the,return,current,of,these,electrons.,As,proposed,in,[2],,we,simplify,our,system,by,assuming,that,the,parallel,current,into,the,wall,vanishes,individually,at,each,boundary;,i.e.,,J∥(z+,,t),=,J∥(z−,,t),=,0.,Combined,with,quasineutrality,,this,imposes,ue(z±,,t),=,ui(z±,,t).,The,charge,conservation,equation,(8),can,then,be,integrated,to,find,ue,=,ui,for,all,z.,v∥,|,v∥,|,|,|,Our,boundary,condition,on,p∥,e,is,chosen,based,on,the,physics,we,intend,to,model;,for,the,cases,considered,in,this,report,,we,either,set,Te(z±,,t),=,Ti(z±,,t),(when,νei,is,large),or,we,assume,that,the,electron,temperature,is,constant,throughout,the,sheath,so,that,Te(z±,,t),=,Tw,(when,we,wish,to,force,a,Boltzmann,electron,response),,with,Tw,the,temperature,of,the,wall.,6,NUMERICAL,APPROACH,5.,Normalisations,7,The,normalisations,used,in,the,code,are,given,in,Table,1.,The,normalised,drift,kinetic,equations,for,ions,and,neutrals,are,∂,˜fi,∂˜t,+,˜v∥,∂,˜fi,∂,˜z,−,1,2,∂,˜ϕ,∂,˜z,∂,˜fi,∂˜v∥,(cid:16),˜Rin,˜nn,˜fi,−,=,−,(cid:17),˜ni,˜fn,+,˜Rion˜ne,˜fn,+,˜Si,(28),and,∂,˜fn,∂˜t,+,˜v∥,∂,˜fn,∂,˜z,(cid:16),=,˜Rin,˜nn,˜fi,−,(cid:17),˜ni,˜fn,−,˜Rion˜ne,˜fn,+,˜Sn.,The,normalised,electron,fluid,equations,are,˜ne,=,˜ni,,(˜ne,(˜ui,−,˜ue)),=,0,,∂,∂,˜z,∂,˜ϕ,∂,˜z,∂,˜p∥,e,∂,˜z,−,+,˜ne,2,+,˜F∥,+,˜ne,˜me˜nn,˜Ren,(˜un,−,˜ue),=,0,,(29),(30),(31),(32),and,∂,˜p∥,e,∂˜t,=,2,3,2,3,−,+,∂,˜q∥,e,∂,˜z,−,˜F∥,(˜ui,−,˜Rion,+,˜nn,5,3,˜p∥,e,∂,˜ue,∂z,−,˜ue,∂,˜p∥,e,∂,˜z,+,2,˜me˜νei,˜ue),+,2,˜me,(cid:18),˜p∥,e,−,2,3,˜ne,˜Ren,(cid:19),˜Eion,(cid:0)˜ne,˜p∥,n,−,+,˜,Pe,,(cid:0)˜p∥,i,−,(cid:1),+,2,3,(cid:1),˜p∥,e,˜ne,˜me˜nn,˜Ren,(˜un,−,˜ue)2,(33),˜nn,˜p∥,e,where,.,=,1,√π,˜,Pe,(cid:90),∞,−∞,˜v∥,˜me,˜w2,∥,˜Se.,(34),The,zero,current,boundary,condition,at,the,wall,,combined,with,quasineutrality,(30),and,charge,conservation,(31),,imposes,˜ue,=,˜ui.,6.,Numerical,approach,A,detailed,description,of,the,space,and,time,discretisations,employed,in,the,code,can,be,found,in,report,2047357-TN-14,[5].,Briefly,,we,employ,an,explicit,time,advance,algorithm,(a,strong-stability-preserving,Runge-Kutta,variant),to,evolve,the,ion,and,neutral,particle,distribution,functions,,as,well,as,the,electron,parallel,pressure.,A,Chebyshev,spectral,element,scheme,is,used,for,the,spatial,discretisation.,Solution,of,the,coupled,equations,proceeds,schematically,in,the,following,way:,•,Solve,the,ion,(28),and,neutral,(29),drift,kinetic,equations,for,fi,and,fn,within,a,Runge-Kutta,stage,,given,the,parallel,electric,field,E∥,at,the,previous,time,step,,and,subject,to,the,appropriate,boundary,conditions,(18)-(21).,7,NUMERICAL,RESULTS,8,normalised,variable,˜t,˜z,˜v∥,˜w,˜ns,˜us,˜p∥,s,˜q∥,e,˜Ts,˜ϕ,˜Ez,˜Rsn,˜Rion,˜Eion,˜νei,˜fs,˜F∥,˜Ss,˜me,definition,t(cref/Lref),z/Lref,v∥/cs,w/cs,ns/nref,us/cref,p∥,s/(2nrefTref),q∥,s/(2nrefTrefcref),Ts/Tref,eϕ/Tref,eLrefEz/Tref,Rsn(nrefLref/cref),Rion(nrefLref/cref),Eion/(2Tref),νei(Lref/cref),fs(csπ1/2/nref),F∥(Lref/2nrefTref),Ss(Lrefπ1/2/nref)(cs/cref),me/mi,reference,quantity,Lref,=,Lz,Tref,nref,cref,mi,definition,ref.,length,ref.,temperature,ref.,density,(cid:112)2Tref/mi,ion,mass,Table,1.,Definitions,for,normalised,and,reference,quantities,used,in,the,report.,Note,that,cs,=,cref,mi/ms.,(cid:112),Solve,the,electron,energy,equation,(33),to,update,p∥,e,within,a,Runge-Kutta,stage.,With,fi,and,fn,updated,,calculate,the,ion,density,and,parallel,flow,,and,set,ne,=,ni,and,ue,=,ui,at,the,new,Runge-Kutta,stage.,Solve,the,electron,parallel,momentum,equation,(32),for,the,parallel,electric,field,E∥.,Repeat.,•,•,•,•,7.,Numerical,results,We,first,provide,numerical,results,testing,the,code,implementation,and,then,provide,preliminary,results,for,a,more,general,case.,7,NUMERICAL,RESULTS,7.1.,Boltzmann,electron,test,9,Figure,1.,Comparison,of,simulation,data,for,a,pair,of,simulations,,one,of,which,has,a,hard-wired,Boltzmann,response,for,the,electrons,(“Boltzmann”),and,the,other,(“evolved”),solves,the,electron,fluid,equations,outlined,in,this,report.,Clockwise,from,top,left,to,bottom,left,is,the,electron,density,,electron,parallel,flow,,parallel,electric,field,and,electron,temperature.,For,the,Braginskii,fluid,closure,we,are,employing,,whenever,∂,˜Te/∂,˜z,=,0,=,˜Ren,,the,electrostatic,potential,that,satisfies,the,electron,parallel,momentum,equation,(32),is,˜ϕ,=,˜Te,ln,˜ne;,i.e.,,there,is,a,Boltzmann,electron,density,response.,This,is,because,the,parallel,friction,˜F∥,vanishes,(recall,that,˜ue,=,˜ui,everywhere,due,to,the,zero,parallel,current,boundary,condition).,A,homogeneous,electron,temperature,can,be,assured,at,all,times,by,judicious,choice,of,necessary,Pe,and,a,homogeneous,initial,condition,for,˜Te.,The,˜pe),+,2,˜me˜νei,(˜pi,−,Using,this,source,,initialising,with,a,homogeneous,electron,temperature,and,neglecting,electron,charge,exchange,collisions,,we,obtain,the,results,given,in,Fig.,1.,Input,files,with,the,numerical,parameters,used,can,be,found,in,[6],and,[7].,The,excellent,agreement,with,a,simulation,run,with,a,hard-wired,Boltzmann,electron,response,gives,us,confidence,that,our,numerical,implementation,is,working,properly.,(35),˜nn,˜Rion˜ne,˜Eion,,2,3,Pe,(with,˜Ren,=,0),is,∂,˜ue,˜,˜p∥,e,Pe,=,∂z,−,2,3,0.60.811.21.41.61.822.22.4−0.4−0.200.20.4˜ne˜zevolvedBoltzmann−1.5−1−0.500.511.5−0.4−0.200.20.4˜ue˜zevolvedBoltzmann0.90.9511.051.1−0.4−0.200.20.4˜Te˜zevolvedBoltzmann−40−30−20−10010203040−0.4−0.200.20.4˜Ez˜zevolvedBoltzmann,8,DISCUSSION,10,7.2.,equilibrium,with,Braginskii,closure,Sample,results,from,a,simulation,with,large,electron-ion,collision,frequency,–,for,which,we,expect,Te,=,Ti,–,are,given,in,Fig.,2.,We,see,that,indeed,Te,=,Ti,to,a,good,approximation,across,most,of,the,z,domain.,The,results,actually,look,quite,similar,to,those,from,simulations,with,an,assumed,Boltzmann,electron,response.,This,is,not,entirely,surprising,,as,the,ion,temperature,profile,is,largely,flat,and,ui,=,ue,so,that,the,only,deviation,from,a,Boltzmann,response,present,in,the,electron,parallel,momentum,equation,is,the,electron-neutral,charge,exchange.,There,is,some,roughness,in,the,parallel,electric,field,profile,(see,the,bottom,right,plot,in,Fig.,2),that,could,use,further,exploration,,but,otherwise,the,profiles,are,fairly,smooth,and,the,simulation,well-behaved.,Inputs,for,this,simulation,can,be,found,at,[8].,Figure,2.,Steady-state,moments,of,the,ion,,neutral,and,electron,distribution,functions,for,a,simulation,with,all,collisional,terms,included,(and,notably,,˜νei,=,105),and,the,Braginskii,fluid,closure.,8.,Discussion,With,this,report,we,have,demonstrated,that,our,code,now,has,a,functional,,time-,for,electron,dynamics,that,can,be,used,to,calculate,the,dependent,fluid,model,00.511.522.5−0.6−0.4−0.200.20.40.6˜n˜zionneutral−2−1.5−1−0.500.511.52−0.6−0.4−0.200.20.40.6˜u˜zionneutral00.511.522.53−0.6−0.4−0.200.20.40.6˜T˜zionneutralelectron−40−2002040−0.6−0.4−0.200.20.40.6˜Ez˜z,APPENDIX,A,SUPPORTING,DOCUMENTATION,FOR,THE,SIMULATIONS,11,electrostatic,potential.,Our,immediate,aim,going,forward,is,to,improve,the,closure,for,this,fluid,model;,in,particular,,we,hope,to,use,the,moment-kinetic,approach,proposed,in,[2],in,place,of,the,Braginskii,closure,employed,here.,This,will,be,significant,in,that,it,will,introduce,the,need,to,solve,for,both,the,electron,particle,distribution,function,and,the,electrostatic,potential,itself,(rather,than,the,parallel,electric,field,that,we,solved,for,in,this,report),,a,non-trivial,complication,both,conceptually,and,numerically.,Appendix,A.,Supporting,documentation,for,the,simulations,The,simulations,used,to,create,the,data,presented,in,this,report,were,generated,by,the,branch,https://github.com/mabarnes/moment_kinetics/tree/electrons,,with,the,latest,commit,at,the,time,of,writing,being,9b68be0.,In,this,appendix,we,give,URL,links,to,the,input,files,used,to,generate,the,simulation,data.,To,run,a,simulation,use,the,following,command:,$,julia,-O3,--project,run_moment_kinetics.jl,input.toml,with,input.toml,replaced,by,the,appropriate,input,file,name.,The,input,files,for,the,Boltzmann,response,test,can,be,found,at,[7],(for,the,run,with,the,Braginskii,closure,and,heat,source,needed,to,force,a,Boltzmann,solution,to,the,electron,fluid,equations),and,[6],(for,the,run,with,a,built-in,Boltzmann,electron,response).,For,the,simulation,with,Braginskii,closure,and,large,νei,(corresponding,to,Fig.,2),,the,input,file,can,be,found,at,[8].,APPENDIX,A,SUPPORTING,DOCUMENTATION,FOR,THE,SIMULATIONS,12,[1],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,2d,drift,kinetic,model,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,7:2047357–TN–07–02,M1.4,,2021.,[2],F.,I.,Parra,,M.,Barnes,,and,M.,R.,Hardman.,1d,drift,kinetic,models,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,5:2047357–TN–05–01,M1.3,,2021.,[3],S.,I.,Braginskii.,Transport,phenomena,in,a,completely,ionized,two-temperature,plasma.,Sov.,Phys.,JETP,,6:358,,1958.,[4],M.,Knudsen.,Das,cosinusgesetz,in,der,kinetischen,gastheorie.,Annal.,Phys.,,353:1113,,1916.,[5],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,drift,kinetic,models,for,parallel,dynamics,in,the,plasma,edge.,Excalibur/Neptune,Report,,14:2047357–TN–14,D2.2,,2022.,[6],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,boltzmann.toml.,[7],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,braginskii_boltzmann_test.toml.,[8],https://github.com/mabarnes/moment_kinetics/blob/electrons/runs/wall%2Bsheath-bc_,braginskii_colls.toml." name="keywords" />

    <title>TN-05_NumericalImplementationFluidModelElectronsDriftKineticCode &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tn-05-numericalimplementationfluidmodelelectronsdriftkineticcode">
<h1>TN-05_NumericalImplementationFluidModelElectronsDriftKineticCode<a class="headerlink" href="#tn-05-numericalimplementationfluidmodelelectronsdriftkineticcode" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/TN-05_NumericalImplementationFluidModelElectronsDriftKineticCode.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TN-05_NumericalImplementationFluidModelElectronsDriftKineticCode.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>