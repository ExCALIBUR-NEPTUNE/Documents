
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="High-order,methods,and,their,implementation,in,Nektar++,David,Moxey,,Department,of,Engineering,,King's,College,London,Chris,Cantwell,,Department,of,Aeronautics,,Imperial,College,London,UKAEA,Nektar++,Training,Workshop,,1st,August,2022,Outline,&amp;,agenda,â€¢,This,morning,(10am-12pm):,this,talk,-,Overview,of,high-order,finite,element,methods.,-,Outline,of,their,high-level,implementation,within,Nektar++.,â€¢,Meant,to,be,a,dynamic,presentation;,please,interrupt,if,you,have,questions!,â€¢,This,afternoon:,-,1:30pm,-,3:30pm:,NEPTUNE-specific,talks,(particles,,review,and,overview,of,our,proxyapps,to,date),-,3:30pm,-,4:00pm:,more,hands-on,demo,from,Bin,Liu,&amp;,Mashy,Green:,need,to,install,docker,if,you,don't,have,it,â€¢,Dinner,this,evening?,Let,Wayne/us,know,by,lunchtime,today...,High-order,methods,How,do,we,model,a,physical,system?,form,underlying,equations,discretise,a,typically,complex,domain,solve,resulting,system,advection,velocity,v,âˆ‚u,âˆ‚t,+,v,â‹…,âˆ‡u,=,0,elements,on,which,the,equations,can,be,solved,Ax,=,b,(+,timestepping),What,is,a,spectral/hp,element?,Consider,an,approximation,to,a,.Ï•n,functions,in,terms,of,modes,uÎ´(x),=,N,âˆ‘,n=1,Ì‚unÏ•n(x),finite,element,method,uÎ´,={,h,spatial,ï¬‚exibility,(h),+,accuracy,(p),spectral/hp,element,spectral,method,uÎ´,={,p,Traditional,finite,elements,â€¢,In,traditional,linear,FEM,,the,modes,that,represent,functions,are,given,by,â€˜hatâ€™,functions.,â€¢,Linear,interpolation,then,occurs,between,the,vertices,of,each,element.,â€¢,However,to,avoid,need,for,modes,in,every,element,,we,can,define,them,instead,inside,of,a,standard,element.,â€¢,Each,element's,modes,are,given,by,mapping,Ï‡,into,world-space,element.,â€¢,For,a,high-order,element,,we,increase,the,order,of,the,polynomial,space,that's,being,used.,u2,u2,O,O,u1,u1,O,O,u0,u0,O,O,u3,u3,O,O,Ë†3.x/,Ë†3.x/,Ë†2.x/,Ë†2.x/,Ë†1.x/,Ë†1.x/,Ë†0.x/,Ë†0.x/,x0,x0,1,1,x1,x1,2,2,x2,x2,3,3,x3,x3,1,1,2,2,ue,ue,1,1,O,O,ue,ue,0,0,O,O,1,1,,,st,st,1,1,3,3,0.x/,0.x/,1.x/,1.x/,Figure,2.1:,Global,and,local,expansion,bases,Ë†k,and,k,for,a,three-element,ï¬nite,element,Figure,2.1:,Global,and,local,expansion,bases,Ë†k,and,k,for,a,three-element,ï¬nite,element,expansion.,e,is,the,linear,projection,mapping,the,standard,element,st,to,e.,expansion.,e,is,the,linear,projection,mapping,the,standard,element,st,to,e.,to,somehow,relate,the,local,coefï¬cients,to,somehow,relate,the,local,coefï¬cients,p,to,the,global,coefï¬cients,p,to,the,global,coefï¬cients,uk.,Typically,there,will,uk.,Typically,there,will,O,O,be,more,local,coefï¬cients,than,global,,and,hence,we,need,additional,restrictions,in,order,to,be,more,local,coefï¬cients,than,global,,and,hence,we,need,additional,restrictions,in,order,to,ue,ue,O,O,make,the,problem,uniquely,solvable.,make,the,problem,uniquely,solvable.,Before,considering,this,problem,however,,note,that,it,is,unnecessary,to,deï¬ne,a,set,of,Before,considering,this,problem,however,,note,that,it,is,unnecessary,to,deï¬ne,a,set,of,elemental,basis,functions,e,elemental,basis,functions,e,p,on,each,element.,Whilst,technically,possible,,it,introduces,p,on,each,element.,Whilst,technically,possible,,it,introduces,a,number,of,additional,computational,overheads,into,the,formulation.,Instead,,we,exploit,a,number,of,additional,computational,overheads,into,the,formulation.,Instead,,we,exploit,the,simple,elemental,geometry,to,deï¬ne,a,single,set,of,local,modes,p,the,simple,elemental,geometry,to,deï¬ne,a,single,set,of,local,modes,p,standard,element,st,D,Ï€,standard,element,st,D,Ï€,â‡ ,â‡ ,j,,j,,1,6,â‡ ,6,1,1,6,â‡ ,6,1,Âº,Âº,,,and,deï¬ne,a,bijective,mapping,e,,,and,deï¬ne,a,bijective,mapping,e,projecting,st,onto,e.,Local,elemental,modes,can,then,be,deï¬ned,by,the,composite,projecting,st,onto,e.,Local,elemental,modes,can,then,be,deï¬ned,by,the,composite,st,!,st,!,W,W,R,on,the,R,on,the,st,!,st,!,W,W,e,e,1.,In,the,rest,of,this,chapter,,â‡ ,denotes,a,location,inside,the,standard,1.,In,the,rest,of,this,chapter,,â‡ ,denotes,a,location,inside,the,standard,function,e,function,e,p,D,p,D,p,p,Å’eÃ§,Å’eÃ§,Ä±,Ä±,element.,element.,As,a,demonstration,of,this,local-to-global,mapping,,let,us,consider,a,ï¬nite,element,problem,As,a,demonstration,of,this,local-to-global,mapping,,let,us,consider,a,ï¬nite,element,problem,22,22,Spectral/hp,element,methods,Boundary-interior,decomposition,Assembly,matrix,A,(â‡ ),u,1,1(x)Î¦,u,0,0(x)Î¦,1,X,1,u,1,1Ï†,(Î¾),global,bases,u,3,3(x)Î¦,u,2,2(x)Î¦,3,X,2,X,2,u,1,1Ï†,(Î¾),â„¦,0x,â„¦,1,1x,â„¦,2,2x,â„¦,3,3x,1,u,0,2,u,0,3,u,0,âŒ¦,âŒ¦e,Anatomy,of,a,spectral/hp,element,0Ï†,(Î¾),0Ï†,(Î¾),0Ï†,(Î¾),âˆ’1,âˆ’1,âˆ’1,1,1,local,bases,1Ï†,(Î¾),3,u,1,1,âŒ¦st,P,u,=,i,Ë†u,i=0,X,1,1,Z,,Q,1,,i=0,X,u(â‡ )dâ‡ ,=,wiu(â‡ i),standard,linear,element,3,degrees,of,freedom,one,per,vertex,(or,cell),Primarily,tensor-product,bases,hierarchical,basis,P,=,5,element,21,degrees,of,freedom,vertex,,edge,and,interior,â€˜modesâ€™,1Ï†,(Î¾),3,u,1,1,Spectral/hp,element,methods,Spectral/hp,element,methods,Boundary-interior,decomposition,global,bases,u,3,3(x)Î¦,u,2,2(x)Î¦,6,6,D.,MOXEY,,R.,AMICI,AND,R.,M.,KIRBY,D.,MOXEY,,R.,AMICI,AND,R.,M.,KIRBY,u,1,âŒ¦,Assembly,matrix,1(x)Î¦,u,0,0(x)Î¦,âŒ¦e,A,(â‡ ),â„¦,0x,â„¦,1,x,=,Ï‡e(Î¾),X,1x,1,â„¦,2,1,u,1,1Ï†,(Î¾),2x,â„¦,3,3x,3,X,2,X,2,u,1,1Ï†,(Î¾),1,u,0,2,u,0,3,u,0,[,,collapsed,element,,2,[,âŒ˜,=,(âŒ˜1,,âŒ˜2),1,,1]2,âŒ˜,=,(âŒ˜1,,âŒ˜2),2,collapsed,collapsed,element,coordinates,(Î·1,,Î·2),âˆˆ,[âˆ’1,1]2,0Ï†,(Î¾),1,2,âŒ¦e,âŒ¦tri,1,,1]2,x,=,(x1,,x2),âŒ¦tri,â‡ ,=,(â‡ 1,,â‡ 2),â‡ ,=,(â‡ 1,,â‡ 2),âˆ’1,st,st,2,reference,curvilinear,element,standard,element,standard,element,element,(Î¾1,,Î¾2),âˆˆ,Î©st,Fig.,1.,Illustration,of,the,three,coordinate,systems,used,in,the,representation,of,a,high-order,triangle.,A,representative,equally-spaced,distribution,of,points,is,used,to,highlight,the,distribution,of,quadrature,points,in,the,resulting,high-order,element.,Fig.,1.,Illustration,of,the,three,coordinate,systems,used,in,the,representation,of,a,high-order,triangle.,A,representative,equally-spaced,distribution,of,points,is,used,to,highlight,the,distribution,of,quadrature,points,in,the,resulting,high-order,element.,âŒ¦st,0Ï†,(Î¾),âˆ’1,âŒ¦e,x,=,(x1,,x2),2,curvilinear,element,local,bases,2,âˆ’1,1,0Ï†,(Î¾),224,225,P,u,=,i,Ë†u,226,i=0,X,227,228,u(â‡ )dâ‡ ,=,229,1,1,Z,,226,224,225,u(â‡ 1,,â‡ 2),=,ment,a,basis,for,a,quadrilateral,can,be,formed,as,pq(â‡ 1,,â‡ 2),=,p(â‡ 1)q(â‡ 2).,Evaluation,of,an,expansion,at,a,given,point,can,then,be,represented,as,ment,a,basis,for,a,quadrilateral,can,be,formed,as,pq(â‡ 1,,â‡ 2),=,p(â‡ 1)q(â‡ 2).,(C0),tensor,Evaluation,of,an,expansion,at,a,given,point,can,then,be,represented,as,product,basis,p(Î·1),Ï•b,Ï•a,pq(Î·2),where,the,brackets,denote,the,use,of,a,temporary,storage.,At,a,given,di-,mension,d,,and,considering,a,tensor,product,of,quadrature,or,solution,points,wiu(â‡ i),that,require,evaluation,,this,technique,thereby,substantially,reduces,operator,(P,2(d,1)).,(P,2d),to,evaluations,from,where,the,brackets,denote,the,use,of,a,temporary,storage.,At,a,given,di-,mension,d,,and,considering,a,tensor,product,of,quadrature,or,solution,points,that,require,evaluation,,this,technique,thereby,substantially,reduces,operator,Primarily,tensor-product,bases,(P,2d),to,1)).,(P,2(d,evaluations,from,P,Ë†upqp(â‡ 1)q(â‡ 2),=,&quot;,p=0,X,P,Ë†upqp(â‡ 1)q(â‡ 2),=,q=0,X,P,P,u(â‡ 1,,â‡ 2),=,p=0,q=0,X,X,P,Ë†upqq(â‡ 2),p(â‡ 1),&quot;,Ë†upqq(â‡ 2),1,227,228,229,,,#,q=0,X,p(â‡ 1),q=0,p=0,X,X,,,#,p=0,X,,P,P,P,Q,i=0,X,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,230,O,O,O,,O,,The,relative,performance,of,these,approaches,,speciï¬cally,on,modern,hardware,,The,relative,performance,of,these,approaches,,speciï¬cally,on,modern,hardware,,231,has,been,considered,previously,in,separate,work,(e.g.,[21]),,but,only,for,elements,that,has,been,considered,previously,in,separate,work,(e.g.,[21]),,but,only,for,elements,that,232,naturally,lend,themselves,to,a,tensor-product,basis:,namely,quadrilaterals,and,hexa-,naturally,lend,themselves,to,a,tensor-product,basis:,namely,quadrilaterals,and,hexa-,233,hedra.,In,this,paper,,however,,we,consider,how,eâ†µectively,this,matrix-free,evaluation,hedra.,In,this,paper,,however,,we,consider,how,eâ†µectively,this,matrix-free,evaluation,234,can,be,applied,in,the,context,of,unstructured,elements,to,yield,ecient,solvers,for,can,be,applied,in,the,context,of,unstructured,elements,to,yield,ecient,solvers,for,235,very,complex,geometries.,To,do,this,requires,the,selection,of,a,basis,permitting,tensor,very,complex,geometries.,To,do,this,requires,the,selection,of,a,basis,permitting,tensor,236,product,decomposition,,which,we,discuss,in,the,following,section.,product,decomposition,,which,we,discuss,in,the,following,section.,237,2.2.,Choice,of,polynomial,basis.,The,selection,of,the,polynomial,basis,on,2.2.,Choice,of,polynomial,basis.,The,selection,of,the,polynomial,basis,on,238,each,element,is,a,key,consideration,of,this,paper.,Much,of,the,prior,work,considered,each,element,is,a,key,consideration,of,this,paper.,Much,of,the,prior,work,considered,239,in,Section,1,exploits,the,use,of,a,tensor,product,of,one-dimensional,nodal,Lagrange,in,Section,1,exploits,the,use,of,a,tensor,product,of,one-dimensional,nodal,Lagrange,240,basis,functions,,where,on,the,standard,segment,[,basis,functions,,where,on,the,standard,segment,[,1,,1],,these,are,deï¬ned,as,1,,1],,these,are,deï¬ned,as,241,242,`p(â‡ ),=,,â‡ ,`p(â‡ ),=,,Ë†â‡ p,,Ë†â‡ q,Ë†â‡ q,P,q,Y0,ï£¿,=p,ï£¿,q,P,q,Y0,ï£¿,=p,ï£¿,q,,Ë†â‡ q,Ë†â‡ q,â‡ ,,Ë†â‡ p,,where,Ë†â‡ q,2,243,[,where,Ë†â‡ q,2,,,1,,1],denote,a,set,of,P,+,1,data,points,frequently,chosen,to,align,or,1,,1],denote,a,set,of,P,+,1,data,points,frequently,chosen,to,align,or,[,collocate,with,an,underlying,quadrature,(e.g.,Gauss,or,Gauss-Lobatto,points).,Al-,collocate,with,an,underlying,quadrature,(e.g.,Gauss,or,Gauss-Lobatto,points).,Al-,244,though,this,approach,can,readily,be,extended,to,higher,dimensional,tensor-product,though,this,approach,can,readily,be,extended,to,higher,dimensional,tensor-product,245,elements,,a,formulation,of,these,basis,functions,inside,hybrid,or,simplicial,elements,elements,,a,formulation,of,these,basis,functions,inside,hybrid,or,simplicial,elements,246,such,as,triangles,and,tetrahedra,leads,to,a,set,of,basis,functions,that,lack,the,tensor,such,as,triangles,and,tetrahedra,leads,to,a,set,of,basis,functions,that,lack,the,tensor,247,product,structure,required,to,enable,the,use,of,sum,factorisation.,More,details,on,product,structure,required,to,enable,the,use,of,sum,factorisation.,More,details,on,248,this,approach,can,be,found,in,e.g.,[16].,this,approach,can,be,found,in,e.g.,[16].,249,To,arrive,at,a,tensor,product,formulation,,we,follow,standard,practice,[18],and,To,arrive,at,a,tensor,product,formulation,,we,follow,standard,practice,[18],and,250,employ,the,use,of,a,square-to-triangle,Duâ†µy,transformation,[10],to,deï¬ne,two,inde-,employ,the,use,of,a,square-to-triangle,Duâ†µy,transformation,[10],to,deï¬ne,two,inde-,251,pendent,coordinate,directions,over,which,to,perform,the,decomposition,(or,otherwise,pendent,coordinate,directions,over,which,to,perform,the,decomposition,(or,otherwise,252,This,manuscript,is,for,review,purposes,only.,This,manuscript,is,for,review,purposes,only.,6,6,Why,use,a,high-order,method?,âœ“,error,decays,exponentially,(smooth,solutions);,âœ“,favorable,diffusion,&amp;,dispersion,characteristics;,âœ“,model,complex,domains,âœ“,computational,advantage:,reduced,memory,bandwidth,,better,use,of,hardware.,h-refinement,(algebraic),100,4,10,uÄ±,k,u,E,k,,8,10,12,10,p-refinement,(exponential),16,10,100,101,102,Ndof,Next,generation,modelling,Reynolds,Averaged,Navier-Stokes,Detached,Eddy,Simulation,under-resolved,Direct,Numerical,Simulation,Elemental,road,race,car,5th,order,Re,=,1m,Design,2:,+33%,Downforce,Moxey,,Turner,,Jassim,,Taylor,,Peiro,&amp;,Sherwin,Design,3:,+270%,Downforce,Continuous,formulations,The,lingo,of,high-order,elements,â€¢,Different,high-order,variants,depending,on,which,polynomial,basis,you're,using,,and,how,you,bolt,the,elements,together.,-,spectral,element:,typically,uses,Lagrange,interpolants,â„“p(x),-,hp-FEM:,automatic,hp,adaptivity,,typically,with,quad/hex,meshes,and,hanging,node,constraints;,seems,to,be,used,more,in,structural,mechanics,applications.,-,discontinuous,Galerkin,(DG):,Galerkin,approach,where,continuity,between,elements,is,removed;,recovers,finite,volume,methods,at,P,=,0,.,-,ï¬‚ux,reconstruction:,similar,to,DG,,but,uses,correction,functions,to,enforce,continuity,of,fluxes,between,elements.,-,...and,many,more!,Classical,C0,finite,elements,âˆ‡2u(x),âˆ’,Î»u(x),=,âˆ’,f(x),Boundary,conditions,u,x,gD,x,Dirichlet,,âˆ‚Î©D,(cid:11),(cid:31),(cid:11),(cid:10),x,(cid:10),(cid:11),Neumann,,âˆ‚Î©N,gN,(cid:31),(cid:10),u,n,(cid:2491),(cid:2491),boundary,domain,Î©,âˆ‚Î©,=,âˆ‚Î©D,âˆª,âˆ‚Î©N,Classical,finite,elements,C0,u,u,(cid:94),v,v,Î©e,(cid:94),Î©e,(cid:94),(cid:94),2u,dx,(cid:1895),(cid:31),(cid:93),(cid:1896),(cid:31),(cid:93),v,Î©,(cid:741),(cid:3275),u,n,v,(cid:2491),(cid:2491),u,ds,Î©,(cid:3275),(cid:730),Î©N,(cid:3275),(cid:2491),u,v,Î»u,dx,uD,(cid:31),(cid:13),fv,dx,N,(cid:731),(cid:1891),N,Î©e,Î©e,(cid:10),u,Î©D,(cid:11)(cid:14),u,(cid:94)(cid:2491),Î©D,(cid:31),gD,0,(cid:95),Choose,test,and,trial,spaces,(C0),(cid:731),(cid:1891),(cid:10),Î»u,dx,(cid:11)(cid:14),(cid:94)(cid:2491),Î©,(cid:31),(cid:741),(cid:3275),(cid:95),(cid:31),fv,dx,Multiply,by,test,function,and,integrate,u,v,dx,(cid:730),Apply,the,divergence,theorem,Lift,Dirichlet,solution,Î©,(cid:741),(cid:3275),(cid:730),uH,Î©,(cid:3275),(cid:10)(cid:730),(cid:730),(cid:13),(cid:11),Î©,(cid:31),(cid:3275),Î©N,(cid:13),(cid:3275),(cid:2491),vgNds,Arrive,at,the,weak,form,Into,matrix,form,â€¢,In,this,form,we,can,substitute,expansions,from,the,test,and,trial,spaces,to,arrive,at,a,matrix,problem.,uÎ´(x),=,N,âˆ‘,n=1,Ì‚unÏ•n(x),substitute,(L,+,Î»M),Ì‚u,=,Ì‚f,Mij,=,âˆ«,Ï•i(x)Ï•j(x),dx,Lij,=,âˆ‡Ï•i(x),âˆ‡Ï•j(x),dx,âˆ«,Ì‚fi,=,âˆ«,f(x),âˆ‡Ï•i(x),dx,mass,matrix,Laplacian,matrix,forcing,inner,product,â€¢,To,compute,these,matrices,we,split,them,up,element,by,element,,and,then,assemble,across,elements,using,a,sparse,assembly,operator,ð’œ,.,â€¢,Also,require,sensible,choice,of,quadrature.,Solving,the,weak,form,Solving,the,resulting,matrices,can,be,done,in,a,number,of,ways,,depending,on,the,size,of,the,mesh.,Smaller,problems,â€¢,Use,a,direct,approach,â€¢,Form,large,SPD,matrix,â€¢,Solve,using,e.g.,LAPACK,(Cholesky,factorisation),â€¢,Typically,done,in,serial,Larger,problems,â€¢,Use,an,iterative,approach,â€¢,No,global,matrix,formed:,only,local,matrices,â€¢,Symmetric,problems,solved,using,e.g.,PCG,â€¢,Done,in,parallel,comms.,(cid:1883),(cid:13),Some,numerical,considerations,Direct,approach,â€¢,Bandwidth,of,the,system,-,use,a,reordering,,e.g.,reverse,Cuthill-,McKee,â€¢,Whether,the,problem,is,too,big,to,fit,in,memory/be,solved,in,a,reasonable,time,Iterative,approach,Evaluation,costs,â€¢,Generally,slower,than,using,a,direct,â€¢,In,iterative,solvers,,most,solver,â€¢,Performance,heavily,governed,by,cost,comes,from,evaluation,of,finite,element,operator.,iteration,count,â€¢,In,general,,local,matrix,is,â€¢,Needs,effective,preconditioning,,rank,O(P2d),particularly,if,Î»,=,0,â€¢,Nearly,all,3D,problems,are,too,â€¢,Effective,communication,between,large,to,solve,this,way,elements,needed,in,parallel,static,condensation,â€¢,Two,strategies,to,reduce,this:,static,condensation,and,matrix-free,evaluation.,H,â†’,Hbb,Hib,Hbi,Hii],[,Rank,of,Hbb,=,ð’ª(P2(dâˆ’1)),Discontinuous,formulations,Hyperbolic,equations,â€¢,Consider,the,hyperbolic,conservation,law,âˆ‚u,âˆ‚t,+,âˆ‡,â‹…,F(u),=,0,F(u),=,[F1(u),,F2(u)],in,2D,â€¢,This,encapsulates,a,wide,range,of,equations:,e.g.,compressible,Euler,or,Navier-Stokes,equations.,â€¢,Can,apply,methods,to,this,,but,perhaps,not,the,most,natural,method,and,some,concerns,around,e.g.,local,conservation,properties,between,elements.,C0,â€¢,Discontinuous,Galerkin,methods,very,popular,in,this,setting:,have,several,advantages,including,favourable,stability,properties.,Discontinuous,Galerkin,method,Consider,Galerkin,approach,on,a,single,element,,but,remove,the,continuity,of,functions,between,elements.,This,leads,to,the,formulation,v,âˆ‚u,âˆ‚t,âˆ«Î©e,dx,+,âˆ«Î©e,vâˆ‡,â‹…,F(u),dx,=,0,integration,by,parts,v,âˆ‚u,âˆ‚t,âˆ«Î©e,dx,âˆ’,âˆ«Î©e,âˆ‡vâˆ‡,â‹…,F(u),dx,+,âˆ®âˆ‚Î©e,v,â‹…,Ì‚F(u+,,uâˆ’,,n)ds,=,0,this,numerical,flux,appears,because,u,is,discontinuous,across,element,boundaries,Discontinuous,Galerkin,method,â€¢,The,discretisation,gives,the,semi-discrete,ODE,system,on,each,element:,De,dBe,WeFd,u,be,D,ue,Me,d,dt,(cid:887),(cid:11),(cid:31),1(cid:10),(cid:3278)d,(cid:31),inner,product,w.r.t.,derivative,of,basis,(cid:10),(cid:11),(cid:741),boundary,flux,contributions,â€¢,Note,that,elements,aren't,decoupled:,boundary,flux,couples,them,together.,â€¢,Can,now,apply,time-stepping,schemes:,e.g.,forward,Euler,,Runge-Kutta,,Adams-Bashforth,,...,(cid:200),Discontinuous,Galerkin,method,â€¢,Need,some,consistent,definition,of,which,element,is,'forward',and,'backward',â€¢,Can,then,employ,the,usual,machinery,from,finite,volume,methods:,â€£,e.g.,for,simple,transport,problems,we,can,upwind,based,on,forward,and,backward,spaces,â€£,More,complex,Riemann,solvers,for,nonlinear,problems,such,as,compressible,N-S,equations,â€¢,Other,stabilisation,techniques,such,as,slope,limiters,also,apply,in,this,setting.,F(u+,,uâˆ’,,n),=,u-,u+,n,Î©f,Î©e,trace,or,skeleton,space,advection,velocity,v,uâˆ’,,u+,,{,v,â‹…,n,â‰¥,0,,v,â‹…,n,&lt;,0,Elliptic,operators,in,DG,â€¢,Elliptic,operators,require,careful,consideration,to,ensure,stability.,â€¢,For,example,in,the,Poisson,equation,âˆ’,âˆ‡2u,=,f,,,we,introduce,an,auxiliary,variable,q,=,âˆ‡u,,,so,that,we,instead,solve,the,system,âˆ’,âˆ‡,â‹…,q,=,f,{,q,=,âˆ‡u,â€¢,Applying,the,DG,formulation,to,the,above,equations,leads,to,a,weak,form,similar,to,that,shown,previously.,â€¢,A,careful,choice,of,fluxes,for,q,in,particular,(e.g.,local,discontinuous,Galerkin,,BR2),ensures,convergence,and,stability.,Hybridisable,discontinuous,Galerkin,(HDG),â€¢,An,alternative,is,to,consider,static,condensation,in,the,formulation,of,DG.,q,=,âˆ‡u,u,=,div(q),on,Î©,â€¢,This,leads,to,HDG,where,boundary,matrices,are,formed,for,the,trace,space.,â€¢,Partially,supported,in,Nektar++,but,only,for,Helmholtz,operator.,u,=,Î»,on,âˆ‚Î©,(static,condensation),local,boundary,system,AÎ»,Ai,interior,solve,u,project,Î»,onto,u,AÎ»,(cid:606),â‡ 3â‡ 1â‡ 2â‡ 3â‡ 1,Challenges,The,challenge,of,implementation,â€¢,High-order,methods,have,potential,to,bring,some,nice,numerical,and,computational,benefits,to,bear,on,complex,problems.,â€¢,Offer,high(er),fidelity,at,equivalent,or,lower,costs,,as,they,have,good,implementation,characteristics.,â€¢,However,,one,of,the,main,barriers,to,using,high-order,methods,is,that,they,are,difï¬cult,to,implement.,â€¢,There,are,a,number,of,other,issues,too,including,stabilisation,and,mesh,generation.,â€¢,We'll,touch,on,these,briefly,here.,High-order,mesh,generation,â€¢,Good,quality,meshes,are,essential,to,finite,element,and,finite,volume,simulations.,â€¢,You,can,have,a,very,fancy,solver,,but,if,you,canâ€™t,mesh,your,geometry,then,you,canâ€™t,run,your,simulation!,â€¢,At,high,orders,we,have,an,additional,headache,,as,we,must,curve,the,elements,to,fit,the,geometry.,â€¢,This,can,easily,cause,self,intersection,,particularly,when,dealing,with,high-aspect,ratio,elements,(e.g.,in,a,fluid,boundary,layer).,triangulation,surface,donâ€™t,lie,on,the,surface!,High-order,mesh,generation,Ï•,=,Ï•M,âˆ˜,Ï•âˆ’1,I,add,curvature,surface,surface,6,D.,MOXEY,,R.,AMICI,AND,R.,M.,KIRBY,Ï•M,Ï•I,variational,approach,M.,Turner,,J.,PeirÃ³,,D.,Moxey,,Curvilinear,mesh,generation,using,a,variational,framework,,Computer,Aided,Design,103,73-91,(2018),âŒ˜,=,(âŒ˜1,,âŒ˜2),1,,1]2,[,,2,collapsed,element,âŒ¦tri,â‡ ,=,(â‡ 1,,â‡ 2),st,standard,element,2,â„°(Ï•),=,min,W(,âˆ‡Ï•),dy,Ï•,âˆ«Î©I,min,Ï•,âŒ¦e,x,=,(x1,,x2),curvilinear,element,2,Fig.,1.,Illustration,of,the,three,coordinate,systems,used,in,the,representation,of,a,high-order,triangle.,A,representative,equally-spaced,distribution,of,points,is,used,to,highlight,the,distribution,of,quadrature,points,in,the,resulting,high-order,element.,ment,a,basis,for,a,quadrilateral,can,be,formed,as,pq(â‡ 1,,â‡ 2),=,p(â‡ 1)q(â‡ 2).,Evaluation,of,an,expansion,at,a,given,point,can,then,be,represented,as,u(â‡ 1,,â‡ 2),=,Ë†upqp(â‡ 1)q(â‡ 2),=,p(â‡ 1),Ë†upqq(â‡ 2),,,P,P,p=0,X,q=0,X,P,p=0,X,P,&quot;,q=0,X,#,where,the,brackets,denote,the,use,of,a,temporary,storage.,At,a,given,di-,mension,d,,and,considering,a,tensor,product,of,quadrature,or,solution,points,that,require,evaluation,,this,technique,thereby,substantially,reduces,operator,evaluations,from,(P,2d),to,(P,2(d,1)).,,O,O,The,relative,performance,of,these,approaches,,speciï¬cally,on,modern,hardware,,has,been,considered,previously,in,separate,work,(e.g.,[21]),,but,only,for,elements,that,naturally,lend,themselves,to,a,tensor-product,basis:,namely,quadrilaterals,and,hexa-,hedra.,In,this,paper,,however,,we,consider,how,eâ†µectively,this,matrix-free,evaluation,can,be,applied,in,the,context,of,unstructured,elements,to,yield,ecient,solvers,for,very,complex,geometries.,To,do,this,requires,the,selection,of,a,basis,permitting,tensor,product,decomposition,,which,we,discuss,in,the,following,section.,2.2.,Choice,of,polynomial,basis.,The,selection,of,the,polynomial,basis,on,each,element,is,a,key,consideration,of,this,paper.,Much,of,the,prior,work,considered,in,Section,1,exploits,the,use,of,a,tensor,product,of,one-dimensional,nodal,Lagrange,basis,functions,,where,on,the,standard,segment,[,1,,1],,these,are,deï¬ned,as,,Ë†â‡ q,Ë†â‡ q,â‡ ,,Ë†â‡ p,,`p(â‡ ),=,P,q,Y0,ï£¿,=p,ï£¿,q,where,Ë†â‡ q,2,[,,1,,1],denote,a,set,of,P,+,1,data,points,frequently,chosen,to,align,or,collocate,with,an,underlying,quadrature,(e.g.,Gauss,or,Gauss-Lobatto,points).,Al-,though,this,approach,can,readily,be,extended,to,higher,dimensional,tensor-product,elements,,a,formulation,of,these,basis,functions,inside,hybrid,or,simplicial,elements,such,as,triangles,and,tetrahedra,leads,to,a,set,of,basis,functions,that,lack,the,tensor,product,structure,required,to,enable,the,use,of,sum,factorisation.,More,details,on,this,approach,can,be,found,in,e.g.,[16].,To,arrive,at,a,tensor,product,formulation,,we,follow,standard,practice,[18],and,employ,the,use,of,a,square-to-triangle,Duâ†µy,transformation,[10],to,deï¬ne,two,inde-,pendent,coordinate,directions,over,which,to,perform,the,decomposition,(or,otherwise,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,This,manuscript,is,for,review,purposes,only.,6,Boundary,layer,meshing,Shape,function,is,a,mapping,from,reference,element,(parametric,coordinates),to,mesh,element,(physical,coordinates),Subdivide,the,reference,element,in,order,to,obtain,a,boundary,layer,mesh,An,isoparametric,approach,to,high-order,curvilinear,boundary-layer,meshing,D.,Moxey,,M.,Hazan,,S.,J.,Sherwin,,J.,PeirÃ³,,under,review,in,Comp.,Meth.,Appl.,Mech.,Eng.,Spacing,distribution,Stabilisation,â€¢,Significant,effort,into,stability,analysis,for,under-resolved,problems,,much,Figure,2,(left),shows,the,solution,with,no,SVV;,ï¬gure,2,(centre),shows,the,solution,with,SVV,(Pcut,=,7,,!SV,V,=,0.1);,and,ï¬gure,2,(right),shows,the,solution,with,SVV,(Pcut,=,3,,!SV,V,=,0.1).,based,around,spectral,vanishing,viscosity,(SVV):,(cid:69)(cid:74)(cid:78),(cid:86),(cid:85),(cid:2473),(cid:2473),(cid:1039),(cid:19)(cid:86),(cid:52)(cid:55)(cid:55),(cid:86),(cid:52)(cid:55)(cid:55),(cid:86),(cid:1031),(cid:31),(cid:723),(cid:13),(cid:10),(cid:11)(cid:14),(cid:10),(cid:11),(cid:31),(cid:50)(cid:69)(cid:74)(cid:78),(cid:3344),(cid:914),(cid:89)(cid:74),(cid:18),(cid:2473),(cid:2473),(cid:3260)(cid:74),(cid:31),(cid:86),(cid:89)(cid:74),(cid:2473),(cid:2473),(cid:3347),No,SVV,Pcut,=,7,,Fig.,2.,Standard,diï¬€usion,to,time,T,=,0.1,(left);,standard,diï¬€usion,with,SVV,Pcut,=,7,,!SV,V,=,0.1,(centre);,and,standard,diï¬€usion,with,SVV,Pcut,=,3,,!SV,V,=,0.1,(right),âœSV,V,=,0.1,From,this,example,we,see,that,the,SVV,dissipation,added,to,the,high,mode,numbers,with,R.,Kirby,,S.,Sherwin,,Comp.,Meth.,Appl.,Mech.,Eng.,,2006,respect,to,the,spectral,element,discretisation,does,indeed,yield,dissipation,at,the,global,high,wavenumber,scales,of,the,solution,(as,exhibited,in,Figure,2,(centre,and,right)).,Decreasing,Pcut,=,3,,âœSV,V,=,0.1,the,SVV,wavenumber,cutoï¬€,(Pcut),from,eight,to,four,produces,further,dissipation,of,the,high,wavenumber,features,within,the,solution.,3,Incorporation,of,SVV,into,the,Navier-Stokes,Equations,In,this,section,we,discuss,how,SVV,can,be,incorporated,into,a,velocity-correction,splitting,scheme,to,discretise,the,incompressible,Navier-Stokes,equations,[17].,The,incompressible,Navier-Stokes,equations,can,be,written,as:,+,N(u),=,p,+,Î½L(u),âˆ‚u,âˆ‚t,1,âˆ’,Ï,âˆ‡,Â·,âˆ‡,2u,âˆ‡,N(u),=,(u,)u,L(u),=,(20),(21),(22),The,temporal,discretisation,adopted,in,this,work,is,a,projection,scheme,,based,on,backwards,diï¬€erencing,in,time.,As,originally,described,[17],,this,was,characterised,as,an,operator-,splitting,scheme,,but,more,recently,[18],it,has,been,shown,that,the,method,is,one,of,a,class,of,velocity-correction,projection,schemes.,The,projection,scheme,requires,the,solution,of,a,pressure,Poisson,equation,to,(approximately),maintain,solenoidality,of,the,velocity.,Backwards,time,diï¬€erencing,is,used,to,approximate,a,12,Stabilisation,â€¢,Large,body,of,work,more,recently,on,emulating,the,stabilisation,properties,of,DG,for,classical,CG,elliptic,operators,via,eigenspectrum,analysis.,â€¢,Naturally,the,DG,method,acts,to,dampen,higher-order,oscillations,(and,is,one,of,the,reasons,that,it,is,so,popular,for,e.g.,LES).,â€¢,See,several,references,below!,â€¢,Mengaldo,G,,De,Grazia,D,,Moura,RC,,Sherwin,SJ,,2018,,Spatial,eigensolution,analysis,of,energy-stable,flux,reconstruction,schemes,and,influence,of,the,numerical,flux,on,accuracy,and,robustness,,Journal,of,Computational,Physics,,358,,1-20,â€¢,Mengaldo,G,,Moura,RC,,Giralda,B,,PeirÃ³,J,,Sherwin,SJ,2017,,Spatial,eigensolution,analysis,of,discontinuous,Galerkin,schemes,with,practical,insights,for,under-resolved,computations,and,implicit,LES,,Computers,and,Fluids,,0045-7930,â€¢,Moura,RC,,Sherwin,SJ,,Peiro,J,,2016,,Eigensolution,analysis,of,spectral/hp,continuous,Galerkin,approximations,to,advection-diffusion,problems:,Insights,into,spectral,vanishing,viscosity,,Journal,of,Computational,Physics,,307,,401-422,â€¢,Moura,RC,,Sherwin,SJ,,Peiro,J,,2015,,Linear,dispersion-diffusion,analysis,and,its,application,to,under-resolved,turbulence,simulations,using,discontinuous,Galerkin,spectral/hp,methods,,Journal,of,Computational,Physics,,298,,695-710,,Other,considerations:,aliasing,i,t,n,e,c,i,f,f,e,o,C,n,o,s,n,a,p,x,E,i,28,26,24,22,20,18,16,14,12,10,8,6,4,2,0,Example:,Galerkin,projection,of,u2,using:,â€¢,Q,=,17,â€“,exact,Quadrature,â€¢,Q,=,12,â€“,sufficient,for,integrating,20th,degree,polynomials,Reduced,quadrature,Exact,quadrature,0,2,4,6,Expandsion,Mode,8,10,Aliasing,Error,Example,from,Kirby,&amp;,Karniadakis,,J.,Comp.,Phys,(2003),!,20th,order,polynomial,-1,-0.5,0,12th,order,quadrature,0.5,1,Nektar++,spectral/hp,element,framework,High-fidelity,numerical,methods,Highly,parallel,,designed,for,unsteady,problems,Nektar++,spectral/hp,element,framework,â€¢,Nektar++,is,an,open,source,framework,for,high-order,methods.,â€¢,Although,fluids,is,a,key,application,area,,we,try,to,make,it,easier,to,use,these,methods,in,many,areas,,not,just,ï¬‚uids.,â€¢,C++,API,,with,ambitions,to,bridge,current,and,future,hardware,diversity,(e.g.,many-core,processors,,GPUs).,â€¢,Modern,development,practices,with,continuous,integration,,git,,etc.,35,Development,team,Mike,Kirby,Spencer,Sherwin,Chris,Cantwell,David,Moxey,â€¢,Project,coordinators:,Joaquim,PeirÃ³,,Gianmarco,Mengaldo,â€¢,Senior,developers:,Giacomo,Castiglioni,,Ankang,Gao,,Mohsen,Lahooti,,Zhenguo,Yan,Some,application,areas,struct,a,two-dimensional,mesh,of,3626,quadrilateral,elements,at,polynomial,order,P,=,6,,and,exploit,the,domain,symmetry,with,a,Fourier,pseudospectral,method,consisting,of,160,collo-,cation,points,in,the,spanwise,direction,to,perform,the,simula-,tion.,This,yields,a,resolution,of,20.9M,degrees,of,freedom,per,ï¬eld,variable,and,allows,us,to,obtain,excellent,agreement,with,the,benchmark,statistics.,4.3.,Flow,stability,(a),(b),www.nektar.info,(a),Figure,5:,Contours,of,the,magnitude,of,velocity,in,a,periodic,hill,simulation,at,Re,=,2800.,1,(a),for,ï¬‚ow,over,a,NACA0012,aerofoil,at,a,farï¬eld,Mach,number,=,0.8,and,a,1.5,angle,of,attack.,The,transonic,mach,Ma,number,of,this,ï¬‚ow,leads,to,the,development,of,a,strong,and,weak,shock,along,the,upper,and,lower,surfaces,of,the,wing,re-,spectively.,This,ï¬gure,shows,isocontours,of,the,mach,number,where,the,presence,of,the,shocks,are,clearly,identiï¬ed.,Finally,,In,Fig.,4(c),,we,visualise,the,temperature,ï¬eld,from,ï¬‚ow,pass-,ing,over,a,T106C,low-pressure,turbine,blade,at,Re,=,80,000,to,highlight,applications,to,high,Reynolds,number,ï¬‚ow,simula-,tions.,(b),4.2.,Transitional,turbulent,ï¬‚ow,dynamics,In,addition,to,direct,numerical,simulation,of,incompressible,Navier-Stokes,the,full,non-linear,the,IncNavierStokesSolver,supports,global,ï¬‚ow,stability,analysis,through,the,linearised,Navier-Stokes,equations,with,respect,to,a,steady,or,periodic,base,ï¬‚ow.,This,process,identiï¬es,whether,a,steady,ï¬‚ow,is,susceptible,to,a,fundamental,change,of,state,when,perturbed,by,an,inï¬nitesimal,disturbance.,The,linearisation,takes,the,form,equations,,&#64;u0,&#64;t,+,(u0,Â·,r,)U,+,(U,Â·,r,p0,+,âŒ«,2u0,r,)u0,=,r,u0,=,0,,r,Â·,where,U,is,the,base,ï¬‚ow,and,u0,is,now,the,inï¬nitesimal,pertur-,bation.,The,time-independent,base,ï¬‚ow,is,computed,through,evolving,Equs.,9,to,steady-state,with,appropriate,boundary,con-,ditions.,For,time-period,base,ï¬‚ows,,the,ï¬‚ow,is,sampled,at,reg-,ular,intervals,and,interpolated.,The,linear,evolution,of,a,perturbation,under,Equs.,10,can,be,expressed,as,(c),Transient,problems,in,which,turbulence,dominates,the,ï¬‚ow,domain,,or,in,which,the,transition,to,turbulence,dominates,the,simulation,,remain,some,of,the,most,challenging,problems,to,resolve,in,computational,ï¬‚uid,simulations.,Here,,accurate,nu-,merical,schemes,and,high,resolution,of,the,domain,is,critical.,Moreover,,any,choice,of,scheme,must,be,ecient,in,order,to,ob-,Figure,8:,Illustrative,simulation,of,a,depolarising,electrochemical,wavefront,(b),tain,results,in,computationally,feasible,time-scales.,Tradition-,on,a,two-dimensional,manifold,representation,of,a,human,left,atrium.,Blue,areas,denote,regions,of,unexcited,(polarised),tisue,,while,green,denotes,areas,ally,,highly,resolved,turbulence,simulations,,such,as,the,Taylor-,of,excited,(depolarised),cells.,The,red,areas,highlight,the,wavefront.,Green,vortex,problem,,lie,ï¬rmly,in,the,class,of,spectral,meth-,ods.,However,,spectral,methods,typically,lead,to,strong,geom-,sulting,in,more,complex,activation,patterns.,The,geometry,is,etry,restrictions,which,limits,the,domain,of,interest,to,simple,derived,from,segmented,magnetic,resonance,imaging,(MRI),shapes,such,as,cuboids,or,cylinders.,data,,while,tissue,heterogeneity,is,prescribed,based,on,late,Whilst,spectral,element,methods,may,seem,the,ideal,choice,gadolinium-enhanced,MRI.,A,human,atrial,ionic,model,[33],is,used,as,the,reactive,term,in,the,model,and,represents,the,ex-,for,such,simulations,,particularly,when,the,domain,of,interest,changes,of,ions,between,the,interior,and,exterior,of,the,cell,,is,geometrically,complex,,they,can,be,more,computationally,along,with,other,cellular,biophysics.,expensive,in,comparison,to,spectral,methods.,However,,when,the,domain,of,interest,has,a,geometrically,homogeneous,com-,ponent,â€“,that,is,,the,domain,can,be,seen,to,be,the,tensor,prod-,1D,modelling,of,the,vasculature,(arterial,network),represents,an,insightful,and,ecient,tool,for,tackling,problems,encoun-,uct,of,a,two-dimensional,â€˜complexâ€™,part,and,a,one-dimensional,tered,in,arterial,biomechanics,as,well,as,other,engineering,prob-,segment,â€“,we,can,combine,both,the,spectral,element,and,tradi-,lems.,In,particular,,3D,modelling,of,the,vasculature,is,relatively,tional,spectral,methods,to,create,a,highly,ecient,and,spectrally,expensive.,1D,modelling,provides,an,alternative,in,which,the,accurate,technique,[4].,modelling,assumptions,provide,a,good,balance,between,physi-,We,consider,the,application,of,this,methodology,to,the,prob-,ological,accuracy,and,computational,eciency.,To,describe,the,Figure,7:,Solitary,wave,impinging,a,cylinder.,(a),t,=,4.5,s;,(b),t,=,5.5,s;,(c),ï¬‚ow,and,pressure,in,this,network,we,consider,the,conservation,lem,of,ï¬‚ow,over,a,periodic,hill,,depicted,in,Fig.,5,,where,the,t,=,8.5,s;,(d),t,=,12.5,s;,(c),4.6.,Biological,ï¬‚ow,(d),A,A,for,some,initial,state,u00,,and,we,seek,,for,some,arbitrary,time,T,,the,dominant,eigenvalues,and,eigenmodes,of,the,operator,Figure,8:,Illustrative,simulation,of,a,depolarising,electrochemical,wavefront,on,a,two-dimensional,manifold,representation,of,a,human,left,atrium.,Blue,areas,denote,regions,of,unexcited,(polarised),tisue,,while,green,denotes,areas,of,excited,(depolarised),cells.,The,red,areas,highlight,the,wavefront.,u0(t),=,(t)u00,(T,),,which,are,solutions,to,the,equation,A,A,(T,),Ëœu,j,=,,j,Ëœu,j.,sulting,in,more,complex,activation,patterns.,The,geometry,is,derived,from,segmented,magnetic,resonance,imaging,(MRI),data,,while,tissue,heterogeneity,is,prescribed,based,on,late,The,sign,of,the,leading,eigenvalues,,j,are,used,to,establish,the,gadolinium-enhanced,MRI.,A,human,atrial,ionic,model,[33],global,stability,of,the,ï¬‚ow.,An,iterative,Arnoldi,method,[26],is,used,as,the,reactive,term,in,the,model,and,represents,the,ex-,(T,).,Repeated,actions,is,applied,to,a,discretisation,M,of,changes,of,ions,between,the,interior,and,exterior,of,the,cell,,of,M,are,applied,to,the,initial,state,u0,using,the,same,time-,along,with,other,cellular,biophysics.,integration,code,as,for,the,non-linear,equations,[27].,The,re-,sulting,sequence,of,vectors,spans,a,Krylov,subspace,of,M,and,,through,a,partial,Hessenberg,reduction,,the,leading,eigenval-,ues,and,eigenvectors,can,be,eciently,determined.,The,same,approach,can,be,applied,to,the,adjoint,form,of,the,linearised,Navier-Stokes,evolution,operator,Aâ‡¤,to,examine,the,receptivity,of,the,ï¬‚ow,and,,in,combination,with,the,direct,mode,,identify,the,sensitivity,of,the,ï¬‚ow,to,base,ï¬‚ow,modiï¬cation,and,local,feedback.,The,direct,and,adjoint,methods,can,also,be,combined,1D,modelling,of,the,vasculature,(arterial,network),represents,an,insightful,and,ecient,tool,for,tackling,problems,encoun-,tered,in,arterial,biomechanics,as,well,as,other,engineering,prob-,lems.,In,particular,,3D,modelling,of,the,vasculature,is,relatively,expensive.,1D,modelling,provides,an,alternative,in,which,the,modelling,assumptions,provide,a,good,balance,between,physi-,ological,accuracy,and,computational,eciency.,To,describe,the,4.6.,Biological,ï¬‚ow,(c),surface,for,a,prescribed,body,force,,as,shown,in,Fig.,10(a).,The,resulting,proï¬le,is,imposed,on,the,three-dimensional,ï¬‚ow,problem,as,illustrated.,The,steady-state,velocity,ï¬eld,from,the,ï¬‚ow,simulation,at,Reynolds,number,Re,=,300,is,shown,in,Fig.,10(b).,A,single,boundary,layer,of,prismatic,elements,is,used,for,this,simulation,and,both,the,prismatic,and,tetrahedral,elements,use,a,polynomial,expansion,order,of,P,=,4.,This,is,sucient,to,capture,the,boundary,layer,at,the,walls.,(d),We,now,solve,the,advection-diâ†µusion,equation,,D,(,,r,r,Â·,c,+,cu),=,0,,to,model,transport,of,oxygen,along,the,arterial,wall.,Here,,c,is,the,concentration,and,u,is,the,steady-state,ï¬‚ow,solution,ob-,tained,previously.,D,=,1/Pe,is,the,diâ†µusivity,of,the,species,105,for,oxygen).,For,most,of,the,do-,considered,(Pe,=,7.5,Figure,7:,Solitary,wave,impinging,a,cylinder.,(a),t,=,4.5,s;,(b),t,=,5.5,s;,(c),main,,the,non-dimensional,concentration,remains,constant,at,t,=,8.5,s;,(d),t,=,12.5,s;,c,=,1.,However,,a,particularly,high,gradient,in,concentration,forms,at,the,wall.,It,is,this,gradient,which,is,of,particular,inter-,â‡¥,Figure,9:,Geometry,used,for,the,simulation.,Insets,show,how,ï¬‚ow,and,pressure,vary,with,time,and,diâ†µerent,locations,in,the,geometry.,Figure,4:,Examples,of,external,aerodynamics,problems,solved,using,the,CompressibleFlowSolver.,(a),Flow,over,a,cylinder,at,Re,=,3,,900.,(b),Euler,simulation,over,a,NACA0012,aerofoil,at,Ma,=,0.8.,(c),Temperature,of,ï¬‚ow,passing,over,a,T106C,low-pressure,turbine,blade,at,Re,=,80,,000.,1,substrate,modiï¬cation,to,restore,normal,rhythm,is,often,partic-,est,and,needs,to,be,captured,accurately.,The,existing,mesh,used,ularly,challenging,and,may,beneï¬t,from,insight,derived,from,where,U,=,[â‡¢,,â‡¢u,,â‡¢v,,â‡¢w,,E]&gt;,is,the,vector,of,conserved,vari-,for,the,ï¬‚ow,simulation,is,unable,to,resolve,the,gradients,close,computer,modelling.,ables,in,terms,of,density,â‡¢,,velocity,(u1,,u2,,u3),=,(u,,v,,w),,E,is,to,the,wall.,We,therefore,reï¬ne,the,boundary,layer,in,the,wall-,The,CardiacEPSolver,models,the,conduction,process,us-,the,speciï¬c,total,energy,,and,normal,direction,using,element,heights,following,a,geometric,ing,the,monodomain,equations,ï¬‚ow,is,periodic,in,both,streamwise,and,spanwise,directions.,of,mass,and,momentum,applied,to,an,impermeable,,deformable,This,case,is,a,well-established,benchmark,problem,in,the,DNS,Galerkin,and,ï¬‚ux,reconstruction,spatial,discretisations,,which,of,partial,diâ†µerential,equations,presented,in,non-conservative,tube,ï¬lled,with,an,incompressible,ï¬‚uid,,the,nonlinear,system,and,LES,communities,[25],,and,is,challenging,to,resolve,due,to,substrate,modiï¬cation,to,restore,normal,rhythm,is,often,partic-,have,various,numerical,equivalences,[22],but,may,possess,dif-,form,is,given,by,the,smooth,detachment,of,the,ï¬‚uid,from,the,surface,and,recir-,ularly,challenging,and,may,beneï¬t,from,insight,derived,from,ferent,performance,characteristics.,In,the,ï¬‚ux,reconstruction,&#64;U,&#64;U,(14),progression.,To,reduce,computational,cost,,we,also,exploit,the,culation,region.,Here,we,consider,a,Reynolds,number,of,2800,,formulation,,we,instead,use,the,equation,in,diâ†µerential,form,in,computer,modelling.,to,identify,convective,instabilities,over,diâ†µerent,time,horizons,âŒ§,in,a,ï¬‚ow,by,computing,the,leading,eigenmodes,of,(,ï¬‚ow,and,pressure,in,this,network,we,consider,the,conservation,)(âŒ§).,This,is,referred,to,as,transient,growth,analysis.,of,mass,and,momentum,applied,to,an,impermeable,,deformable,Aâ‡¤A,To,illustrate,the,linear,analysis,capabilities,of,Nektar++,,we,tube,ï¬lled,with,an,incompressible,ï¬‚uid,,the,nonlinear,system,use,the,example,of,two-dimensional,ï¬‚ow,past,a,circular,cylin-,of,partial,diâ†µerential,equations,presented,in,non-conservative,+,H,=,S,&#64;x,&#64;t,spectral/hp,discretisation,and,reduce,the,polynomial,order,of,u,,,=,normalised,by,the,bulk,velocity,at,the,hill,crest,and,the,height,combination,with,correction,functions,which,impose,continuity,The,CardiacEPSolver,models,the,conduction,process,us-,U,U,A,Cm,,0,der,at,Re,=,42,,just,below,the,critical,Reynolds,number,for,form,is,given,by,â‡¢u,p,+,â‡¢u2,&#64;u,&#64;t,â‡¢v,+,Iion,â‡¢uv,r,Â·,â‡¢w,r,â‡¢uw,â‡¢vw,F(U),=,2,the,prisms,in,the,directions,parallel,to,the,wall,,since,the,con-,!,of,the,hill,,with,an,appropriate,body,forcing,term,to,drive,the,ing,the,monodomain,equations,of,ï¬‚uxes,between,elements.,&#64;A,U,â‡¢,centration,shows,negligible,variation,in,these,directions.,Fur-,where,the,Iion,term,captures,the,complex,movement,of,ions,thermore,,the,domain-interior,tetrahedra,may,also,be,discarded,in,and,out,of,cells,and,is,itself,modelled,as,a,set,of,ordinary,diâ†µerential,equations.,Additionally,,,captures,the,potentially,and,a,dirichlet,c,=,1,condition,imposed,on,the,resulting,interior,u(E,+,p),u(E,+,p),v(E,+,p),heterogeneous,and,anisotropic,nature,of,the,tissue,which,af-,prism,boundary.,â‡¢w2,+,p,ï¬‚ow,over,the,periodic,hill,conï¬guration.,In,either,case,,information,is,transferred,between,elements,in,which,A,is,the,Area,(related,to,pressure),,x,is,the,axial,coor-,The,periodicity,of,this,problem,makes,it,an,ideal,candidate,dinate,along,the,vessel,,U(x,,t),the,axial,velocity,,P(x,,t),is,the,by,solving,a,one-dimensional,Riemann,problem,at,the,interface,for,the,hybrid,technique,described,above.,We,therefore,con-,between,two,elements.,For,the,non-viscous,terms,there,is,sup-,pressure,in,the,tube,,â‡¢,is,the,density,and,ï¬nally,f,the,frictional,port,for,a,wide,variety,of,Riemann,solvers,,including,an,exact,force,per,unit,length.,The,unknowns,in,equation,14,are,u,,A,and,+,Iion,Cm,r,Â·,&#64;u,&#64;t,u,,,r,=,,!,â‡£,âŒ˜,â‡¢v2,+,p,â‡¢vw,â‡¢uv,â‡¢uw,A,&quot;,#,â‡¢,&#64;p,&quot;,,,#,S,=,1,f,A,,s,#,&quot;,U,=,,,H,=,3,777777777777777775,666666666666666664,where,p,is,the,pressure.,To,close,the,system,we,need,to,specify,fects,the,speed,of,electrical,propagation.,While,full,3D,simula-,Fig.,10(c),shows,the,resulting,concentration,gradient,ï¬eld,on,an,equation,of,state,,in,this,case,the,ideal,gas,law,p,=,â‡¢RT,tions,of,myocardium,are,traditionally,performed,,the,left,atrium,the,surface,of,the,arterial,wall.,Regions,of,low,concentration,where,T,is,the,temperature,and,R,is,the,gas,constant.,For,the,is,suciently,thin,that,it,can,be,reasonably,represented,as,a,gradient,are,observed,upstream,of,the,branches,,while,high,con-,Euler,equations,,the,tensor,of,viscous,forces,Fv(U),=,0,,and,for,centration,gradients,are,observed,downstream.,Fig.10(d),shows,two-dimensional,manifold,embedded,in,three,dimensions,and,solved,at,signiï¬cantly,reduced,computational,cost,[32].,The,close-ups,of,the,branches,to,illustrate,this.,geometry,of,the,left,atrium,is,created,through,segmentation,of,Navier-Stokes,magnetic,resonance,images,of,the,heart.,0,0,0,Fv(U),=,2,An,example,of,a,left,atrium,simulation,is,illustrated,in,Fig-,5.,Discussion,&amp;,Future,Directions,ure,8.,Electrophysiological,characteristics,vary,spatially,,with,âŒ§xx,âŒ§yx,âŒ§zx,regions,of,scar,and,ï¬brosis,more,resistive,to,activation,,re-,The,Nektar++,framework,provides,a,feature-rich,platform,with,which,to,develop,numerical,methods,and,solvers,in,the,11,âŒ§xy,âŒ§xz,A,âŒ§yy,âŒ§yz,B,âŒ§zy,âŒ§zz,C,A,=,uâŒ§xx,+,vâŒ§xy,+,wâŒ§xz,+,k&#64;xT,,signed,in,such,a,way,that,the,libraries,reï¬‚ect,the,mathematical,abstractions,of,the,method,,to,simplify,uptake,for,new,users,,B,=,uâŒ§yx,+,vâŒ§yy,+,wâŒ§yz,+,k&#64;yT,,as,well,as,being,written,in,a,modular,way,to,improve,the,ro-,C,=,uâŒ§zx,+,vâŒ§zy,+,wâŒ§zz,+,k&#64;zT,bustness,of,the,code,,minimise,duplication,of,functionality,and,3,777777777777777775,666666666666666664,where,in,tensor,notation,the,stress,tensor,âŒ§xi,x,j,=,2Âµ(&#64;xiui,+,promote,sustainability.,1,&#64;xiu,j,,3,&#64;xk,uki,j),,Âµ,is,the,dynamic,viscosity,calculated,using,Sutherlandâ€™s,law,and,k,is,the,thermal,conductivity.,Development,9,solution,or,a,number,of,appproximate,solvers,such,as,HLLC,,where,the,Iion,term,captures,the,complex,movement,of,ions,p;,hence,we,must,provide,an,explicit,algebraic,relationship,to,close,this,system.,Typically,,closure,is,provided,by,an,algebraic,Roe,and,Lax-Friedrichs,solvers,[23].,For,the,viscous,terms,,we,in,and,out,of,cells,and,is,itself,modelled,as,a,set,of,ordinary,relationship,between,A,and,p.,For,a,thin,elastic,tube,this,is,given,by,utilise,a,local,discontinuous,Galerkin,method,(or,the,equivalent,diâ†µerential,equations.,Additionally,,,captures,the,potentially,ï¬‚ux,reconstruction,version).,Various,versions,of,the,discontin-,heterogeneous,and,anisotropic,nature,of,the,tissue,which,af-,uous,Galerkin,method,which,are,available,throughout,the,lit-,fects,the,speed,of,electrical,propagation.,While,full,3D,simula-,erature,,mostly,relating,to,the,choices,of,modal,functions,and,tions,of,myocardium,are,traditionally,performed,,the,left,atrium,quadrature,points,,can,also,be,readily,selected,by,setting,appro-,is,suciently,thin,that,it,can,be,reasonably,represented,as,a,where,p0,is,the,external,pressure,,A0,is,the,initial,cross-,priate,options,in,the,session,ï¬le.,p,=,p0,+,,pâ‡¡hE,âŒ«2)A0,(15),pA,,=,A0,(1,p,,,â‡£,âŒ˜,,,sectional,area,,E,is,the,Youngâ€™s,modulus,,h,is,the,vessel,wall,two-dimensional,manifold,embedded,in,three,dimensions,and,Given,the,complexity,and,highly,nonlinear,form,of,these,equations,,we,adopt,a,fully,explicit,formulation,to,discre-,solved,at,signiï¬cantly,reduced,computational,cost,[32].,The,plicit,timestepping,algorithms,implemented,through,the,gen-,magnetic,resonance,images,of,the,heart.,eral,linear,methods,framework,[16],,including,2nd,and,4th,order,An,example,of,a,left,atrium,simulation,is,illustrated,in,Fig-,Runge-Kutta,methods.,Finally,,in,order,to,stabilise,the,ï¬‚ow,ure,8.,Electrophysiological,characteristics,vary,spatially,,with,in,the,presence,of,discontinuities,we,utilise,a,shock,capturing,regions,of,scar,and,ï¬brosis,more,resistive,to,activation,,re-,technique,which,makes,use,of,artiï¬cial,viscosity,to,damp,os-,cillations,in,the,solution,,in,conjunction,with,a,discontinuity,sensor,adapted,from,the,approach,taken,in,[24],to,decide,where,11,context,of,high-order,ï¬nite,element,methods.,It,has,been,de-,tise,the,equations,in,time,,allowing,us,to,use,any,of,the,ex-,geometry,of,the,left,atrium,is,created,through,segmentation,of,the,onset,of,the,BÂ´enard-von,KÂ´armÂ´an,vortex,street.,This,is,a,+,H,=,S,well-established,test,case,for,which,signiï¬cant,analysis,is,avail-,able,in,the,literature.,We,show,in,Fig.,6,the,leading,eigen-,0,U,modes,for,the,direct,(,U,=,),and,adjoint,(,,,H,=,â‡¢,&#64;p,Aâ‡¤),linear,operators,for,&#64;A,U,â‡¢,1,f,S,=,,,#,&quot;,A,,&quot;,U,A,&quot;,#,A,&#64;U,&#64;x,A,&#64;U,&#64;t,(14),s,#,âŒ˜,in,which,A,is,the,Area,(related,to,pressure),,x,is,the,axial,coor-,â‡£,dinate,along,the,vessel,,U(x,,t),the,axial,velocity,,P(x,,t),is,the,pressure,in,the,tube,,â‡¢,is,the,density,and,ï¬nally,f,the,frictional,force,per,unit,length.,The,unknowns,in,equation,14,are,u,,A,and,p;,hence,we,must,provide,an,explicit,algebraic,relationship,to,close,this,system.,Typically,,closure,is,provided,by,an,algebraic,relationship,between,A,and,p.,For,a,thin,elastic,tube,this,is,given,by,p,=,p0,+,,pA,A0,,,,=,(15),,â‡£,p,âŒ˜,pâ‡¡hE,âŒ«2)A0,(1,,where,p0,is,the,external,pressure,,A0,is,the,initial,cross-,sectional,area,,E,is,the,Youngâ€™s,modulus,,h,is,the,vessel,wall,thickness,and,âŒ«,is,the,Poissonâ€™s,ratio.,Other,more,elaborate,pressure,-,area,relationships,are,currently,being,implemented,into,the,framework.,Application,of,Riemannâ€™s,method,of,char-,acteristics,to,Equations,14,and,15,indicates,that,velocity,and,area,are,propagated,through,the,system,by,forward,and,back-,ward,travelling,waves.,These,waves,are,reï¬‚ected,within,the,network,by,appropriate,treatment,of,interfaces,and,boundaries,(see,for,example,[34,,35]).,The,ï¬nal,system,of,equations,are,discretised,in,the,Nektar++,framework,using,a,discontinuous,Galerkin,projection.,To,illustrate,the,capabilities,of,the,PulseWaveSolver,,a,1D,geometry,was,created,by,extracting,the,centreline,directly,from,a,3D,segmentation,of,a,carotid,bifurcation,(the,extracted,cen-,treline,with,the,segmented,geometry,overlaid,is,shown,in,Fig-,ure,9).,At,the,inlet,a,half-sinusoidal,ï¬‚ow,proï¬le,was,applied,during,the,systolic,phase,,whist,during,the,diastolic,phase,a,no-,ï¬‚ow,condition,was,applied.,Although,this,proï¬le,is,not,rep-,resentative,of,the,carotid,wave,,it,is,useful,for,demonstrating,essential,dynamics,of,the,system,e.g.,reï¬‚ection,of,backward,travelling,waves,only,during,the,diastolic,phase.,At,the,outï¬‚ow,RCR,boundary,conditions,were,utilised,[35].,These,boundary,conditions,take,into,account,the,peripheral,resistance,and,com-,pliance,of,the,vasculature.,The,pressure,and,ï¬‚ow,results,are,shown,in,Figure,9.,The,insets,demonstrate,that,the,pressure,needs,about,4,cycles,to,reach,a,periodic,state.,To,conclude,this,section,,we,illustrate,the,ï¬‚exibility,of,the,software,in,combining,two,solvers,to,understand,mass,trans-,port,in,the,aorta.,We,consider,the,simulation,of,blood-ï¬‚ow,through,a,pair,of,intercostal,branches,in,the,decending,aorta.,The,three-dimensional,geometry,is,derived,from,CT,scans,and,is,meshed,using,a,combination,of,tetraheda,and,prismatic,el-,ements.,Prisms,are,used,to,better,capture,the,boundary,layer,close,to,the,wall,,while,tetrahedra,ï¬ll,the,remaining,interior,of,the,domain.,The,embedded,manifold,discretisation,code,can,be,used,to,compute,boundary,conditions,for,three-dimensional,simulations,where,the,complexity,of,the,geometry,precludes,the,use,of,analytic,conditions.,The,ï¬‚ow,is,modelled,using,the,incompressible,Navier-Stokes,equations,(see,Section,4.1).,In,this,case,,the,inlet,ï¬‚ow,proï¬le,To,discretise,these,equations,in,space,,we,adopt,an,approach,The,development,of,a,complex,and,extensive,software,which,allows,for,the,resolution,of,discontinuities,and,shocks,project,such,as,Nektar++,necessitates,the,adoption,of,certain,that,may,appear,in,the,solution,at,transonic,and,supersonic,ï¬‚ow,development,practices,to,enable,developers,to,easily,write,new,speeds.,We,therefore,use,approximations,to,our,solution,com-,code,for,their,features,without,breaking,the,code,for,other,peo-,prised,of,functions,which,are,not,continuous,across,element,ple.,The,code,is,managed,using,the,git,distributed,version,boundaries.,Traditionally,,we,follow,a,Galerkin,approach,by,control,system,[36],due,to,its,performance,,enhanced,support,utilising,the,variational,form,of,the,equations,in,order,to,ob-,for,branching,,as,well,as,supporting,oâ†µ-line,development.,All,tain,the,discontinuous,Galerkin,method.,One,of,the,key,fea-,development,is,performed,in,branches,and,only,after,rigor-,tures,of,Nektar++,is,the,ability,to,select,a,wide,range,of,nu-,ous,multi-architecture,testing,and,internal,peer-review,is,new,merical,options,,and,to,this,end,we,support,both,discontinuous,code,merged,into,the,main,codebase,,thereby,always,maintain-,the,addition,of,artiï¬cial,viscosity,is,needed.,Figure,4,shows,representative,results,from,compressible,ï¬‚ow,simulations,of,a,number,of,industrially-relevant,test,cases.,We,ï¬rst,highlight,two,simulations,which,utilise,the,Navier-Stokes,equations.,Fig.,4(a),demonstrates,the,three-dimensional,ver-,sion,of,the,compressible,solver,by,investigating,the,ï¬‚ow,over,a,cylinder,at,Re,=,3,900.,In,this,ï¬gure,we,visualise,isocontours,of,the,pressure,ï¬eld,and,colour,the,ï¬eld,according,to,the,den-,sity,â‡¢.,To,demonstrate,the,shock,capturing,techniques,available,in,the,code,,Fig.,4(b),shows,the,results,of,an,Euler,simulation,f,in,Equ.,9,is,the,solution,of,the,Poisson,problem,,computed,ing,a,stable,distribution.,Any,new,bugs,or,feature,requests,using,the,ADRSolver,,on,the,two-dimensional,inlet,boundary,are,tracked,using,the,Trac,issue-management,system,,which,8,12,Design,Approach,â€¢,Challenge:,Large,software,project,,many,developers.,â€¢,Hide,algorithmic,complexity.,â€¢,Tie,implementation,to,mathematics,wherever,possible.,â€¢,Compartmentalise,features,/,algorithms,/,data,structures.,â€¢,Choice,of,abstraction,-,â€œthere,is,more,than,one,way,to,skin,a,catâ€.,â€¢,Coding,paradigms:,template,pattern,,factory,pattern,-,Switch,algorithms,transparently,-,Aids,design,of,suitable,interfaces,between,components,-,Decoupling,of,code,-,faster,build,times,,more,robust,Library,structure,METISBoostTinyXMLHDF5gslibMPITetgenFFTWArpackNektar++,LibrariesIncompressible,Navier-StokesNekMesh...FieldConvertPETScOpenCascadeBLASLAPACKScotchCompressible,Navier-StokesCardiac,Electrophysiology,Library,structure,METISBoostTinyXMLHDF5gslibMPITetgenFFTWArpackNektar++,LibrariesIncompressible,Navier-StokesNekMesh...FieldConvertPETScOpenCascadeBLASLAPACKScotchCompressible,Navier-StokesCardiac,Electrophysiology,MultiRegionsLocalRegions-1-111SpatialDomainsStdRegionsLibUtilitiesSolverUtilsDISCRETISATIONAUXILIARYAPPLICATION,DOMAINCollections,+,MFNektar++,LibrariesGlobalMappingsNekMeshUtilsFieldUtils,Operator,Construction,Helmholtz,problem:,Weak,form,+,IBP:,MultiRegionsStdRegions-1-111SpatialDomainsLocalRegions,Operator,Construction,Helmholtz,problem:,Weak,form,+,IBP:,MultiRegionsStdRegions-1-111SpatialDomainsLocalRegionsCollections,+,Matrix,Free-1-111,Diffusion,solver,â€¢,Quick,example:,solve,the,diffusion,equation,with,backward,Euler:,âˆ‚u,âˆ‚t,=,Îµ,âˆ‡2u,un+1,âˆ’,un,Î”t,=,Îµ,âˆ‡2un+1,âˆ‡2un+1,âˆ’,un+1,ÎµÎ”t,=,âˆ’,un,ÎµÎ”t,â€¢,Involves,the,solution,of,a,Helmholtz,equation.,â€¢,Weâ€™ll,use,basic,routines,to,highlight,how,you,might,solve,this,using,fundamentals,of,the,library.,â€¢,In,Nektar++,,see,solvers/DiffusionSolver,for,full,source,code.,Diffusion,solver,Create,session,session,=,LibUtilities::SessionReader::CreateInstance(argc,,argv);,Set,up,a,mesh,string,var,=,session-&gt;GetVariable(0);,auto,mesh,=,SpatialDomains::MeshGraph::Read(session);,auto,field,=,MemoryManager&lt;MultiRegions::ContField2D&gt;,::AllocateSharedPtr(session,,mesh,,var);,Initial,conditions,int,nq,=,field-&gt;GetNpoints();,Array&lt;OneD,,double&gt;,x0(nq),,x1(nq),,x2(nq);,field-&gt;GetCoords(x0,,x1,,x2);,icond-&gt;Evaluate(x0,,x1,,x2,,0.0,,field-&gt;UpdatePhys());,Parameters,double,epsilon,=,session-&gt;GetParameter(&quot;epsilon&quot;);,double,delta_t,=,session-&gt;GetParameter(&quot;delta_t&quot;);,44,Time,integrate,Diffusion,solver,for,(int,n,=,0;,n,&lt;,nSteps;,++n),{,Vmath::Smul(nq,,-1.0/delta_t/epsilon,,field-&gt;GetPhys(),,1,,field-&gt;UpdatePhys(),,1);,field-&gt;HelmSolve(field-&gt;GetPhys(),,field-&gt;UpdateCoeffs(),,NullFlagList,,factors);,field-&gt;BwdTrans,(field-&gt;GetCoeffs(),,field-&gt;UpdatePhys());,},Output,fldIO-&gt;Write(outFile,,FieldDef,,FieldData);,Implementation,strategies,Implementation,strategies,Implementation,choices,Implementation,strategies,Finite,element,operation,evaluations,(e.g.,mass,matrix),form,bulk,of,simulation,cost;,however,can,be,evaluated,in,several,ways.,1D,basis,functions,Global,matrix,assemble,a,sparse,matrix,Local,evaluation,create,elemental,dense,matrices,+,assembly,map,Matrix,free,no,local,matrices,at,all,sum,factorisation,speedup,increasing,arithmetic,intensity,=Global,Strategy=Local,Strategy=Sum-factorisation=Local,Strategy=Sum-factorisation=Sum-factorisation,Collections,===Local,Matrix,StdMat1.,Apply,Jacobian,(L1)2.,L3,Multiply,by,ref.,matrix=IterPerExp1.ApplyJacobian(L1)2.,L2,multiply,by,ref.,matrixfor,i,=,1:N...SumFac,(Quad)1.,Apply,Jacobian,(L1)2.,L2,multiply,for,first,dim,ref.,matrix...=for,i,=,1:N3.,L2,multiply,for,second,dim,ref.,matrix=,Data,layout,Natural,to,consider,data,laid,out,element,by,element,degrees,of,freedom,elements,Data,layout,Exploit,vectorisation,by,grouping,DoFs,by,vector,width,degrees,of,freedom,elements,Use,of,vectorisation,â€¢,Operations,occur,over,groups,of,elements,of,size,of,vector,width,elements,â€¢,Use,C++,data,type,that,encodes,vector,operations,vs.,compiler,intrinsics.,â€¢,Templating,used,to,allow,compiler,to,unroll,as,much,as,possible.,256-bit,AVX2,basis,functions,âœ–,âœ–,âœ–,âœ–,4.3.2,3-D,elements,Pyramidal,A,similar,approach,to,the,2-D,elements,test,cases,was,taken,in,terms,of,generating,the,mesh,The,hardware,that,was,used,to,run,both,conï¬g-,geometry,for,the,3-D,element,test,cases.,How-,urations,was,a,compute,node,with,24,hardware,ever,,the,3-D,meshes,had,signiï¬cantly,less,el-,cores,,192GB,RAM,and,two,Intel,Xeon,Phi,7120,For,the,pyramidal,mesh,,there,were,6,elements,arranged,in,a,cuboid,volume.,The,mesh,can,be,seen,in,Figures,4.20,and,4.21.,The,solution,superimposed,onto,this,grid,can,be,seen,in,Fig-,ements,,as,the,focus,was,to,run,quick,tests,in,ure,4.22.,processors.,Tetrahedral,For,the,tetrahedral,mesh,,there,were,6,elements,arranged,in,a,cuboid,volume.,The,mesh,can,be,seen,in,Figure,4.23.,The,solution,superimposed,onto,this,grid,can,be,seen,in,Figure,4.24.,Timings,were,then,taken,for,the,four,test,cases,,with,polynomial,order,set,to,3,P,Ã†,Ã†,7.,The,timings,taken,for,the,quadrilateral,,prismatic,,pyramidal,and,tetrahedral,test,cases,can,be,seen,in,Figures,4.12,,4.13,,4.14,and,4.15,respec-,(4.4),order,to,aid,code,iteration,during,the,design,process.,Also,,each,test,case,was,only,run,25,4.3.1,2-D,elements,times,before,the,mean,was,taken.,For,testing,2-D,elements,,quadrilateral,and,tri-,angle,mesh,geometries,were,generated,in,Gmsh.,A,high,number,of,elements,in,each,mesh,was,de-,Hexahedral,sired,in,these,test,cases,,in,order,to,prevent,any,For,the,hexahedral,mesh,,there,were,6,elements,cases,of,data,being,stored,during,execution,,in-,arranged,in,a,cuboid,volume.,The,mesh,can,be,stead,of,computation,over,every,element.,Each,seen,in,Figure,4.16.,The,solution,superimposed,test,case,was,run,1000,times,,and,the,mean,was,onto,this,grid,can,be,seen,in,Figure,4.17.,taken.,Prismatic,c,4,Quadrilateral,3,3,3,c,4,For,the,prismatic,mesh,,there,were,54,elements,For,the,quadrilateral,mesh,,there,were,1972,ele-,ï¬z,arranged,in,a,cuboid,volume.,The,mesh,can,be,ments,arranged,in,a,hexagonal,shape.,The,mesh,seen,in,Figure,4.18.,The,solution,superimposed,can,be,seen,in,Figures,4.5,,4.6,and,4.7.,The,so-,onto,this,grid,can,be,seen,in,Figure,4.19.,lution,superimposed,onto,this,grid,can,be,seen,c,4,(4.5),tively.,in,Figure,4.8.,Triangular,For,the,triangular,mesh,,there,were,4096,ele-,ments,arranged,in,a,hexagonal,shape.,The,mesh,can,be,seen,in,Figures,4.9,and,4.10.,The,solu-,tion,superimposed,onto,this,grid,can,be,seen,in,Figure,4.11.,Timings,were,then,taken,for,both,of,these,test,For,the,3-D,cases,,the,forcing,function,and,boundary,conditions,used,were,similar:,uboundary,=,sin,ï¬x,ï¬y,sin,sin,a,4,3,b,4,3,c,4,3,ï¬z,where,a,,b,,c,were,set,to,arbitrary,constants,,and,f,=,â„,+,ï¬2,â‰ ,5,â€¡00,a2,+,â€¡11,b2,+,â€¡22,c2,3,ï¬x,sin,3,â€¡01,3,3,ab,4,â€¡02,ac,4,â€¡12,bc,4,3,a,4,cos,cos,sin,sin,3,ï¬x,3,a,4,ï¬x,3,a,4,ï¬x,a,4,3,ï¬y,46,ï¬z,sin,b,4,cos,3,ï¬y,c,4,sin,3,b,4,ï¬y,3,b,4,ï¬y,b,4,3,cos,cos,sin,cos,+,2ï¬2,+,2ï¬2,+,2ï¬2,ï¬z,ï¬z,The,exact,analytical,solution,,to,be,used,to,compare,to,the,numerical,solution,found,,was:,u,=,sin,ï¬x,ï¬y,sin,sin,a,4,3,b,4,3,c,4,3,ï¬z,(4.6),The,test,ï¬les,were,run,in,two,conï¬gurations,,with,and,without,the,ï¬‚ags,for,SIMD,vectori-,sation,on,during,compilation,in,cmake.,These,ï¬‚ags,were:,â€¢,NEKTAR,ENABLE,SIMD,AVX2,set,to,ON.,â€¢,CMAKE,CXX,FLAGS,set,to,-mavx2,-mfma.,Software,implementation,cases,,with,polynomial,order,set,to,3,Ã†,7.,The,timings,taken,for,the,quadrilateral,test,case,can,be,seen,in,Figure,4.3,,and,the,timings,taken,for,the,triangular,test,case,can,be,seen,in,Figure,4.4.,Ã†,P,Figure,4.12:,Timings,for,hexahedral,mesh.,Figure,4.13:,Timings,for,prismatic,mesh.,â„’(u),=,âˆ‡[D,â‹…,âˆ‡u],d,x,d,spatially-constant,diffusion,tensor,Figure,4.3:,Timings,for,quadrilateral,mesh.,Figure,4.4:,Timings,for,triangular,mesh.,Figure,4.14:,Timings,for,pyramidal,mesh.,Figure,4.15:,Timings,for,tetrahedral,mesh.,22,Good,speedups,observed,over,non-vectorised,versions,of,26,this,operator,for,both,2D,&amp;,3D,elements,Parallel,I/O,â€¢,Hierarchical,Data,Format,â€£,Scalable,and,high-performance,â€£,Used,for,both,input,and,output,â€£,Read/write,in,parallel,â€¢,Usage,â€£,Distribute,readingof,elements,â€£,Parallel,partition:,PTScotch,â€£,Top-down,reading,of,mesh,â€£,Bottom-up,object,construction,â€£,Read,ancillary,data,(composites).,Mesh,structure,&amp;,its,layout,within,a,HDF5,mesh,file.,Scalable,and,high-performanceUsed,for,both,input,and,outputRead/write,in,parallelHierarchical,Data,FormatDistribute,reading,of,elementsParallel,partition:,PT-scotchTop-down,reading,of,meshUsageBottom-up,object,constructionRead,ancillary,data,(composites),In-situ,processing,â€¢,Post-processing,poses,storage/,memory,challenges.,â€¢,In-situ,filter,for,using,existing,post-,processing,algorithms.,â€¢,Enables,efficient,calculation,of,derived,quantities,during,run.,â€¢,Modules,specified,in,XML,session,file.,Computation,of,vorticity,performed,every,100,timesteps,using,the,FieldConvert,filter.,Post-processing,poses,storage/memory,challengesIn-situ,filter,for,using,existing,post-processing,algorithmsEnables,efficient,calculation,of,derived,quantities,during,runModules,specified,in,XML,Python,interface,â€¢,Bindings,for,key,libraries.,â€¢,Simplify,usage,for,new,users,and,for,teaching.,â€¢,Access,from,other,software,packages.,â€¢,Leverages,Boost.Python.,â€¢,Interoperability,with,NumPy:,explicit,memory,sharing,between,Nektar++,arrays.,Simple,example,of,integration,within,a,quadrilateral,region.,Bindings,for,key,librariesSimplify,usage,for,newusers,and,for,teachingAccess,from,other,software,packagesLeverages,Boost.PythonInteroperability,with,NumPy,Summary,Summary,â€¢,Hopefully,a,useful,overview,of,high-order,methods,and,some,of,our,implementation,within,Nektar++.,â€¢,We,see,high-order,methods,as,an,enabling,technology,for,many,of,these,challenging,physics,problems.,â€¢,Some,areas,for,us,to,work,on,(some,discussion,on,this,later):,â€£,Mesh,generation,continues,to,be,a,focus,and,typically,quite,a,challenge,for,new,users.,â€£,Performance,portability,across,architectures,and,multi-architecture,support.,Nektar++,workshop,â€¢,We're,holding,our,6th,annual(ish),workshop,for,Nektar++.,â€¢,Good,opportunity,to,see,(or,contribute!),some,talks,around,recent,developments,in,Nektar++,and,application,areas,around,it.,â€¢,Also,good,opportunity,to,connect,with,the,various,developers,around,Nektar++.,â€¢,Will,be,held,13-16th,September,2022,at,Imperial,College,London.,â€¢,Registration,free!,https://www.nektar.info/community/workshops/nektar-workshop-2022/,Thanks,for,listening!,Questions?,david.moxey&#64;kcl.ac.uk,c.cantwell&#64;imperial.ac.uk,&#64;davidmoxey,www.nektar.info,gitlab.nektar.info,Mailing,list:,nektar-,users&#64;imperial.ac.uk" name="keywords" />

    <title>RP-01-hom_and_implementation_HighOrderMethodsTheirImplementationNektar &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="rp-01-hom-and-implementation-highordermethodstheirimplementationnektar">
<h1>RP-01-hom_and_implementation_HighOrderMethodsTheirImplementationNektar<a class="headerlink" href="#rp-01-hom-and-implementation-highordermethodstheirimplementationnektar" title="Permalink to this heading">Â¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/RP-01-hom_and_implementation_HighOrderMethodsTheirImplementationNektar.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/RP-01-hom_and_implementation_HighOrderMethodsTheirImplementationNektar.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>