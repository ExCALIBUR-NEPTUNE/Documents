
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="ExCALIBUR,Selection,of,the,physics,models,M2.8.1,Abstract,The,report,describes,work,for,ExCALIBUR,project,NEPTUNE,at,Milestone,2.8.1.,Minutes,of,meeting,to,form,report,on,technical,progress.,UKAEA,REFERENCE,AND,APPROVAL,SHEET,Client,Reference:,UKAEA,Reference:,CD/EXCALIBUR-FMS/0037,Issue:,Date:,1.00,April,27,,2021,Project,Name:,ExCALIBUR,Fusion,Modelling,System,Prepared,By:,Name,and,Department,Ed,Threlfall,Wayne,Arter,Signature,N/A,N/A,Date,April,27,,2021,April,27,,2021,BD,Reviewed,By:,Rob,Akers,April,27,,2021,Advanced,Dept.,Manager,Computing,Approved,By:,Rob,Akers,April,27,,2021,Advanced,Dept.,Manager,Computing,2,1,NEPTUNE,Meeting:,20,April,2021,2-3pm,BST,Present,•,Chair:,Wayne,Arter,,UKAEA,•,Felix,Parra,,Oxford,•,Michael,Barnes,,Oxford,•,Sarah,Newton,,UKAEA,•,John,Omotani,,UKAEA,•,Joseph,Parker,,UKAEA,•,Ed,Threlfall,,UKAEA,2,Minutes,WA,started,by,discussing,the,recent,report,‘03’,by,Oxford,,Physics,in,the,edge,of,fusion,de-,vices,[1].,(Two,other,reports,[2,,3],have,already,been,produced.),He,commended,the,very,good,report,,praising,an,accessible,(ie.,to,other,NEPTUNE,grant,holders),introduction,,followed,by,an,authoritative,literature,survey,(4,pages,of,references).,The,reviewer,had,passed,the,report,subject,to,only,minor,details.,WA,thought,the,focus,on,drift-ordered,ﬂuid,models,interesting,and,FP,con-,ﬁrmed,that,this,was,the,approach,taken,in,most,of,the,current,state-of-the-art,models.,WA,said,the,fundamental,dimension,is,the,size,of,the,ﬂow,ie.,the,size,of,the,boundary,sheath,,but,mentioned,there,could,be,an,alternative,expansion,for,higher,ﬂows,-,FP,agreed,and,cited,the,case,where,there,is,a,potential,difference,across,the,wall,(some,machines,do,this,eg.,rotating,mirrors,,but,not,tokamaks;,he,also,mentioned,biasing,the,divertor,though,this,idea,seems,to,have,been,abandoned,years,ago,for,reasons,that,were,unclear).,WA,said,potential,differences,made,performance,worse,and,that,the,pedestal,does,not,‘like’,having,ﬂow.,WA,moved,on,to,discuss,the,novel,research,content,of,the,report;,it,was,not,clear,what,model,would,be,best,ie.,full,gyrokinetics,,or,drift,kinetics,with,small,corrections,(easier).,FP,added,that,drift-plus-corrections,might,be,acceptable;,WA,stated,that,the,main,worry,with,this,approach,is,a,proper,energy,conservation,relation;,however,,a,cheap,model,is,certainly,needed,,in,order,to,perform,many,runs,with,the,aim,of,assessing,the,effect,of,damping,terms.,WA,mentioned,that,lots,of,diverging,types,of,calculations,were,performed,in,the,1990s.,WA,suggested,formulating,the,new,physics,in,the,form,of,a,variational,principle,,compatible,with,new,work,involving,adding,a,variational-based,DSL,to,NEKTAR++,as,part,of,ExCALIBUR,cross-cutting,theme,work,(this,could,allow,the,easy,passage,of,the,new,physics,into,an,exascale-enabled,code,in,the,next,three,years).,FP,mentioned,that,there,are,many,variational,approaches,,automatic,differentiation,etc.,so,many,possible,ways,of,formulating,physics,models.,WA,returned,to,his,own,questions,regarding,the,report,and,asked,FP,how,he,planned,to,proceed,next.,FP,responded,that,he,proposes,to,explore,three,areas,where,existing,work,is,lacking:,3,1.,Address,neutrals,,with,a,charge-exchange,operator;,2.,Wall,boundary,conditions;,3.,Calculation,of,the,electric,ﬁeld,(difﬁcult).,The,electric,ﬁeld,is,obtained,from,a,pressure,balance,equation,and,there,is,a,trick,in,gyrokinetics,for,calculating,it,from,a,small,polarization,density,term.,Material,on,the,pressure,balance,approach,is,included,in,FP’s,ﬁrst,report,(the,new,thing,is,to,try,this,in,the,higher-moment,approach,,meaning,the,electric,ﬁeld,can,be,derived,from,the,parallel,momentum,equation).,FP,is,not,sure,it,will,work,as,it,involves,a,rather,artiﬁcial,‘split’,of,an,equation.,WA,then,asked,about,similarities,to,the,asymptotic-preserving,schemes,as,used,by,Patrick,Farrell;,FP,said,this,problem,is,similar,-,it,involves,the,asymptotic,behaviour,of,a,small,parameter,(here,,the,gyroradius),though,it,does,not,clearly,fall,into,the,strict,ambit,of,asymptotic-preserving,problems.,WA,mentioned,that,even,if,implemented,using,asymptotic-preserving,methods,,PF’s,work,shows,that,a,degree,of,numerical,ingenuity,is,still,required.,It,seemed,that,FP,had,talked,with,PF,after,the,last,progress,meeting,to,revisit,a,problem,FP,had,worked,on,(without,success),in,the,past,-,it,seems,they,are,working,on,this,but,there,were,no,details.,WA,steered,the,discussion,back,to,the,report;,he,was,a,little,confused,by,the,discussion,of,particle,methods,(a,kinetic,model,may,be,attacked,as,a,5-D,ﬂuid,system,or,as,a,particle,system).,FP,stated,that,the,continuum,equations,are,integrable,using,particles;,WA,said,the,the,physics,suggests,this,is,so,but,that,electromagnetism,is,then,a,challenge.,FP,said,his,method,is,not,exclusive,to,ﬂuid,or,particle,approaches;,ﬂuid,methods,are,attractive,as,it,is,clear,how,to,do,a,spectral,implementation,,as,in,MB’s,work,(there,was,some,confusion,about,whether,a,spectral,particle,code,is,even,possible).,The,HAGIS,code,[4],(particles,coupled,to,spectral,force,ﬁelds),was,cited,-,Fourier,spectral,ﬁeld,representation,provides,a,nice,cut-off,here.,WA,said,he,had,brought,up,particles,because,of,sheath,effects,meaning,it,is,not,clear,what,boundary,conditions,to,use,for,In,this,context,,FP,has,extended,work,by,Geraldini,et,al,[5],to,derive,the,ﬂuids,near,the,wall.,distribution,of,ions,at,a,domain,end,(extension,involves,replacing,adiabatic,electrons,with,kinetic,ones);,this,distribution,is,input,into,a,(complicated),code,by,Geraldini,that,calculates,the,potential,at,the,wall,,and,which,electrons,come,back,,given,the,ion,distribution,at,the,presheath.,WA,wanted,to,understand,how,this,all,ﬁtted,together.,FP,said,for,ExCALIBUR,,,the,full,sheath,code,would,be,replaced,by,something,simpler,eg.,assuming,ions,always,leave,and,that,this,assumption,determines,the,potential,drop,,hence,a,simpliﬁed,boundary,condition.,The,motivation,here,was,not,to,start,simulations,with,a,full-blown,code,whose,true,results,are,unknown.,WA,mentioned,that,PIC,modelling,could,be,used,to,check,the,outputs,of,this,boundary,code.,FP,agreed,and,also,said,the,Geraldini,boundary,code,might,prove,unstable.,Regarding,PIC,coupling,,WA,asked,about,how,to,couple,the,different,representations,used,in,different,domains,,having,talked,previously,to,a,worker,on,the,XGC,boundary,code,who,had,admitted,that,the,determination,of,the,sizes,of,overlap,regions,was,done,largely,by,trial,and,error.,WA,had,previously,mentioned,methodological,concerns,about,instabilities,in,the,US,GENE,simulation,code.,FP,expressed,his,own,confusion,why,there,is,currently,work,to,couple,XGC,and,GENE,,given,that,these,are,both,kinetic,codes,(XGC,is,gyrokinetic,PIC,and,GENE,treats,a,5-D,continuum,model.,WA,mentioned,that,NASA,need,to,solve,the,particles,/,ﬂuids,dichotomy;,he,thought,XGC,was,best,for,boundaries,and,GENE,for,bulk.,WA,agrees,that,one,can,use,a,continuum,representation,but,worries,that,collision,operators,are,problematic;,further,to,this,,FP,asked,whether,particle,methods,were,better,for,collisions.,WA,4,said,that,collisions,have,been,done,for,many,years,and,the,trade-off,is,accurate,microphysics,but,much,noise,/,sampling,error;,he,mentioned,it,might,not,be,necessary,for,us,to,get,the,momentum,balance,strictly,correct.,FP,thinks,collisions,are,a,problem,in,PIC,too;,he,sees,why,the,neutronics,ﬁeld,uses,particle,codes,but,thinks,either,particle,or,continuum,appropriate,for,plasmas.,WA,mentions,collisions,in,ﬂuids,are,harder,because,both,particles,are,moving,and,generally,a,hard,problem,to,identify,a,particle,‘collision’,without,using,a,mesh.,FP,said,particle,vs.,continuum,is,not,considered,in,his,report.,WA,said,he,has,never,looked,into,rigorous,maths,behind,this,in,detail,and,opined,that,a,deﬁnitive,theory,is,needed,here.,WA,then,mentioned,that,in,classical,ﬂuids,,the,mean,free,path,is,used,to,determine,what,overlap,is,needed,(ie.,between,regions,simulated,using,continuum,and,particle,descriptions),-,can,this,be,applied,in,plasmas?,FP,opined,that,he,favours,ﬂuid,/,drift,models,for,two,reasons:,1),the,11-moment,equation,can,be,used,to,compute,the,electric,ﬁeld,and,2),one,has,better,control,over,the,energy;,in,different,regions,of,different,temperatures,,their,grids,can,rescale,‘automatically’.,There,is,scope,for,a,diagnostic,in,this,code,that,detects,that,the,distribution,is,Maxwellian,and,triggers,use,of,Braginskii,theory.,WA,mentioned,that,in,space,applications,,he,thought,he,recollected,that,the,mean,free,path,is,used,to,determine,whether,a,particle,description,is,needed,(it,is,clearly,more,attractive,to,simulate,a,ﬂuid,by,default,and,switch,unresolved,regions,to,use,a,more,expensive,particle,description,as,required,,rather,than,defaulting,to,particles);,NASA,applications,involve,compression,and,heating,near,a,nose,cone,giving,a,hot,,collisionless,gas,(and,indeed,a,plasma).,WA,asked,whether,there,exists,a,simple,problem,using,FP’s,formalism,in,which,the,need,for,a,particle,description,can,be,detected.,FP,answered,that,,in,his,experience,,the,need,for,kinetics,is,determined,heuristically,(he,used,the,phrase,‘fudge,factor’);,he,noted,that,even,if,the,mean,free,path,is,relatively,small,,collisionless,processes,involve,high,energy,particles,which,can,nevertheless,contribute,signiﬁcantly,to,transport,eg.,heat,ﬂuxes.,WA,invited,FP,to,talk,about,his,plans,for,future,work,and,FP,handed,over,to,MB,,who,has,imple-,mented,a,1+1-D,drift,kinetic,solver,which,evolves,the,distribution,function,,see,the,’02’,report,[3].,The,results,from,this,agree,with,kinetic,solvers,(once,they,apply,‘corrections’).,Technical,details:,implemented,in,Julia,using,the,FFTW3,library;,Chebyshev,pseudospectral,elements;,no,explicit,artiﬁcial,viscosity,but,uses,an,upwind,ﬂux,at,element,boundaries,so,it,has,slight,numerical,dis-,sipation:,apparently,they,deal,with,this,by,‘re-normalizing’,the,integral,over,velocity,space,so,it,remains,constant.,They,still,want,to,test,solving,for,the,electromagnetic,ﬁeld,in,this,code,(this,would,conclude,their,work,with,periodic,boundaries).,WA,mentioned,that,a,similar,code,could,be,implemented,in,MATLAB,but,that,this,would,run,slowly;,MB,added,that,JO,had,tested,the,Julia,code,vs.,C++,and,found,little,difference,in,speed.,There,followed,a,brief,discussion,on,DSLs,(unfortunately,FP,and,MB,missed,the,recent,DSL,meeting,due,to,other,commitments).,WA,mentioned,that,FIREDRAKE,is,build,around,Python,and,it,calls,C,code,,giving,a,possible,challenge,for,integrating,NEKTAR++,into,the,DSL,of,FIREDRAKE,as,part,of,a,forthcoming,cross-cutting,ExCALIBUR,bid.,MB,added,that,Julia,can,call,C++,or,Fortran,code.,WA,closed,the,meeting.,FP,checked,it,was,OK,for,JO,to,be,a,co-author,on,their,publication;,WA,said,there,was,no,issue,here,so,long,as,the,bidding,process,is,seen,to,be,transparent,and,fair.,He,reiterated,that,the,aim,of,UKAEA,is,to,make,codes,that,come,out,of,NEPTUNE,as,widely-available,as,possible.,5,Acknowledgement,The,support,of,the,UK,Meteorological,Ofﬁce,and,Strategic,Priorities,Fund,is,acknowledged.,References,[1],F.I,Parra,,M.,Barnes,,and,M.R.,Hardman.,Physics,in,the,edge,of,fusion,devices.,Technical,Report,2047357-TN-03-01,,UKAEA,Project,Neptune,,2021.,[2],F.I,Parra,,M.,Barnes,,and,M.R.,Hardman.,1D,drift,kinetic,models,with,periodic,boundary,con-,ditions.,Technical,Report,2047357-TN-01-02,,UKAEA,Project,Neptune,,2021.,[3],M.,Barnes,,F.I.,Parra,,and,M.R.,Hardman.,Numerical,study,of,1D,drift,kinetic,models,with,periodic,boundary,conditions.,Technical,Report,2047357-TN-02-01,,UKAEA,Project,Neptune,,2021.,[4],S.D.,Pinches,,L.C.,Appel,,J.,Candy,,S.E.,Sharapov,,H.L.,Berk,,D.,Borba,,B.N.,Breizman,,T.C.,Hender,,K.I.,Hopcraft,,G.T.A.,Huysmans,,and,W.,Kerner.,The,HAGIS,self-consistent,nonlinear,wave-particle,interaction,model.,Computer,Physics,Communications,,111(1):133–149,,1998.,[5],A.,Geraldini,,F.I.,Parra,,and,F.,Militello.,Dependence,on,ion,temperature,of,shallow-angle,magnetic,presheaths,with,adiabatic,electrons.,Journal,of,Plasma,Physics,,85(6),,2019.,6" name="keywords" />

    <title>CD-EXCALIBUR-FMS0037-M2.8.1_SelectionPhysics &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cd-excalibur-fms0037-m2-8-1-selectionphysics">
<h1>CD-EXCALIBUR-FMS0037-M2.8.1_SelectionPhysics<a class="headerlink" href="#cd-excalibur-fms0037-m2-8-1-selectionphysics" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/CD-EXCALIBUR-FMS0037-M2.8.1_SelectionPhysics.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/CD-EXCALIBUR-FMS0037-M2.8.1_SelectionPhysics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>