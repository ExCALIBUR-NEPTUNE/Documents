
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="technical note " name="description" />
<meta content="Report,2047357-TN-D2.5+M2.9,Overview,of,the,numerical,issues,and,ﬁndings,associated,with,the,1D,and,2D,drift,kinetic,models,M.,Barnes1,,M.,R.,Hardman1,,J.,Omotani2,and,F.,I.,Parra3,1,Rudolf,Peierls,Centre,for,Theoretical,Physics,,University,of,Oxford,,Clarendon,Laboratory,,Parks,Road,,Oxford,OX1,3PU,,United,Kingdom,2,Culham,Centre,for,Fusion,Energy,,Culham,Science,Centre,,Abingdon,,Oxon,,OX14,3DB,,United,Kingdom,3,Princeton,Plasma,Physics,Laboratory,,P.O.,Box,451,,Princeton,,New,Jersey,08540,,United,States,E-mail:,michael.barnes&#64;physics.ox.ac.uk,1.,Introduction,An,accurate,model,of,plasma,dynamics,in,the,edge,of,tokamaks,must,include,a,treatment,of,both,open,and,closed,ﬁeld,lines,,motion,both,along,and,across,the,(predominantly,toroidal),equilibrium,magnetic,ﬁeld,,and,interaction,between,charged,and,neutral,particles.,As,the,plasma,varies,from,nearly,collisionless,in,the,closed-ﬁeld-line,region,to,strongly,collisional,close,to,the,material,wall,,the,model,should,further,incorporate,kinetic,eﬀects,and,–,ideally,–,reduce,to,a,ﬂuid,description,where,appropriate.,We,considered,a,variety,of,diﬀerent,drift,kinetic,models,for,this,project,,each,addressing,diﬀerent,aspects,of,the,physics,needed,to,probe,key,features,of,plasma,dynamics,in,the,edge,of,tokamaks.,The,results,of,our,numerical,studies,of,these,models,is,contained,in,a,series,of,reports,[1,,2,,3,,4,,5,,6,,7,,8],,culminating,in,overviews,of,both,drift,kinetic,and,moment,kinetic,models,for,parallel,dynamics,[7],and,a,drift,kinetic,model,for,dynamics,in,a,homogeneous,,helical,magnetic,ﬁeld,[8].,In,particular,,for,details,on,the,current,state,of,our,most,physically-complete,numerical,model,,see,[8].,Rather,than,re-hashing,the,details,of,those,reports,here,,we,instead,provide,what,we,think,are,key,ﬁndings,from,our,numerical,studies,,including,a,discussion,of,numerical,diﬃculties,encountered,,how,they,were,(or,were,not),overcome,,outstanding,issues,and,possible,next,steps.,2.,Space-time,discretisation,For,all,model,varieties,we,considered,,we,chose,to,discretise,in,time,using,a,time-,marching,scheme,taken,from,the,family,of,Strong,Stability,Preserving,Runge-Kutta,schemes,and,in,space,using,Chebyshev,spectral,elements.,We,chose,these,discretisations,for,a,combination,of,robustness,,ease,of,implementation,and,computational,eﬃciency.,This,discretisation,worked,well,in,most,of,the,cases,we,considered,,with,good,convergence,properties;,c.f.,[7].,However,,we,did,sometimes,ﬁnd,it,necessary,to,use,upwinded,ﬂuxes,1,Overview,of,numerics,for,1D,and,2D,kinetic,models,2,at,element,boundaries,in,order,to,ensure,numerical,stability.,We,also,observed,poor,convergence,near,the,domain,boundary,for,cases,with,a,helical,ﬁeld,and,non-zero,radial,electric,ﬁeld;,this,is,discussed,separately,below.,Other,than,a,simple,ﬁnite-diﬀerence,discretisation,in,space,,which,performed,predictably,poorly,relative,to,the,spectral,element,approach,in,virtually,all,cases,,no,other,methods,were,attempted.,Though,beyond,the,scope,of,our,study,,it,may,thus,prove,proﬁtable,to,explore,other,discretisations.,It,is,perhaps,worth,noting,that,as,part,of,our,algorithm,,we,developed,a,scheme,for,ensuring,exact,conservation,of,particles,,momentum,and,energy,(where,appropriate),,c.f.,[7].,This,scheme,generically,improved,numerical,stability,and,was,particularly,necessary,to,maintain,stability,for,the,moment,kinetic,model.,At,present,,the,method,of,guaranteeing,conservation,properties,involves,correcting,the,nominal,distribution,function,with,a,function,whose,form,is,constrained,to,be,similar,to,a,Maxwellian,distribution,in,velocity,space.,Given,that,the,actual,distribution,function,may,be,far,from,Maxwellian,in,regions,of,the,edge,plasma,,it,may,be,worth,generalising,the,form,of,the,correction,used,in,the,code.,3.,Moment,kinetic,approach,One,of,the,main,aims,of,our,numerical,investigation,was,to,evaluate,the,eﬃcacy,of,a,novel,moment,kinetic,model,for,simulating,edge,plasma,dynamics.,This,model,has,the,advantage,of,decoupling,the,density,,ﬂow,and,pressure,evolution,from,the,evolved,particle,distribution,function,via,an,appropriate,choice,of,normalisation,[7].,Such,a,decoupling,has,the,potential,to,make,a,transition,between,ﬂuid,and,kinetic,treatments,more,straightforward,,as,well,as,enabling,a,more,eﬃcient,treatment,of,velocity,space,coordinates.,We,found,that,the,moment,kinetic,approach,performed,comparably,to,the,drift,kinetic,approach,when,simulating,parallel,dynamics,with,periodic,boundary,conditions,(corresponding,to,closed,ﬁeld,lines),but,became,problematic,when,employing,wall,boundary,conditions,(corresponding,to,open,ﬁeld,lines),[7].,The,genesis,of,this,issue,is,the,combination,of,two,things:,the,need,to,impose,a,wall,boundary,condition,on,the,particle,distribution,function,that,diﬀers,for,particles,with,positive,and,negative,parallel,velocities,,respectively;,and,the,fact,that,a,shifted,parallel,velocity,variable,is,used,in,the,moment,kinetic,approach,,rendering,the,true,parallel,velocity,a,function,of,time.,One,must,thus,impose,a,boundary,condition,at,a,point,in,phase,space,for,which,in,general,there,will,be,no,corresponding,grid,point,in,the,code.,It,is,possible,that,a,clever,choice,of,numerical,algorithm,may,overcome,this,diﬃculty,,but,we,were,unable,to,devise,such,an,algorithm,in,the,time,provided,that,could,solve,the,problem.,One,way,to,avoid,this,issue,would,be,to,separately,evolve,density,and,pressure,,but,not,the,ﬂow,[7].,However,,this,appears,to,sacriﬁce,one,of,the,main,advantages,of,the,moment,kinetic,approach:,the,ability,to,evolve,a,potentially,closed,set,of,low-order,ﬂuid,moments.,Consequently,,we,chose,to,focus,on,the,standard,drift,kinetic,approach,when,expanding,our,model,to,consider,helical,magnetic,ﬁelds.,Overview,of,numerics,for,1D,and,2D,kinetic,models,3,4.,Wall,boundary,condition,for,the,helical,magnetic,ﬁeld,As,described,in,[8],,inclusion,of,a,radial,electric,ﬁeld,in,the,model,modiﬁes,the,wall,boundary,condition,for,the,ions.,In,particular,,it,makes,the,critical,velocity,beyond,which,no,ions,can,be,present,a,function,of,the,time-dependent,radial,electric,ﬁeld.,This,introduces,a,problem,similar,to,the,one,described,above,for,the,wall,boundary,condition,when,using,the,moment,kinetic,approach.,One,potential,solution,–,yet,to,be,tried,–,would,be,to,deﬁne,a,shifted,parallel,velocity,coordinate,that,absorbs,the,time,dependence,of,the,radial,electric,ﬁeld,,thus,ensuring,that,the,zero,of,the,(shifted),velocity,is,on,the,grid,and,allowing,for,proper,enforcement,of,the,wall,boundary,condition.,In,the,absence,of,such,a,ﬁx,,It,has,been,veriﬁed,that,our,model,works,well,in,the,absence,of,the,radial,electric,ﬁeld,but,has,poor,convergence,when,the,ﬁeld,is,included.,Solution,of,this,problem,is,a,critical,next,step,necessary,to,make,further,progress.,5.,Interaction,between,ions,and,neutrals,Another,of,our,main,goals,was,to,assess,the,diﬃculty,of,treating,numerically,the,interaction,between,ions,and,neutrals,in,the,plasma,edge.,For,this,purpose,we,employed,relatively,simple,models,for,charge,exchange,and,ionisation,[7,,8].,The,main,numerical,issue,encountered,during,our,investigation,was,due,to,the,diﬀerence,in,the,velocity,space,dynamics,of,ions,and,neutrals:,gyrophase,information,can,be,averaged,away,for,ions,but,not,for,neutral,particles.,Because,the,neutrals,are,not,accelerated,by,the,Lorentz,force,,velocity,coordinates,aligned,with,the,spatial,domain,were,used.,Conversely,,the,velocity,grid,for,the,ions,was,chosen,to,align,with,the,magnetic,ﬁeld,to,take,advantage,of,the,lack,of,gyro-angle,dependence.,This,resulted,in,the,need,to,perform,three-dimensional,interpolation,in,the,velocity,space,when,accounting,for,ion-neutral,collisions.,One,promising,way,forward,would,be,to,use,ﬁeld-aligned,velocity,coordinates,for,the,neutrals,as,well.,This,would,eliminate,the,need,for,interpolation,,provided,the,ion,and,neutral,velocity,coordinates,were,normalised,in,the,same,way.,Such,a,normalisation,in,itself,could,lead,to,numerical,ineﬃciencies,if,the,temperatures,of,the,ions,and,neutrals,are,signiﬁcantly,diﬀerent,,as,the,velocity,grid,would,need,narrow,spacing,to,resolve,the,cold,species,dynamics,and,would,need,to,extend,to,large,values,to,resolve,the,hot,species,dynamics.,Use,of,the,moment,kinetic,approach,–,in,which,the,velocity,is,normalised,by,the,local,species,thermal,speed,–,would,overcome,this,but,re-introduce,the,problem,of,interpolation.,A,dedicated,study,of,the,eﬃciency,of,these,possible,approaches,would,be,beneﬁcial.,6.,Extensions,to,the,model,In,addition,to,the,outstanding,issues,raised,above,,there,are,numerous,extensions,that,can,be,made,proﬁtably,to,the,current,models.,The,magnetic,geometry,could,clearly,be,made,more,realistic,by,considering,full,toroidal,geometry,with,a,separatrix.,The,model,Overview,of,numerics,for,1D,and,2D,kinetic,models,4,for,electron,dynamics,(currently,an,assumed,Boltzmann,response),could,be,upgraded.,Collisions,between,diﬀerent,charged,particles,are,currently,absent.,A,more,sophisticated,treatment,of,the,wall,boundary,conditions,could,be,employed.,Electromagnetic,eﬀects,are,missing.,More,realistic,models,for,ion-neutral,collisions,could,be,used.,Toroidal,variations,in,the,distribution,function,could,be,taken,into,account.,While,there,is,clearly,much,that,could,be,done,to,improve,the,physics,ﬁdelity,of,the,model,,we,suggest,that,signiﬁcant,improvements,could,be,made,with,a,few,(relatively,straightforward),upgrades.,Much,of,the,interesting,physics,of,the,edge,could,be,explored,within,a,helical,magnetic,ﬁeld,,provided,it,is,extended,to,allow,for,inhomogeneity,and,for,’ﬂare’,in,the,ﬁeld,lines.,Combination,with,a,separatrix-like,region,to,demonstrate,transition,from,open,to,closed,ﬁeld,lines,would,then,provide,a,fairly,complete,picture,of,edge,magnetic,ﬁeld,geometry.,To,include,such,a,region,would,require,a,more,sophisticated,treatment,for,electrons,,with,possibilities,being,either,a,drift-kinetic,or,ﬂuid,treatment.,The,former,could,be,facilitated,by,use,of,a,mass,ratio,expansion,so,that,calculation,of,the,electrostatic,potential,does,not,become,prohibitively,expensive,in,simulation.,A,simpliﬁed,model,for,charged,particle,collisions,could,be,used,in,the,ﬁrst,instance,to,ensure,that,the,equilibrium,distribution,function,is,nudged,towards,a,Maxwellian,–,with,the,added,beneﬁt,of,aiding,possible,transition,to,a,ﬂuid,treatment.,Overview,of,numerics,for,1D,and,2D,kinetic,models,5,[1],M.,Barnes,,F.,I.,Parra,,and,M.,R.,Hardman.,Numerical,study,of,1d,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,2:2047357–TN–02,M2.1,,2021.,[2],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,4:2047357–,TN–04,M2.2,,2021.,[3],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,,moment-based,drift,kinetic,models,with,periodic,boundary,conditions.,Excalibur/Neptune,Report,,6:2047357–,TN–06,M2.3,,2021.,[4],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,drift,kinetic,model,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,8:2047357–TN–08,M2.4,,2021.,[5],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,moment,kinetic,model,with,wall,boundary,conditions.,Excalibur/Neptune,Report,,10:2047357–TN–10,M2.5,,2021.,[6],M.,Barnes.,Tests,for,a,2d,drift,kinetic,model,for,the,plasma,edge.,Excalibur/Neptune,Report,,12:2047357–TN–12,M1.5,,2021.,[7],M.,Barnes,,F.,I.,Parra,,M.,R.,Hardman,,and,J.,Omotani.,Numerical,study,of,1+1d,drift,kinetic,models,for,parallel,dynamics,in,the,plasma,edge.,Excalibur/Neptune,Report,,14:2047357–TN–14,D2.2,,2022.,[8],M.,R.,Hardman,,J.,Omotani,,M.,Barnes,,and,F.,I.,Parra.,Numerical,study,of,a,reduced,model,coupling,2d+2v,drift-kinetic,ions,and,2d-3v,kinetic,neutrals,in,a,helical,magnetic,ﬁeld,with,wall,boundaries.,Excalibur/Neptune,Report,,15:2047357–TN–15,D2.4,,2022." name="keywords" />

    <title>TN-14-2_OverviewNumerical1D2DDriftKinetic &#8212; Excalibur-Neptune Documents 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tn-14-2-overviewnumerical1d2ddriftkinetic">
<h1>TN-14-2_OverviewNumerical1D2DDriftKinetic<a class="headerlink" href="#tn-14-2-overviewnumerical1d2ddriftkinetic" title="Permalink to this heading">¶</a></h1>
<p>
                        <iframe
                                id="ID"
                                style="border:1px solid #666CCC"
                                title="PDF"
                                src="_static/TN-14-2_OverviewNumerical1D2DDriftKinetic.pdf"
                                frameborder="1"
                                scrolling="auto"
                                height="1600"
                                width="1100"
                                align="middle">
                        </iframe>
                     </p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Excalibur-Neptune Documents</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embeddedpdfs.html">Technical Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, UKAEA.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TN-14-2_OverviewNumerical1D2DDriftKinetic.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>